"use strict";(window["garfish-demo"]=window["garfish-demo"]||[]).push([[898],{3133:function(X,T,a){a.d(T,{Z:function(){return j}});var e=Object.defineProperty,C=(y,u,P)=>u in y?e(y,u,{enumerable:!0,configurable:!0,writable:!0,value:P}):y[u]=P,E=(y,u,P)=>(C(y,typeof u!="symbol"?u+"":u,P),P);const S=a(7258),N="ywkf_jwt";class j{static setAccessToken(u){S.set(N,u?`${u.token_type} ${u.access_token}`:"",{expires:new Date(u.expires_at*1e3)})}static getAccessToken(u){return S.get(u)}static clearAccessToken(u){S.remove(u)}}E(j,"key",N)},6592:function(X,T,a){a.d(T,{c:function(){return x}});var e=a(7977),C=a.n(e),E=a(6419),S=a(3133),N=Object.defineProperty,j=(I,_,o)=>_ in I?N(I,_,{enumerable:!0,configurable:!0,writable:!0,value:o}):I[_]=o,y=(I,_,o)=>(j(I,typeof _!="symbol"?_+"":_,o),o);const u="/api",P="6000";class x{constructor(_){y(this,"instance"),y(this,"baseConfig",{baseURL:u,timeout:Number(P)}),this.instance=C().create(Object.assign(this.baseConfig,_)),this.instance.interceptors.request.use(o=>(o.headers=o.headers||{},o.headers.Authorization=S.Z.getAccessToken("ywkf_jwt")||"",o),o=>Promise.reject(o)),this.instance.interceptors.response.use(o=>{const{data:c}=o,{code:b,message:O}=c;return b===1?(E.Z.error({message:O||"\u672A\u77E5\u9519\u8BEF"}),Promise.reject(c)):b===999?(E.Z.error({message:O||"\u767B\u5F55\u8FC7\u671F, \u8BF7\u91CD\u65B0\u767B\u5F55"}),Promise.reject(c)):b!==0?(E.Z.error({message:O||"\u672A\u5B9A\u4E49\u9519\u8BEF"}),Promise.reject(c)):(b===0&&O&&E.Z.success({message:O}),o.data)},o=>{let c="";switch(o.response.status){case 400:c="\u8BF7\u6C42\u9519\u8BEF(400)";break;case 401:c="\u672A\u6388\u6743\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55(401)";break;case 403:c="\u62D2\u7EDD\u8BBF\u95EE(403)";break;case 404:c="\u8BF7\u6C42\u51FA\u9519(404)";break;case 408:c="\u8BF7\u6C42\u8D85\u65F6(408)";break;case 500:c="\u670D\u52A1\u5668\u9519\u8BEF(500)";break;case 501:c="\u670D\u52A1\u672A\u5B9E\u73B0(501)";break;case 502:c="\u7F51\u7EDC\u9519\u8BEF(502)";break;case 503:c="\u670D\u52A1\u4E0D\u53EF\u7528(503)";break;case 504:c="\u7F51\u7EDC\u8D85\u65F6(504)";break;case 505:c="HTTP\u7248\u672C\u4E0D\u53D7\u652F\u6301(505)";break;default:c=`\u8FDE\u63A5\u51FA\u9519(${o.response.status})!`}return Promise.reject(o.response)})}request(_){return this.instance.request(_)}get(_,o){return this.instance.get(_,o)}post(_,o,c){return this.instance.post(_,o,c)}put(_,o,c){return this.instance.put(_,o,c)}delete(_,o){return this.instance.delete(_,o)}}var B=new x({})},1008:function(X,T,a){a.r(T),a.d(T,{default:function(){return ve}});var e=a(959),C=a(3009),E=a(5034),S=a(9570),N={title:"src-components-Header-components-Logo-Logo__title--LPvFo",logo:"src-components-Header-components-Logo-Logo__logo--lT8wK"},y=()=>e.createElement("div",{className:N.title},e.createElement("a",{className:N.logo,href:"/"})),u=a(9069),P=a(3390),x=a(8547),B=a(3905),I=a(9936),_=a(1516),o=a(9928),c=a.p+"images/62b5a93c32a9758ada6b.jpg",b={avatar:"src-components-Header-components-Avatar-Avatar__avatar--hUtVy",content:"src-components-Header-components-Avatar-Avatar__content--A2AAA",left:"src-components-Header-components-Avatar-Avatar__left--l1WTW",detail:"src-components-Header-components-Avatar-Avatar__detail--nKxLy",info:"src-components-Header-components-Avatar-Avatar__info--YQ0sJ",avatarDropDown:"src-components-Header-components-Avatar-Avatar__avatarDropDown--Y4jIW",headerAvatar__dropDown:"src-components-Header-components-Avatar-Avatar__headerAvatar__dropDown--nKTIC",dropdown__avatar:"src-components-Header-components-Avatar-Avatar__dropdown__avatar--JF1gs",body:"src-components-Header-components-Avatar-Avatar__body--EztvH",userInfo:"src-components-Header-components-Avatar-Avatar__userInfo--LBoTJ",dropdown__title:"src-components-Header-components-Avatar-Avatar__dropdown__title--zTHEP"},r=()=>{const t=(0,_.Z)(U=>U.currentUser),d=(0,o.Z)(U=>U.logout),i=(0,E.s0)(),R=U=>e.createElement("div",{className:b.headerAvatar__dropDown,style:{backgroundColor:"#fff",color:"rgba(0,0,0,0.88)"}},e.createElement("div",{className:b.dropdown__avatar},e.createElement("div",{className:b.body},e.createElement("img",{src:c,style:{width:38,height:38,borderRadius:"50%"}}),e.createElement("div",{className:b.userInfo},e.createElement("div",{className:b.dropdown__title},t?.cname),e.createElement("div",{className:b.info},`\u5DE5\u53F7\uFF1A${t?.name}`)))),e.cloneElement(U,{style:{boxShadow:"none",backgroundColor:"#fff",color:"rgba(0,0,0,0.88)"}})),G=()=>{d().then(()=>i("/auth",{replace:!0}))};return e.createElement(B.Z,{className:"avatarDropDown",menu:{items:[{key:"1",type:"divider"},{key:"account",label:e.createElement(u.rU,{to:"/cam/profile"},"\u4E2A\u4EBA\u8BBE\u7F6E"),icon:e.createElement(P.Z,null)},{type:"divider"},{key:"quit",label:e.createElement("div",{onClick:G},"\u9000\u51FA"),icon:e.createElement(x.Z,null)}]},dropdownRender:R},e.createElement("div",{className:b.avatar},e.createElement("div",{className:b.content},e.createElement("div",{className:b.left},e.createElement("div",{className:b.detail},t?.cname),e.createElement("div",{className:b.info},t?.name)),e.createElement("div",{className:b.right},e.createElement(I.C,{src:c})))))},v=a(410),n={rich__menu:"src-components-Header-components-Menu-Menu__rich__menu--cpTFC"},s=a(2430),p=Object.defineProperty,k=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,l=(t,d,i)=>d in t?p(t,d,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[d]=i,F=(t,d)=>{for(var i in d||(d={}))w.call(d,i)&&l(t,i,d[i]);if(k)for(var i of k(d))f.call(d,i)&&l(t,i,d[i]);return t},K=()=>{const t=Object.values(s.ZP.appInfos),d=(0,E.TH)(),i=(0,E.s0)(),R=(0,_.Z)(D=>D.navCode),{microActiveApps:G}=(0,_.Z)(),U=t.filter(D=>{var h,L;return((h=D?.props)==null?void 0:h.renderInHeaderMenu)!==!1&&R.includes((L=D?.props)==null?void 0:L.perarr)}),[Q,Y]=(0,e.useState)([]),J=(0,e.useMemo)(()=>U.map(D=>{var h,L;return F({label:(h=D?.props)==null?void 0:h.cname,key:(L=D?.props)==null?void 0:L.key},D)}),[U]);(0,e.useEffect)(()=>{Y(G.map(D=>D.name))},[G]);const q=({item:D,selectedKeys:h})=>{var L,Z;Y(h),i((Z=(L=D?.props)==null?void 0:L.activeWhen)!=null?Z:"/")};return e.createElement(C.ZP,{theme:{token:{colorBgContainer:"#0e79c6"},components:{Menu:{itemColor:"#fff",itemHoverColor:"#fff",horizontalItemSelectedColor:"#fff",horizontalItemSelectedBg:"rgb(11, 92, 150)"}}}},e.createElement(v.Z,{mode:"horizontal",items:J,className:n.rich__menu,selectedKeys:Q,onSelect:q}))},De={title:"src-components-Header-Header__title--vyiae",logo:"src-components-Header-Header__logo--WyxAe",header:"src-components-Header-Header__header--bGYv_"};const re=()=>e.createElement(C.ZP,{theme:{components:{Layout:{colorBgHeader:"#0e79c6"}}}},e.createElement(S.Z.Header,{className:"px-0 header flex",style:{height:50}},e.createElement(y,null),e.createElement(K,null),e.createElement(r,null)));var _e=a(5280),ne=a(9324),ce=a(8628),te=a(5033),de={siderMenu:"src-components-Sider-Sider__siderMenu--A10D5"},ie=Object.defineProperty,se=Object.getOwnPropertySymbols,me=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable,ae=(t,d,i)=>d in t?ie(t,d,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[d]=i,$=(t,d)=>{for(var i in d||(d={}))me.call(d,i)&&ae(t,i,d[i]);if(se)for(var i of se(d))le.call(d,i)&&ae(t,i,d[i]);return t};const ue=()=>{const{navCode:t,microActiveApps:d,siderRoutes:i}=(0,_.Z)(),[R,G]=(0,e.useState)([]),[U,Q]=(0,e.useState)(!1),[Y,J]=(0,e.useState)([]),[q,D]=(0,e.useState)([]),[h,L]=(0,e.useState)({routes:[],name:""}),Z=(0,E.TH)();(0,e.useEffect)(()=>{const A=oe(h?.routes,h?.name),z=pe(h?.routes,h?.name);G(z);const V="/"+Z.pathname.split(`/${h?.name}/`).join(""),m=(0,te.fp)(A,V);if(m&&m.length>0){const g=[];m.forEach(W=>{g.push(W.route.key)}),D([...g]),J([...g])}},[Z,h]);const oe=(A,z)=>{const V=[];return!Array.isArray(A)||A.length===0||A.forEach(m=>{const g=$({},m);if(g.url=z+"/"+m.path,m&&m.children&&m.children.length>0){const M=oe(m.children,g.url);M.length>0?g.children=M:delete g.children}const W=`${m.id}_${m.path}_${m.name}|${g.url}`;if(g.key=W,g.label=m.name,m.icon){const M=ee=>e.createElement(ne.Z,$({component:m.icon},ee));g.icon=e.createElement(M,null)}V.push(g)}),V},pe=(A,z)=>{const V=[];return!Array.isArray(A)||A.length===0||A.forEach(m=>{const g=$({},m);if(!t.find(M=>M===m.id))return[];if(m.hideInMenu===!0)return[];if(g.url=z+"/"+m.path,m&&m.children&&m.children.length>0){const M=pe(m.children,g.url);M.length>0?g.children=M:delete g.children}const W=`${m.id}_${m.path}_${m.name}|${g.url}`;if(g.key=W,g.label=e.createElement(u.rU,{to:`/${g.url}`,style:{color:"inherit"}},m.name),m.icon){const M=ee=>e.createElement(ne.Z,$({component:m.icon},ee));g.icon=e.createElement(M,null)}V.push(g)}),V};(0,e.useEffect)(()=>{L(i)},[i]);const ge=()=>{Q(A=>!A)},be=({keyPath:A})=>{J(A)},ke=A=>{D(A)};return e.createElement(S.Z.Sider,{trigger:null,collapsible:!0,collapsed:U,width:240,style:{boxShadow:"0 4px 8px rgb(32 45 64 / 5%), 0 1px 4px rgb(32 45 64 / 8%)"}},e.createElement(_e.Z,{active:!0,title:!1,loading:d.find(A=>A.loading),className:"p-2",paragraph:{rows:18,width:"100%"}},e.createElement("div",{className:"flex flex-column min-h-[calc(100vh_-_50px)] "},e.createElement("div",{className:"flex-1 flex flex-col bg-white relative"},e.createElement(v.Z,{mode:"inline",theme:"light",selectedKeys:Y,openKeys:q,items:d.find(A=>A.loading)?[]:R,onSelect:be,onOpenChange:ke,className:`py-4 ${de.siderMenu}`}),e.createElement("div",{style:{boxShadow:"0 4px 8px rgb(32 45 64 / 5%), 0 1px 4px rgb(32 45 64 / 8%)"},className:"flex absolute top-[10px] right-[-12px] items-center justify-center w-6 h-6 z-10 rounded-2xl cursor-pointer bg-white",onClick:ge},e.createElement(ce.Z,{rotate:U?180:0,style:{color:"#1677ff",fontSize:12}}))))))};var ve=()=>{const t=(0,_.Z)(R=>R.layout),d=(0,_.Z)(R=>R.setLayout),i=R=>{d(R)};return(0,e.useEffect)(()=>(s.ZP.channel.on("layout",i),()=>{s.ZP.channel.removeListener("layout",i)}),[]),e.createElement(C.ZP,{prefixCls:"rta",theme:{token:{fontFamily:"FAE8F6F96C59ED1,Microsoft Yahei,Hiragino Sans GB,tahoma,arial,B8B F53",colorTextBase:"rgba(0, 0, 0, 0.65)",colorTextSecondary:"rgba(0, 0, 0, 0.45)",colorTextHeading:"rgba(0, 0, 0, 0.85)",colorTextDisabled:"rgba(0, 0, 0, 0.25)"}}},e.createElement("div",{className:"flex flex-col h-full"},t.renderHeader?e.createElement(re,null):void 0,e.createElement("div",{className:"flex flex-row h-full"},t.renderSider?e.createElement(ue,null):void 0,e.createElement("div",{className:"module__app"},e.createElement(E.j3,null))),t.renderFooter?e.createElement("div",null,"\u5E95\u90E8"):void 0))}},9928:function(X,T,a){a.d(T,{Z:function(){return v}});var e=a(6497),C=a(3133),E=a(6592);const S=new E.c({});function N(n){return S.post("/main/gateway/login",n)}function j(n){return S.put("/main/gateway/logout",n)}var y=Object.defineProperty,u=Object.defineProperties,P=Object.getOwnPropertyDescriptors,x=Object.getOwnPropertySymbols,B=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable,_=(n,s,p)=>s in n?y(n,s,{enumerable:!0,configurable:!0,writable:!0,value:p}):n[s]=p,o=(n,s)=>{for(var p in s||(s={}))B.call(s,p)&&_(n,p,s[p]);if(x)for(var p of x(s))I.call(s,p)&&_(n,p,s[p]);return n},c=(n,s)=>u(n,P(s)),b=(n,s,p)=>new Promise((k,w)=>{var f=H=>{try{F(p.next(H))}catch(K){w(K)}},l=H=>{try{F(p.throw(H))}catch(K){w(K)}},F=H=>H.done?k(H.value):Promise.resolve(H.value).then(f,l);F((p=p.apply(n,s)).next())});const O=a(7258);var v=(0,e.Ue)()(n=>({showCaptcha:!1,loginStatus:!1,captchaR:(Math.random().toString(36).substr(2)+Math.random().toString(36).substr(2)).slice(2,18),loginLoading:!1,login:s=>b(void 0,null,function*(){n({loginLoading:!0});const{payload:p,redirect:k}=s;let w="",f=O.get("client");f||(f=(Math.random().toString(36).substr(2)+Math.random().toString(36).substr(2)).slice(2,18),O.set("client",f));try{const{data:l}=yield N(c(o({},p),{_xsrf:f}));return n({showCaptcha:!1}),C.Z.setAccessToken(l),l?.path!=""&&(w=l?.path),k&&(w=k),n({loginStatus:!0,loginLoading:!1}),{loginStatus:!0}}catch(l){return n({captchaR:(Math.random().toString(36).substr(2)+Math.random().toString(36).substr(2)).slice(2,18)}),l.message==="\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"&&n({showCaptcha:!0}),n({loginStatus:!1,loginLoading:!1}),{loginStatus:!1}}}),logout:()=>b(void 0,null,function*(){yield j({}),O.remove(C.Z.key),O.remove("_xsrf")})}))},1516:function(X,T,a){a.d(T,{Z:function(){return O}});var e=a(6497),C=a(6592);const E=new C.c({});function S(r){return E.get("/main/gateway/copyright",r)}function N(r){return E.get("/main/gateway/profile",r)}function j(r){return E.get("/main/gateway/perarr",r)}function y(r){return E.get("/main/gateway/module",r)}var u=a(6685),P=Object.defineProperty,x=Object.getOwnPropertySymbols,B=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable,_=(r,v,n)=>v in r?P(r,v,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[v]=n,o=(r,v)=>{for(var n in v||(v={}))B.call(v,n)&&_(r,n,v[n]);if(x)for(var n of x(v))I.call(v,n)&&_(r,n,v[n]);return r},c=(r,v,n)=>new Promise((s,p)=>{var k=l=>{try{f(n.next(l))}catch(F){p(F)}},w=l=>{try{f(n.throw(l))}catch(F){p(F)}},f=l=>l.done?s(l.value):Promise.resolve(l.value).then(k,w);f((n=n.apply(r,v)).next())}),O=(0,e.Ue)()((r,v)=>({year:{s:"0",e:"0"},currentUser:{},navCode:[],microActiveApps:[],siderRoutes:{},getYearData:n=>c(void 0,null,function*(){const{data:s}=yield S(n);r({year:s.year})}),syncGetCurrentUser:n=>{N(n).then(s=>{const{data:p}=s;r({currentUser:p?.user})})},getCurrentUser:n=>c(void 0,null,function*(){const{data:s}=yield N({});return r({currentUser:s?.user}),{currentUser:s?.user}}),syncGetNav:n=>{j(n).then(s=>{const{data:p}=s;r({navCode:p})})},getNav:n=>c(void 0,null,function*(){const{data:s}=yield j(n);return r({navCode:s}),{navCode:s}}),modules:[],syncGetModule:n=>{y(n).then(s=>{const{data:p}=s;r({modules:p})})},getModule:n=>c(void 0,null,function*(){const{data:s}=yield y(n);return r({modules:s}),{modules:s}}),getBasicInfo:n=>c(void 0,null,function*(){try{const s=v().getCurrentUser,p=yield s(n),k=v().getNav,w=yield k(n),f=v().getModule,l=yield f(n);return o(o(o({},p),w),l)}catch(s){return console.log(s),{currentUser:"",navCode:[],modules:[]}}}),layout:{renderFooter:!1,renderHeader:!0,renderSider:!0},setLayout:n=>{const s=v().layout;r({layout:o(o({},s),n)})},setMicroActiveApps:n=>{const{action:s,appInfo:p}=n,k=u.Z.cloneDeep(v().microActiveApps);switch(s){case"add":if(k.find(l=>l.id===p.id))return;k.push(p),r({microActiveApps:k});return;case"delete":const w=k.findIndex(l=>l.id===p.id);if(w===-1)return;k.splice(w,1),r({microActiveApps:k});return;case"update":const f=k.findIndex(l=>l.id===p.id);if(f===-1)return;k[f]=p,r({microActiveApps:k});return}},setSiderRoutes:n=>{const s=v().siderRoutes;r({siderRoutes:o(o({},s),n)})}}))}}]);
