(window["garfish-demo"] = window["garfish-demo"] || []).push([["vendors-node_modules_pnpm_antd_5_8_0_moment_2_29_4_react-dom_18_2_0_react_18_2_0_node_modules-64ba58"],{

/***/ "./node_modules/.pnpm/@garfish+browser-snapshot@1.16.2/node_modules/@garfish/browser-snapshot/dist/esm/index.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@garfish+browser-snapshot@1.16.2/node_modules/@garfish/browser-snapshot/dist/esm/index.js ***!
  \**********************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   GarfishBrowserSnapshot: function() { return /* binding */ GarfishBrowserSnapshot; },
/* harmony export */   "default": function() { return /* binding */ Sandbox; }
/* harmony export */ });
// src/patchers/event.ts
var rawAddEventListener;
var rawRemoveEventListener;
var PatchEvent = class {
  constructor() {
    this.listenerMap = /* @__PURE__ */ new Map();
  }
  activate() {
    this.listenerMap.forEach((listeners, type) => [...listeners].forEach((listener) => window.addEventListener(type, listener)));
    if (!rawAddEventListener || !rawRemoveEventListener) {
      rawAddEventListener = window.addEventListener;
      rawRemoveEventListener = window.removeEventListener;
    }
    window.addEventListener = (type, listener, options) => {
      const listeners = this.listenerMap.get(type) || [];
      this.listenerMap.set(type, [...listeners, listener]);
      return rawAddEventListener.call(window, type, listener, options);
    };
    window.removeEventListener = (type, listener, options) => {
      const storedTypeListeners = this.listenerMap.get(type);
      if (storedTypeListeners && storedTypeListeners.length && storedTypeListeners.indexOf(listener) !== -1) {
        storedTypeListeners.splice(storedTypeListeners.indexOf(listener), 1);
      }
      return rawRemoveEventListener.call(window, type, listener, options);
    };
  }
  deactivate() {
    this.listenerMap.forEach((listeners, type) => [...listeners].forEach((listener) => window.removeEventListener(type, listener)));
    window.removeEventListener = rawRemoveEventListener;
    window.addEventListener = rawAddEventListener;
  }
};

// src/patchers/interceptor.ts
function isStyledComponentsLike(element) {
  var _a;
  return element instanceof HTMLStyleElement && !element.textContent && ((_a = element.sheet) == null ? void 0 : _a.cssRules.length);
}
var Snapshot = class {
  constructor(arrDoms) {
    this.arrDoms = arrDoms;
    this.arrDoms = arrDoms;
  }
  static take(target = document.head) {
    let list;
    if (target.childNodes) {
      list = Array.prototype.slice.call(target.childNodes);
    } else {
      list = Array.prototype.slice.call(target);
    }
    return new Snapshot(list);
  }
  diff(s) {
    if (!s) {
      return {
        created: new Snapshot([]),
        removed: new Snapshot([])
      };
    }
    return {
      created: new Snapshot(this.arrDoms.filter((d) => s.arrDoms.indexOf(d) === -1)),
      removed: new Snapshot(s.arrDoms.filter((d) => this.arrDoms.indexOf(d) === -1))
    };
  }
};
var Interceptor = class {
  constructor(dom = document.head) {
    this.dom = dom;
    this.dom = dom;
    this.dynamicStyleSheetElementSet = /* @__PURE__ */ new Set();
    this.styledComponentCSSRulesMap = /* @__PURE__ */ new WeakMap();
  }
  add(createdOrSnapshot, removed) {
    let created;
    if (!removed) {
      const diff = Snapshot.take(this.dom).diff(createdOrSnapshot);
      created = diff.created;
      removed = diff.removed;
    } else {
      created = createdOrSnapshot;
    }
    created.arrDoms.reduce((prev, val) => {
      var _a, _b;
      prev.appendChild(val);
      if (val instanceof HTMLStyleElement) {
        const cssRules = this.styledComponentCSSRulesMap.get(val);
        if (cssRules && cssRules.length) {
          for (let i = 0; i < cssRules.length; i++) {
            const cssRule = cssRules[i];
            (_b = val.sheet) == null ? void 0 : _b.insertRule(cssRule.cssText, (_a = val.sheet) == null ? void 0 : _a.cssRules.length);
          }
        }
      }
      return prev;
    }, this.dom);
    removed.arrDoms.reduce((prev, val) => {
      prev.removeChild(val);
      return prev;
    }, this.dom);
  }
  remove(createdOrSnapshot, removed) {
    let created;
    if (!removed) {
      const diff = Snapshot.take(this.dom).diff(createdOrSnapshot);
      created = diff.created;
      removed = diff.removed;
    } else {
      created = createdOrSnapshot;
    }
    created.arrDoms.reduce((prev, val) => {
      var _a;
      if (val instanceof HTMLStyleElement && isStyledComponentsLike(val) && ((_a = val == null ? void 0 : val.sheet) == null ? void 0 : _a.cssRules)) {
        this.styledComponentCSSRulesMap.set(val, val.sheet.cssRules);
      }
      prev.removeChild(val);
      return prev;
    }, this.dom);
    removed.arrDoms.reduce((prev, val) => {
      prev.appendChild(val);
      return prev;
    }, this.dom);
  }
};

// src/patchers/style.ts
var PatchStyle = class {
  constructor() {
    this.headInterceptor = new Interceptor(document.head);
  }
  activate() {
    this.domSnapshotBefore = Snapshot.take();
    if (this.domSnapshotMutated)
      this.headInterceptor.add(this.domSnapshotMutated.created, this.domSnapshotMutated.removed);
  }
  deactivate() {
    const domSnapshot = Snapshot.take();
    this.domSnapshotMutated = domSnapshot.diff(this.domSnapshotBefore);
    if (!this.domSnapshotMutated)
      return;
    this.headInterceptor.remove(this.domSnapshotMutated.created, this.domSnapshotMutated.removed);
  }
  formateCtx(arrDoms) {
    const effectMap = {
      style: [],
      script: [],
      other: []
    };
    arrDoms.forEach((dom) => {
      let type = "other";
      if (/css/.test(dom.type))
        type = "style";
      if (/javascript/.test(dom.type))
        type = "script";
      effectMap[type].push({
        src: dom.src,
        outerHTML: dom.outerHTML,
        content: dom.innerText
      });
    });
    return effectMap;
  }
};

// src/patchers/history.ts
var rawPushState;
var rawReplaceState;
var PatchHistory = class {
  activate() {
    if (!rawPushState || !rawReplaceState) {
      rawPushState = window.history.pushState;
      rawReplaceState = window.history.replaceState;
    }
  }
  deactivate() {
    window.history.pushState = rawPushState;
    window.history.replaceState = rawReplaceState;
  }
};

// src/patchers/interval.ts
var rawInterval = window.setInterval;
var rawClearInterval = window.clearInterval;
var PatchInterval = class {
  constructor() {
    this.intervals = [];
  }
  activate() {
    window.setInterval = (handler, timeout, ...args) => {
      const intervalId = rawInterval(handler, timeout, ...args);
      this.intervals = [...this.intervals, intervalId];
      return intervalId;
    };
    window.clearInterval = (intervalId) => {
      this.intervals = this.intervals.filter((id) => id !== intervalId);
      return rawClearInterval(intervalId);
    };
  }
  deactivate(_clearEffects) {
    if (_clearEffects) {
      this.intervals.forEach((id) => window.clearInterval(id));
    }
    window.setInterval = rawInterval;
    window.clearInterval = rawClearInterval;
  }
};

// src/patchers/variable.ts
var hasOwnProperty = Object.prototype.hasOwnProperty;
function hasOwn(obj, key) {
  return hasOwnProperty.call(obj, key);
}
var PatchGlobalVal = class {
  constructor(targetToProtect = typeof window !== "undefined" ? window : globalThis, protectVariable = []) {
    this.targetToProtect = targetToProtect;
    this.protectVariable = protectVariable;
    this.snapshotOriginal = /* @__PURE__ */ new Map();
    this.snapshotMutated = /* @__PURE__ */ new Map();
    this.whiteList = [
      "location",
      "addEventListener",
      "removeEventListener",
      "webpackJsonp"
    ];
    this.targetToProtect = targetToProtect;
    this.protectVariable = protectVariable;
    this.whiteList = [...this.whiteList, ...protectVariable];
  }
  safeIterator(fn) {
    for (const i in this.targetToProtect) {
      if (this.whiteList.indexOf(i) !== -1) {
        continue;
      }
      const prop = Object.getOwnPropertyDescriptor(this.targetToProtect, i);
      if (!prop || !prop.writable) {
        continue;
      }
      if (hasOwn(this.targetToProtect, i)) {
        fn(i);
      }
    }
  }
  activate() {
    this.safeIterator((i) => {
      this.snapshotOriginal.set(i, this.targetToProtect[i]);
    });
    this.snapshotMutated.forEach((val, mutateKey) => {
      this.targetToProtect[mutateKey] = this.snapshotMutated.get(mutateKey);
    });
  }
  deactivate() {
    const deleteMap = {};
    const updateMap = {};
    const addMap = {};
    this.safeIterator((normalKey) => {
      if (this.snapshotOriginal.get(normalKey) !== this.targetToProtect[normalKey]) {
        this.snapshotMutated.set(normalKey, this.targetToProtect[normalKey]);
        this.targetToProtect[normalKey] = this.snapshotOriginal.get(normalKey);
        if (this.targetToProtect[normalKey] === void 0) {
          addMap[normalKey] = this.snapshotMutated.get(normalKey);
        } else {
          updateMap[normalKey] = this.snapshotMutated.get(normalKey);
        }
      }
      this.snapshotOriginal.delete(normalKey);
    });
    this.snapshotOriginal.forEach((val, deleteKey) => {
      this.snapshotMutated.set(deleteKey, this.targetToProtect[deleteKey]);
      this.targetToProtect[deleteKey] = this.snapshotOriginal.get(deleteKey);
      deleteMap[deleteKey] = this.targetToProtect[deleteKey];
    });
  }
};

// src/patchers/webpackjsonp.ts
var PatchWebpackJsonp = class {
  activate() {
    this.preWebpackJsonp = window.webpackJsonp;
    window.webpackJsonp = this.currentWebpackJsonp;
  }
  deactivate() {
    this.currentWebpackJsonp = window.webpackJsonp;
    window.webpackJsonp = this.preWebpackJsonp;
  }
};

// src/sandbox.ts
var Sandbox = class {
  constructor(name, protectVariable = [], targetToProtect = typeof window !== "undefined" ? window : globalThis, isInBrowser = typeof window === "undefined" ? false : true) {
    this.name = name;
    this.protectVariable = protectVariable;
    this.targetToProtect = targetToProtect;
    this.isInBrowser = isInBrowser;
    this.type = "snapshot";
    this.isRunning = false;
    this.patchList = [];
    this.name = name;
    this.isInBrowser = isInBrowser;
    this.patchList.push(new PatchGlobalVal(targetToProtect, protectVariable));
    if (this.isInBrowser) {
      this.patchList = [
        ...this.patchList,
        new PatchStyle(),
        new PatchEvent(),
        new PatchHistory(),
        new PatchInterval(),
        new PatchWebpackJsonp()
      ];
    }
  }
  activate() {
    if (this.isRunning)
      return;
    this.patchList.forEach((patch) => {
      patch.activate();
    });
    this.isRunning = true;
  }
  deactivate(clearEffects = true) {
    if (!this.isRunning)
      return;
    [...this.patchList].reverse().forEach((patch) => {
      patch.deactivate(clearEffects);
    });
    this.isRunning = false;
  }
};

// src/index.ts
function GarfishBrowserSnapshot(op) {
  return function(Garfish) {
    const options = {
      openBrowser: false,
      version: "1.16.2",
      name: "browser-snapshot",
      afterLoad(appInfo, appInstance) {
        var _a;
        const config = op || { open: true };
        const sandboxConfig = appInfo.sandbox || ((_a = Garfish == null ? void 0 : Garfish.options) == null ? void 0 : _a.sandbox);
        if (sandboxConfig === false || sandboxConfig.open === false || (sandboxConfig == null ? void 0 : sandboxConfig.snapshot) === false) {
          config.open = false;
        }
        if (sandboxConfig) {
          config.protectVariable = [
            ...(Garfish == null ? void 0 : Garfish.options.protectVariable) || [],
            ...appInfo.protectVariable || []
          ];
        }
        options.openBrowser = !!config.open;
        if (!config.open)
          return;
        if (appInstance) {
          if (appInstance.snapshotSandbox)
            return;
          const sandbox = new Sandbox(appInfo.name, config.protectVariable);
          appInstance.snapshotSandbox = sandbox;
        }
      },
      beforeMount(appInfo, appInstance) {
        if (!appInstance.snapshotSandbox)
          return;
        appInstance.snapshotSandbox.activate();
      },
      afterUnmount(appInfo, appInstance) {
        if (!appInstance.snapshotSandbox)
          return;
        appInstance.snapshotSandbox.deactivate();
      }
    };
    return options;
  };
}



/***/ }),

/***/ "./node_modules/.pnpm/@garfish+browser-vm@1.16.2/node_modules/@garfish/browser-vm/dist/esm/index.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@garfish+browser-vm@1.16.2/node_modules/@garfish/browser-vm/dist/esm/index.js ***!
  \**********************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   GarfishBrowserVm: function() { return /* binding */ GarfishBrowserVm; },
/* harmony export */   "default": function() { return /* binding */ Sandbox; }
/* harmony export */ });
/* harmony import */ var _garfish_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @garfish/utils */ "./node_modules/.pnpm/@garfish+utils@1.16.2/node_modules/@garfish/utils/dist/esm/index.js");
/* harmony import */ var _garfish_loader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @garfish/loader */ "./node_modules/.pnpm/@garfish+loader@1.16.2/node_modules/@garfish/loader/dist/esm/index.js");
/* harmony import */ var _garfish_hooks__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @garfish/hooks */ "./node_modules/.pnpm/@garfish+hooks@1.16.2/node_modules/@garfish/hooks/dist/esm/index.js");
/* provided dependency */ var process = __webpack_require__(/*! process/browser */ "./node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");
var __defProp = Object.defineProperty;
var __defProps = Object.defineProperties;
var __getOwnPropDescs = Object.getOwnPropertyDescriptors;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a, b) => {
  for (var prop in b || (b = {}))
    if (__hasOwnProp.call(b, prop))
      __defNormalProp(a, prop, b[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b)) {
      if (__propIsEnum.call(b, prop))
        __defNormalProp(a, prop, b[prop]);
    }
  return a;
};
var __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));

// src/pluginify.ts


// src/sandbox.ts



// src/modules/history.ts


// src/proxyInterceptor/shared.ts


// src/utils.ts


// src/symbolTypes.ts
var GARFISH_NAMESPACE_PREFIX = "__Garfish__";
var GARFISH_OPTIMIZE_NAME = "__garfish_optimize__";
var __proxyNode__ = Symbol.for("garfish.proxyNode");
var __domWrapper__ = Symbol.for("garfish.domWrapper");
var __windowBind__ = Symbol.for("garfish.windowBind");
var __sandboxMap__ = Symbol.for("garfish.sandboxMap");
var __documentBind__ = Symbol.for("garfish.documentBind");
var __garfishGlobal__ = Symbol.for("garfish.globalObject");
var __elementSandboxTag__ = Symbol.for("garfish.elementSandboxTag");

// src/utils.ts
var esGlobalMethods = "eval,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Array,ArrayBuffer,BigInt,BigInt64Array,BigUint64Array,Boolean,DataView,Date,Error,EvalError,FinalizationRegistry,Float32Array,Float64Array,Function,Int8Array,Int16Array,Int32Array,Map,Number,Object,Promise,Proxy,RangeError,ReferenceError,RegExp,Set,SharedArrayBuffer,String,Symbol,SyntaxError,TypeError,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,URIError,WeakMap,WeakRef,WeakSet,Atomics,JSON,Math,Reflect,".split(",");
var nativeCodeMethods = "hasOwnProperty,".split(",");
var isEsGlobalMethods = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.makeMap)(esGlobalMethods);
var isNativeCodeMethods = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.makeMap)(nativeCodeMethods);
var optimizeMethods = [...esGlobalMethods].filter((v) => v !== "eval");
var sandboxList = /* @__PURE__ */ new Map();
if (!window[__sandboxMap__]) {
  window[__sandboxMap__] = sandboxList;
} else {
  sandboxList = window[__sandboxMap__];
}
var sandboxMap = {
  sandboxMap: sandboxList,
  get(element) {
    if (!element)
      return;
    const sandboxId = element[__elementSandboxTag__];
    if (typeof sandboxId !== "number")
      return;
    return this.sandboxMap.get(sandboxId);
  },
  setElementTag(element, sandbox) {
    if (!element)
      return;
    element[__elementSandboxTag__] = sandbox.id;
  },
  set(sandbox) {
    if (this.sandboxMap.get(sandbox.id))
      return;
    this.sandboxMap.set(sandbox.id, sandbox);
  },
  del(sandbox) {
    this.sandboxMap.delete(sandbox.id);
  }
};
function handlerParams(args) {
  args = Array.isArray(args) ? args : Array.from(args);
  return args.map((v) => {
    return v && v[__proxyNode__] ? v[__proxyNode__] : v;
  });
}
function rootElm(sandbox) {
  const container = sandbox && sandbox.options.el;
  return container && container();
}
function createFakeObject(target, filter, isWritable) {
  const fakeObject = {};
  const propertyMap = {};
  const storageBox = /* @__PURE__ */ Object.create(null);
  const propertyNames = Object.getOwnPropertyNames(target);
  const def2 = (p) => {
    const descriptor = Object.getOwnPropertyDescriptor(target, p);
    if (descriptor == null ? void 0 : descriptor.configurable) {
      const hasGetter = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(descriptor, "get");
      const hasSetter = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(descriptor, "set");
      const canWritable = typeof isWritable === "function" && isWritable(p);
      if (hasGetter) {
        descriptor.get = () => (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(storageBox, p) ? storageBox[p] : target[p];
      }
      if (hasSetter) {
        descriptor.set = (val) => {
          storageBox[p] = val;
          return true;
        };
      }
      if (canWritable) {
        if (descriptor.writable === false) {
          descriptor.writable = true;
        } else if (hasSetter) {
          descriptor.set = (val) => {
            storageBox[p] = val;
            return true;
          };
        }
      }
      Object.defineProperty(fakeObject, p, Object.freeze(descriptor));
    }
  };
  propertyNames.forEach((p) => {
    propertyMap[p] = true;
    typeof filter === "function" ? !filter(p) && def2(p) : def2(p);
  });
  for (const prop in target) {
    !propertyMap[prop] && def2(prop);
  }
  return fakeObject;
}
var setting = true;
function microTaskHtmlProxyDocument(proxyDocument) {
  const html = document.children[0];
  if (html && html.parentNode !== proxyDocument) {
    Object.defineProperty(html, "parentNode", {
      value: proxyDocument,
      configurable: true
    });
    if (setting) {
      setting = false;
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.nextTick)(() => {
        setting = true;
        Object.defineProperty(html, "parentNode", {
          value: document,
          configurable: true
        });
      });
    }
  }
}
function isStyledComponentsLike(element) {
  return element instanceof HTMLStyleElement && !element.textContent;
}
var LockQueue = class {
  constructor() {
    this.id = 0;
    this.lockQueue = [];
    this.currentId = 0;
  }
  genId() {
    const lockId = this.id;
    let promiseResolve = () => {
    };
    const waiting = new Promise((resolve) => {
      promiseResolve = resolve;
      this.currentId++;
    });
    const lockItem = {
      id: lockId,
      waiting,
      resolve: () => {
        promiseResolve();
      }
    };
    this.lockQueue.push(lockItem);
    this.id += 1;
    return lockId;
  }
  getId() {
    return this.id;
  }
  async wait(id2) {
    const { lockQueue } = this;
    const firstLock = lockQueue[0];
    const lockItem = lockQueue.find((item) => item.id === id2);
    const lockIndex = lockQueue.findIndex((item) => item.id === id2);
    if (firstLock.id === id2) {
      lockItem == null ? void 0 : lockItem.resolve();
      return;
    }
    if (lockItem) {
      await Promise.all(lockQueue.slice(0, lockIndex).map((item) => item.waiting));
      const lastLock = lockQueue[lockQueue.length - 1];
      if (lastLock.id === id2) {
        this.clear();
      }
    }
  }
  release(id2) {
    const { lockQueue } = this;
    const lockItem = lockQueue.find((item) => item.id === id2);
    lockItem == null ? void 0 : lockItem.resolve();
  }
  clear() {
    this.lockQueue = [];
  }
};

// src/proxyInterceptor/shared.ts
function isDataDescriptor(desc) {
  if (desc === void 0)
    return false;
  return "value" in desc || "writable" in desc;
}
function isAccessorDescriptor(desc) {
  if (desc === void 0)
    return false;
  return "get" in desc || "set" in desc;
}
function verifyGetterDescriptor(target, p, newValue) {
  const desc = Object.getOwnPropertyDescriptor(target, p);
  if (desc !== void 0 && desc.configurable === false) {
    if (isDataDescriptor(desc) && desc.writable === false) {
      if (!Object.is(newValue, desc.value)) {
        if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
          (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.warn)(`property "${String(p)}" is non-configurable and non-writable.`);
        }
        return 1;
      }
    } else if (isAccessorDescriptor(desc) && desc.get === void 0) {
      return 2;
    }
  }
  return 0;
}
function verifySetter(proxyTarget, target, p, val, receiver) {
  const verifyResult = verifySetterDescriptor(proxyTarget ? proxyTarget : receiver || target, p, val);
  let result;
  if (verifyResult > 0) {
    if (verifyResult === 1 || verifyResult === 2)
      result = false;
    if (verifyResult === 3)
      result = true;
  }
  return result;
}
function verifySetterDescriptor(target, p, newValue) {
  const desc = Object.getOwnPropertyDescriptor(target, p);
  if (desc !== void 0 && desc.configurable === false) {
    if (isDataDescriptor(desc) && desc.writable === false) {
      if (!Object.is(newValue, desc.value)) {
        if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
          (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.warn)(`property "${String(p)}" is non-configurable and non-writable.`);
        }
        return 1;
      } else {
        return 3;
      }
    } else if (isAccessorDescriptor(desc) && desc.set === void 0) {
      return 2;
    }
  }
  return 0;
}
function safeToString(thing) {
  try {
    return thing.toString();
  } catch (e) {
    return "[toString failed]";
  }
}
function isConstructor(fn) {
  const fp = fn.prototype;
  const hasConstructor = fp && fp.constructor === fn && Object.getOwnPropertyNames(fp).length > 1;
  const functionStr = !hasConstructor && safeToString(fn);
  return hasConstructor || /^function\s+[A-Z]/.test(functionStr) || /^class\b/.test(functionStr);
}
var buildInProps = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.makeMap)([
  "length",
  "caller",
  "callee",
  "arguments",
  "prototype",
  Symbol.hasInstance
]);
function transferProps(o, n) {
  for (const key of Reflect.ownKeys(o)) {
    if (buildInProps(key))
      continue;
    const desc = Object.getOwnPropertyDescriptor(n, key);
    if (desc && desc.writable) {
      n[key] = o[key];
    }
  }
}
function bind(fn, context) {
  const fNOP = function() {
  };
  function bound() {
    const args = handlerParams(arguments);
    if (this instanceof bound) {
      const obj = new fn(...args);
      Object.setPrototypeOf(obj, bound.prototype);
      return obj;
    } else {
      return fn.apply(context, args);
    }
  }
  bound.$native = fn;
  transferProps(fn, bound);
  if (fn.prototype) {
    fNOP.prototype = fn.prototype;
  }
  bound.prototype = new fNOP();
  if (Symbol.hasInstance) {
    Object.defineProperty(bound, Symbol.hasInstance, {
      configurable: true,
      value(instance) {
        const op = fn.prototype;
        return (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.isObject)(op) || typeof op === "function" ? instance instanceof fn : false;
      }
    });
  }
  return bound;
}

// src/modules/history.ts
var passedKey = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.makeMap)(["scrollRestoration"]);
function historyModule() {
  const proto = Object.getPrototypeOf(window.history) || History.prototype;
  const fakeHistory = Object.create(proto);
  const proxyHistory = new Proxy(fakeHistory, {
    get(target, p) {
      const value = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(target, p) ? target[p] : window.history[p];
      return typeof value === "function" ? value.bind(window.history) : value;
    },
    set(target, p, value, receiver) {
      const isPassKey = typeof p === "string" && passedKey(p);
      const verifySetterResult = verifySetter(isPassKey ? history : null, target, p, value, receiver);
      if (verifySetterResult !== void 0) {
        return verifySetterResult;
      } else {
        return isPassKey ? Reflect.set(history, p, value) : Reflect.set(target, p, value, receiver);
      }
    },
    getPrototypeOf() {
      return fakeHistory;
    }
  });
  const fakeHistoryCtor = function History2() {
    throw new TypeError("Illegal constructor");
  };
  fakeHistoryCtor.prototype = fakeHistory;
  fakeHistoryCtor.prototype.constructor = fakeHistoryCtor;
  return {
    override: {
      history: proxyHistory,
      History: fakeHistoryCtor
    }
  };
}

// src/modules/network.ts

function networkModule(sandbox) {
  const baseUrl = sandbox.options.baseUrl;
  const wsSet = /* @__PURE__ */ new Set();
  const xhrSet = /* @__PURE__ */ new Set();
  const fetchSet = /* @__PURE__ */ new Set();
  const needFix = (url) => sandbox.options.fixBaseUrl && baseUrl && typeof url === "string" && !(0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.isAbsolute)(url);
  class fakeXMLHttpRequest extends XMLHttpRequest {
    constructor() {
      super();
      xhrSet.add(this);
    }
    open() {
      if (arguments[2] === false) {
        xhrSet.delete(this);
      }
      if (needFix(arguments[1])) {
        arguments[1] = baseUrl ? (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.transformUrl)(baseUrl, arguments[1]) : arguments[1];
      }
      const url = arguments[1];
      if (sandbox.options.addSourceList) {
        sandbox.options.addSourceList({
          tagName: "xmlhttprequest",
          url
        });
      }
      return super.open.apply(this, arguments);
    }
    abort() {
      xhrSet.delete(this);
      return super.abort.apply(this, arguments);
    }
  }
  class fakeWebSocket extends WebSocket {
    constructor(url, protocols) {
      if (needFix(url) && baseUrl) {
        const baseWsUrl = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.toWsProtocol)(baseUrl);
        url = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.transformUrl)(baseWsUrl, arguments[1]);
      }
      super(url, protocols);
      wsSet.add(this);
    }
    close() {
      wsSet.delete(this);
      return super.close.apply(this, arguments);
    }
  }
  const fakeFetch = (input, options = {}) => {
    if (needFix(input) && baseUrl) {
      input = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.transformUrl)(baseUrl, input);
    }
    if (sandbox.options.addSourceList) {
      sandbox.options.addSourceList({
        tagName: "fetch",
        url: input
      });
    }
    let controller;
    if (!(0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(options, "signal") && window.AbortController) {
      controller = new window.AbortController();
      fetchSet.add(controller);
      options.signal = controller.signal;
    }
    const result = window.fetch(input, options);
    return controller && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.isPromise)(result) ? result.finally(() => fetchSet.delete(controller)) : result;
  };
  return {
    override: {
      WebSocket: fakeWebSocket,
      XMLHttpRequest: fakeXMLHttpRequest,
      fetch: fakeFetch
    },
    recover() {
      wsSet.forEach((ws) => {
        if (typeof ws.close === "function")
          ws.close();
      });
      xhrSet.forEach((xhr) => {
        if (typeof xhr.abort === "function")
          xhr.abort();
      });
      fetchSet.forEach((ctor) => {
        if (typeof ctor.abort === "function")
          ctor.abort();
      });
      wsSet.clear();
      xhrSet.clear();
      fetchSet.clear();
    }
  };
}

// src/proxyInterceptor/document.ts

var passedKey2 = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.makeMap)(["title", "cookie", "onselectstart", "ondragstart"]);
var queryFunctions = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.makeMap)([
  "querySelector",
  "querySelectorAll",
  "getElementById",
  "getElementsByTagName",
  "getElementsByTagNameNS",
  "getElementsByClassName"
]);
function createGetter(sandbox) {
  return (target, p, receiver) => {
    if (p === "activeElement") {
      return Reflect.get(document, p);
    }
    const rootNode = rootElm(sandbox);
    const strictIsolation = sandbox.options.strictIsolation;
    const value = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(target, p) ? Reflect.get(target, p, receiver) : Reflect.get(document, p);
    const hooksRes = sandbox.hooks.lifecycle.documentGetter.emit({
      value,
      rootNode,
      propName: p,
      proxyDocument: target,
      customValue: null
    });
    if (hooksRes.customValue) {
      return hooksRes.customValue;
    }
    const setSandboxRef = (el) => {
      if ((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.isObject)(el)) {
        sandboxMap.setElementTag(el, sandbox);
        if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
          el.__SANDBOX__ = true;
        }
      }
      return el;
    };
    if (rootNode) {
      if (p === "createElement") {
        return function(tagName, options) {
          const el = value.call(document, tagName, options);
          return setSandboxRef(el);
        };
      } else if (p === "createTextNode") {
        return function(data) {
          const el = value.call(document, data);
          return setSandboxRef(el);
        };
      } else if (p === "head") {
        return (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.findTarget)(rootNode, ["head", `div[${_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.__MockHead__}]`]) || value;
      }
      if (strictIsolation) {
        if (p === "body") {
          return (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.findTarget)(rootNode, ["body", `div[${_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.__MockBody__}]`]);
        } else if (queryFunctions(p)) {
          return p === "getElementById" ? (id2) => rootNode.querySelector(`#${id2}`) : rootNode[p].bind(rootNode);
        }
      }
    }
    if (typeof value === "function") {
      let newValue = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(value, __documentBind__) ? value[__documentBind__] : null;
      if (!newValue)
        newValue = bind(value, document);
      const verifyResult = verifyGetterDescriptor(target, p, newValue);
      if (verifyResult > 0) {
        if (verifyResult === 1)
          return value;
        if (verifyResult === 2)
          return void 0;
      }
      value[__documentBind__] = newValue;
      return newValue;
    }
    return value;
  };
}
var safariProxyDocumentDealHandler = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.safari13Deal)();
function createSetter(sandbox) {
  return (target, p, value, receiver) => {
    const rootNode = rootElm(sandbox);
    const verifyResult = verifySetterDescriptor(typeof p === "string" && passedKey2(p) ? document : receiver || target, p, value);
    if (verifyResult > 0) {
      if (verifyResult === 1 || verifyResult === 2)
        return false;
      if (verifyResult === 3)
        return true;
    }
    if (p === "onselectstart" || p === "ondragstart") {
      if (rootNode) {
        return Reflect.set(rootNode, p, value);
      } else {
        return Reflect.set(document, p, value);
      }
    }
    if (typeof p === "string" && passedKey2(p)) {
      return Reflect.set(document, p, value);
    } else {
      safariProxyDocumentDealHandler.triggerSet();
      return Reflect.set(target, p, value, receiver);
    }
  };
}
function createDefineProperty() {
  return (target, p, descriptor) => {
    safariProxyDocumentDealHandler.handleDescriptor(descriptor);
    return passedKey2(p) ? Reflect.defineProperty(document, p, descriptor) : Reflect.defineProperty(target, p, descriptor);
  };
}
function createHas() {
  return (target, p) => {
    if (p === "activeElement")
      return Reflect.has(document, p);
    return (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(target, p) || Reflect.has(document, p);
  };
}

// src/modules/document.ts
var documentModule = (sandbox) => {
  let proxyDocument = Object.create(document);
  const getter = createGetter(sandbox);
  const fakeDocument = createFakeObject(document);
  const fakeDocumentProto = new Proxy(fakeDocument, {
    get: (...args) => {
      microTaskHtmlProxyDocument(proxyDocument);
      return getter(...args);
    },
    has: createHas()
  });
  proxyDocument = new Proxy(Object.create(fakeDocumentProto, {
    currentScript: {
      value: null,
      writable: true
    },
    [__proxyNode__]: {
      writable: false,
      configurable: false,
      value: document
    }
  }), {
    set: createSetter(sandbox),
    defineProperty: createDefineProperty(),
    getPrototypeOf() {
      return HTMLDocument.prototype || Document.prototype;
    }
  });
  return {
    override: {
      document: proxyDocument
    }
  };
};

// src/modules/uiEvent.ts

var MouseEventPatch = class extends MouseEvent {
  constructor(typeArg, mouseEventInit) {
    if (mouseEventInit && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.getType)(mouseEventInit.view) === "window") {
      mouseEventInit.view = window;
    }
    super(typeArg, mouseEventInit);
  }
};
function UiEventOverride() {
  return {
    override: {
      MouseEvent: MouseEventPatch
    }
  };
}

// src/modules/storage.ts
var CusStorage = class {
  constructor(namespace, rawStorage) {
    this.rawStorage = rawStorage;
    this.namespace = namespace;
    this.prefix = `${GARFISH_NAMESPACE_PREFIX}${namespace}__`;
  }
  get length() {
    return this.getKeys().length;
  }
  getKeys() {
    return Object.keys(this.rawStorage).filter((key) => key.startsWith(this.prefix));
  }
  key(n) {
    const key = this.getKeys()[n];
    return key ? key.substring(this.prefix.length) : null;
  }
  getItem(keyName) {
    return this.rawStorage.getItem(`${this.prefix + keyName}`);
  }
  setItem(keyName, keyValue) {
    this.rawStorage.setItem(`${this.prefix + keyName}`, keyValue);
  }
  removeItem(keyName) {
    this.rawStorage.removeItem(`${this.prefix + keyName}`);
  }
  clear() {
    this.getKeys().forEach((key) => {
      this.rawStorage.removeItem(key);
    });
  }
};
function localStorageModule(sandbox) {
  const namespace = sandbox.options.namespace;
  return {
    override: {
      localStorage: new CusStorage(namespace, localStorage),
      sessionStorage: new CusStorage(namespace, sessionStorage)
    }
  };
}

// src/modules/eventListener.ts
function listenerModule(_sandbox) {
  const listeners = /* @__PURE__ */ new Map();
  const rawAddEventListener = window.addEventListener;
  const rawRemoveEventListener = window.removeEventListener;
  function addListener(type, listener, options) {
    const curListeners = listeners.get(type) || [];
    listeners.set(type, [...curListeners, listener]);
    rawAddEventListener.call(this, type, listener, options);
  }
  function removeListener(type, listener, options) {
    const curListeners = listeners.get(type) || [];
    const idx = curListeners.indexOf(listener);
    if (idx !== -1) {
      curListeners.splice(idx, 1);
    }
    listeners.set(type, [...curListeners]);
    rawRemoveEventListener.call(this, type, listener, options);
  }
  const recover = () => {
    listeners.forEach((listener, key) => {
      listener.forEach((fn) => {
        rawRemoveEventListener.call(window, key, fn);
      });
    });
    listeners.clear();
  };
  return {
    recover,
    override: {
      addEventListener: addListener.bind(window),
      removeEventListener: removeListener.bind(window)
    },
    created(global) {
      const fakeDocument = global == null ? void 0 : global.document;
      if (fakeDocument) {
        fakeDocument.addEventListener = addListener.bind(document);
        fakeDocument.removeEventListener = removeListener.bind(document);
      }
    }
  };
}

// src/modules/mutationObserver.ts
function observerModule(_sandbox) {
  const observerSet = /* @__PURE__ */ new Set();
  class ProxyMutationObserver extends MutationObserver {
    constructor(cb) {
      super(cb);
      observerSet.add(this);
    }
  }
  const recover = () => {
    observerSet.forEach((observer) => {
      if (typeof observer.disconnect === "function")
        observer.disconnect();
    });
    observerSet.clear();
  };
  return {
    recover,
    override: {
      MutationObserver: ProxyMutationObserver
    }
  };
}

// src/modules/timer.ts
var rawSetTimeout = window.setTimeout;
var rawClearTimeout = window.clearTimeout;
var rawSetInterval = window.setInterval;
var rawClearInterval = window.clearInterval;
var timeoutModule = () => {
  const timeout = /* @__PURE__ */ new Set();
  const setTimeout2 = (handler, ms, ...args) => {
    const timeoutId = rawSetTimeout(handler, ms, ...args);
    timeout.add(timeoutId);
    return timeoutId;
  };
  const clearTimeout = (timeoutId) => {
    timeout.delete(timeoutId);
    rawClearTimeout(timeoutId);
  };
  const recover = () => {
    timeout.forEach((timeoutId) => {
      rawClearTimeout(timeoutId);
    });
  };
  return {
    recover,
    override: {
      setTimeout: setTimeout2,
      clearTimeout
    }
  };
};
var intervalModule = () => {
  const timeout = /* @__PURE__ */ new Set();
  const setInterval = (callback, ms, ...args) => {
    const intervalId = rawSetInterval(callback, ms, ...args);
    timeout.add(intervalId);
    return intervalId;
  };
  const clearInterval = (intervalId) => {
    timeout.delete(intervalId);
    rawClearInterval(intervalId);
  };
  const recover = () => {
    timeout.forEach((intervalId) => {
      rawClearInterval(intervalId);
    });
  };
  return {
    recover,
    override: {
      setInterval,
      clearInterval,
      setImmediate: (fn) => setTimeout(fn, 0)
    }
  };
};

// src/dynamicNode/index.ts


// src/dynamicNode/processParams.ts
function injectHandlerParams() {
  if (window.MutationObserver) {
    const rawObserver = window.MutationObserver.prototype.observe;
    MutationObserver.prototype.observe = function() {
      return rawObserver.apply(this, handlerParams(arguments));
    };
  }
  const desc = Object.getOwnPropertyDescriptor(window.Document.prototype, "activeElement");
  const rawActiveEl = desc && desc.get;
  if (rawActiveEl) {
    Object.defineProperty(window.Document.prototype, "activeElement", {
      get(...args) {
        return rawActiveEl.apply(handlerParams([this])[0], handlerParams(args));
      }
    });
  }
}

// src/dynamicNode/processor.ts

var isInsertMethod = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.makeMap)(["insertBefore", "insertAdjacentElement"]);
var rawElementMethods = /* @__PURE__ */ Object.create(null);
var _DynamicNodeProcessor = class {
  constructor(el, sandbox, methodName) {
    this.nativeAppend = rawElementMethods["appendChild"];
    this.nativeRemove = rawElementMethods["removeChild"];
    this.el = el;
    this.sandbox = sandbox;
    this.methodName = methodName;
    this.rootElement = rootElm(sandbox) || document;
    this.DOMApis = new _garfish_utils__WEBPACK_IMPORTED_MODULE_0__.DOMApis(sandbox.global.document);
    this.tagName = el.tagName ? el.tagName.toLowerCase() : "";
  }
  is(tag) {
    return this.tagName === tag;
  }
  fixResourceNodeUrl(el) {
    const baseUrl = this.sandbox.options.baseUrl;
    if (baseUrl) {
      const src = el.getAttribute("src");
      const href = el.getAttribute("href");
      if (this.sandbox.options.fixStaticResourceBaseUrl) {
        src && (el.src = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.transformUrl)(baseUrl, src));
        href && (el.href = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.transformUrl)(baseUrl, href));
      }
      const url = el.src || el.href;
      if (url && this.sandbox.options.addSourceList) {
        this.sandbox.options.addSourceList({
          tagName: el.tagName,
          url
        });
      }
    }
  }
  dispatchEvent(type, errInfo) {
    Promise.resolve().then(() => {
      var _a;
      const isError = type === "error";
      let event;
      if (isError && errInfo) {
        event = new ErrorEvent(type, __spreadProps(__spreadValues({}, errInfo), {
          message: (_a = errInfo.error) == null ? void 0 : _a.message
        }));
      } else {
        event = new Event(type);
      }
      event.__byGarfish__ = true;
      Object.defineProperty(event, "target", { value: this.el });
      this.el.dispatchEvent(event);
      isError && window.dispatchEvent(event);
    });
  }
  addDynamicLinkNode(callback) {
    const { href, type } = this.el;
    if (!type || (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.isCssType)({ src: href, type })) {
      if (href) {
        const { baseUrl, namespace, styleScopeId } = this.sandbox.options;
        const fetchUrl = baseUrl ? (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.transformUrl)(baseUrl, href) : href;
        const lockId = _DynamicNodeProcessor.linkLock.genId();
        this.sandbox.loader.load({
          scope: namespace,
          url: fetchUrl,
          defaultContentType: type
        }).then(async ({ resourceManager: styleManager }) => {
          await _DynamicNodeProcessor.linkLock.wait(lockId);
          if (styleManager) {
            styleManager.correctPath();
            if (styleScopeId) {
              styleManager.setScope({
                appName: namespace,
                rootElId: styleScopeId()
              });
            }
            callback(styleManager.renderAsStyleElement());
          } else {
            (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.warn)(`Invalid resource type "${type}", "${href}" can't generate styleManager`);
          }
          this.dispatchEvent("load");
          _DynamicNodeProcessor.linkLock.release(lockId);
        }).catch((e) => {
          _DynamicNodeProcessor.linkLock.release(lockId);
          (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.warn)(e);
          this.dispatchEvent("error", {
            error: e,
            filename: fetchUrl
          });
        });
      }
    } else {
      if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
        (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.warn)(`Invalid resource type "${type}", "${href}"`);
      }
    }
    const linkCommentNode = this.DOMApis.createLinkCommentNode(href);
    this.el[_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.__REMOVE_NODE__] = () => this.DOMApis.removeElement(linkCommentNode);
    return linkCommentNode;
  }
  addDynamicScriptNode() {
    const { src, type, crossOrigin } = this.el;
    const isModule2 = type === "module";
    const code = this.el.textContent || this.el.text || "";
    if (!type || (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.isJsType)({ src, type })) {
      const { baseUrl, namespace } = this.sandbox.options;
      if (src) {
        const fetchUrl = baseUrl ? (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.transformUrl)(baseUrl, src) : src;
        this.sandbox.loader.load({
          scope: namespace,
          url: fetchUrl,
          crossOrigin,
          defaultContentType: type
        }).then((manager) => {
          if (manager.resourceManager) {
            const {
              resourceManager: { url, scriptCode }
            } = manager;
            this.sandbox.execScript(scriptCode, {}, url, {
              isModule: isModule2,
              defer: false,
              async: false,
              noEntry: true,
              originScript: this.el
            });
          } else {
            (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.warn)(`Invalid resource type "${type}", "${src}" can't generate scriptManager`);
          }
          this.dispatchEvent("load");
        }, (e) => {
          (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.warn)(e);
          this.dispatchEvent("error", {
            error: e,
            filename: fetchUrl
          });
        });
      } else if (code) {
        this.sandbox.execScript(code, {}, baseUrl, {
          noEntry: true,
          originScript: this.el
        });
      }
      const scriptCommentNode = this.DOMApis.createScriptCommentNode({
        src,
        code
      });
      this.el[_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.__REMOVE_NODE__] = () => this.DOMApis.removeElement(scriptCommentNode);
      return scriptCommentNode;
    }
    return this.el;
  }
  monitorChangesOfLinkNode() {
    if (this.el.modifyFlag)
      return;
    const mutator = new MutationObserver((mutations) => {
      var _a;
      if (this.el.modifyFlag)
        return;
      for (const { type, attributeName } of mutations) {
        if (type === "attributes") {
          if (attributeName === "rel" || attributeName === "stylesheet") {
            if (this.el.modifyFlag)
              return;
            if (this.el.rel === "stylesheet" && this.el.href) {
              this.el.disabled = this.el.modifyFlag = true;
              const commentNode = this.addDynamicLinkNode((styleNode) => {
                var _a2;
                (_a2 = commentNode.parentNode) == null ? void 0 : _a2.replaceChild(styleNode, commentNode);
              });
              (_a = this.el.parentNode) == null ? void 0 : _a.replaceChild(commentNode, this.el);
            }
          }
        }
      }
    });
    mutator.observe(this.el, { attributes: true });
  }
  monitorChangesOfStyle() {
    const { baseUrl, namespace, styleScopeId } = this.sandbox.options;
    const rootElId = styleScopeId == null ? void 0 : styleScopeId();
    const modifyStyleCode = (styleCode) => {
      if (styleCode) {
        const manager = new this.sandbox.loader.StyleManager(styleCode);
        manager.correctPath(baseUrl);
        if (rootElId) {
          manager.setScope({
            rootElId,
            appName: namespace
          });
        }
        styleCode = manager.transformCode(styleCode);
      }
      return styleCode;
    };
    const mutator = new MutationObserver((mutations) => {
      var _a;
      for (const { type, addedNodes } of mutations) {
        if (type === "childList") {
          if ((_a = addedNodes[0]) == null ? void 0 : _a.textContent) {
            addedNodes[0].textContent = modifyStyleCode(addedNodes[0].textContent);
          }
        }
      }
    });
    mutator.observe(this.el, { childList: true });
    let fakeSheet = null;
    Reflect.defineProperty(this.el, "sheet", {
      get: () => {
        if (!fakeSheet) {
          fakeSheet = this.createFakeSheet(modifyStyleCode);
        }
        return fakeSheet;
      },
      configurable: true
    });
  }
  findParentNodeInApp(parentNode, defaultInsert) {
    if (parentNode === document.body) {
      return (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.findTarget)(this.rootElement, [
        "body",
        `div[${_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.__MockBody__}]`
      ]);
    } else if (parentNode === document.head) {
      return (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.findTarget)(this.rootElement, [
        "head",
        `div[${_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.__MockHead__}]`
      ]);
    }
    if (this.rootElement.contains(parentNode) || !document.contains(parentNode)) {
      return parentNode;
    }
    if (defaultInsert === "head") {
      return (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.findTarget)(this.rootElement, [
        "head",
        `div[${_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.__MockHead__}]`
      ]);
    } else if (defaultInsert === "body") {
      return (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.findTarget)(this.rootElement, [
        "body",
        `div[${_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.__MockBody__}]`
      ]);
    }
    return parentNode;
  }
  append(context, args, originProcess) {
    var _a;
    let convertedNode;
    let parentNode = context;
    const { baseUrl, namespace, styleScopeId } = this.sandbox.options;
    if (_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.sourceListTags.includes(this.tagName)) {
      this.fixResourceNodeUrl(this.el);
    }
    if (this.is("script")) {
      parentNode = this.findParentNodeInApp(context, "body");
      convertedNode = this.addDynamicScriptNode();
    } else if (this.is("style")) {
      parentNode = this.findParentNodeInApp(context, "head");
      const manager = new this.sandbox.loader.StyleManager(this.el.textContent);
      manager.correctPath(baseUrl);
      if (styleScopeId) {
        manager.setScope({
          appName: namespace,
          rootElId: styleScopeId()
        });
      }
      this.el.textContent = manager.transformCode(manager.styleCode);
      convertedNode = this.el;
      this.sandbox.dynamicStyleSheetElementSet.add(this.el);
      this.monitorChangesOfStyle();
    } else if (this.is("link")) {
      parentNode = this.findParentNodeInApp(context, "head");
      if (this.el.rel === "stylesheet" && this.el.href) {
        convertedNode = this.addDynamicLinkNode((styleNode) => {
          this.nativeAppend.call(parentNode, styleNode);
        });
      } else {
        convertedNode = this.el;
        this.monitorChangesOfLinkNode();
      }
    }
    if (!this.rootElement.contains(parentNode) && document.contains(parentNode)) {
      if (parentNode !== this.rootElement) {
        this.sandbox.deferClearEffects.add(() => {
          this.DOMApis.removeElement(this.el);
          return this.el;
        });
      }
    }
    if (this.el && this.el.querySelectorAll) {
      const needFixDom = this.el.querySelectorAll("iframe,img,video,link,script,audio,style");
      if (needFixDom.length > 0) {
        needFixDom.forEach((dom) => {
          (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.safeWrapper)(() => this.fixResourceNodeUrl(dom));
        });
      }
    }
    if (this.is("iframe") && typeof this.el.onload === "function") {
      const { el, sandbox } = this;
      const originOnload = el.onload;
      el.onload = function() {
        (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.safeWrapper)(() => (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.def)(el.contentWindow, "parent", sandbox.global));
        return originOnload.apply(this, arguments);
      };
    }
    if (convertedNode) {
      if (isInsertMethod(this.methodName) && this.rootElement.contains(context) && ((_a = args[1]) == null ? void 0 : _a.parentNode) === context) {
        return originProcess();
      }
      this.sandbox.hooks.lifecycle.appendNode.emit(parentNode, this.el, convertedNode, this.tagName);
      return this.nativeAppend.call(parentNode, convertedNode);
    }
    return originProcess();
  }
  removeChild(context, originProcess) {
    if (typeof this.el[_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.__REMOVE_NODE__] === "function") {
      this.el[_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.__REMOVE_NODE__]();
      return this.el;
    }
    if (this.is("style") || this.is("link") || this.is("script")) {
      const parentNode = this.findParentNodeInApp(context, this.is("script") ? "body" : "head");
      if (this.el.parentNode === parentNode) {
        if (this.sandbox.dynamicStyleSheetElementSet.has(this.el)) {
          this.sandbox.dynamicStyleSheetElementSet.delete(this.el);
        }
        return this.nativeRemove.call(parentNode, this.el);
      }
    }
    return originProcess();
  }
  getRealSheet() {
    return Reflect.get(HTMLStyleElement.prototype, "sheet", this.el);
  }
  createFakeSheet(styleTransformer) {
    const processor = this;
    const rulesData = [];
    this.sandbox.styledComponentCSSRulesMap.set(this.el, rulesData);
    const fakeSheet = {
      get cssRules() {
        var _a;
        const realSheet = processor.getRealSheet();
        return (_a = realSheet == null ? void 0 : realSheet.cssRules) != null ? _a : [];
      },
      insertRule(rule, index) {
        const realSheet = processor.getRealSheet();
        const transformed = styleTransformer(rule);
        if (realSheet) {
          realSheet.insertRule(transformed, index);
        }
        rulesData.splice(index || 0, 0, transformed);
        return index || 0;
      },
      deleteRule(index) {
        const realSheet = processor.getRealSheet();
        if (realSheet) {
          realSheet.deleteRule(index);
        }
        rulesData.splice(index, 1);
      }
    };
    return fakeSheet;
  }
};
var DynamicNodeProcessor = _DynamicNodeProcessor;
DynamicNodeProcessor.linkLock = new LockQueue();

// src/dynamicNode/index.ts
var mountElementMethods = [
  "append",
  "appendChild",
  "insertBefore",
  "insertAdjacentElement"
];
var removeChildElementMethods = ["removeChild"];
var ignoreElementTimingTags = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.makeMap)([
  "STYLE",
  "SCRIPTS",
  "LINK",
  "META",
  "TITLE"
]);
function injector(current, methodName) {
  return function() {
    var _a;
    const el = methodName === "insertAdjacentElement" ? arguments[1] : arguments[0];
    const sandbox = sandboxMap.get(el);
    const originProcess = () => current.apply(this, arguments);
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.safeWrapper)(() => {
      if (ignoreElementTimingTags(el.tagName))
        return;
      if ((el == null ? void 0 : el.setAttribute) && typeof (el == null ? void 0 : el.setAttribute) === "function" && !(el == null ? void 0 : el.getAttribute("elementtiming")) && sandbox && sandbox.options.disableElementtiming !== true) {
        el == null ? void 0 : el.setAttribute("elementtiming", sandbox ? `${sandbox.options.namespace}-element-timing` : "element-timing");
      }
    });
    if (sandbox) {
      if (el && ((_a = this == null ? void 0 : this.tagName) == null ? void 0 : _a.toLowerCase()) === "style") {
        const manager = new sandbox.loader.StyleManager(el.textContent);
        const { baseUrl, namespace, styleScopeId } = sandbox.options;
        manager.correctPath(baseUrl);
        manager.setScope({
          appName: namespace,
          rootElId: styleScopeId()
        });
        el.textContent = manager.transformCode(manager.styleCode);
        return originProcess();
      } else {
        const processor = new DynamicNodeProcessor(el, sandbox, methodName);
        return processor.append(this, arguments, originProcess);
      }
    } else {
      return originProcess();
    }
  };
}
function injectorRemoveChild(current, methodName) {
  return function() {
    const el = arguments[0];
    const sandbox = el && sandboxMap.get(el);
    const originProcess = () => {
      return current.apply(this, arguments);
    };
    if (sandbox) {
      const processor = new DynamicNodeProcessor(el, sandbox, methodName);
      return processor.removeChild(this, originProcess);
    }
    return originProcess();
  };
}
function handleOwnerDocument() {
  Object.defineProperty(window.Element.prototype, "ownerDocument", {
    get() {
      const sandbox = this && sandboxMap.get(this);
      const realValue = Reflect.get(window.Node.prototype, "ownerDocument", this);
      return sandbox ? sandbox.global.document : realValue;
    },
    set() {
      (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.warn)('"ownerDocument" is a read-only attribute.');
    }
  });
}
function makeElInjector(sandboxConfig) {
  if (makeElInjector.hasInject)
    return;
  makeElInjector.hasInject = true;
  if (typeof window.Element === "function") {
    if (sandboxConfig.fixBaseUrl)
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.safeWrapper)(() => handleOwnerDocument());
    const rewrite = (methods, builder) => {
      for (const name of methods) {
        const fn = window.Element.prototype[name];
        if (typeof fn !== "function" || fn[__domWrapper__]) {
          continue;
        }
        rawElementMethods[name] = fn;
        const wrapper = builder(fn, name);
        wrapper[__domWrapper__] = true;
        window.Element.prototype[name] = wrapper;
      }
    };
    rewrite(mountElementMethods, injector);
    rewrite(removeChildElementMethods, injectorRemoveChild);
  }
  injectHandlerParams();
}
function rebuildCSSRules(dynamicStyleSheetElementSet, styledComponentCSSRulesMap) {
  dynamicStyleSheetElementSet.forEach((styleElement) => {
    const rules = styledComponentCSSRulesMap.get(styleElement);
    if (rules && (isStyledComponentsLike(styleElement) || rules.length)) {
      const realSheet = Reflect.get(HTMLStyleElement.prototype, "sheet", styleElement);
      if (realSheet) {
        for (let i = 0; i < rules.length; i++) {
          const cssRule = rules[i];
          realSheet.insertRule(cssRule, i);
        }
      }
    }
  });
}

// src/lifecycle.ts

function sandboxLifecycle() {
  return new _garfish_hooks__WEBPACK_IMPORTED_MODULE_2__.PluginSystem({
    closed: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_2__.SyncHook(),
    stared: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_2__.SyncHook(),
    appendNode: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_2__.SyncHook(),
    documentGetter: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_2__.SyncWaterfallHook("documentGetter"),
    beforeClearEffect: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_2__.SyncHook(),
    afterClearEffect: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_2__.SyncHook(),
    beforeInvoke: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_2__.SyncHook(),
    afterInvoke: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_2__.SyncHook(),
    invokeError: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_2__.SyncHook()
  });
}

// src/proxyInterceptor/global.ts

function createGetter2(sandbox) {
  return (target, p, receiver) => {
    if (p === Symbol.unscopables)
      return void 0;
    let value;
    const { overrideList } = sandbox.replaceGlobalVariables;
    if (sandbox.isProtectVariable(p)) {
      return Reflect.get(window, p);
    } else if (sandbox.isInsulationVariable(p)) {
      value = Reflect.get(target, p, receiver);
    } else {
      value = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(target, p) ? Reflect.get(target, p, receiver) : Reflect.get(window, p);
    }
    if (typeof value === "function") {
      if (isEsGlobalMethods(p) || isNativeCodeMethods(p) || (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(overrideList, p) || isConstructor(value) || sandbox.isExternalGlobalVariable.has(p)) {
        return value;
      }
    } else {
      return value;
    }
    const newValue = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(value, __windowBind__) ? value[__windowBind__] : bind(value, window);
    const verifyResult = verifyGetterDescriptor(target, p, newValue);
    if (verifyResult > 0) {
      if (verifyResult === 1)
        return value;
      if (verifyResult === 2)
        return void 0;
    }
    value[__windowBind__] = newValue;
    return newValue;
  };
}
var safariProxyWindowDealHandler = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.safari13Deal)();
function createSetter2(sandbox) {
  return (target, p, value, receiver) => {
    const verifyResult = verifySetterDescriptor(sandbox.isProtectVariable(p) ? window : receiver ? receiver : target, p, value);
    if (verifyResult > 0) {
      if (verifyResult === 1 || verifyResult === 2)
        return false;
      if (verifyResult === 3)
        return true;
    }
    if (sandbox.isProtectVariable(p)) {
      return Reflect.set(window, p, value);
    } else {
      safariProxyWindowDealHandler.triggerSet();
      const success = Reflect.set(target, p, value, receiver);
      if (success) {
        if (sandbox.initComplete) {
          sandbox.isExternalGlobalVariable.add(p);
        }
        if (sandbox.global) {
          const methods = sandbox.global[`${GARFISH_OPTIMIZE_NAME}Methods`];
          if (Array.isArray(methods)) {
            if (methods.includes(p)) {
              const updateStack = sandbox.global[`${GARFISH_OPTIMIZE_NAME}UpdateStack`];
              updateStack.forEach((fn) => fn(p, value));
            }
          }
        }
      }
      return success;
    }
  };
}
function createDefineProperty2(sandbox) {
  return (target, p, descriptor) => {
    safariProxyWindowDealHandler.handleDescriptor(descriptor);
    if (sandbox.isProtectVariable(p)) {
      return Reflect.defineProperty(window, p, descriptor);
    } else {
      const success = Reflect.defineProperty(target, p, descriptor);
      if (sandbox.initComplete && success) {
        sandbox.isExternalGlobalVariable.add(p);
      }
      return success;
    }
  };
}
function createDeleteProperty(sandbox) {
  return (target, p) => {
    if ((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(target, p)) {
      delete target[p];
      if (sandbox.initComplete && sandbox.isExternalGlobalVariable.has(p)) {
        sandbox.isExternalGlobalVariable.delete(p);
      }
    } else if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
      if ((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(window, p) && sandbox.isProtectVariable(p)) {
        (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.warn)(`The "${String(p)}" is global protect variable."`);
      }
    }
    return true;
  };
}
function createHas2(sandbox) {
  return (_target, p) => {
    if (sandbox.isProtectVariable(p))
      return false;
    if (sandbox.envVariable === p)
      return false;
    return true;
  };
}

// src/sandbox.ts
var id = 0;
var defaultModules = [
  networkModule,
  timeoutModule,
  intervalModule,
  historyModule,
  documentModule,
  listenerModule,
  observerModule,
  UiEventOverride,
  localStorageModule
];
var isModule = (module) => {
  return (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.isObject)(module) ? module[__garfishGlobal__] !== void 0 : false;
};
var addProxyWindowType = (module, parentModule) => {
  if (!isModule(module)) {
    module[__garfishGlobal__] = parentModule;
  }
  return module;
};
var Sandbox = class {
  constructor(options) {
    this.id = id++;
    this.type = "vm";
    this.closed = true;
    this.initComplete = false;
    this.version = "1.16.2";
    this.hooks = sandboxLifecycle();
    this.deferClearEffects = /* @__PURE__ */ new Set();
    this.isExternalGlobalVariable = /* @__PURE__ */ new Set();
    this.dynamicStyleSheetElementSet = /* @__PURE__ */ new Set();
    this.styledComponentCSSRulesMap = /* @__PURE__ */ new WeakMap();
    this.optimizeCode = "";
    this.envVariable = "__GARFISH_SANDBOX_ENV_VAR__";
    const defaultOptions = {
      baseUrl: "",
      namespace: "",
      modules: [],
      fixBaseUrl: false,
      fixStaticResourceBaseUrl: true,
      disableWith: false,
      strictIsolation: false,
      el: () => null,
      styleScopeId: () => "",
      protectVariable: () => [],
      insulationVariable: () => []
    };
    this.options = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(options) ? (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.deepMerge)(defaultOptions, options) : defaultOptions;
    const { loaderOptions, protectVariable, insulationVariable } = this.options;
    this.loader = new _garfish_loader__WEBPACK_IMPORTED_MODULE_1__.Loader(loaderOptions);
    this.isProtectVariable = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.makeMap)((protectVariable == null ? void 0 : protectVariable()) || []);
    this.isInsulationVariable = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.makeMap)((insulationVariable == null ? void 0 : insulationVariable()) || []);
    this.replaceGlobalVariables = {
      createdList: [],
      prepareList: [],
      recoverList: [],
      overrideList: {}
    };
    makeElInjector(this.options);
    this.start();
    sandboxMap.set(this);
  }
  start() {
    this.closed = false;
    this.replaceGlobalVariables = this.getModuleData();
    const { createdList, overrideList } = this.replaceGlobalVariables;
    this.global = this.createProxyWindow(Object.keys(overrideList));
    if (overrideList && this.global) {
      for (const key in overrideList) {
        this.global[key] = overrideList[key];
      }
    }
    if (createdList) {
      createdList.forEach((fn) => fn && fn(this.global));
    }
    if (!this.options.disableWith) {
      this.optimizeCode = this.optimizeGlobalMethod();
    }
    this.initComplete = true;
    this.hooks.lifecycle.stared.emit(this.global);
  }
  close() {
    if (this.closed)
      return;
    this.clearEffects();
    this.closed = true;
    this.global = void 0;
    this.optimizeCode = "";
    this.initComplete = false;
    this.deferClearEffects.clear();
    this.isExternalGlobalVariable.clear();
    this.dynamicStyleSheetElementSet.clear();
    this.replaceGlobalVariables.createdList = [];
    this.replaceGlobalVariables.prepareList = [];
    this.replaceGlobalVariables.recoverList = [];
    this.replaceGlobalVariables.overrideList = [];
    this.hooks.lifecycle.closed.emit();
  }
  reset() {
    this.close();
    this.start();
  }
  createProxyWindow(moduleKeys = []) {
    const fakeWindow = createFakeObject(window, this.isInsulationVariable, (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.makeMap)(moduleKeys));
    const baseHandlers = {
      get: createGetter2(this),
      set: createSetter2(this),
      defineProperty: createDefineProperty2(this),
      deleteProperty: createDeleteProperty(this),
      getPrototypeOf() {
        return Object.getPrototypeOf(window);
      }
    };
    const parentHandlers = __spreadProps(__spreadValues({}, baseHandlers), {
      has: createHas2(this),
      getPrototypeOf() {
        return Object.getPrototypeOf(window);
      }
    });
    const proxy = new Proxy(fakeWindow, parentHandlers);
    const subProxy = new Proxy(fakeWindow, baseHandlers);
    proxy.self = subProxy;
    proxy.window = subProxy;
    proxy.globalThis = subProxy;
    proxy.__debug_sandbox__ = this;
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.safeWrapper)(() => {
      proxy.top = window.top === window ? subProxy : window.top;
      proxy.parent = window.parent === window ? subProxy : window.parent;
    });
    addProxyWindowType(proxy, window);
    return proxy;
  }
  getModuleData() {
    var _a;
    const recoverList = [];
    const createdList = [];
    const prepareList = [];
    const overrideList = {};
    const allModules = defaultModules.concat((_a = this.options.modules) != null ? _a : []);
    for (const module of allModules) {
      if (typeof module === "function") {
        const { recover, override, created, prepare } = module(this) || {};
        if (recover)
          recoverList.push(recover);
        if (created)
          createdList.push(created);
        if (prepare)
          prepareList.push(prepare);
        if (override) {
          for (const key in override) {
            if ((typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) && overrideList[key]) {
              (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.warn)(`"${key}" global variables are overwritten.`);
            }
            overrideList[key] = override[key];
          }
        }
      }
    }
    return { recoverList, createdList, overrideList, prepareList };
  }
  clearEffects() {
    this.hooks.lifecycle.beforeClearEffect.emit();
    this.replaceGlobalVariables.recoverList.forEach((fn) => fn && fn());
    this.deferClearEffects.forEach((fn) => fn && fn());
    this.hooks.lifecycle.afterClearEffect.emit();
  }
  optimizeGlobalMethod(tempEnvKeys = []) {
    let code = "";
    const methods = optimizeMethods.filter((p) => {
      return p && !this.isProtectVariable(p) && !tempEnvKeys.includes(p) && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.hasOwn)(this.global, p);
    });
    if (methods.length > 0) {
      code = methods.reduce((prevCode, name) => {
        return `${prevCode} let ${name} = window.${name};`;
      }, code);
      if (this.global) {
        this.global[`${GARFISH_OPTIMIZE_NAME}Methods`] = methods;
        this.global[`${GARFISH_OPTIMIZE_NAME}UpdateStack`] = [];
      }
      code += `window.${GARFISH_OPTIMIZE_NAME}UpdateStack.push(function(k,v){eval(k+"=v")});`;
    }
    if (tempEnvKeys.length > 0) {
      code = tempEnvKeys.reduce((prevCode, name) => {
        return `${prevCode} let ${name} = ${this.envVariable}.${name};`;
      }, code);
    }
    return code;
  }
  createExecParams(codeRef, env) {
    const { disableWith } = this.options;
    const { prepareList, overrideList } = this.replaceGlobalVariables;
    if (prepareList) {
      prepareList.forEach((fn) => fn && fn());
    }
    const params = __spreadValues({
      window: this.global
    }, overrideList);
    if (disableWith) {
      Object.assign(params, env);
    } else {
      const envKeys = Object.keys(env);
      const optimizeCode = envKeys.length > 0 ? this.optimizeGlobalMethod(envKeys) : this.optimizeCode;
      codeRef.code = `with(window) {;${optimizeCode + codeRef.code}
}`;
      params[this.envVariable] = env;
    }
    return params;
  }
  processExecError(e, url, env, options) {
    this.hooks.lifecycle.invokeError.emit(e, url, env, options);
    if (this.global && typeof this.global.onerror === "function") {
      const source = url || this.options.baseUrl;
      const message = e instanceof Error ? e.message : String(e);
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.safeWrapper)(() => {
        var _a, _b;
        (_b = (_a = this.global) == null ? void 0 : _a.onerror) == null ? void 0 : _b.call(this.global, message, source, null, null, e);
      });
    }
    throw e;
  }
  execScript(code, env = {}, url = "", options) {
    var _a;
    const codeRef = { code };
    const { async, defer } = options || {};
    this.hooks.lifecycle.beforeInvoke.emit(codeRef, url, env, options);
    const revertCurrentScript = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.setDocCurrentScript)((_a = this.global) == null ? void 0 : _a.document, codeRef.code, false, url, async, defer, options == null ? void 0 : options.originScript);
    try {
      const params = this.createExecParams(codeRef, env);
      codeRef.code += `
${url ? `//# sourceURL=${url}
` : ""}`;
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.evalWithEnv)(codeRef.code, params, this.global);
    } catch (e) {
      this.processExecError(e, url, env, options);
    } finally {
      Promise.resolve().then(revertCurrentScript);
    }
    this.hooks.lifecycle.afterInvoke.emit(codeRef, url, env, options);
  }
  static getNativeWindow() {
    let module = window;
    while (isModule(module)) {
      module = module[__garfishGlobal__];
    }
    return module;
  }
  static canSupport() {
    let support = true;
    if (!window.Proxy || !Array.prototype.includes || !String.prototype.includes) {
      support = false;
    }
    if (support) {
      try {
        new Function("let a = 666;");
      } catch (e) {
        support = false;
      }
    }
    if (!support) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.warn)('The current environment does not support "vm sandbox",Please use the "snapshot sandbox" instead.');
    }
    return support;
  }
};

// src/pluginify.ts
var specialExternalVariables = [
  "onerror",
  "webpackjsonp",
  "__REACT_ERROR_OVERLAY_GLOBAL_HOOK__",
  (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) ? "webpackHotUpdate" : ""
];
function compatibleOldModule(modules) {
  if (!Array.isArray(modules)) {
    (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.warn)('"vm sandbox" modules should be an array');
    const list = [];
    for (const key in modules) {
      list.push(modules[key]);
    }
    modules = list;
  }
  return modules;
}
function rewriteAppAndSandbox(Garfish, app, sandbox) {
  var _a;
  const originExecScript = sandbox.execScript;
  sandbox.loader = Garfish.loader;
  sandbox.execScript = (code, env, url, options) => {
    const evalHooksArgs = [app.appInfo, code, env, url, options];
    app.hooks.lifecycle.beforeEval.emit(...evalHooksArgs);
    try {
      const res = originExecScript.call(sandbox, code, __spreadValues(__spreadValues({}, env), app.getExecScriptEnv(options == null ? void 0 : options.noEntry)), url, options);
      app.hooks.lifecycle.afterEval.emit(...evalHooksArgs);
      return res;
    } catch (err) {
      app.hooks.lifecycle.errorExecCode.emit(err, ...evalHooksArgs);
      throw err;
    }
  };
  app.vmSandbox = sandbox;
  app.global = sandbox.global;
  app.strictIsolation = (_a = sandbox.options.strictIsolation) != null ? _a : false;
  app.runCode = function() {
    return originExecScript.apply(sandbox, arguments);
  };
  if (app.entryManager.DOMApis && sandbox.global) {
    app.entryManager.DOMApis.document = sandbox.global.document;
  }
}
function createOptions(Garfish) {
  const canSupport = Sandbox.canSupport();
  const options = {
    name: "browser-vm",
    version: "1.16.2",
    afterLoad(appInfo, appInstance) {
      var _a, _b, _c, _d, _e, _f;
      if (!canSupport || !appInstance || (appInstance == null ? void 0 : appInstance.vmSandbox) || appInfo.sandbox === false || appInfo.sandbox && appInfo.sandbox.open === false || appInfo.sandbox && appInfo.sandbox.snapshot) {
        if (appInstance == null ? void 0 : appInstance.vmSandbox) {
          appInstance.global = appInstance.vmSandbox.global;
        }
        return;
      }
      rewriteAppAndSandbox(Garfish, appInstance, new Sandbox({
        namespace: appInfo.name,
        addSourceList: appInstance.addSourceList.bind(appInstance),
        baseUrl: appInstance.entryManager.url,
        modules: compatibleOldModule(((_a = appInfo.sandbox) == null ? void 0 : _a.modules) || []),
        fixBaseUrl: Boolean((_b = appInfo.sandbox) == null ? void 0 : _b.fixBaseUrl),
        fixStaticResourceBaseUrl: Boolean((_c = appInfo.sandbox) == null ? void 0 : _c.fixStaticResourceBaseUrl),
        disableWith: Boolean((_d = appInfo.sandbox) == null ? void 0 : _d.disableWith),
        disableElementtiming: Boolean((_e = appInfo.sandbox) == null ? void 0 : _e.disableElementtiming),
        strictIsolation: Boolean((_f = appInfo.sandbox) == null ? void 0 : _f.strictIsolation),
        el: () => appInstance.htmlNode,
        styleScopeId: () => appInstance.appContainer.id,
        protectVariable: () => appInfo.protectVariable || [],
        insulationVariable: () => {
          return [
            ...specialExternalVariables,
            ...appInfo.insulationVariable || []
          ].filter(Boolean);
        }
      }));
    },
    afterUnmount(appInfo, appInstance, isCacheMode) {
      if (appInstance.vmSandbox && !isCacheMode) {
        appInstance.vmSandbox.reset();
      }
    },
    afterMount(appInfo, appInstance) {
      if (appInstance.vmSandbox) {
        rebuildCSSRules(appInstance.vmSandbox.dynamicStyleSheetElementSet, appInstance.vmSandbox.styledComponentCSSRulesMap);
        appInstance.vmSandbox.execScript(`
          if (typeof window.onload === 'function') {
            window.onload.call(window);
          }
        `);
      }
    }
  };
  return options;
}
function GarfishBrowserVm() {
  return function(Garfish) {
    Garfish.getGlobalObject = function() {
      return Sandbox.getNativeWindow();
    };
    Garfish.setGlobalValue = function(key, value) {
      return this.getGlobalObject()[key] = value;
    };
    Garfish.clearEscapeEffect = function(key, value) {
      const global = this.getGlobalObject();
      if (key in global) {
        global[key] = value;
      }
    };
    return createOptions(Garfish);
  };
}



/***/ }),

/***/ "./node_modules/.pnpm/@garfish+core@1.16.2/node_modules/@garfish/core/dist/esm/index.js":
/*!**********************************************************************************************!*\
  !*** ./node_modules/.pnpm/@garfish+core@1.16.2/node_modules/@garfish/core/dist/esm/index.js ***!
  \**********************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ Garfish; }
/* harmony export */ });
/* harmony import */ var _garfish_loader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @garfish/loader */ "./node_modules/.pnpm/@garfish+loader@1.16.2/node_modules/@garfish/loader/dist/esm/index.js");
/* harmony import */ var eventemitter2__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! eventemitter2 */ "./node_modules/.pnpm/eventemitter2@6.4.9/node_modules/eventemitter2/lib/eventemitter2.js");
/* harmony import */ var eventemitter2__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(eventemitter2__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _garfish_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @garfish/utils */ "./node_modules/.pnpm/@garfish+utils@1.16.2/node_modules/@garfish/utils/dist/esm/index.js");
/* harmony import */ var _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @garfish/hooks */ "./node_modules/.pnpm/@garfish+hooks@1.16.2/node_modules/@garfish/hooks/dist/esm/index.js");
/* harmony import */ var _alioth_org_es_module_lexer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @alioth-org/es-module-lexer */ "./node_modules/.pnpm/@alioth-org+es-module-lexer@1.1.0/node_modules/@alioth-org/es-module-lexer/dist/lexer.js");
/* provided dependency */ var process = __webpack_require__(/*! process/browser */ "./node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");
var __defProp = Object.defineProperty;
var __defProps = Object.defineProperties;
var __getOwnPropDescs = Object.getOwnPropertyDescriptors;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a, b) => {
  for (var prop in b || (b = {}))
    if (__hasOwnProp.call(b, prop))
      __defNormalProp(a, prop, b[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b)) {
      if (__propIsEnum.call(b, prop))
        __defNormalProp(a, prop, b[prop]);
    }
  return a;
};
var __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));
var __objRest = (source, exclude) => {
  var target = {};
  for (var prop in source)
    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)
      target[prop] = source[prop];
  if (source != null && __getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(source)) {
      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))
        target[prop] = source[prop];
    }
  return target;
};

// src/garfish.ts





// src/config.ts

var filterAppConfigKeys = {
  beforeBootstrap: true,
  bootstrap: true,
  beforeRegisterApp: true,
  registerApp: true,
  beforeLoad: true,
  afterLoad: true,
  errorLoadApp: true,
  appID: true,
  apps: true,
  disableStatistics: true,
  disablePreloadApp: true,
  plugins: true,
  autoRefreshApp: true,
  onNotMatchRouter: true,
  loader: true
};
var deepMergeConfig = (globalConfig, localConfig) => {
  const _a = globalConfig, { props: globalProps } = _a, newGlobalConfig = __objRest(_a, ["props"]);
  const _b = localConfig, { props: localProps } = _b, newLocalConfig = __objRest(_b, ["props"]);
  const props = __spreadValues(__spreadValues({}, globalProps || {}), localProps || {});
  const result = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.deepMerge)((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.filterUndefinedVal)(newGlobalConfig), (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.filterUndefinedVal)(newLocalConfig));
  return __spreadProps(__spreadValues({}, result), {
    props
  });
};
var getAppConfig = (globalConfig, localConfig) => {
  const mergeResult = deepMergeConfig(globalConfig, localConfig);
  Object.keys(mergeResult).forEach((key) => {
    if (filterAppConfigKeys[key]) {
      delete mergeResult[key];
    }
  });
  return mergeResult;
};
var generateAppOptions = (appName, garfish, options) => {
  let appInfo = garfish.appInfos[appName] || { name: appName };
  appInfo = getAppConfig(garfish.options, __spreadProps(__spreadValues(__spreadValues({}, appInfo), options), {
    props: __spreadValues(__spreadValues({}, appInfo.props || {}), (options == null ? void 0 : options.props) || {})
  }));
  return appInfo;
};
var createDefaultOptions = () => {
  const config = {
    appID: "",
    apps: [],
    autoRefreshApp: true,
    disableStatistics: false,
    disablePreloadApp: false,
    basename: "/",
    props: {},
    asyncProviderTimeout: 2e3,
    domGetter: () => document.createElement("div"),
    sandbox: {
      snapshot: false,
      fixBaseUrl: false,
      fixStaticResourceBaseUrl: true,
      disableWith: false,
      strictIsolation: false,
      disableElementtiming: false
    },
    beforeLoad: () => {
    },
    afterLoad: () => {
    },
    errorLoadApp: (e) => (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.error)(e),
    onNotMatchRouter: () => {
    },
    beforeEval: () => {
    },
    afterEval: () => {
    },
    beforeMount: () => {
    },
    afterMount: () => {
    },
    beforeUnmount: () => {
    },
    afterUnmount: () => {
    },
    errorMountApp: (e) => (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.error)(e),
    errorUnmountApp: (e) => (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.error)(e),
    customLoader: void 0
  };
  return config;
};

// src/module/app.ts


// src/lifecycle.ts

function globalLifecycle() {
  return new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.PluginSystem({
    beforeBootstrap: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncHook(),
    bootstrap: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncHook(),
    beforeRegisterApp: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncHook(),
    registerApp: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncHook(),
    beforeLoad: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.AsyncHook(),
    afterLoad: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.AsyncHook(),
    errorLoadApp: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncHook()
  });
}
function appLifecycle() {
  return new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.PluginSystem({
    beforeEval: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncHook(),
    afterEval: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncHook(),
    beforeMount: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncHook(),
    afterMount: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncHook(),
    errorMountApp: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncHook(),
    beforeUnmount: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncHook(),
    afterUnmount: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncHook(),
    errorUnmountApp: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncHook(),
    errorExecCode: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncHook(),
    customRender: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncWaterfallHook("customRender")
  });
}

// src/module/esModule.ts



var __GARFISH_ESM_ENV__ = "__GARFISH_ESM_ENV__";
var getModuleImportProcessor = (code) => {
  let finalCode = "";
  let resetCode = code;
  let prevCodeIndex = 0;
  const rawImport = "import";
  const wrapImport = "_import_";
  return (importAnalysis, newModuleName = "") => {
    const { d: importType, n: moduleName, s, e, ss, se } = importAnalysis;
    const isDynamicImport = importType > -1;
    if (isDynamicImport) {
      const codeStart = ss - prevCodeIndex;
      const codeEnd = se - prevCodeIndex;
      const dynamicImportStatement = resetCode.slice(codeStart, codeEnd);
      finalCode += resetCode.slice(0, codeStart);
      finalCode += dynamicImportStatement.replace(rawImport, wrapImport);
      resetCode = resetCode.slice(codeEnd);
      prevCodeIndex = se;
    } else if (moduleName) {
      const codeStart = s - prevCodeIndex;
      const codeEnd = e - prevCodeIndex;
      finalCode += resetCode.slice(0, codeStart);
      finalCode += newModuleName;
      resetCode = resetCode.slice(codeEnd);
      prevCodeIndex = e;
    }
    return [finalCode, resetCode];
  };
};
var genShellExecutionCode = (id, sourceModuleName, shellUrl) => `;import*as m$$_${id} from'${sourceModuleName}';import{u$$_ as u$$_${id}}from'${shellUrl}';u$$_${id}(m$$_${id})`;
var ESModuleLoader = class {
  constructor(app) {
    this.moduleCache = {};
    this.lock = new _garfish_utils__WEBPACK_IMPORTED_MODULE_2__.Lock();
    this.app = app;
    this.globalVarKey = `${__GARFISH_ESM_ENV__}_${this.app.appId}`;
  }
  execModuleCode(blobUrl) {
    const result = (0, eval)(`import('${blobUrl}')`);
    this.lock.release();
    return result;
  }
  createBlobUrl(code) {
    return URL.createObjectURL(new Blob([code], { type: "text/javascript" }));
  }
  setBlobUrl(saveId, blobUrl) {
    this.moduleCache[saveId].blobUrl = blobUrl;
  }
  async fetchModuleResource(lockId, envVarStr, noEntryEnvVarStr, saveUrl, requestUrl) {
    const { resourceManager } = await this.app.context.loader.load({
      scope: this.app.name,
      url: requestUrl
    });
    if (resourceManager) {
      let sourcemap = "";
      let { url, scriptCode } = resourceManager;
      if (!(0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.haveSourcemap)(scriptCode)) {
        sourcemap = await (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.createSourcemap)(scriptCode, requestUrl);
      }
      scriptCode = await this.analysisModule(lockId, scriptCode, envVarStr, noEntryEnvVarStr, saveUrl, url);
      const blobUrl = this.createBlobUrl(`import.meta.url='${url}';${this.app.isNoEntryScript(url) ? noEntryEnvVarStr : envVarStr}${scriptCode}
${sourcemap}`);
      this.setBlobUrl(saveUrl, blobUrl);
    }
  }
  getUrl(referUrl, targetUrl) {
    return !(0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.isAbsolute)(targetUrl) && referUrl ? (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.transformUrl)(referUrl, targetUrl) : targetUrl;
  }
  preloadStaticModuleAsync(analysis, realUrl) {
    const [imports] = analysis;
    for (let i = 0, length = imports.length; i < length; i++) {
      const importAnalysis = imports[i];
      const { d: importType, n: moduleName } = importAnalysis;
      const isDynamicImport = importType > -1;
      if (moduleName && !isDynamicImport) {
        this.app.context.loader.load({
          scope: this.app.name,
          url: this.getUrl(realUrl, moduleName)
        });
      }
    }
  }
  async analysisModule(lockId, code, envVarStr, noEntryEnvVarStr, baseUrl, realUrl) {
    await this.lock.wait(lockId);
    await (0,_alioth_org_es_module_lexer__WEBPACK_IMPORTED_MODULE_4__.init)();
    const analysis = (0,_alioth_org_es_module_lexer__WEBPACK_IMPORTED_MODULE_4__.parse)(code, realUrl || "");
    const thisModule = {
      analysis,
      source: code
    };
    if (baseUrl) {
      this.moduleCache[baseUrl] = thisModule;
    }
    let result = ["", code];
    let shellExecutionCode = "";
    const dynamicImport = `var _import_=(url)=>window.${this.globalVarKey}.import(url,'${baseUrl}','${realUrl}');`;
    const processImportModule = getModuleImportProcessor(code);
    const [imports] = analysis;
    this.preloadStaticModuleAsync(analysis, realUrl);
    for (let i = 0, length = imports.length; i < length; i++) {
      const importAnalysis = imports[i];
      const { d: importType, n: moduleName } = importAnalysis;
      const isDynamicImport = importType > -1;
      let saveUrl = moduleName || "";
      let newModuleName = "";
      if (moduleName && !isDynamicImport) {
        const requestUrl = this.getUrl(realUrl, moduleName);
        saveUrl = this.getUrl(baseUrl, moduleName);
        let currentModule = this.moduleCache[saveUrl];
        if (currentModule && !currentModule.blobUrl) {
          if (!currentModule.shellUrl) {
            const [currentModuleImports, currentModuleExports] = currentModule.analysis;
            const wildcardExports = currentModuleImports.filter((importItem) => {
              const statement = currentModule.source.substring(importItem.ss, importItem.se);
              return /^export\s*\*\s*from\s*/.test(statement);
            });
            const wildcardExportStatements = [];
            for (let j = 0, l = wildcardExports.length; j < l; j++) {
              const wildcardExport = wildcardExports[j];
              const wildcardExportUrl = wildcardExport.n || "";
              const wildcardExportSaveUrl = this.getUrl(baseUrl, wildcardExportUrl);
              await this.fetchModuleResource(lockId, envVarStr, noEntryEnvVarStr, wildcardExportSaveUrl, this.getUrl(realUrl, wildcardExportUrl));
              const wildcardModule = this.moduleCache[wildcardExportSaveUrl];
              if (wildcardModule == null ? void 0 : wildcardModule.blobUrl) {
                wildcardExportStatements.push(`export * from '${wildcardModule.blobUrl}'`);
              }
            }
            currentModule.shellUrl = this.createBlobUrl(`export function u$$_(m){${currentModuleExports.map((exportSpecifier) => exportSpecifier.n === "default" ? "d$$_=m.default" : `${exportSpecifier.n}=m.${exportSpecifier.n}`).join(",")}}${currentModuleExports.map((exportSpecifier) => exportSpecifier.n === "default" ? "let d$$_;export{d$$_ as default}" : `export let ${exportSpecifier.n}`).join(";")}${wildcardExportStatements.length ? `;${wildcardExportStatements.join(";")}` : ""}
//# sourceURL=${saveUrl}?cycle`);
          }
          newModuleName = currentModule.shellUrl;
        } else if (!currentModule) {
          await this.fetchModuleResource(lockId, envVarStr, noEntryEnvVarStr, saveUrl, requestUrl);
          currentModule = this.moduleCache[saveUrl];
          const { blobUrl, shellUrl, shellExecuted } = currentModule;
          newModuleName = blobUrl;
          if (shellUrl && !shellExecuted) {
            shellExecutionCode += genShellExecutionCode(i, newModuleName, shellUrl);
            currentModule.shellExecuted = true;
          }
        } else {
          newModuleName = currentModule.blobUrl;
        }
      }
      result = processImportModule(importAnalysis, newModuleName || moduleName);
    }
    thisModule.source = "";
    delete thisModule.analysis;
    return `${dynamicImport}${shellExecutionCode};${result.join("")}`;
  }
  destroy() {
    for (const key in this.moduleCache) {
      const { blobUrl, shellUrl } = this.moduleCache[key];
      if (blobUrl) {
        URL.revokeObjectURL(blobUrl);
      }
      if (shellUrl) {
        URL.revokeObjectURL(shellUrl);
      }
    }
    this.moduleCache = {};
    this.lock.clear();
    delete this.app.global[this.globalVarKey];
  }
  load(code, env, url, options) {
    return new Promise(async (resolve) => {
      if (url && this.moduleCache[url]) {
        return resolve();
      }
      const genShellCodeWrapper = (blobUrl2, shellUrl, sourceUrl) => {
        return `export * from '${blobUrl2}'${genShellExecutionCode(0, blobUrl2, shellUrl)}
//# sourceURL=${sourceUrl}?cycle`;
      };
      env = __spreadProps(__spreadValues({}, env), {
        resolve,
        import: async (moduleId, baseUrl, realUrl) => {
          let saveUrl = moduleId;
          let requestUrl = moduleId;
          if (!(0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.isAbsolute)(moduleId)) {
            saveUrl = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.transformUrl)(baseUrl, moduleId);
            requestUrl = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.transformUrl)(realUrl, moduleId);
          }
          let targetModule = this.moduleCache[saveUrl];
          if (!(targetModule == null ? void 0 : targetModule.blobUrl)) {
            await this.fetchModuleResource(this.lock.genId(), envVarStr, noEntryEnvVarStr, saveUrl, requestUrl);
            targetModule = this.moduleCache[saveUrl];
          }
          if (targetModule && targetModule.shellUrl && !targetModule.shellExecuted && targetModule.blobUrl) {
            return this.execModuleCode(this.createBlobUrl(genShellCodeWrapper(targetModule.blobUrl, targetModule.shellUrl, saveUrl)));
          }
          return this.execModuleCode(targetModule.blobUrl);
        }
      });
      const genEnvVarStr = (targetEnv, noEntry) => {
        const newEnv = __spreadValues({}, targetEnv);
        if (noEntry) {
          delete newEnv.exports;
          delete newEnv.module;
        }
        return Object.keys(newEnv).reduce((prevCode, name) => {
          if (name === "resolve" || name === "import")
            return prevCode;
          return `${prevCode} var ${name} = window.${this.globalVarKey}.${name};`;
        }, "");
      };
      const envVarStr = genEnvVarStr(env);
      const noEntryEnvVarStr = genEnvVarStr(env, true);
      let sourcemap = "";
      if (!(0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.haveSourcemap)(code) && url) {
        sourcemap = await (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.createSourcemap)(code, options && options.isInline ? `index.html(inline.${this.app.scriptCount}.js)` : url);
      }
      code = await this.analysisModule(this.lock.genId(), code, envVarStr, noEntryEnvVarStr, url, url);
      code = `import.meta.url='${url}';${(options == null ? void 0 : options.noEntry) ? noEntryEnvVarStr : envVarStr}${code}
;window.${this.globalVarKey}.resolve();
${sourcemap}`;
      this.app.global[this.globalVarKey] = env;
      let blobUrl = this.createBlobUrl(code);
      if (options && !options.isInline && url) {
        this.setBlobUrl(url, blobUrl);
      }
      const currentModule = this.moduleCache[url || ""];
      if ((currentModule == null ? void 0 : currentModule.shellUrl) && !currentModule.shellExecuted) {
        blobUrl = this.createBlobUrl(genShellCodeWrapper(blobUrl, currentModule.shellUrl, url || ""));
      }
      this.execModuleCode(blobUrl);
    });
  }
};

// src/module/app.ts
var appId = 0;
var __GARFISH_GLOBAL_ENV__ = "__GARFISH_GLOBAL_ENV__";
var __GARFISH_EXPORTS__ = "__GARFISH_EXPORTS__";
var App = class {
  constructor(context, appInfo, entryManager, resources, isHtmlMode, customLoader) {
    this.appId = appId++;
    this.scriptCount = 0;
    this.display = false;
    this.mounted = false;
    this.mounting = false;
    this.strictIsolation = false;
    this.esmQueue = new _garfish_utils__WEBPACK_IMPORTED_MODULE_2__.Queue();
    this.esModuleLoader = new ESModuleLoader(this);
    this.global = window;
    this.customExports = {};
    this.sourceList = [];
    this.sourceListMap = /* @__PURE__ */ new Map();
    this.childGarfishConfig = {};
    this.active = false;
    this.unmounting = false;
    this.deferNodeMap = /* @__PURE__ */ new Map();
    var _a;
    this.context = context;
    this.appInfo = appInfo;
    this.name = appInfo.name;
    this.resources = resources;
    this.isHtmlMode = isHtmlMode;
    this.entryManager = entryManager;
    this.appInfo.appId = this.appId;
    this.globalEnvVariables = {
      currentApp: this,
      loader: context.loader,
      externals: context.externals,
      remoteModulesCode: resources.modules
    };
    this.cjsModules = {
      exports: {},
      module: null,
      require: (key) => {
        const pkg = this.global[key] || context.externals[key] || window[key];
        if (!pkg) {
          (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(`Package "${key}" is not found`);
        }
        return pkg;
      }
    };
    this.cjsModules.module = this.cjsModules;
    this.customLoader = customLoader;
    this.hooks = appLifecycle();
    this.hooks.usePlugin(__spreadProps(__spreadValues({}, appInfo), {
      name: `${appInfo.name}-lifecycle`
    }));
    const nodes = entryManager.getNodesByTagName(..._garfish_utils__WEBPACK_IMPORTED_MODULE_2__.sourceListTags);
    for (const key in nodes) {
      nodes[key].forEach((node) => {
        var _a2, _b;
        const url = entryManager.findAttributeValue(node, "href") || entryManager.findAttributeValue(node, "src");
        if (url) {
          this.addSourceList({
            tagName: node.tagName,
            url: entryManager.url ? (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.transformUrl)(entryManager.url, url) : url
          });
        }
        if ((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.isGarfishConfigType)({
          type: entryManager.findAttributeValue(node, "type")
        })) {
          this.childGarfishConfig = JSON.parse((_b = (_a2 = node.children) == null ? void 0 : _a2[0]) == null ? void 0 : _b.content);
        }
      });
    }
    this.appInfo.entry && this.addSourceList({ tagName: "html", url: this.appInfo.entry });
    this.asyncProviderTimeout = (_a = this.appInfo.asyncProviderTimeout) != null ? _a : 0;
  }
  get rootElement() {
    return (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.findTarget)(this.htmlNode, [`div[${_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.__MockBody__}]`, "body"]);
  }
  get getSourceList() {
    return this.sourceList;
  }
  addSourceList(sourceInfo) {
    if (this.appInfo.disableSourceListCollect)
      return;
    if (Array.isArray(sourceInfo)) {
      const nSourceList = sourceInfo.filter((item) => {
        const url = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.getSourceURL)(item.url);
        if (!this.sourceListMap.has(url) && url.startsWith("http")) {
          this.sourceListMap.set(url, item);
          return true;
        }
        return false;
      });
      this.sourceList = this.sourceList.concat(nSourceList);
    } else {
      const url = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.getSourceURL)(sourceInfo.url);
      if (!this.sourceListMap.get(url) && url.startsWith("http")) {
        this.sourceList.push(sourceInfo);
        this.sourceListMap.set(url, sourceInfo);
      }
    }
  }
  initAsyncProviderRegistration() {
    const { asyncProviderTimeout, customExports } = this;
    if (asyncProviderTimeout) {
      customExports.registerProvider = (provider) => {
        var _a;
        this.asyncProvider = provider;
        (_a = this.resolveAsyncProvider) == null ? void 0 : _a.call(this);
      };
    }
  }
  awaitAsyncProviderRegistration() {
    return new Promise((resolve) => {
      if (this.asyncProvider) {
        resolve(this.asyncProvider);
        return;
      }
      const timeoutId = setTimeout(() => {
        resolve(this.asyncProvider);
      }, this.asyncProviderTimeout);
      this.resolveAsyncProvider = () => {
        clearTimeout(timeoutId);
        resolve(this.asyncProvider);
      };
    });
  }
  getProvider() {
    return this.provider ? Promise.resolve(this.provider) : this.checkAndGetProvider();
  }
  isNoEntryScript(url = "") {
    var _a, _b;
    return (_b = (_a = this.childGarfishConfig.sandbox) == null ? void 0 : _a.noEntryScripts) == null ? void 0 : _b.some((item) => url.indexOf(item) > -1);
  }
  execScript(code, env, url, options) {
    env = __spreadValues(__spreadValues({}, this.getExecScriptEnv(options == null ? void 0 : options.noEntry)), env || {});
    this.scriptCount++;
    const args = [this.appInfo, code, env, url, options];
    this.hooks.lifecycle.beforeEval.emit(...args);
    try {
      this.runCode(code, env, url, options);
    } catch (err) {
      this.hooks.lifecycle.errorExecCode.emit(err, ...args);
      throw err;
    }
    this.hooks.lifecycle.afterEval.emit(...args);
  }
  runCode(code, env, url, options) {
    if (options && options.isModule) {
      this.esmQueue.add(async (next) => {
        await this.esModuleLoader.load(code, __spreadValues(__spreadValues({}, this.getExecScriptEnv()), env), url, options);
        next();
      });
    } else {
      const revertCurrentScript = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.setDocCurrentScript)(this.global.document, code, true, url, options == null ? void 0 : options.async, options == null ? void 0 : options.defer, options == null ? void 0 : options.originScript);
      code += url ? `
//# sourceURL=${url}
` : "";
      if (!(0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.hasOwn)(env, "window")) {
        env = __spreadProps(__spreadValues({}, env), {
          window: this.global
        });
      }
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.evalWithEnv)(`;${code}`, env, this.global);
      Promise.resolve().then(revertCurrentScript);
    }
  }
  async show() {
    this.active = true;
    const { display, mounted, provider } = this;
    if (display)
      return false;
    if (!mounted) {
      (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)('Need to call the "app.mount()" method first.');
      return false;
    }
    this.hooks.lifecycle.beforeMount.emit(this.appInfo, this, true);
    this.context.activeApps.push(this);
    await this.addContainer();
    this.callRender(provider, false);
    this.display = true;
    this.hooks.lifecycle.afterMount.emit(this.appInfo, this, true);
    return true;
  }
  hide() {
    this.active = false;
    this.mounting = false;
    const { display, mounted, provider } = this;
    if (!display)
      return false;
    if (!mounted) {
      (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)('Need to call the "app.mount()" method first.');
      return false;
    }
    this.hooks.lifecycle.beforeUnmount.emit(this.appInfo, this, true);
    this.callDestroy(provider, false);
    this.display = false;
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.remove)(this.context.activeApps, this);
    this.hooks.lifecycle.afterUnmount.emit(this.appInfo, this, true);
    return true;
  }
  async mount() {
    if (!this.canMount())
      return false;
    this.hooks.lifecycle.beforeMount.emit(this.appInfo, this, false);
    this.active = true;
    this.mounting = true;
    try {
      this.context.activeApps.push(this);
      this.initAsyncProviderRegistration();
      const { asyncScripts, deferScripts } = await this.compileAndRenderContainer();
      if (!this.stopMountAndClearEffect())
        return false;
      deferScripts();
      const provider = await this.getProvider();
      if (!this.stopMountAndClearEffect())
        return false;
      this.callRender(provider, true);
      this.display = true;
      this.mounted = true;
      this.hooks.lifecycle.afterMount.emit(this.appInfo, this, false);
      await asyncScripts;
      if (!this.stopMountAndClearEffect())
        return false;
    } catch (e) {
      this.entryManager.DOMApis.removeElement(this.appContainer);
      this.hooks.lifecycle.errorMountApp.emit(e, this.appInfo);
      return false;
    } finally {
      this.mounting = false;
    }
    return true;
  }
  unmount() {
    this.active = false;
    this.mounting = false;
    if (!this.mounted || !this.appContainer) {
      return false;
    }
    if (this.unmounting) {
      (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(`The ${this.name} app unmounting.`);
      return false;
    }
    this.unmounting = true;
    this.hooks.lifecycle.beforeUnmount.emit(this.appInfo, this, false);
    try {
      this.callDestroy(this.provider, true);
      this.display = false;
      this.mounted = false;
      this.provider = void 0;
      this.customExports = {};
      this.cjsModules.exports = {};
      this.esModuleLoader.destroy();
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.remove)(this.context.activeApps, this);
      this.hooks.lifecycle.afterUnmount.emit(this.appInfo, this, false);
    } catch (e) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.remove)(this.context.activeApps, this);
      this.entryManager.DOMApis.removeElement(this.appContainer);
      this.hooks.lifecycle.errorUnmountApp.emit(e, this.appInfo);
      return false;
    } finally {
      this.unmounting = false;
    }
    return true;
  }
  getExecScriptEnv(noEntry) {
    const envs = {
      [__GARFISH_EXPORTS__]: this.customExports,
      [__GARFISH_GLOBAL_ENV__]: this.globalEnvVariables
    };
    if (noEntry) {
      return __spreadProps(__spreadValues({}, envs), {
        require: this.cjsModules.require
      });
    }
    return __spreadValues(__spreadValues({}, envs), this.cjsModules);
  }
  async compileAndRenderContainer() {
    await this.renderTemplate();
    const execScript = (type) => {
      for (const jsManager of this.resources.js) {
        if (jsManager[type]) {
          try {
            let noEntry = false;
            const targetUrl = jsManager.url || this.appInfo.entry;
            if (type === "defer") {
              const node = this.deferNodeMap.get(jsManager);
              if (node) {
                noEntry = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.toBoolean)(this.entryManager.findAttributeValue(node, "no-entry"));
              }
              if (!noEntry) {
                noEntry = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.toBoolean)(this.isNoEntryScript(targetUrl));
              }
            }
            this.execScript(jsManager.scriptCode, {}, targetUrl, {
              noEntry,
              defer: type === "defer",
              async: type === "async",
              isModule: jsManager.isModule(),
              isInline: jsManager.isInlineScript()
            });
          } catch (e) {
            if (type !== "defer") {
              this.hooks.lifecycle.errorMountApp.emit(e, this.appInfo);
            } else {
              throw e;
            }
          }
        }
      }
    };
    return {
      deferScripts: () => execScript("defer"),
      asyncScripts: new Promise((resolve) => {
        setTimeout(() => {
          if (this.stopMountAndClearEffect()) {
            execScript("async");
          }
          resolve();
        });
      })
    };
  }
  canMount() {
    if (this.mounting) {
      (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(`The ${this.appInfo.name} app mounting.`);
      return false;
    }
    if (this.mounted) {
      (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(`The ${this.appInfo.name} app already mounted.`);
      return false;
    }
    if (this.unmounting) {
      (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(`The ${this.appInfo.name} app is unmounting can't Perform application rendering.`);
      return false;
    }
    return true;
  }
  stopMountAndClearEffect() {
    if (!this.active) {
      if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
        (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(`The app "${this.name}" rendering process has been blocked.`);
      }
      this.mounting = false;
      if (this.appContainer) {
        this.entryManager.DOMApis.removeElement(this.appContainer);
      }
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.coreLog)(`${this.appInfo.name} id:${this.appId} stopMountAndClearEffect`, this.appContainer);
      return false;
    }
    return true;
  }
  callRender(provider, isMount) {
    if (provider && provider.render) {
      provider.render({
        appName: this.appInfo.name,
        dom: this.rootElement,
        basename: this.appInfo.basename,
        appRenderInfo: { isMount },
        props: this.appInfo.props
      });
    }
  }
  callDestroy(provider, isUnmount) {
    const { rootElement, appContainer } = this;
    if (provider && provider.destroy) {
      provider.destroy({
        appName: this.appInfo.name,
        dom: rootElement,
        appRenderInfo: { isUnmount },
        props: this.appInfo.props
      });
    }
    this.entryManager.DOMApis.removeElement(appContainer);
  }
  async addContainer() {
    const wrapperNode = await (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.getRenderNode)(this.appInfo.domGetter);
    if (typeof wrapperNode.appendChild === "function") {
      wrapperNode.appendChild(this.appContainer);
    }
  }
  async renderTemplate() {
    const { appInfo, entryManager, resources } = this;
    const { url: baseUrl, DOMApis } = entryManager;
    const { htmlNode, appContainer } = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.createAppContainer)(appInfo);
    const fixStaticResourceBaseUrl = !this.appInfo.sandbox || this.appInfo.sandbox && this.appInfo.sandbox.fixStaticResourceBaseUrl === true;
    this.htmlNode = htmlNode;
    this.appContainer = appContainer;
    await this.addContainer();
    const customRenderer = {
      meta: () => null,
      img: (node) => {
        fixStaticResourceBaseUrl && baseUrl && entryManager.toResolveUrl(node, "src", baseUrl);
        return DOMApis.createElement(node);
      },
      video: (node) => {
        fixStaticResourceBaseUrl && baseUrl && entryManager.toResolveUrl(node, "src", baseUrl);
        return DOMApis.createElement(node);
      },
      audio: (node) => {
        fixStaticResourceBaseUrl && baseUrl && entryManager.toResolveUrl(node, "src", baseUrl);
        return DOMApis.createElement(node);
      },
      iframe: (node) => {
        fixStaticResourceBaseUrl && baseUrl && entryManager.toResolveUrl(node, "src", baseUrl);
        return DOMApis.createElement(node);
      },
      body: (node) => {
        if (!this.strictIsolation) {
          node = entryManager.cloneNode(node);
          node.tagName = "div";
          node.attributes.push({
            key: _garfish_utils__WEBPACK_IMPORTED_MODULE_2__.__MockBody__,
            value: null
          });
        }
        return DOMApis.createElement(node);
      },
      head: (node) => {
        if (!this.strictIsolation) {
          node = entryManager.cloneNode(node);
          node.tagName = "div";
          node.attributes.push({
            key: _garfish_utils__WEBPACK_IMPORTED_MODULE_2__.__MockHead__,
            value: null
          });
        }
        return DOMApis.createElement(node);
      },
      script: (node) => {
        const mimeType = entryManager.findAttributeValue(node, "type");
        const isModule = mimeType === "module";
        if (mimeType) {
          if (!isModule && !(0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.isJsType)({ type: mimeType })) {
            return DOMApis.createElement(node);
          }
        }
        const jsManager = resources.js.find((manager) => {
          return !manager.async ? manager.isSameOrigin(node) : false;
        });
        if (jsManager) {
          if (jsManager.defer) {
            this.deferNodeMap.set(jsManager, node);
          } else {
            const { url, scriptCode } = jsManager;
            const mockOriginScript = document.createElement("script");
            node.attributes.forEach((attribute) => {
              if (attribute.key) {
                mockOriginScript.setAttribute(attribute.key, attribute.value || "");
              }
            });
            const targetUrl = url || this.appInfo.entry;
            this.execScript(scriptCode, {}, targetUrl, {
              isModule,
              async: false,
              defer: false,
              isInline: jsManager.isInlineScript(),
              noEntry: (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.toBoolean)(entryManager.findAttributeValue(node, "no-entry") || this.isNoEntryScript(targetUrl)),
              originScript: mockOriginScript
            });
          }
        } else if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
          const async = entryManager.findAttributeValue(node, "async");
          if (typeof async === "undefined" || async === "false") {
            const tipInfo = JSON.stringify(node, null, 2);
            (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(`Current js node cannot be found, the resource may not exist.

 ${tipInfo}`);
          }
        }
        return DOMApis.createScriptCommentNode(node);
      },
      style: (node) => {
        const text = node.children[0];
        if (text) {
          const styleManager = new this.context.loader.StyleManager(text.content, baseUrl);
          styleManager.setScope({
            appName: this.name,
            rootElId: this.appContainer.id
          });
          baseUrl && styleManager.correctPath(baseUrl);
          return entryManager.ignoreChildNodesCreation(styleManager.renderAsStyleElement());
        }
        return DOMApis.createElement(node);
      },
      link: (node) => {
        if (DOMApis.isCssLinkNode(node)) {
          const styleManager = this.resources.link.find((manager) => manager.isSameOrigin(node));
          if (styleManager) {
            styleManager.setScope({
              appName: this.name,
              rootElId: this.appContainer.id
            });
            return styleManager.renderAsStyleElement((typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) ? `
/*${DOMApis.createLinkCommentNode(node)}*/
` : "");
          }
        }
        return DOMApis.isPrefetchJsLinkNode(node) ? DOMApis.createScriptCommentNode(node) : DOMApis.isIconLinkNode(node) ? null : DOMApis.createElement(node);
      }
    };
    entryManager.createElements(customRenderer, htmlNode, (node, parent) => {
      return this.hooks.lifecycle.customRender.emit({
        node,
        parent,
        app: this,
        customElement: null
      });
    });
  }
  async checkAndGetProvider() {
    const { appInfo, rootElement, cjsModules, customExports } = this;
    const { name, props, basename } = appInfo;
    let provider = void 0;
    await this.esmQueue.awaitCompletion();
    if (cjsModules.exports) {
      if ((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.isPromise)(cjsModules.exports))
        cjsModules.exports = await cjsModules.exports;
      if (cjsModules.exports.provider)
        provider = cjsModules.exports.provider;
    }
    if (customExports.provider) {
      provider = customExports.provider;
    }
    if (this.asyncProviderTimeout && !provider) {
      provider = await this.awaitAsyncProviderRegistration();
    }
    if (typeof provider === "function") {
      provider = await provider(__spreadValues({
        basename,
        dom: rootElement
      }, props || {}), props);
    } else if ((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.isPromise)(provider)) {
      provider = await provider;
    }
    if (!(0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.isObject)(provider) && typeof provider !== "function") {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(` Invalid module content: ${name}, you should return both render and destroy functions in provider function.`);
    }
    const hookRes = await (this.customLoader && this.customLoader(provider, appInfo, basename));
    if (hookRes) {
      const { mount, unmount } = hookRes || {};
      if (typeof mount === "function" && typeof unmount === "function") {
        provider.render = mount;
        provider.destroy = unmount;
      }
    }
    if (!appInfo.noCheckProvider) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.assert)(provider, `"provider" is "${provider}".`);
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.assert)("render" in provider, '"render" is required in provider.');
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.assert)("destroy" in provider, '"destroy" is required in provider.');
    }
    this.provider = provider;
    return provider;
  }
};

// src/module/resource.ts

function fetchStaticResources(appName, loader, entryManager) {
  const toBoolean2 = (val) => typeof val !== "undefined" && val !== "false";
  const jsNodes = Promise.all(entryManager.findAllJsNodes().map((node) => {
    const src = entryManager.findAttributeValue(node, "src");
    const type = entryManager.findAttributeValue(node, "type");
    const crossOrigin = entryManager.findAttributeValue(node, "crossorigin");
    if (src) {
      const fetchUrl = entryManager.url ? (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.transformUrl)(entryManager.url, src) : src;
      const async = entryManager.findAttributeValue(node, "async");
      const defer = entryManager.findAttributeValue(node, "defer");
      return loader.load({
        scope: appName,
        url: fetchUrl,
        crossOrigin,
        defaultContentType: type
      }).then(({ resourceManager: jsManager }) => {
        if (jsManager) {
          jsManager.setDep(node);
          type && jsManager.setMimeType(type);
          jsManager.setAsyncAttribute(toBoolean2(async));
          jsManager.setDefferAttribute(toBoolean2(defer));
          return jsManager;
        } else {
          (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(`[${appName}] Failed to load script: ${fetchUrl}`);
        }
      }).catch(() => null);
    } else if (node.children.length > 0) {
      const code = node.children[0].content;
      if (code) {
        const jsManager = new loader.JavaScriptManager(code, "");
        jsManager.setDep(node);
        type && jsManager.setMimeType(type);
        return jsManager;
      }
    }
  }).filter(Boolean));
  const linkNodes = Promise.all(entryManager.findAllLinkNodes().map((node) => {
    if (!entryManager.DOMApis.isCssLinkNode(node))
      return;
    const href = entryManager.findAttributeValue(node, "href");
    if (href) {
      const fetchUrl = entryManager.url ? (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.transformUrl)(entryManager.url, href) : href;
      return loader.load({ scope: appName, url: fetchUrl }).then(({ resourceManager: styleManager }) => {
        if (styleManager) {
          styleManager.setDep(node);
          styleManager == null ? void 0 : styleManager.correctPath();
          return styleManager;
        } else {
          (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(`${appName} Failed to load link: ${fetchUrl}`);
        }
      }).catch(() => null);
    }
  }).filter(Boolean));
  const metaNodes = Promise.all(entryManager.findAllMetaNodes().map((node) => {
    if (!entryManager.DOMApis.isRemoteModule(node))
      return;
    const async = entryManager.findAttributeValue(node, "async");
    const alias = entryManager.findAttributeValue(node, "alias");
    if (!toBoolean2(async)) {
      const src = entryManager.findAttributeValue(node, "src");
      if (src) {
        return loader.loadModule(src).then(({ resourceManager: moduleManager }) => {
          if (moduleManager && alias) {
            moduleManager && moduleManager.setAlias(alias);
          }
          return moduleManager;
        }).catch(() => null);
      }
    } else if (alias) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(`Asynchronous loading module, the alias "${alias}" is invalid.`);
    }
  }).filter(Boolean));
  return Promise.all([jsNodes, linkNodes, metaNodes]).then((ls) => ls.map((ns) => ns.filter(Boolean)));
}
async function processAppResources(loader, appInfo) {
  let isHtmlMode = false, fakeEntryManager;
  const resources = { js: [], link: [], modules: [] };
  (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.assert)(appInfo.entry, `[${appInfo.name}] Entry is not specified.`);
  const { resourceManager: entryManager } = await loader.load({
    scope: appInfo.name,
    url: (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.transformUrl)(location.href, appInfo.entry)
  });
  if (entryManager instanceof loader.TemplateManager) {
    isHtmlMode = true;
    const [js, link, modules] = await fetchStaticResources(appInfo.name, loader, entryManager);
    resources.js = js;
    resources.link = link;
    resources.modules = modules;
  } else if (entryManager instanceof loader.JavaScriptManager) {
    isHtmlMode = false;
    const mockTemplateCode = `<script src="${entryManager.url}"><\/script>`;
    fakeEntryManager = new loader.TemplateManager(mockTemplateCode, entryManager.url);
    entryManager.setDep(fakeEntryManager.findAllJsNodes()[0]);
    resources.js = [entryManager];
  } else {
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.error)(`Entrance wrong type of resource of "${appInfo.name}".`);
  }
  return [fakeEntryManager || entryManager, resources, isHtmlMode];
}

// src/plugins/fixHMR.ts
function GarfishHMRPlugin() {
  let hasInit = false;
  let isHotUpdate = false;
  return function(Garfish2) {
    return {
      name: "fix-hmr",
      version: "1.16.2",
      bootstrap() {
        if (hasInit)
          return;
        hasInit = true;
        let webpackHotUpdateName = "webpackHotUpdate";
        let webpackHotUpdate = window[webpackHotUpdateName];
        for (const i in window) {
          if (i.includes("webpackHotUpdate")) {
            webpackHotUpdateName = i;
            webpackHotUpdate = window[i];
          }
        }
        if (typeof webpackHotUpdate === "function") {
          window[webpackHotUpdateName] = function() {
            isHotUpdate = true;
            return webpackHotUpdate.apply(this, arguments);
          };
          const observer = new MutationObserver(() => {
            if (!isHotUpdate)
              return;
            isHotUpdate = false;
            Garfish2.activeApps.forEach((app) => {
              if (app.mounted) {
                setTimeout(() => {
                  app.display && app.hide();
                  app.show();
                });
              }
            });
          });
          observer.observe(document.documentElement, {
            subtree: true,
            childList: true,
            attributes: true
          });
        }
      }
    };
  };
}

// src/plugins/lifecycle.ts
function GarfishOptionsLife(options, name) {
  return function() {
    return __spreadValues({
      name,
      version: "1.16.2"
    }, options);
  };
}

// src/plugins/preload.ts


var storageKey = "__garfishPreloadApp__";
var isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
var requestQueue = new _garfish_utils__WEBPACK_IMPORTED_MODULE_2__.Queue();
var isSlowNetwork = () => navigator.connection ? navigator.connection.saveData || /(2|3)g/.test(navigator.connection.effectiveType) : false;
var requestIdleCallback = typeof _garfish_utils__WEBPACK_IMPORTED_MODULE_2__.idleCallback !== "function" ? window.setTimeout : _garfish_utils__WEBPACK_IMPORTED_MODULE_2__.idleCallback;
function safeLoad({
  loader,
  appName,
  url,
  isModule,
  immediately,
  callback
}) {
  const generateSuccess = (next = () => {
  }) => ({ resourceManager }) => {
    callback && callback(resourceManager);
    setTimeout(next, 500);
  };
  const generateThrowWarn = (next = () => {
  }) => (e) => {
    if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(e);
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(`Preload failed. "${url}"`);
    }
    next();
  };
  const loadResource = (next = () => {
  }) => {
    const throwWarn = generateThrowWarn(next);
    const success = generateSuccess(next);
    try {
      if (isModule) {
        loader.loadModule(url).then(success, throwWarn);
      } else {
        loader.load({ scope: appName, url }).then(success, throwWarn);
      }
    } catch (e) {
      throwWarn(e);
      next();
    }
  };
  if (immediately) {
    loadResource();
  } else {
    requestQueue.add((next) => {
      requestIdleCallback(() => loadResource(next));
    });
  }
}
function loadAppResource(loader, info, immediately = false) {
  false;
  const fetchUrl = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.transformUrl)(location.href, info.entry);
  safeLoad({
    loader,
    appName: info.name,
    url: fetchUrl,
    isModule: false,
    immediately,
    callback: (manager) => {
      const loadStaticResource = () => {
        if (manager instanceof _garfish_loader__WEBPACK_IMPORTED_MODULE_0__.TemplateManager) {
          const baseUrl = manager.url;
          const jsNodes = manager.findAllJsNodes();
          const linkNodes = manager.findAllLinkNodes();
          const metaNodes = manager.findAllMetaNodes();
          if (jsNodes) {
            jsNodes.forEach((node) => {
              const src = manager.findAttributeValue(node, "src");
              src && safeLoad({
                loader,
                appName: info.name,
                url: baseUrl ? (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.transformUrl)(baseUrl, src) : src,
                isModule: false,
                immediately
              });
            });
          }
          if (linkNodes) {
            linkNodes.forEach((node) => {
              if (manager.DOMApis.isCssLinkNode(node)) {
                const href = manager.findAttributeValue(node, "href");
                href && safeLoad({
                  loader,
                  appName: info.name,
                  url: baseUrl ? (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.transformUrl)(baseUrl, href) : href,
                  isModule: false,
                  immediately
                });
              }
            });
          }
          if (metaNodes) {
            metaNodes.forEach((node) => {
              if (manager.DOMApis.isRemoteModule(node)) {
                const src = manager.findAttributeValue(node, "src");
                if (src && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.isAbsolute)(src)) {
                  safeLoad({
                    loader,
                    appName: info.name,
                    url: src,
                    isModule: true,
                    immediately
                  });
                } else {
                  (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(`The loading of the remote module must be an absolute path. "${src}"`);
                }
              }
            });
          }
        }
      };
      if (immediately) {
        loadStaticResource();
      } else {
        requestIdleCallback(loadStaticResource);
      }
    }
  });
}
function getRanking() {
  const str = localStorage.getItem(storageKey);
  if (str) {
    const data = JSON.parse(str);
    return data.sort((a, b) => b.count - a.count);
  }
  return [];
}
function setRanking(appName) {
  const str = localStorage.getItem(storageKey);
  const newCurrent = { appName, count: 1 };
  if (!str) {
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.safeWrapper)(() => localStorage.setItem(storageKey, JSON.stringify([newCurrent])));
  } else {
    const data = JSON.parse(str);
    const current = data.find((app) => app.appName === appName);
    current ? current.count++ : data.push(newCurrent);
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.safeWrapper)(() => localStorage.setItem(storageKey, JSON.stringify(data)));
  }
}
var loadedMap = /* @__PURE__ */ Object.create(null);
function GarfishPreloadPlugin() {
  return function(Garfish2) {
    Garfish2.preloadApp = (appName) => {
      if (loadedMap[appName]) {
        return;
      }
      loadedMap[appName] = true;
      loadAppResource(Garfish2.loader, Garfish2.appInfos[appName], true);
    };
    return {
      name: "preload",
      version: "1.16.2",
      beforeLoad(appInfo) {
        if (Garfish2.options.disablePreloadApp) {
          return;
        }
        setRanking(appInfo.name);
      },
      registerApp(appInfos) {
        if (Garfish2.options.disablePreloadApp) {
          return;
        }
        setTimeout(() => {
          if (isMobile || isSlowNetwork())
            return;
          const ranking = getRanking();
          for (const { appName } of ranking) {
            if (appInfos[appName] && !loadedMap[appName]) {
              loadedMap[appName] = true;
              loadAppResource(Garfish2.loader, appInfos[appName]);
            }
          }
          for (const key in appInfos) {
            if (!loadedMap[key]) {
              loadAppResource(Garfish2.loader, appInfos[key]);
            }
          }
        },  false ? 0 : 5e3);
      }
    };
  };
}

// src/plugins/performance/subAppObserver.ts

var SubAppObserver = class {
  constructor(options) {
    this.observer = new MutationObserver(this._mutationObserverCallback.bind(this));
    this.subAppBeforeLoadTime = 0;
    this.subAppBeforeMountTime = 0;
    this.subAppStartPageShowTime = 0;
    this.subAppPageShowTime = 0;
    this.entry = "";
    this.observeTimer = 0;
    this.dataTimer = 0;
    this.domQuerySelector = options.subAppRootSelector;
    this.config = { attributes: true, childList: true, subtree: true };
    this.targetSubscriber = [];
    this.timeLag = options.domObserverMaxTime || 3e3;
    this.reportTimeLag = options.waitSubAppNotifyMaxTime || 1e4;
    this.isRecordFinish = false;
    this.cbEntryList = [];
    this.isStartShowFlag = true;
    this.isCallBackFinish = false;
    this.isSubAppNotifyFinish = false;
    this.finishAction = "";
    this.performanceData = {
      resourceLoadTime: 0,
      blankScreenTime: 0,
      firstScreenTime: 0,
      isFirstRender: true,
      entry: "",
      action: ""
    };
  }
  subscribePerformanceData(callback) {
    try {
      this.targetSubscriber.push(callback);
    } catch (e) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(e);
    }
  }
  subscribePerformanceDataOnce(callback) {
    try {
      const wrapCallback = (performanceData) => {
        callback(performanceData);
        this.unsubscribePerformanceData(wrapCallback);
      };
      this.targetSubscriber.push(wrapCallback);
    } catch (e) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(e);
    }
  }
  unsubscribePerformanceData(callback) {
    try {
      this.targetSubscriber = this.targetSubscriber.filter((sub) => sub === callback);
    } catch (e) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(e);
    }
  }
  subAppBeforeLoad(entry) {
    this.entry = entry;
    this.isRecordFinish = false;
    this.isSubAppNotifyFinish = false;
    this.subAppBeforeLoadTime = performance.now();
    this.isCallBackFinish = false;
    this._handleSubscribeCallback(false);
  }
  subAppBeforeMount() {
    this.subAppBeforeMountTime = performance.now();
    this._subAppStartObserver();
  }
  subAppUnmount() {
    if (!this.isRecordFinish) {
      this._subAppEndObserver("subAppUnmount");
    }
    this._handleSubscribeCallback(true);
  }
  afterRenderNotify() {
    if (!this.isRecordFinish) {
      this._subAppEndObserver("SubAppRenderNotify");
    } else if (!this.isSubAppNotifyFinish) {
      this.isSubAppNotifyFinish = true;
      this.isRecordFinish = true;
      this.finishAction = "SubAppRenderNotify";
      this._subAppPerformanceDataHandle();
    }
  }
  _mutationObserverCallback() {
    if (this.isStartShowFlag) {
      this.subAppStartPageShowTime = performance.now();
      this.isStartShowFlag = false;
    }
    clearTimeout(this.observeTimer);
    this.observeTimer = setTimeout(() => {
      clearTimeout(this.observeTimer);
      if (!this.isRecordFinish) {
        this._subAppEndObserver("MutationObserver");
      }
    }, this.timeLag);
  }
  _subAppEndObserver(finishAction) {
    this.isRecordFinish = true;
    this.finishAction = finishAction;
    this.subAppPageShowTime = performance.now();
    this.observer.disconnect();
    this._subAppPerformanceDataHandle();
    this.isStartShowFlag = true;
  }
  async _subAppStartObserver() {
    try {
      const targetNode = await (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.getRenderNode)(this.domQuerySelector);
      this.observer.observe(targetNode, this.config);
      this._subAppClickEventObserver(targetNode);
    } catch (e) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(e);
    }
  }
  _subAppPerformanceDataHandle() {
    const timeDifference = this.finishAction === "MutationObserver" ? this.timeLag : 0;
    this.performanceData = {
      resourceLoadTime: this.subAppBeforeMountTime - this.subAppBeforeLoadTime,
      blankScreenTime: this.subAppStartPageShowTime - this.subAppBeforeLoadTime,
      firstScreenTime: this.subAppPageShowTime - this.subAppBeforeLoadTime - timeDifference,
      isFirstRender: this.cbEntryList.indexOf(this.entry) === -1,
      entry: this.entry,
      action: this.finishAction
    };
  }
  _subAppClickEventObserver(targetNode) {
    const eventCallback = () => {
      clearTimeout(this.observeTimer);
      if (!this.isRecordFinish) {
        this._subAppEndObserver("UserEvent");
      }
    };
    targetNode.addEventListener("click", eventCallback);
    targetNode.addEventListener("keyup", eventCallback);
    targetNode.addEventListener("keydown", eventCallback);
    targetNode.addEventListener("keypress", eventCallback);
  }
  _handleCallback() {
    try {
      this.isCallBackFinish = true;
      this.targetSubscriber.forEach((callback) => {
        const {
          firstScreenTime,
          blankScreenTime,
          resourceLoadTime,
          action,
          entry
        } = this.performanceData;
        if (firstScreenTime > 0 && blankScreenTime > 0 && resourceLoadTime > 0 && action && entry) {
          if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
            console.warn("SUCCESS: ", this.performanceData);
          }
          this.cbEntryList.push(this.entry);
          callback(this.performanceData);
        } else if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
          console.warn("ERROR: ", this.performanceData);
        }
      });
    } catch (e) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(e);
    }
  }
  _handleSubscribeCallback(isImmediately) {
    try {
      clearTimeout(this.dataTimer);
      if (isImmediately && !this.isCallBackFinish) {
        this._handleCallback();
      } else {
        this.dataTimer = setTimeout(() => {
          this._handleCallback();
        }, this.reportTimeLag);
      }
    } catch (e) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(e);
    }
  }
};

// src/plugins/performance/index.ts
function GarfishPerformance() {
  return function() {
    const subAppMap = {};
    return {
      name: "performance",
      beforeLoad(appInfo) {
        if (!subAppMap[appInfo.name] && appInfo.domGetter) {
          subAppMap[appInfo.name] = new SubAppObserver({
            subAppRootSelector: appInfo.domGetter
          });
        }
        subAppMap[appInfo.name].subAppBeforeLoad(appInfo.entry);
      },
      afterLoad(appInfo, appInstance) {
        if (appInstance) {
          appInstance.appPerformance = subAppMap[appInfo.name];
        }
      },
      beforeMount(appInfo) {
        subAppMap[appInfo.name].subAppBeforeMount(appInfo.entry);
      },
      beforeUnmount(appInfo) {
        subAppMap[appInfo.name].subAppUnmount(appInfo.entry);
      }
    };
  };
}

// src/plugins/logger.ts

function GarfishLogger() {
  return function() {
    return {
      name: "garfish-logger",
      version: "1.16.2",
      beforeLoad(appInfo, ...args) {
        (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.coreLog)(`${appInfo.name} beforeLoad`, [appInfo, ...args]);
      },
      afterLoad(appInfo, appInstance, ...args) {
        if (appInstance) {
          (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.coreLog)(`${appInfo.name} id: ${appInstance.appId} afterLoad`, [
            appInfo,
            ...args
          ]);
        }
      },
      beforeMount(appInfo, appInstance, ...args) {
        (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.coreLog)(`${appInfo.name} id: ${appInstance.appId} beforeMount`, [
          appInfo,
          ...args
        ]);
      },
      afterMount(appInfo, appInstance, ...args) {
        (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.coreLog)(`${appInfo.name} id: ${appInstance.appId} afterMount`, [
          appInfo,
          ...args
        ]);
      },
      beforeUnmount(appInfo, appInstance, ...args) {
        (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.coreLog)(`${appInfo.name} id: ${appInstance.appId} beforeUnmount`, [
          appInfo,
          ...args
        ]);
      },
      afterUnmount(appInfo, appInstance, ...args) {
        (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.coreLog)(`${appInfo.name} id: ${appInstance.appId} afterUnmount`, [
          appInfo,
          ...args
        ]);
      }
    };
  };
}

// src/garfish.ts
var DEFAULT_PROPS = /* @__PURE__ */ new WeakMap();
var HOOKS_API = {
  SyncHook: _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncHook,
  AsyncHook: _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.AsyncHook,
  SyncWaterfallHook: _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.SyncWaterfallHook,
  AsyncWaterfallHook: _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.AsyncWaterfallHook
};
var Garfish = class extends eventemitter2__WEBPACK_IMPORTED_MODULE_1__.EventEmitter2 {
  constructor(options) {
    super();
    this.running = false;
    this.version = "1.16.2";
    this.flag = _garfish_utils__WEBPACK_IMPORTED_MODULE_2__.__GARFISH_FLAG__;
    this.loader = new _garfish_loader__WEBPACK_IMPORTED_MODULE_0__.Loader();
    this.hooks = globalLifecycle();
    this.channel = new eventemitter2__WEBPACK_IMPORTED_MODULE_1__.EventEmitter2();
    this.options = createDefaultOptions();
    this.externals = {};
    this.activeApps = [];
    this.plugins = {};
    this.cacheApps = {};
    this.appInfos = {};
    this.loading = {};
    var _a;
    this.setOptions(options);
    DEFAULT_PROPS.set(this, {});
    (_a = this.options.plugins) == null ? void 0 : _a.forEach((plugin) => this.usePlugin(plugin));
    this.usePlugin(GarfishHMRPlugin());
    this.usePlugin(GarfishPerformance());
    this.usePlugin(GarfishPreloadPlugin());
    this.usePlugin(GarfishLogger());
  }
  get props() {
    return this.options && this.options.props || DEFAULT_PROPS.get(this);
  }
  setOptions(options) {
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.assert)(!this.running, "Garfish is running, can`t set options");
    if ((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.isPlainObject)(options)) {
      this.options = deepMergeConfig(this.options, options);
    }
    return this;
  }
  createPluginSystem(callback) {
    const hooks = callback(HOOKS_API);
    return new _garfish_hooks__WEBPACK_IMPORTED_MODULE_3__.PluginSystem(hooks);
  }
  usePlugin(plugin, ...args) {
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.assert)(!this.running, "Cannot register plugin after Garfish is started.");
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.assert)(typeof plugin === "function", "Plugin must be a function.");
    args.unshift(this);
    const pluginConfig = plugin.apply(null, args);
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.assert)(pluginConfig.name, "The plugin must have a name.");
    if (!this.plugins[pluginConfig.name]) {
      this.plugins[pluginConfig.name] = pluginConfig;
      this.hooks.usePlugin(pluginConfig);
    } else if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)("Please do not register the plugin repeatedly.");
    }
    return this;
  }
  run(options = {}) {
    var _a;
    if (this.running) {
      if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
        (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)("Garfish is already running now, Cannot run Garfish repeatedly.");
      }
      return this;
    }
    this.setOptions(options);
    (_a = options.plugins) == null ? void 0 : _a.forEach((plugin) => this.usePlugin(plugin));
    this.usePlugin(GarfishOptionsLife(this.options, "global-lifecycle"));
    this.hooks.lifecycle.beforeBootstrap.emit(this.options);
    this.registerApp(this.options.apps || []);
    this.running = true;
    this.hooks.lifecycle.bootstrap.emit(this.options);
    return this;
  }
  registerApp(list) {
    const currentAdds = {};
    this.hooks.lifecycle.beforeRegisterApp.emit(list);
    if (!Array.isArray(list))
      list = [list];
    for (const appInfo of list) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.assert)(appInfo.name, "Miss app.name.");
      if (!this.appInfos[appInfo.name]) {
        (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.assert)(appInfo.entry, `${appInfo.name} application entry is not url: ${appInfo.entry}`);
        currentAdds[appInfo.name] = appInfo;
        this.appInfos[appInfo.name] = appInfo;
      } else if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
        (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(`The "${appInfo.name}" app is already registered.`);
      }
    }
    this.hooks.lifecycle.registerApp.emit(currentAdds);
    return this;
  }
  setExternal(nameOrExtObj, value) {
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.assert)(nameOrExtObj, "Invalid parameter.");
    if (typeof nameOrExtObj === "object") {
      for (const key in nameOrExtObj) {
        if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
          this.externals[key] && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(`The "${key}" will be overwritten in external.`);
        }
        this.externals[key] = nameOrExtObj[key];
      }
    } else {
      this.externals[nameOrExtObj] = value;
    }
    return this;
  }
  loadApp(appName, options) {
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.assert)(appName, "Miss appName.");
    let appInfo = generateAppOptions(appName, this, options);
    const asyncLoadProcess = async () => {
      const stop = await this.hooks.lifecycle.beforeLoad.emit(appInfo);
      if (stop === false) {
        (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(`Load ${appName} application is terminated by beforeLoad.`);
        return null;
      }
      appInfo = generateAppOptions(appName, this, appInfo);
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.assert)(appInfo.entry, `Can't load unexpected child app "${appName}", Please provide the entry parameters or registered in advance of the app.`);
      let appInstance = null;
      const cacheApp = this.cacheApps[appName];
      if (appInfo.cache && cacheApp) {
        appInstance = cacheApp;
      } else {
        try {
          const [manager, resources, isHtmlMode] = await processAppResources(this.loader, appInfo);
          appInstance = new App(this, appInfo, manager, resources, isHtmlMode, appInfo.customLoader);
          for (const key in this.plugins) {
            appInstance.hooks.usePlugin(this.plugins[key]);
          }
          if (appInfo.cache) {
            this.cacheApps[appName] = appInstance;
          }
        } catch (e) {
          (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_2__.warn)(e);
          this.hooks.lifecycle.errorLoadApp.emit(e, appInfo);
        }
      }
      await this.hooks.lifecycle.afterLoad.emit(appInfo, appInstance);
      return appInstance;
    };
    if (!this.loading[appName]) {
      this.loading[appName] = asyncLoadProcess().finally(() => {
        delete this.loading[appName];
      });
    }
    return this.loading[appName];
  }
};



/***/ }),

/***/ "./node_modules/.pnpm/@garfish+hooks@1.16.2/node_modules/@garfish/hooks/dist/esm/index.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@garfish+hooks@1.16.2/node_modules/@garfish/hooks/dist/esm/index.js ***!
  \************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AsyncHook: function() { return /* binding */ AsyncHook; },
/* harmony export */   AsyncWaterfallHook: function() { return /* binding */ AsyncWaterfallHook; },
/* harmony export */   PluginSystem: function() { return /* binding */ PluginSystem; },
/* harmony export */   SyncHook: function() { return /* binding */ SyncHook; },
/* harmony export */   SyncWaterfallHook: function() { return /* binding */ SyncWaterfallHook; }
/* harmony export */ });
/* harmony import */ var _garfish_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @garfish/utils */ "./node_modules/.pnpm/@garfish+utils@1.16.2/node_modules/@garfish/utils/dist/esm/index.js");
/* provided dependency */ var process = __webpack_require__(/*! process/browser */ "./node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");
// src/syncHook.ts

var SyncHook = class {
  constructor(type) {
    this.type = "";
    this.listeners = /* @__PURE__ */ new Set();
    if (type)
      this.type = type;
  }
  on(fn) {
    if (typeof fn === "function") {
      this.listeners.add(fn);
    } else if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.warn)('Invalid parameter in "Hook".');
    }
  }
  once(fn) {
    const self = this;
    this.on(function wrapper(...args) {
      self.remove(wrapper);
      return fn.apply(null, args);
    });
  }
  emit(...data) {
    if (this.listeners.size > 0) {
      this.listeners.forEach((fn) => fn.apply(null, data));
    }
  }
  remove(fn) {
    return this.listeners.delete(fn);
  }
  removeAll() {
    this.listeners.clear();
  }
};

// src/asyncHook.ts
var AsyncHook = class extends SyncHook {
  emit(...data) {
    let result;
    const ls = Array.from(this.listeners);
    if (ls.length > 0) {
      let i = 0;
      const call = (prev) => {
        if (prev === false) {
          return false;
        } else if (i < ls.length) {
          return Promise.resolve(ls[i++].apply(null, data)).then(call);
        } else {
          return prev;
        }
      };
      result = call();
    }
    return Promise.resolve(result);
  }
};

// src/syncWaterfallHook.ts

function checkReturnData(originData, returnData) {
  if (!(0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.isObject)(returnData))
    return false;
  if (originData !== returnData) {
    for (const key in originData) {
      if (!(key in returnData)) {
        return false;
      }
    }
  }
  return true;
}
var SyncWaterfallHook = class extends SyncHook {
  constructor(type) {
    super();
    this.onerror = _garfish_utils__WEBPACK_IMPORTED_MODULE_0__.error;
    this.type = type;
  }
  emit(data) {
    if (!(0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.isObject)(data)) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.error)(`"${this.type}" hook response data must be an object.`);
    }
    for (const fn of this.listeners) {
      try {
        const tempData = fn(data);
        if (checkReturnData(data, tempData)) {
          data = tempData;
        } else {
          this.onerror(`The return value of hook "${this.type}" is incorrect.`);
          break;
        }
      } catch (e) {
        (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.warn)(e);
        this.onerror(e);
      }
    }
    return data;
  }
};

// src/asyncWaterfallHooks.ts

var AsyncWaterfallHook = class extends SyncHook {
  constructor(type) {
    super();
    this.onerror = _garfish_utils__WEBPACK_IMPORTED_MODULE_0__.error;
    this.type = type;
  }
  emit(data) {
    if (!(0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.isObject)(data)) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.error)(`"${this.type}" hook response data must be an object.`);
    }
    const ls = Array.from(this.listeners);
    if (ls.length > 0) {
      let i = 0;
      const processError = (e) => {
        (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.warn)(e);
        this.onerror(e);
        return data;
      };
      const call = (prevData) => {
        if (prevData === false) {
          return false;
        } else if (checkReturnData(data, prevData)) {
          data = prevData;
          if (i < ls.length) {
            try {
              return Promise.resolve(ls[i++](data)).then(call, processError);
            } catch (e) {
              return processError(e);
            }
          }
        } else {
          this.onerror(`The return value of hook "${this.type}" is incorrect.`);
        }
        return data;
      };
      return Promise.resolve(call(data));
    }
    return Promise.resolve(data);
  }
};

// src/pluginSystem.ts

var PluginSystem = class {
  constructor(lifecycle) {
    this.registerPlugins = {};
    this.lifecycle = lifecycle;
    this.lifecycleKeys = Object.keys(lifecycle);
  }
  usePlugin(plugin) {
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.assert)((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.isPlainObject)(plugin), "Invalid plugin configuration.");
    const pluginName = plugin.name;
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.assert)(pluginName, "Plugin must provide a name.");
    if (!this.registerPlugins[pluginName]) {
      this.registerPlugins[pluginName] = plugin;
      for (const key in this.lifecycle) {
        const pluginLife = plugin[key];
        if (pluginLife) {
          this.lifecycle[key].on(pluginLife);
        }
      }
    } else {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.warn)(`Repeat to register plugin hooks "${pluginName}".`);
    }
  }
  removePlugin(pluginName) {
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.assert)(pluginName, "Must provide a name.");
    const plugin = this.registerPlugins[pluginName];
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.assert)(plugin, `plugin "${pluginName}" is not registered.`);
    for (const key in plugin) {
      if (key === "name")
        continue;
      this.lifecycle[key].remove(plugin[key]);
    }
  }
  inherit({ lifecycle, registerPlugins }) {
    for (const hookName in lifecycle) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.assert)(!this.lifecycle[hookName], `"${hookName}" hook has conflict and cannot be inherited.`);
      this.lifecycle[hookName] = lifecycle[hookName];
    }
    for (const pluginName in registerPlugins) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.assert)(!this.registerPlugins[pluginName], `"${pluginName}" plugin has conflict and cannot be inherited.`);
      this.usePlugin(registerPlugins[pluginName]);
    }
    return this;
  }
};



/***/ }),

/***/ "./node_modules/.pnpm/@garfish+loader@1.16.2/node_modules/@garfish/loader/dist/esm/index.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@garfish+loader@1.16.2/node_modules/@garfish/loader/dist/esm/index.js ***!
  \**************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   CrossOriginCredentials: function() { return /* binding */ CrossOriginCredentials; },
/* harmony export */   JavaScriptManager: function() { return /* binding */ JavaScriptManager; },
/* harmony export */   Loader: function() { return /* binding */ Loader; },
/* harmony export */   ModuleManager: function() { return /* binding */ ModuleManager; },
/* harmony export */   StyleManager: function() { return /* binding */ StyleManager; },
/* harmony export */   TemplateManager: function() { return /* binding */ TemplateManager; }
/* harmony export */ });
/* harmony import */ var _garfish_hooks__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @garfish/hooks */ "./node_modules/.pnpm/@garfish+hooks@1.16.2/node_modules/@garfish/hooks/dist/esm/index.js");
/* harmony import */ var _garfish_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @garfish/utils */ "./node_modules/.pnpm/@garfish+utils@1.16.2/node_modules/@garfish/utils/dist/esm/index.js");
/* provided dependency */ var process = __webpack_require__(/*! process/browser */ "./node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");
var __defProp = Object.defineProperty;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a, b) => {
  for (var prop in b || (b = {}))
    if (__hasOwnProp.call(b, prop))
      __defNormalProp(a, prop, b[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b)) {
      if (__propIsEnum.call(b, prop))
        __defNormalProp(a, prop, b[prop]);
    }
  return a;
};

// src/index.ts



// src/managers/style.ts

var MATCH_CSS_URL = /url\(\s*(['"])?(.*?)\1\s*\)/g;
var MATCH_CHARSET_URL = /@charset\s+(['"])(.*?)\1\s*;?/g;
var MATCH_IMPORT_URL = /@import\s+(['"])(.*?)\1/g;
var StyleManager = class {
  constructor(styleCode, url) {
    this.depsStack = /* @__PURE__ */ new Set();
    this.scopeData = null;
    this.url = url || null;
    this.styleCode = styleCode;
  }
  correctPath(baseUrl) {
    const { url, styleCode } = this;
    if (!baseUrl)
      baseUrl = url;
    if (baseUrl && typeof styleCode === "string") {
      this.styleCode = styleCode.replace(MATCH_CHARSET_URL, "").replace(MATCH_IMPORT_URL, function(k0, k1, k2) {
        return k2 ? `@import url(${k1}${k2}${k1})` : k0;
      }).replace(MATCH_CSS_URL, (k0, k1, k2) => {
        if ((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.isAbsolute)(k2))
          return k0;
        return `url("${baseUrl ? (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.transformUrl)(baseUrl, k2) : k2}")`;
      });
    }
  }
  transformCode(code) {
    return code;
  }
  setDep(node) {
    this.depsStack.add(node);
  }
  setScope(data) {
    this.scopeData = data;
  }
  isSameOrigin(node) {
    return this.depsStack.has(node);
  }
  renderAsStyleElement(extraCode = "") {
    const node = document.createElement("style");
    const code = extraCode + (this.styleCode ? this.styleCode : "/**empty style**/");
    node.setAttribute("type", "text/css");
    node.textContent = this.transformCode(code);
    return node;
  }
  clone() {
    const cloned = new this.constructor();
    cloned.url = this.url;
    cloned.styleCode = this.styleCode;
    cloned.scopeData = this.scopeData;
    cloned.depsStack = new Set(this.depsStack);
    return cloned;
  }
};

// src/managers/module.ts
var ModuleManager = class {
  constructor(moduleCode, url) {
    this.alias = null;
    this.url = url || null;
    this.moduleCode = moduleCode;
  }
  setAlias(name) {
    if (name && typeof name === "string") {
      this.alias = name;
    }
  }
  clone() {
    const cloned = new this.constructor();
    cloned.url = this.url;
    cloned.alias = this.alias;
    cloned.moduleCode = this.moduleCode;
    return cloned;
  }
};

// src/managers/template.ts

var TemplateManager = class {
  constructor(template, url) {
    this.DOMApis = new _garfish_utils__WEBPACK_IMPORTED_MODULE_1__.DOMApis();
    this.astTree = [];
    this.pretreatmentStore = {};
    this.url = url;
    if (template) {
      const [astTree, collectionEls] = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.templateParse)(template, [
        "meta",
        "link",
        "style",
        "script"
      ]);
      this.astTree = astTree;
      this.pretreatmentStore = collectionEls;
    }
  }
  getNodesByTagName(...tags) {
    let counter = 0;
    const collection = {};
    for (const tag of tags) {
      if (this.pretreatmentStore[tag]) {
        counter++;
        collection[tag] = this.pretreatmentStore[tag];
      } else {
        collection[tag] = [];
      }
    }
    if (counter !== tags.length) {
      const traverse = (node) => {
        if (node.type !== "element")
          return;
        if (tags.indexOf(node.tagName) > -1 && !this.pretreatmentStore[node.tagName]) {
          collection[node.tagName].push(node);
        }
        for (const child of node.children)
          traverse(child);
      };
      for (const node of this.astTree)
        traverse(node);
    }
    return collection;
  }
  createElements(renderer, parent, commonRender) {
    const elements = [];
    const traverse = (node, parentEl) => {
      var _a;
      let el;
      if (this.DOMApis.isCommentNode(node)) {
      } else if (this.DOMApis.isText(node)) {
        el = this.DOMApis.createTextNode(node);
        parentEl && parentEl.appendChild(el);
      } else if (this.DOMApis.isNode(node)) {
        const { tagName, children } = node;
        if (typeof commonRender === "function") {
          el = (_a = commonRender(node, parent)) == null ? void 0 : _a.customElement;
        }
        if (!el) {
          if (renderer[tagName]) {
            el = renderer[tagName](node);
          } else {
            el = this.DOMApis.createElement(node);
          }
        }
        if (parentEl && el) {
          parentEl.appendChild(el);
        }
        if (el) {
          const { nodeType, _ignoreChildNodes } = el;
          if (!_ignoreChildNodes && nodeType !== 8 && nodeType !== 10) {
            for (const child of children) {
              traverse(child, el);
            }
          }
        }
      }
      return el;
    };
    for (const node of this.astTree) {
      if (this.DOMApis.isNode(node) && node.tagName !== "!doctype") {
        const el = traverse(node, parent);
        el && elements.push(el);
      }
    }
    return elements;
  }
  toResolveUrl(node, type, baseUrl) {
    var _a;
    const src = (_a = node.attributes) == null ? void 0 : _a.find(({ key }) => key === type);
    if (src && src.value && baseUrl) {
      src.value = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.transformUrl)(baseUrl, src.value);
    }
  }
  ignoreChildNodesCreation(node) {
    if (node) {
      node._ignoreChildNodes = true;
    }
    return node;
  }
  findAllMetaNodes() {
    return this.getNodesByTagName("meta").meta;
  }
  findAllLinkNodes() {
    return this.getNodesByTagName("link").link;
  }
  findAllJsNodes() {
    return this.getNodesByTagName("script").script;
  }
  findAttributeValue(node, type) {
    var _a, _b;
    return ((_b = (_a = node.attributes) == null ? void 0 : _a.find(({ key }) => key === type)) == null ? void 0 : _b.value) || void 0;
  }
  cloneNode(node) {
    return (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.deepMerge)(node, {});
  }
  clone() {
    const cloned = new this.constructor();
    cloned.url = this.url;
    cloned.astTree = this.astTree;
    cloned.pretreatmentStore = this.pretreatmentStore;
    cloned.DOMApis = new _garfish_utils__WEBPACK_IMPORTED_MODULE_1__.DOMApis(this.DOMApis.document);
    return cloned;
  }
};

// src/managers/javascript.ts
var JavaScriptManager = class {
  constructor(scriptCode, url) {
    this.depsStack = /* @__PURE__ */ new Set();
    this.mimeType = "";
    this.async = false;
    this.defer = false;
    this.url = url;
    this.scriptCode = scriptCode;
  }
  isModule() {
    return this.mimeType === "module";
  }
  isInlineScript() {
    return Boolean(!this.url);
  }
  setMimeType(mimeType) {
    this.mimeType = mimeType || "";
  }
  setAsyncAttribute(val) {
    this.async = Boolean(val);
  }
  setDefferAttribute(val) {
    this.defer = Boolean(val);
  }
  setDep(node) {
    this.depsStack.add(node);
  }
  isSameOrigin(node) {
    return this.depsStack.has(node);
  }
  clone() {
    const cloned = new this.constructor();
    cloned.url = this.url;
    cloned.async = this.async;
    cloned.mimeType = this.mimeType;
    cloned.scriptCode = this.scriptCode;
    cloned.depsStack = new Set(this.depsStack);
    return cloned;
  }
};

// src/utils.ts

function getRequest(customFetch) {
  return async function request(url, config) {
    let result = await customFetch.emit(url, config || {});
    if (!result || !(result instanceof Response)) {
      result = await fetch(url, config || {});
    }
    if (result.status >= 400) {
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.error)(`"${url}" load failed with status "${result.status}"`);
    }
    const code = await result.text();
    const type = result.headers.get("content-type") || "";
    const size = Number(result.headers.get("content-size"));
    const mimeType = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.parseContentType)(type || "");
    return {
      code,
      result,
      mimeType,
      type,
      size: Number.isNaN(size) ? null : size
    };
  };
}
function copyResult(result) {
  if (result.resourceManager) {
    result.resourceManager = result.resourceManager.clone();
  }
  return result;
}
function mergeConfig(loader, url) {
  const extra = loader.requestConfig;
  const config = typeof extra === "function" ? extra(url) : extra;
  return __spreadValues({ mode: "cors" }, config);
}

// src/appCache.ts
var cachedDataSet = /* @__PURE__ */ new WeakSet();
var MAX_SIZE = 1024 * 1024 * 50;
var DEFAULT_POLL = Symbol("__defaultBufferPoll__");
var FILE_TYPES = [
  "js" /* js */,
  "css" /* css */,
  "module" /* module */,
  "template" /* template */,
  DEFAULT_POLL
];
var AppCacheContainer = class {
  constructor(maxSize = MAX_SIZE) {
    this.totalSize = 0;
    this.recorder = {};
    this.maxSize = maxSize;
    FILE_TYPES.forEach((key) => {
      this.recorder[key] = 0;
      this[key] = /* @__PURE__ */ new Map();
    });
  }
  bufferPool(type) {
    return this[type];
  }
  has(url) {
    return FILE_TYPES.some((key) => this[key].has(url));
  }
  get(url) {
    for (const key of FILE_TYPES) {
      if (this[key].has(url)) {
        return this[key].get(url);
      }
    }
  }
  set(url, data, type) {
    const curSize = cachedDataSet.has(data) ? 0 : data.size;
    const totalSize = this.totalSize + curSize;
    if (totalSize < this.maxSize) {
      let bar = type;
      let bufferPool = this.bufferPool(type);
      if (!bufferPool) {
        bar = DEFAULT_POLL;
        bufferPool = this.bufferPool(DEFAULT_POLL);
      }
      bufferPool.set(url, data);
      this.totalSize = totalSize;
      this.recorder[bar] += curSize;
      return true;
    }
    return false;
  }
  clear(type) {
    if (typeof type === "string") {
      const cacheBox = this.bufferPool(type);
      if (cacheBox && cacheBox instanceof Map) {
        const size = this.recorder[type];
        this.totalSize -= size;
        this.recorder[type] = 0;
        cacheBox.clear();
      }
    } else {
      FILE_TYPES.forEach((key) => {
        this[key].clear();
        this.recorder[key] = 0;
      });
      this.totalSize = 0;
    }
  }
};

// src/index.ts
var CrossOriginCredentials = /* @__PURE__ */ ((CrossOriginCredentials2) => {
  CrossOriginCredentials2["anonymous"] = "same-origin";
  CrossOriginCredentials2["use-credentials"] = "include";
  return CrossOriginCredentials2;
})(CrossOriginCredentials || {});
var Loader = class {
  constructor(options) {
    this.personalId = _garfish_utils__WEBPACK_IMPORTED_MODULE_1__.__LOADER_FLAG__;
    this.StyleManager = StyleManager;
    this.ModuleManager = ModuleManager;
    this.TemplateManager = TemplateManager;
    this.JavaScriptManager = JavaScriptManager;
    this.hooks = new _garfish_hooks__WEBPACK_IMPORTED_MODULE_0__.PluginSystem({
      error: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_0__.SyncHook(),
      loaded: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_0__.SyncWaterfallHook("loaded"),
      clear: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_0__.SyncWaterfallHook("clear"),
      beforeLoad: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_0__.SyncWaterfallHook("beforeLoad"),
      fetch: new _garfish_hooks__WEBPACK_IMPORTED_MODULE_0__.AsyncHook("fetch")
    });
    this.options = options || {};
    this.loadingList = /* @__PURE__ */ Object.create(null);
    this.cacheStore = /* @__PURE__ */ Object.create(null);
  }
  setOptions(options) {
    this.options = __spreadValues(__spreadValues({}, this.options), options);
  }
  clear(scope, fileType) {
    const appCacheContainer = this.cacheStore[scope];
    if (appCacheContainer) {
      appCacheContainer.clear(fileType);
      this.hooks.lifecycle.clear.emit({ scope, fileType });
    }
  }
  clearAll(fileType) {
    for (const scope in this.cacheStore) {
      this.clear(scope, fileType);
    }
  }
  usePlugin(options) {
    this.hooks.usePlugin(options);
  }
  setLifeCycle(lifeCycle) {
    this.hooks.usePlugin(__spreadValues({
      name: "loader-lifecycle"
    }, lifeCycle));
  }
  loadModule(url) {
    return this.load({
      scope: "modules",
      url,
      isRemoteModule: true
    });
  }
  async load({
    scope,
    url,
    isRemoteModule = false,
    crossOrigin = "anonymous",
    defaultContentType = ""
  }) {
    const { options, loadingList, cacheStore } = this;
    const res = loadingList[url];
    if (res && Object.keys(res).includes(scope)) {
      return (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.macroTask)(res[scope], 4);
    }
    let appCacheContainer = cacheStore[scope];
    if (!appCacheContainer) {
      appCacheContainer = cacheStore[scope] = new AppCacheContainer(options.maxSize);
    }
    if (appCacheContainer.has(url)) {
      return (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.macroTask)(copyResult(appCacheContainer.get(url)), 4);
    } else {
      for (const key in cacheStore) {
        const container = cacheStore[key];
        if (container !== appCacheContainer) {
          if (container.has(url)) {
            const result = container.get(url);
            cachedDataSet.add(result);
            appCacheContainer.set(url, result, result.fileType);
            return (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.macroTask)(copyResult(result), 4);
          }
        }
      }
    }
    const requestConfig = mergeConfig(this, url);
    requestConfig.credentials = CrossOriginCredentials[crossOrigin];
    const resOpts = this.hooks.lifecycle.beforeLoad.emit({
      url,
      scope,
      requestConfig
    });
    const request = getRequest(this.hooks.lifecycle.fetch);
    const loadRes = request(resOpts.url, resOpts.requestConfig).then(({ code, size, result, type }) => {
      let managerCtor, fileType = "";
      if (isRemoteModule) {
        fileType = "module" /* module */;
        managerCtor = this.ModuleManager;
      } else if ((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.isHtmlType)({ type, src: result.url }) || (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.isHtmlType)({
        type: defaultContentType
      })) {
        fileType = "template" /* template */;
        managerCtor = this.TemplateManager;
      } else if ((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.isJsType)({ type: defaultContentType }) || (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.isJsType)({ type, src: result.url })) {
        fileType = "js" /* js */;
        managerCtor = this.JavaScriptManager;
      } else if ((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.isCssType)({ src: result.url, type }) || (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.isCssType)({
        type: defaultContentType
      })) {
        fileType = "css" /* css */;
        managerCtor = this.StyleManager;
      }
      const resourceManager = managerCtor ? new managerCtor(code, result.url) : null;
      const data = this.hooks.lifecycle.loaded.emit({
        result,
        value: {
          url,
          scope,
          resourceManager,
          fileType: fileType || "",
          size: size || code.length,
          code: resourceManager ? "" : code
        }
      });
      fileType && appCacheContainer.set(url, data.value, fileType);
      return copyResult(data.value);
    }).catch((e) => {
      (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) && (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_1__.error)(e);
      this.hooks.lifecycle.error.emit(e, { scope });
      throw e;
    }).finally(() => {
    });
    loadingList[url] ? loadingList[url][scope] = loadRes : loadingList[url] = { [scope]: loadRes };
    return loadRes;
  }
};



/***/ }),

/***/ "./node_modules/.pnpm/@garfish+router@1.16.2/node_modules/@garfish/router/dist/esm/index.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@garfish+router@1.16.2/node_modules/@garfish/router/dist/esm/index.js ***!
  \**************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   GarfishRouter: function() { return /* binding */ GarfishRouter; }
/* harmony export */ });
/* harmony import */ var _garfish_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @garfish/utils */ "./node_modules/.pnpm/@garfish+utils@1.16.2/node_modules/@garfish/utils/dist/esm/index.js");
var __defProp = Object.defineProperty;
var __defProps = Object.defineProperties;
var __getOwnPropDescs = Object.getOwnPropertyDescriptors;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a, b) => {
  for (var prop in b || (b = {}))
    if (__hasOwnProp.call(b, prop))
      __defNormalProp(a, prop, b[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b)) {
      if (__propIsEnum.call(b, prop))
        __defNormalProp(a, prop, b[prop]);
    }
  return a;
};
var __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));

// src/index.ts


// src/config.ts
var __GARFISH_ROUTER_UPDATE_FLAG__ = "__GARFISH_ROUTER_UPDATE_FLAG__";
var __GARFISH_ROUTER_FLAG__ = "__GARFISH_ROUTER_FLAG__";
var __GARFISH_BEFORE_ROUTER_EVENT__ = "garfish:before-routing-event";
var RouterConfig = {
  basename: "/",
  current: {
    fullPath: "/",
    path: "/",
    matched: [],
    query: {},
    state: {},
    href: ""
  },
  apps: [],
  beforeEach: (to, from, next) => next(),
  afterEach: (to, from, next) => next(),
  active: () => Promise.resolve(),
  deactive: () => Promise.resolve(),
  routerChange: () => {
  },
  autoRefreshApp: true,
  listening: true
};
function set(field, value) {
  RouterConfig[field] = value;
}
function setRouterConfig(options) {
  Object.assign(RouterConfig, options);
}

// src/utils/urlUt.ts
function parseQuery(query = "") {
  const res = {};
  if (query) {
    query.slice(1).split("&").map((item) => {
      const pairs = item.split("=");
      res[pairs[0]] = pairs;
    });
  }
  return res;
}
function getPath(basename = "/", pathname) {
  if (basename === "/" || basename === "") {
    return pathname || location.pathname;
  } else {
    return (pathname || location.pathname).replace(new RegExp(`^/?${basename}`), "");
  }
}
function getAppRootPath(appInfo) {
  const path = getPath(appInfo.basename, location.pathname);
  let appRootPath = appInfo.basename === "/" ? "" : appInfo.basename || "";
  if (typeof appInfo.activeWhen === "string") {
    appRootPath += appInfo.activeWhen;
  } else {
    appRootPath += path.split("").reduce((pre, next) => {
      if (typeof appInfo.activeWhen === "function" && !appInfo.activeWhen(pre))
        return pre + next;
      return pre;
    }, "");
  }
  return appRootPath;
}

// src/utils/index.ts
async function asyncForEach(arr, callback) {
  const length = arr.length;
  let k = 0;
  while (k < length) {
    const kValue = arr[k];
    await callback(kValue, k, arr);
    k++;
  }
}
function toMiddleWare(to, from, cb) {
  return new Promise((resolve, reject) => {
    try {
      cb(to, from, resolve);
    } catch (err) {
      reject(err);
    }
  });
}
function createEvent(type) {
  let e;
  if (navigator.userAgent.indexOf("MSIE") !== -1 || navigator.appVersion.indexOf("Trident/") > 0) {
    e = document.createEvent("UIEvents");
    e.initUIEvent(type.toLowerCase(), true, false, window, 0);
  } else {
    e = new Event(type.toLowerCase());
  }
  return e;
}

// src/utils/customEvent.ts
var NativeCustomEvent = typeof __webpack_require__.g !== "undefined" ? __webpack_require__.g == null ? void 0 : __webpack_require__.g.CustomEvent : null;
function useNative() {
  try {
    const p = new NativeCustomEvent("cat", { detail: { foo: "bar" } });
    return p.type === "cat" && p.detail.foo === "bar";
  } catch (e) {
  }
  return false;
}
var CustomEvent;
if (NativeCustomEvent && useNative()) {
  CustomEvent = NativeCustomEvent;
} else if (typeof document !== "undefined" && typeof document.createEvent === "function") {
  CustomEvent = function(type, params) {
    params = params || { bubbles: false, cancelable: false, detail: null };
    const evt = document.createEvent("CustomEvent");
    evt.initCustomEvent(type, params.bubbles || false, params.cancelable || false, params.detail || null);
    return evt;
  };
} else {
  CustomEvent = function(type, params) {
    const e = document.createEventObject();
    e.type = type;
    if (params) {
      e.bubbles = Boolean(params.bubbles);
      e.cancelable = Boolean(params.cancelable);
      e.detail = params.detail;
    } else {
      e.bubbles = false;
      e.cancelable = false;
      e.detail = void 0;
    }
    return e;
  };
}
var customEvent_default = CustomEvent;

// src/utils/navEvent.ts

function createPopStateEvent(state, originalMethodName) {
  let evt;
  try {
    evt = new PopStateEvent("popstate", { state });
  } catch (err) {
    evt = document.createEvent("PopStateEvent");
    evt.initPopStateEvent("popstate", false, false, state);
  }
  evt.garfish = true;
  evt.garfishTrigger = originalMethodName;
  return evt;
}
var callCapturedEventListeners = (type) => {
  const eventArguments = createPopStateEvent(window.history.state, type);
  window.dispatchEvent(eventArguments);
};
var handlerParams = function(path, query, basename) {
  if (!path || typeof path !== "string")
    return "";
  let url = path;
  if (url[0] !== "/")
    url = "/" + url;
  if (Object.prototype.toString.call(query) === "[object Object]") {
    const qs = Object.keys(query).map((key) => `${key}=${query[key]}`).join("&");
    url += qs ? "?" + qs : "";
  }
  if (basename !== "/")
    url = basename + url;
  if (url[0] !== "/")
    url = "/" + url;
  return url;
};
var push = ({
  path,
  query,
  basename
}) => {
  if (!basename)
    basename = RouterConfig.basename || "/";
  let url = null;
  if ((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.validURL)(path)) {
    url = /(^https?:)|(^\/\/)/.test(path) ? path : `//${path}`;
  } else {
    url = handlerParams(path, query, basename);
  }
  history.pushState(__spreadValues({ [__GARFISH_ROUTER_UPDATE_FLAG__]: true }, history.state), "", url);
};
var replace = ({
  path,
  query,
  basename
}) => {
  if (!basename)
    basename = RouterConfig.basename || "/";
  let url = null;
  if ((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.validURL)(path)) {
    url = /^(https?:)(\/\/)/.test(path) ? path : `//${path}`;
  } else {
    url = handlerParams(path, query, basename);
  }
  history.replaceState(__spreadValues({ [__GARFISH_ROUTER_UPDATE_FLAG__]: true }, history.state), "", url);
};

// src/linkTo.ts
var hasActive = (activeWhen, path) => {
  if (typeof activeWhen === "string") {
    if (activeWhen[0] !== "/")
      activeWhen = `/${activeWhen}`;
    if (activeWhen === "/" && path === activeWhen)
      return true;
    const activeWhenArr = activeWhen.split("/");
    const pathArr = path.split("/");
    let flag = true;
    activeWhenArr.forEach((pathItem, index) => {
      if (pathItem && pathItem !== pathArr[index]) {
        flag = false;
      }
    });
    return flag;
  } else {
    return activeWhen(path);
  }
};
var linkTo = async ({
  toRouterInfo,
  fromRouterInfo,
  eventType
}) => {
  const {
    current,
    apps,
    deactive,
    active,
    notMatch,
    beforeEach: beforeEach2,
    afterEach: afterEach2,
    autoRefreshApp
  } = RouterConfig;
  const deactiveApps = current.matched.filter((appInfo) => !hasActive(appInfo.activeWhen, getPath(appInfo.basename, location.pathname)));
  const activeApps = apps.filter((appInfo) => {
    return hasActive(appInfo.activeWhen, getPath(appInfo.basename, location.pathname));
  });
  const needToActive = activeApps.filter(({ name }) => {
    return !current.matched.some(({ name: cName }) => name === cName);
  });
  const to = __spreadProps(__spreadValues({}, toRouterInfo), {
    matched: needToActive
  });
  const from = __spreadProps(__spreadValues({}, fromRouterInfo), {
    matched: deactiveApps
  });
  await toMiddleWare(to, from, beforeEach2);
  if (current.matched.length > 0) {
    await asyncForEach(deactiveApps, async (appInfo) => await deactive(appInfo, getPath(appInfo.basename, location.pathname)));
  }
  setRouterConfig({
    current: {
      path: getPath(RouterConfig.basename),
      fullPath: location.pathname,
      href: location.href,
      matched: activeApps,
      state: history.state,
      query: parseQuery(location.search)
    }
  });
  const curState = window.history.state || {};
  if (eventType !== "popstate" && (curState[__GARFISH_ROUTER_UPDATE_FLAG__] || autoRefreshApp)) {
    callCapturedEventListeners(eventType);
  }
  await asyncForEach(needToActive, async (appInfo) => {
    const appRootPath = getAppRootPath(appInfo);
    await active(appInfo, appRootPath);
  });
  if (activeApps.length === 0 && notMatch)
    notMatch(location.pathname);
  await toMiddleWare(to, from, afterEach2);
};

// src/agentRouter.ts
var normalAgent = () => {
  const addRouterListener = function() {
    window.addEventListener(__GARFISH_BEFORE_ROUTER_EVENT__, function(env) {
      RouterConfig.routerChange && RouterConfig.routerChange(location.pathname);
      linkTo(env.detail);
    });
  };
  if (!window[__GARFISH_ROUTER_FLAG__]) {
    const rewrite = function(type) {
      const hapi = history[type];
      return function() {
        const urlBefore = window.location.pathname + window.location.hash;
        const stateBefore = history == null ? void 0 : history.state;
        const res = hapi.apply(this, arguments);
        const urlAfter = window.location.pathname + window.location.hash;
        const stateAfter = history == null ? void 0 : history.state;
        const e = createEvent(type);
        e.arguments = arguments;
        if (urlBefore !== urlAfter || JSON.stringify(stateBefore) !== JSON.stringify(stateAfter)) {
          window.dispatchEvent(new customEvent_default(__GARFISH_BEFORE_ROUTER_EVENT__, {
            detail: {
              toRouterInfo: {
                fullPath: urlAfter,
                href: location.href,
                query: parseQuery(location.search),
                path: getPath(RouterConfig.basename, urlAfter),
                state: stateAfter
              },
              fromRouterInfo: {
                fullPath: urlBefore,
                query: RouterConfig.current.query,
                href: RouterConfig.current.href,
                path: getPath(RouterConfig.basename, urlBefore),
                state: stateBefore
              },
              eventType: type
            }
          }));
        }
        return res;
      };
    };
    history.pushState = rewrite("pushState");
    history.replaceState = rewrite("replaceState");
    window.addEventListener("popstate", function(event) {
      if (event && typeof event === "object" && event.garfish)
        return;
      if (history.state && typeof history.state === "object")
        delete history.state[__GARFISH_ROUTER_UPDATE_FLAG__];
      window.dispatchEvent(new customEvent_default(__GARFISH_BEFORE_ROUTER_EVENT__, {
        detail: {
          toRouterInfo: {
            fullPath: location.pathname,
            href: location.href,
            query: parseQuery(location.search),
            path: getPath(RouterConfig.basename)
          },
          fromRouterInfo: {
            fullPath: RouterConfig.current.fullPath,
            path: getPath(RouterConfig.basename, RouterConfig.current.path),
            href: RouterConfig.current.href,
            query: RouterConfig.current.query
          },
          eventType: "popstate"
        }
      }));
    }, false);
    window[__GARFISH_ROUTER_FLAG__] = true;
  }
  addRouterListener();
};
var initRedirect = () => {
  linkTo({
    toRouterInfo: {
      fullPath: location.pathname,
      href: location.href,
      path: getPath(RouterConfig.basename),
      query: parseQuery(location.search),
      state: history.state
    },
    fromRouterInfo: {
      fullPath: "/",
      href: "",
      path: "/",
      query: {},
      state: {}
    },
    eventType: "pushState"
  });
};
var listen = () => {
  normalAgent();
  initRedirect();
};

// src/context.ts
var beforeEach = (hook) => {
  set("beforeEach", hook);
};
var afterEach = (hook) => {
  set("afterEach", hook);
};
var routerChange = (hook) => {
  set("routerChange", hook);
};
var registerRouter = (Apps) => {
  const unregisterApps = Apps.filter((app) => !RouterConfig.apps.some((item) => app.name === item.name));
  set("apps", RouterConfig.apps.concat(unregisterApps));
};
var listenRouterAndReDirect = ({
  apps,
  basename = "/",
  autoRefreshApp,
  active,
  deactive,
  notMatch,
  listening = true
}) => {
  registerRouter(apps);
  setRouterConfig({
    basename,
    autoRefreshApp,
    active,
    deactive,
    notMatch,
    listening
  });
  listen();
};
var Router = {
  push,
  replace,
  beforeEach,
  afterEach,
  registerRouter,
  routerChange,
  listenRouterAndReDirect,
  setRouterConfig,
  routerConfig: RouterConfig
};
var context_default = Router;

// src/index.ts
function GarfishRouter(_args) {
  return function(Garfish) {
    Garfish.apps = {};
    Garfish.router = context_default;
    return {
      name: "router",
      version: "1.16.2",
      bootstrap(options) {
        let activeApp = null;
        const unmounts = {};
        const { basename } = options;
        const { autoRefreshApp = true, onNotMatchRouter = () => null } = Garfish.options;
        async function active(appInfo, rootPath = "/") {
          (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.routerLog)(`${appInfo.name} active`, {
            appInfo,
            rootPath,
            listening: RouterConfig.listening
          });
          if (!RouterConfig.listening)
            return;
          const { name, active: active2, cache = true } = appInfo;
          if (active2)
            return active2(appInfo, rootPath);
          appInfo.rootPath = rootPath;
          const currentApp = activeApp = (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.createKey)();
          const app = await Garfish.loadApp(appInfo.name, {
            cache,
            basename: rootPath,
            entry: appInfo.entry,
            domGetter: appInfo.domGetter
          });
          if (app) {
            app.appInfo.basename = rootPath;
            const call = async (app2, isRender) => {
              if (!app2)
                return;
              const isDes = cache && app2.mounted;
              if (isRender) {
                return await app2[isDes ? "show" : "mount"]();
              } else {
                return app2[isDes ? "hide" : "unmount"]();
              }
            };
            Garfish.apps[name] = app;
            unmounts[name] = () => {
              if (app.mounting) {
                delete Garfish.cacheApps[name];
              }
              call(app, false);
            };
            if (currentApp === activeApp) {
              await call(app, true);
            }
          }
        }
        async function deactive(appInfo, rootPath) {
          (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.routerLog)(`${appInfo.name} deactive`, {
            appInfo,
            rootPath
          });
          activeApp = null;
          const { name, deactive: deactive2 } = appInfo;
          if (deactive2)
            return deactive2(appInfo, rootPath);
          const unmount = unmounts[name];
          unmount && unmount();
          delete Garfish.apps[name];
          const needToDeleteApps = context_default.routerConfig.apps.filter((app) => {
            if (appInfo.rootPath === app.basename)
              return true;
          });
          if (needToDeleteApps.length > 0) {
            needToDeleteApps.forEach((app) => {
              delete Garfish.appInfos[app.name];
              delete Garfish.cacheApps[app.name];
            });
            context_default.setRouterConfig({
              apps: context_default.routerConfig.apps.filter((app) => {
                return !needToDeleteApps.some((needDelete) => app.name === needDelete.name);
              })
            });
          }
        }
        const apps = Object.values(Garfish.appInfos);
        const appList = apps.filter((app) => {
          if (!app.basename)
            app.basename = basename;
          return !!app.activeWhen;
        });
        const listenOptions = {
          basename,
          active,
          deactive,
          autoRefreshApp,
          notMatch: onNotMatchRouter,
          apps: appList,
          listening: true
        };
        (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.routerLog)("listenRouterAndReDirect", listenOptions);
        listenRouterAndReDirect(listenOptions);
      },
      registerApp(appInfos) {
        const appList = Object.values(appInfos);
        context_default.registerRouter(appList.filter((app) => !!app.activeWhen));
        if (!Garfish.running)
          return;
        (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_0__.routerLog)("registerApp initRedirect", appInfos);
        initRedirect();
      }
    };
  };
}



/***/ }),

/***/ "./node_modules/.pnpm/@garfish+utils@1.16.2/node_modules/@garfish/utils/dist/esm/index.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@garfish+utils@1.16.2/node_modules/@garfish/utils/dist/esm/index.js ***!
  \************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DOMApis: function() { return /* binding */ DOMApis; },
/* harmony export */   Lock: function() { return /* binding */ Lock; },
/* harmony export */   Queue: function() { return /* binding */ Queue; },
/* harmony export */   __GARFISH_FLAG__: function() { return /* binding */ __GARFISH_FLAG__; },
/* harmony export */   __LOADER_FLAG__: function() { return /* binding */ __LOADER_FLAG__; },
/* harmony export */   __MockBody__: function() { return /* binding */ __MockBody__; },
/* harmony export */   __MockHead__: function() { return /* binding */ __MockHead__; },
/* harmony export */   __MockHtml__: function() { return /* binding */ __MockHtml__; },
/* harmony export */   __REMOVE_NODE__: function() { return /* binding */ __REMOVE_NODE__; },
/* harmony export */   _extends: function() { return /* binding */ _extends; },
/* harmony export */   appContainerId: function() { return /* binding */ appContainerId; },
/* harmony export */   assert: function() { return /* binding */ assert; },
/* harmony export */   callTestCallback: function() { return /* binding */ callTestCallback; },
/* harmony export */   changeTagNameToLowerCase: function() { return /* binding */ changeTagNameToLowerCase; },
/* harmony export */   computeErrorUrl: function() { return /* binding */ computeErrorUrl; },
/* harmony export */   computeStackTraceFromStackProp: function() { return /* binding */ computeStackTraceFromStackProp; },
/* harmony export */   coreLog: function() { return /* binding */ coreLog; },
/* harmony export */   createAppContainer: function() { return /* binding */ createAppContainer; },
/* harmony export */   createKey: function() { return /* binding */ createKey; },
/* harmony export */   createSourcemap: function() { return /* binding */ createSourcemap; },
/* harmony export */   deepMerge: function() { return /* binding */ deepMerge; },
/* harmony export */   def: function() { return /* binding */ def; },
/* harmony export */   error: function() { return /* binding */ error; },
/* harmony export */   evalWithEnv: function() { return /* binding */ evalWithEnv; },
/* harmony export */   filterAndWrapEventListener: function() { return /* binding */ filterAndWrapEventListener; },
/* harmony export */   filterUndefinedVal: function() { return /* binding */ filterUndefinedVal; },
/* harmony export */   findTarget: function() { return /* binding */ findTarget; },
/* harmony export */   getGarfishDebugInstanceName: function() { return /* binding */ getGarfishDebugInstanceName; },
/* harmony export */   getParameterByName: function() { return /* binding */ getParameterByName; },
/* harmony export */   getRenderNode: function() { return /* binding */ getRenderNode; },
/* harmony export */   getSourceURL: function() { return /* binding */ getSourceURL; },
/* harmony export */   getType: function() { return /* binding */ getType; },
/* harmony export */   hasOwn: function() { return /* binding */ hasOwn; },
/* harmony export */   haveSourcemap: function() { return /* binding */ haveSourcemap; },
/* harmony export */   hookObjectProperty: function() { return /* binding */ hookObjectProperty; },
/* harmony export */   idleCallback: function() { return /* binding */ idleCallback; },
/* harmony export */   inBrowser: function() { return /* binding */ inBrowser; },
/* harmony export */   internFunc: function() { return /* binding */ internFunc; },
/* harmony export */   isAbsolute: function() { return /* binding */ isAbsolute; },
/* harmony export */   isCss: function() { return /* binding */ isCss; },
/* harmony export */   isCssType: function() { return /* binding */ isCssType; },
/* harmony export */   isGarfishConfigType: function() { return /* binding */ isGarfishConfigType; },
/* harmony export */   isHtml: function() { return /* binding */ isHtml; },
/* harmony export */   isHtmlType: function() { return /* binding */ isHtmlType; },
/* harmony export */   isJs: function() { return /* binding */ isJs; },
/* harmony export */   isJsType: function() { return /* binding */ isJsType; },
/* harmony export */   isJsonp: function() { return /* binding */ isJsonp; },
/* harmony export */   isObject: function() { return /* binding */ isObject; },
/* harmony export */   isPlainObject: function() { return /* binding */ isPlainObject; },
/* harmony export */   isPrimitive: function() { return /* binding */ isPrimitive; },
/* harmony export */   isPromise: function() { return /* binding */ isPromise; },
/* harmony export */   macroTask: function() { return /* binding */ macroTask; },
/* harmony export */   makeMap: function() { return /* binding */ makeMap; },
/* harmony export */   makeMapObject: function() { return /* binding */ makeMapObject; },
/* harmony export */   mapObject: function() { return /* binding */ mapObject; },
/* harmony export */   nextTick: function() { return /* binding */ nextTick; },
/* harmony export */   noop: function() { return /* binding */ noop; },
/* harmony export */   objectToString: function() { return /* binding */ objectToString; },
/* harmony export */   parseContentType: function() { return /* binding */ parseContentType; },
/* harmony export */   remove: function() { return /* binding */ remove; },
/* harmony export */   routerLog: function() { return /* binding */ routerLog; },
/* harmony export */   safari13Deal: function() { return /* binding */ safari13Deal; },
/* harmony export */   safeWrapper: function() { return /* binding */ safeWrapper; },
/* harmony export */   setDocCurrentScript: function() { return /* binding */ setDocCurrentScript; },
/* harmony export */   sourceListTags: function() { return /* binding */ sourceListTags; },
/* harmony export */   sourceNode: function() { return /* binding */ sourceNode; },
/* harmony export */   supportWasm: function() { return /* binding */ supportWasm; },
/* harmony export */   templateParse: function() { return /* binding */ templateParse; },
/* harmony export */   toBase64: function() { return /* binding */ toBase64; },
/* harmony export */   toBoolean: function() { return /* binding */ toBoolean; },
/* harmony export */   toWsProtocol: function() { return /* binding */ toWsProtocol; },
/* harmony export */   transformUrl: function() { return /* binding */ transformUrl; },
/* harmony export */   unique: function() { return /* binding */ unique; },
/* harmony export */   validURL: function() { return /* binding */ validURL; },
/* harmony export */   warn: function() { return /* binding */ warn; }
/* harmony export */ });
/* harmony import */ var debug__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! debug */ "./node_modules/.pnpm/debug@4.3.4_supports-color@5.5.0/node_modules/debug/src/browser.js");
/* harmony import */ var debug__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(debug__WEBPACK_IMPORTED_MODULE_0__);
/* provided dependency */ var process = __webpack_require__(/*! process/browser */ "./node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");
// src/utils.ts
var noop = () => {
};
var objectToString = Object.prototype.toString;
var supportWasm = typeof WebAssembly === "object";
var idleCallback = window.requestIdleCallback || window.requestAnimationFrame;
function createKey() {
  return Math.random().toString(36).substr(2, 8);
}
function isObject(val) {
  return val && typeof val === "object";
}
function isPlainObject(val) {
  return objectToString.call(val) === "[object Object]";
}
function getType(val) {
  return objectToString.call(val).slice(8, -1).toLowerCase();
}
function isPromise(obj) {
  return isObject(obj) && typeof obj.then === "function";
}
var hasOwnProperty = Object.prototype.hasOwnProperty;
function hasOwn(obj, key) {
  return hasOwnProperty.call(obj, key);
}
function def(obj, key, value) {
  Object.defineProperty(obj, key, {
    get: () => value,
    set: (val) => {
      if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
        if (val !== value) {
          error(`Try to modify a read-only property ${key}`);
        }
      }
    },
    configurable: (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) ? true : false
  });
}
function makeMap(list) {
  const map = /* @__PURE__ */ Object.create(null);
  for (let i = 0; i < list.length; i++) {
    map[list[i]] = true;
  }
  return (val) => !!map[val];
}
function makeMapObject(list) {
  const map = /* @__PURE__ */ Object.create(null);
  for (let i = 0; i < list.length; i++) {
    map[list[i]] = true;
  }
  return map;
}
function inBrowser() {
  return typeof window !== "undefined";
}
var warnPrefix = "[Garfish warning]";
var processError = (error2, fn) => {
  try {
    if (typeof error2 === "string") {
      error2 = `${warnPrefix}: ${error2}

`;
      fn(error2, true);
    } else if (error2 instanceof Error) {
      if (!error2.message.startsWith(warnPrefix)) {
        error2.message = `${warnPrefix}: ${error2.message}`;
      }
      fn(error2, false);
    }
  } catch (e) {
    fn(error2, typeof error2 === "string");
  }
};
function warn(msg) {
  processError(msg, (e, isString) => {
    const warnMsg = isString ? e : e.message;
    if (false) {}
    console.warn(warnMsg);
  });
}
function error(error2) {
  processError(error2, (e, isString) => {
    if (isString) {
      throw new Error(e);
    } else {
      throw e;
    }
  });
}
function validURL(str) {
  const pattern = new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$", "i");
  return !!pattern.test(str);
}
function internFunc(internalizeString) {
  const temporaryOb = {};
  temporaryOb[internalizeString] = true;
  return Object.keys(temporaryOb)[0];
}
function evalWithEnv(code, params, context, useStrict = false) {
  const keys = Object.keys(params);
  const nativeWindow = (0, eval)("window;");
  const randomValKey = "__garfish__exec_temporary__";
  const values = keys.map((k) => `window.${randomValKey}.${k}`);
  const contextKey = "__garfish_exec_temporary_context__";
  try {
    nativeWindow[randomValKey] = params;
    nativeWindow[contextKey] = context;
    const evalInfo = [
      `;(function(${keys.join(",")}){${useStrict ? '"use strict";' : ""}`,
      `
}).call(window.${contextKey},${values.join(",")});`
    ];
    const internalizeString = internFunc(evalInfo[0] + code + evalInfo[1]);
    (0, eval)(internalizeString);
  } catch (e) {
    throw e;
  } finally {
    delete nativeWindow[randomValKey];
    delete nativeWindow[contextKey];
  }
}
function safeWrapper(callback, disableWarn) {
  try {
    callback();
  } catch (e) {
    !disableWarn && (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) && warn(e);
  }
}
function nextTick(cb) {
  Promise.resolve().then(cb);
}
function assert(condition, msg) {
  if (!condition) {
    error(msg || "unknow reason");
  }
}
function toBoolean(val) {
  if (val === "")
    return true;
  if (val === "false")
    return false;
  return Boolean(val);
}
function remove(list, el) {
  if (Array.isArray(list)) {
    const i = list.indexOf(el);
    if (i > -1) {
      list.splice(i, 1);
      return true;
    }
    return false;
  } else {
    if (list.has(el)) {
      list.delete(el);
      return true;
    }
    return false;
  }
}
function callTestCallback(obj, ...args) {
  if (false) {}
}
function unique(list) {
  const res = [];
  for (let i = 0, len = list.length; i < len; i++) {
    for (let j = i + 1; j < len; j++) {
      if (list[i] === list[j]) {
        j = ++i;
      }
    }
    res.push(list[i]);
  }
  return  false ? 0 : res;
}
function isPrimitive(val) {
  return val === null || typeof val === "string" || typeof val === "number" || typeof val === "bigint" || typeof val === "symbol" || typeof val === "boolean" || typeof val === "undefined" || objectToString.call(val) === "[object RegExp]";
}
function filterUndefinedVal(ob) {
  return Object.keys(ob).reduce((res, key) => {
    if (res[key] === void 0) {
      delete res[key];
    }
    return res;
  }, ob);
}
function deepMerge(o, n, dp, ignores) {
  const leftRecord = /* @__PURE__ */ new WeakMap();
  const rightRecord = /* @__PURE__ */ new WeakMap();
  const valueRecord = /* @__PURE__ */ new WeakMap();
  const ignoresMap = makeMap(ignores || []);
  const isArray = Array.isArray;
  const isAllRefs = (a, b) => {
    if (leftRecord.has(a) || rightRecord.has(a)) {
      return leftRecord.has(b) || rightRecord.has(b);
    }
  };
  const clone = (v) => {
    if (isPrimitive(v) || typeof v === "function") {
      return v;
    } else if (valueRecord.has(v)) {
      return valueRecord.get(v);
    } else if (leftRecord.has(v)) {
      return leftRecord.get(v);
    } else if (rightRecord.has(v)) {
      return rightRecord.get(v);
    } else if (isArray(v)) {
      if (dp)
        v = unique(v);
      const arr = [];
      valueRecord.set(v, arr);
      for (let i = 0, len = v.length; i < len; i++) {
        arr[i] = clone(v[i]);
      }
      return arr;
    } else if (typeof v === "object") {
      const obj = {};
      valueRecord.set(v, obj);
      const keys = Reflect.ownKeys(v);
      keys.forEach((key) => obj[key] = clone(v[key]));
      return obj;
    }
  };
  const setValue = (r, k, key) => {
    if (r.has(k)) {
      return r.get(k);
    } else {
      if (ignoresMap[key]) {
        return k;
      }
      const val = clone(k);
      if (!isPrimitive(val) && typeof val !== "function") {
        r.set(k, val);
      }
      return val;
    }
  };
  const mergeObject = (l, r) => {
    const res = {};
    const leftKeys = Reflect.ownKeys(l);
    const rightKeys = Reflect.ownKeys(r);
    leftRecord.set(l, res);
    rightRecord.set(r, res);
    leftKeys.forEach((key) => {
      const lv = l[key];
      const rv = r[key];
      if (hasOwn(r, key)) {
        if (isArray(lv) && isArray(rv)) {
          const item = clone([...lv, ...rv]);
          res[key] = dp ? unique(item) : item;
        } else if (isPlainObject(lv) && isPlainObject(rv)) {
          res[key] = isAllRefs(lv, rv) ? leftRecord.get(lv) : mergeObject(lv, rv);
        } else {
          res[key] = setValue(rightRecord, rv, key);
        }
      } else {
        res[key] = setValue(leftRecord, lv, key);
      }
    });
    rightKeys.forEach((key) => {
      if (hasOwn(res, key))
        return;
      res[key] = setValue(rightRecord, r[key], key);
    });
    return res;
  };
  return mergeObject(o, n);
}
function isAbsolute(url) {
  if (!/^[a-zA-Z]:\\/.test(url)) {
    if (/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(url)) {
      return true;
    }
  }
  return false;
}
function transformUrl(resolvePath, curPath) {
  const baseUrl = new URL(resolvePath, location.href);
  const realPath = new URL(curPath, baseUrl.href);
  return realPath.href;
}
function toWsProtocol(url) {
  const data = new URL(url);
  if (data.protocol.startsWith("http")) {
    data.protocol = data.protocol === "https:" ? "wss:" : "ws:";
    return data.toString();
  }
  return url;
}
function findTarget(el, selectors) {
  for (const s of selectors) {
    const target = el.querySelector(s);
    if (target)
      return target;
  }
  return el;
}
function setDocCurrentScript(target, code, define, url, async, defer, originScript) {
  if (!target)
    return noop;
  const el = document.createElement("script");
  if (!url && code) {
    el.textContent = code;
  }
  if (url) {
    el.src = url;
  }
  originScript && originScript.getAttributeNames().forEach((attribute) => {
    el.setAttribute(attribute, originScript.getAttribute(attribute) || "");
  });
  if (async) {
    el.setAttribute("async", "true");
  }
  if (defer) {
    el.setAttribute("defer", "true");
  }
  const set = (val) => {
    try {
      if (define) {
        Object.defineProperty(target, "currentScript", {
          value: val,
          writable: true,
          configurable: true
        });
      } else {
        target.currentScript = val;
      }
    } catch (e) {
      if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
        warn(e);
      }
    }
  };
  set(el);
  return () => safeWrapper(() => delete target.currentScript, true);
}
function _extends(d, b) {
  Object.setPrototypeOf(d, b);
  function fNOP() {
    this.constructor = d;
  }
  if (b === null) {
    d.prototype = Object.create(b);
  } else {
    if (b.prototype)
      fNOP.prototype = b.prototype;
    d.prototype = new fNOP();
  }
}
function mapObject(obj, fn) {
  const destObject = {};
  for (const key in obj) {
    if (obj.hasOwnProperty(key)) {
      destObject[key] = fn(key, obj[key]);
    }
  }
  return destObject;
}
function toBase64(input, mimeType) {
  return new Promise((resolve) => {
    const reader = new FileReader();
    reader.readAsDataURL(new Blob([input], { type: mimeType }));
    reader.onload = () => resolve(reader.result);
  });
}
var hookObjectProperty = (obj, key, hookFunc) => {
  return (...params) => {
    if (!obj) {
      return noop;
    }
    const origin = obj[key];
    const hookedUnsafe = hookFunc(origin, ...params);
    let hooked = hookedUnsafe;
    if (typeof hooked === "function") {
      hooked = function(...args) {
        try {
          return hookedUnsafe.apply(this, args);
        } catch (e) {
          return typeof origin === "function" && origin.apply(this, args);
        }
      };
    }
    obj[key] = hooked;
    return (strict) => {
      if (!strict || hooked === obj[key]) {
        obj[key] = origin;
      }
    };
  };
};
function getParameterByName(name, url = window.location.href) {
  name = name.replace(/[\[\]]/g, "\\$&");
  const regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"), results = regex.exec(url);
  if (!results)
    return null;
  if (!results[2])
    return "";
  return decodeURIComponent(results[2].replace(/\+/g, " "));
}
function getGarfishDebugInstanceName() {
  const DEBUG_GARFISH_TAG = "__GARFISH_INSTANCE_DEBUG__";
  return localStorage.getItem(DEBUG_GARFISH_TAG) || getParameterByName(DEBUG_GARFISH_TAG);
}
function safari13Deal() {
  let fromSetFlag = false;
  return {
    triggerSet() {
      fromSetFlag = true;
    },
    handleDescriptor(descriptor) {
      if (fromSetFlag === true) {
        fromSetFlag = false;
        if ((descriptor == null ? void 0 : descriptor.writable) === false)
          descriptor.writable = true;
        if ((descriptor == null ? void 0 : descriptor.enumerable) === false)
          descriptor.enumerable = true;
        if ((descriptor == null ? void 0 : descriptor.configurable) === false)
          descriptor.configurable = true;
      }
    }
  };
}
var SOURCEMAP_REG = /[@#] sourceMappingURL=/g;
function haveSourcemap(code) {
  return SOURCEMAP_REG.test(code);
}
async function createSourcemap(code, filename) {
  const content = await toBase64(JSON.stringify({
    version: 3,
    sources: [filename],
    sourcesContent: [code],
    mappings: ";" + code.split("\n").map(() => "AACA").join(";")
  }));
  return `//@ sourceMappingURL=${content}`;
}
function getSourceURL(url) {
  if (url instanceof URL)
    return url.href;
  if (url instanceof Request)
    return url.url;
  return url.startsWith("/") ? `${location.origin}${url}` : url;
}
function macroTask(value, time = 0) {
  return new Promise((resolve) => {
    setTimeout(() => resolve(value), time);
  });
}

// src/queue.ts
var Queue = class {
  constructor() {
    this.fx = [];
    this.init = true;
    this.lock = false;
    this.finishDefers = /* @__PURE__ */ new Set();
  }
  next() {
    if (!this.lock) {
      this.lock = true;
      if (this.fx.length === 0) {
        this.init = true;
        this.finishDefers.forEach((d) => d.resolve());
        this.finishDefers.clear();
      } else {
        const fn = this.fx.shift();
        if (fn) {
          fn(() => {
            this.lock = false;
            this.next();
          });
        }
      }
    }
  }
  add(fn) {
    this.fx.push(fn);
    if (this.init) {
      this.lock = false;
      this.init = false;
      this.next();
    }
  }
  awaitCompletion() {
    if (this.init)
      return Promise.resolve();
    const defer = {};
    this.finishDefers.add(defer);
    return new Promise((resolve, reject) => {
      defer.resolve = resolve;
      defer.reject = reject;
    });
  }
};

// src/sentry.ts
var chrome = /^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i;
var gecko = /^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension|capacitor).*?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i;
var winjs = /^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i;
var geckoEval = /(\S+) line (\d+)(?: > eval line \d+)* > eval/i;
var chromeEval = /\((\S*)(?::(\d+))(?::(\d+))\)/;
var UNKNOWN_FUNCTION = "?";
function extractMessage(ex) {
  const message = ex && ex.message;
  if (!message) {
    return "No error message";
  }
  if (message.error && typeof message.error.message === "string") {
    return message.error.message;
  }
  return message;
}
function computeStackTraceFromStackProp(ex) {
  if (!ex || !ex.stack) {
    return null;
  }
  const stack = [];
  const lines = ex.stack.split("\n");
  let isEval;
  let submatch;
  let parts;
  let element;
  for (let i = 0; i < lines.length; ++i) {
    if (parts = chrome.exec(lines[i])) {
      const isNative = parts[2] && parts[2].indexOf("native") === 0;
      isEval = parts[2] && parts[2].indexOf("eval") === 0;
      if (isEval && (submatch = chromeEval.exec(parts[2]))) {
        parts[2] = submatch[1];
      }
      let url = parts[2] && parts[2].indexOf("address at ") === 0 ? parts[2].substr("address at ".length) : parts[2];
      let func = parts[1] || UNKNOWN_FUNCTION;
      const isSafariExtension = func.indexOf("safari-extension") !== -1;
      const isSafariWebExtension = func.indexOf("safari-web-extension") !== -1;
      if (isSafariExtension || isSafariWebExtension) {
        func = func.indexOf("@") !== -1 ? func.split("@")[0] : UNKNOWN_FUNCTION;
        url = isSafariExtension ? `safari-extension:${url}` : `safari-web-extension:${url}`;
      }
      element = {
        url,
        func,
        args: isNative ? [parts[2]] : [],
        line: parts[3] ? +parts[3] : null,
        column: parts[4] ? +parts[4] : null
      };
    } else if (parts = winjs.exec(lines[i])) {
      element = {
        url: parts[2],
        func: parts[1] || UNKNOWN_FUNCTION,
        args: [],
        line: +parts[3],
        column: parts[4] ? +parts[4] : null
      };
    } else if (parts = gecko.exec(lines[i])) {
      isEval = parts[3] && parts[3].indexOf(" > eval") > -1;
      if (isEval && (submatch = geckoEval.exec(parts[3]))) {
        parts[1] = parts[1] || "eval";
        parts[3] = submatch[1];
        parts[4] = submatch[2];
        parts[5] = "";
      } else if (i === 0 && !parts[5] && ex.columnNumber !== void 0) {
        stack[0].column = ex.columnNumber + 1;
      }
      element = {
        url: parts[3],
        func: parts[1] || UNKNOWN_FUNCTION,
        args: parts[2] ? parts[2].split(",") : [],
        line: parts[4] ? +parts[4] : null,
        column: parts[5] ? +parts[5] : null
      };
    } else {
      continue;
    }
    if (!element.func && element.line) {
      element.func = UNKNOWN_FUNCTION;
    }
    stack.push(element);
  }
  if (!stack.length) {
    return null;
  }
  return {
    message: extractMessage(ex),
    name: ex.name,
    stack
  };
}
var sourceListTags = [
  "link",
  "style",
  "script",
  "img",
  "video",
  "audio",
  "iframe"
];
var sourceNode = makeMap(sourceListTags);
function computeErrorUrl(ex) {
  if (ex && ex.filename)
    return ex.filename;
  const res = computeStackTraceFromStackProp(ex);
  if (res) {
    const urls = res.stack.map((item) => {
      return item.url;
    });
    return urls[0] || null;
  } else if (ex && ex.target && ex.target.tagName) {
    const tagName = ex.target.tagName.toLowerCase();
    if (sourceNode(tagName)) {
      return ex.target.src || ex.target.href;
    }
  }
  return null;
}
function filterAndWrapEventListener(type, listener, sourceList) {
  const errorHandler = function(e) {
    if (typeof listener === "function") {
      if (sourceList) {
        console.log("**********", computeErrorUrl(e));
        const res = sourceList.find((item) => {
          return item.indexOf(computeErrorUrl(e)) !== -1;
        });
        if (res) {
          listener(e);
        }
      } else {
        listener(e);
      }
    }
  };
  const unhandledrejection = function(event) {
    event.promise.catch((e) => {
      if (e instanceof Error) {
        errorHandler(e);
      } else {
        if (typeof listener === "function")
          listener(event);
      }
    });
  };
  const filterError = function(event) {
    if (typeof listener === "function") {
      if (type === "unhandledrejection") {
        unhandledrejection(event);
      } else if (type === "error") {
        errorHandler(event);
      } else {
        listener(event);
      }
    }
  };
  return filterError;
}

// src/domApis.ts
var xChar = 120;
var colonChar = 58;
var ns = "http://www.w3.org/2000/svg";
var xlinkNS = "http://www.w3.org/1999/xlink";
var xmlNS = "http://www.w3.org/XML/1998/namespace";
var xlinkPrefix = "xlink";
var SVG_TAGS = "svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistanceLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view";
var isSVG = makeMap(SVG_TAGS.split(","));
function changeTagNameToLowerCase(tagName) {
  return isSVG(tagName) ? tagName : tagName.toLowerCase();
}
function attributesString(attributes) {
  if (!attributes || attributes.length === 0)
    return "";
  return attributes.reduce((total, { key, value }) => {
    return total + (value ? `${key}="${value}" ` : key);
  }, "");
}
var DOMApis = class {
  constructor(cusDocument) {
    this.document = cusDocument || document;
  }
  isText(node) {
    return node && node.type === "text";
  }
  isNode(node) {
    return node && node.type === "element";
  }
  isCommentNode(node) {
    return node && node.type === "comment";
  }
  isCssLinkNode(node) {
    if (this.isNode(node) && node.tagName === "link") {
      return !!node.attributes.find(({ key, value }) => key === "rel" && value === "stylesheet");
    }
    return false;
  }
  isIconLinkNode(node) {
    if (this.isNode(node) && node.tagName === "link") {
      return !!node.attributes.find(({ key, value }) => key === "rel" && value === "icon");
    }
    return false;
  }
  isPrefetchJsLinkNode(node) {
    if (!this.isNode(node) || node.tagName !== "link")
      return false;
    let hasRelAttr, hasAsAttr;
    for (const { key, value } of node.attributes) {
      if (key === "rel") {
        hasRelAttr = true;
        if (value !== "preload" && value !== "prefetch") {
          return false;
        }
      } else if (key === "as") {
        hasAsAttr = true;
        if (value !== "script")
          return false;
      }
    }
    return Boolean(hasRelAttr && hasAsAttr);
  }
  isRemoteModule(node) {
    if (!this.isNode(node) || node.tagName !== "meta")
      return false;
    let hasNameAttr, hasSrcAttr;
    for (const { key, value } of node.attributes) {
      if (key === "name") {
        hasNameAttr = true;
        if (value !== "garfish-remote-module") {
          return false;
        }
      } else if (key === "src") {
        hasSrcAttr = true;
        if (typeof value === "undefined" || value === "") {
          return false;
        }
      }
    }
    return Boolean(hasNameAttr && hasSrcAttr);
  }
  removeElement(el) {
    const parentNode = el && el.parentNode;
    if (parentNode) {
      parentNode.removeChild(el);
    }
  }
  createElement(node) {
    const { tagName, attributes } = node;
    const el = isSVG(tagName) ? this.document.createElementNS(ns, tagName) : this.document.createElement(tagName);
    this.applyAttributes(el, attributes);
    return el;
  }
  createTextNode(node) {
    return this.document.createTextNode(node.content);
  }
  createStyleNode(content) {
    const el = this.document.createElement("style");
    content && (el.textContent = content);
    this.applyAttributes(el, [{ key: "type", value: "text/css" }]);
    return el;
  }
  createLinkCommentNode(node) {
    if (this.isNode(node)) {
      const ps = attributesString(node.attributes);
      return `<link ${ps.slice(0, -1)}></link>`;
    } else {
      node = node ? `src="${node}" ` : "";
      return this.document.createComment(`<link ${node}execute by garfish(dynamic)></link>`);
    }
  }
  createScriptCommentNode(node) {
    if (this.isNode(node)) {
      const { attributes, children } = node;
      const ps = attributesString(attributes);
      const code = (children == null ? void 0 : children[0]) ? children[0].content : "";
      return this.document.createComment(`<script ${ps} execute by garfish>${code}<\/script>`);
    } else {
      const { src, code } = node;
      const url = src ? `src="${src}" ` : "";
      return this.document.createComment(`<script ${url}execute by garfish(dynamic)>${code}<\/script>`);
    }
  }
  applyAttributes(el, attributes) {
    if (!attributes || attributes.length === 0)
      return;
    for (const { key, value } of attributes) {
      if (key) {
        if (value === null) {
          el.setAttribute(key, "");
        } else if (typeof value === "string") {
          if (key.charCodeAt(0) !== xChar) {
            el.setAttribute(key, value);
          } else if (key.charCodeAt(3) === colonChar) {
            el.setAttributeNS(xmlNS, key, value);
          } else if (key.charCodeAt(5) === colonChar && key.slice(0, 5) === xlinkPrefix) {
            el.setAttributeNS(xlinkNS, key, value);
          } else {
            el.setAttribute(key, value);
          }
        }
      }
    }
  }
};

// src/garfish.ts
var __LOADER_FLAG__ = Symbol.for("__LOADER_FLAG__");
var __GARFISH_FLAG__ = Symbol.for("__GARFISH_FLAG__");
var __MockHtml__ = "__garfishmockhtml__";
var __MockBody__ = "__garfishmockbody__";
var __MockHead__ = "__garfishmockhead__";
var __REMOVE_NODE__ = "__garfishremovenode__";

// src/mimeType.ts
function parseContentType(input) {
  input = input == null ? void 0 : input.trim();
  if (!input)
    return null;
  let idx = 0;
  let type = "";
  let subType = "";
  while (idx < input.length && input[idx] !== "/") {
    type += input[idx];
    idx++;
  }
  if (type.length === 0 || idx >= input.length) {
    return null;
  }
  idx++;
  while (idx < input.length && input[idx] !== ";") {
    subType += input[idx];
    idx++;
  }
  subType = subType.replace(/[ \t\n\r]+$/, "");
  if (subType.length === 0)
    return null;
  return {
    type: type.toLocaleLowerCase(),
    subtype: subType.toLocaleLowerCase()
  };
}
function isCss(mt) {
  return mt ? mt.type === "text" && mt.subtype === "css" : false;
}
function isHtml(mt) {
  return mt ? mt.type === "text" && mt.subtype === "html" : false;
}
function isJs(mt) {
  const { type, subtype } = mt || {};
  switch (type) {
    case "text": {
      switch (subtype) {
        case "ecmascript":
        case "javascript":
        case "javascript1.0":
        case "javascript1.1":
        case "javascript1.2":
        case "javascript1.3":
        case "javascript1.4":
        case "javascript1.5":
        case "jscript":
        case "livescript":
        case "x-ecmascript":
        case "x-javascript": {
          return true;
        }
        default: {
          return false;
        }
      }
    }
    case "application": {
      switch (subtype) {
        case "ecmascript":
        case "javascript":
        case "x-ecmascript":
        case "x-javascript": {
          return true;
        }
        default: {
          return false;
        }
      }
    }
    default: {
      return false;
    }
  }
}
function isJsonp(mt, src) {
  const callbackRegExp = /callback/;
  try {
    const search = new URL(src).search;
    const { type, subtype } = mt || {};
    if (type === "application" && subtype === "json" && callbackRegExp.test(search)) {
      return true;
    }
  } catch (e) {
    return false;
  }
  return false;
}
function isJsType({ src = "", type }) {
  if (/\.js$/.test(src))
    return true;
  if (type) {
    if (type === "module")
      return true;
    const mimeTypeInfo = parseContentType(type);
    if (isJsonp(mimeTypeInfo, src))
      return true;
    if (isJs(mimeTypeInfo))
      return true;
  }
  return false;
}
function isCssType({ src = "", type }) {
  if (/\.css$/.test(src))
    return true;
  if (type) {
    const mimeTypeInfo = parseContentType(type);
    if (isCss(mimeTypeInfo))
      return true;
  }
  return false;
}
function isHtmlType({
  src = "",
  type
}) {
  if (/\.html$/.test(src))
    return true;
  if (type) {
    const mimeTypeInfo = parseContentType(type);
    if (isHtml(mimeTypeInfo))
      return true;
  }
  return false;
}
function isGarfishConfigType({
  type = ""
}) {
  return /garfish-config/i.test(type);
}

// src/dispatchEvents.ts
var reactEvents = [
  "onAbort",
  "onAnimationCancel",
  "onAnimationEnd",
  "onAnimationIteration",
  "onAuxClick",
  "onBlur",
  "onChange",
  "onClick",
  "onClose",
  "onContextMenu",
  "onDoubleClick",
  "onError",
  "onFocus",
  "onGotPointerCapture",
  "onInput",
  "onKeyDown",
  "onKeyPress",
  "onKeyUp",
  "onLoad",
  "onLoadEnd",
  "onLoadStart",
  "onLostPointerCapture",
  "onMouseDown",
  "onMouseMove",
  "onMouseOut",
  "onMouseOver",
  "onMouseUp",
  "onPointerCancel",
  "onPointerDown",
  "onPointerEnter",
  "onPointerLeave",
  "onPointerMove",
  "onPointerOut",
  "onPointerOver",
  "onPointerUp",
  "onReset",
  "onResize",
  "onScroll",
  "onSelect",
  "onSelectionChange",
  "onSelectStart",
  "onSubmit",
  "onTouchCancel",
  "onTouchMove",
  "onTouchStart",
  "onTouchEnd",
  "onTransitionCancel",
  "onTransitionEnd",
  "onDrag",
  "onDragEnd",
  "onDragEnter",
  "onDragExit",
  "onDragLeave",
  "onDragOver",
  "onDragStart",
  "onDrop",
  "onFocusOut"
];
var divergentNativeEvents = {
  onDoubleClick: "dblclick"
};
var mimickedReactEvents = {
  onInput: "onChange",
  onFocusOut: "onBlur",
  onSelectionChange: "onSelect"
};
function dispatchEvents(shadowRoot) {
  const removeEventListeners = [];
  reactEvents.forEach(function(reactEventName) {
    const nativeEventName = getNativeEventName(reactEventName);
    function retargetEvent(event) {
      const path = event.path || event.composedPath && event.composedPath() || composedPath(event.target);
      for (let i = 0; i < path.length; i++) {
        const el = path[i];
        let props = null;
        const reactComponent = findReactComponent(el);
        const eventHandlers = findReactEventHandlers(el);
        if (!eventHandlers) {
          props = findReactProps(reactComponent);
        } else {
          props = eventHandlers;
        }
        if (reactComponent && props) {
          dispatchEvent(event, reactEventName, props);
        }
        if (reactComponent && props && mimickedReactEvents[reactEventName]) {
          dispatchEvent(event, mimickedReactEvents[reactEventName], props);
        }
        if (event.cancelBubble) {
          break;
        }
        if (el === shadowRoot) {
          break;
        }
      }
    }
    shadowRoot.addEventListener(nativeEventName, retargetEvent, false);
    removeEventListeners.push(function() {
      shadowRoot.removeEventListener(nativeEventName, retargetEvent, false);
    });
  });
  return function() {
    removeEventListeners.forEach(function(removeEventListener) {
      removeEventListener();
    });
  };
}
function findReactEventHandlers(item) {
  return findReactProperty(item, "__reactEventHandlers");
}
function findReactComponent(item) {
  return findReactProperty(item, "_reactInternal");
}
function findReactProperty(item, propertyPrefix) {
  for (const key in item) {
    if (hasOwn(item, key) && key.indexOf(propertyPrefix) !== -1) {
      return item[key];
    }
  }
}
function findReactProps(component) {
  if (!component)
    return void 0;
  if (component.memoizedProps)
    return component.memoizedProps;
  if (component._currentElement && component._currentElement.props)
    return component._currentElement.props;
}
function dispatchEvent(event, eventType, componentProps) {
  event.persist = function() {
    event.isPersistent = () => true;
  };
  if (componentProps[eventType]) {
    componentProps[eventType](event);
  }
}
function getNativeEventName(reactEventName) {
  if (divergentNativeEvents[reactEventName]) {
    return divergentNativeEvents[reactEventName];
  }
  return reactEventName.replace(/^on/, "").toLowerCase();
}
function composedPath(el) {
  const path = [];
  while (el) {
    path.push(el);
    if (el.tagName === "HTML") {
      path.push(document);
      path.push(window);
      return path;
    }
    el = el.parentElement;
  }
}

// src/container.ts
var appContainerId = "garfish_app_for";
function createAppContainer(appInfo) {
  let htmlNode = document.createElement("div");
  const appContainer = document.createElement("div");
  if (appInfo.sandbox && appInfo.sandbox.strictIsolation) {
    htmlNode = document.createElement("html");
    const root = appContainer.attachShadow({ mode: "open" });
    root.appendChild(htmlNode);
    dispatchEvents(root);
  } else {
    htmlNode.setAttribute(__MockHtml__, "");
    appContainer.appendChild(htmlNode);
  }
  appContainer.id = `${appContainerId}_${appInfo.name}_${createKey()}`;
  return {
    htmlNode,
    appContainer
  };
}
function waitElementReady(selector, callback, leftTime) {
  const timeInterval = 50;
  const elem = document.querySelector(selector);
  if (elem !== null || leftTime <= 0) {
    callback(elem);
    return;
  }
  setTimeout(function() {
    waitElementReady(selector, callback, leftTime - timeInterval);
  }, timeInterval);
}
function delay(duration) {
  return new Promise(function(resolve) {
    setTimeout(resolve, duration);
  });
}
function waitElement(selector, timeout = 3e3) {
  const waitPromise = new Promise(function(resolve) {
    waitElementReady(selector, function(elem) {
      return resolve(elem);
    }, timeout);
  });
  return Promise.race([delay(timeout), waitPromise]);
}
async function getRenderNode(domGetter) {
  assert(domGetter, `Invalid domGetter:
 ${domGetter}.`);
  let appWrapperNode;
  if (typeof domGetter === "string") {
    appWrapperNode = await waitElement(domGetter);
  } else if (typeof domGetter === "function") {
    appWrapperNode = await Promise.resolve(domGetter());
  }
  assert(appWrapperNode instanceof Element, `Invalid domGetter: ${domGetter}`);
  return appWrapperNode;
}

// src/templateParse.ts
function Attributes({ name, value }) {
  this.key = name;
  this.value = value;
}
var generateAttributes = (el) => {
  const list = [];
  const attrs = el.attributes;
  const len = attrs.length;
  if (len > 0) {
    if (len === 1) {
      list[0] = new Attributes(attrs[0]);
    } else if (len === 2) {
      list[0] = new Attributes(attrs[0]);
      list[1] = new Attributes(attrs[1]);
    } else {
      for (let i = 0; i < len; i++) {
        list[i] = new Attributes(attrs[i]);
      }
    }
  }
  return list;
};
var createElement = (el, filter) => {
  switch (el.nodeType) {
    case 3 /* TEXT */:
      return {
        type: "text",
        content: el.textContent
      };
    case 8 /* COMMENT */:
      return {
        type: "comment",
        content: el.textContent
      };
    case 1 /* ELEMENT */:
      return filter({
        type: "element",
        tagName: changeTagNameToLowerCase(el.tagName),
        attributes: generateAttributes(el),
        children: Array.from(el.childNodes).map((node) => {
          return createElement(node, filter);
        })
      });
    default:
      error(`Invalid node type "${el.nodeType}"`);
  }
};
function templateParse(code, tags) {
  let astTree = [];
  const htmlNode = document.createElement("html");
  const collectionEls = {};
  const filter = (el) => {
    if (tags.includes(el.tagName)) {
      collectionEls[el.tagName].push(el);
    }
    return el;
  };
  htmlNode.innerHTML = code;
  for (const tag of tags) {
    collectionEls[tag] = [];
  }
  astTree = Array.from(htmlNode.childNodes).map((node) => {
    return createElement(node, filter);
  });
  return [astTree, collectionEls];
}

// src/logger.ts

var log = debug__WEBPACK_IMPORTED_MODULE_0___default()("garfish");
var coreLog = log.extend("core");
var routerLog = log.extend("router");

// src/lock.ts
var Lock = class {
  constructor() {
    this.id = 0;
    this.lockQueue = [];
  }
  genId() {
    return ++this.id;
  }
  getId() {
    return this.id;
  }
  async wait(id) {
    const { lockQueue } = this;
    const firstLock = lockQueue[0];
    const lastLock = firstLock ? lockQueue[lockQueue.length - 1] : void 0;
    if ((firstLock == null ? void 0 : firstLock.id) === id)
      return;
    let lockItem = lockQueue.find((item) => item.id === id);
    if (!lockItem) {
      let promiseResolve = () => {
      };
      const waiting = new Promise((resolve) => {
        promiseResolve = resolve;
      });
      lockItem = { id, waiting, resolve: promiseResolve };
      lockQueue.push(lockItem);
    }
    if (lastLock) {
      await lastLock.waiting;
    }
  }
  release() {
    const { lockQueue } = this;
    const firstLock = lockQueue[0];
    if (!firstLock)
      return;
    lockQueue.shift();
    firstLock.resolve();
  }
  clear() {
    this.lockQueue = [];
  }
};



/***/ }),

/***/ "./node_modules/.pnpm/antd@5.8.0_moment@2.29.4_react-dom@18.2.0_react@18.2.0/node_modules/antd/es/_util/reactNode.js":
/*!***************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/antd@5.8.0_moment@2.29.4_react-dom@18.2.0_react@18.2.0/node_modules/antd/es/_util/reactNode.js ***!
  \***************************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   cloneElement: function() { return /* binding */ cloneElement; },
/* harmony export */   isFragment: function() { return /* binding */ isFragment; },
/* harmony export */   isValidElement: function() { return /* binding */ isValidElement; },
/* harmony export */   replaceElement: function() { return /* binding */ replaceElement; }
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

const {
  isValidElement
} = react__WEBPACK_IMPORTED_MODULE_0__;
function isFragment(child) {
  return child && isValidElement(child) && child.type === react__WEBPACK_IMPORTED_MODULE_0__.Fragment;
}
function replaceElement(element, replacement, props) {
  if (!isValidElement(element)) {
    return replacement;
  }
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.cloneElement(element, typeof props === 'function' ? props(element.props || {}) : props);
}
function cloneElement(element, props) {
  return replaceElement(element, element, props);
}

/***/ }),

/***/ "./node_modules/.pnpm/debug@4.3.4_supports-color@5.5.0/node_modules/debug/src/browser.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/.pnpm/debug@4.3.4_supports-color@5.5.0/node_modules/debug/src/browser.js ***!
  \***********************************************************************************************/
/***/ (function(module, exports, __webpack_require__) {

/* provided dependency */ var process = __webpack_require__(/*! process/browser */ "./node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");
/* eslint-env browser */

/**
 * This is the web browser implementation of `debug()`.
 */

exports.formatArgs = formatArgs;
exports.save = save;
exports.load = load;
exports.useColors = useColors;
exports.storage = localstorage();
exports.destroy = (() => {
	let warned = false;

	return () => {
		if (!warned) {
			warned = true;
			console.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.');
		}
	};
})();

/**
 * Colors.
 */

exports.colors = [
	'#0000CC',
	'#0000FF',
	'#0033CC',
	'#0033FF',
	'#0066CC',
	'#0066FF',
	'#0099CC',
	'#0099FF',
	'#00CC00',
	'#00CC33',
	'#00CC66',
	'#00CC99',
	'#00CCCC',
	'#00CCFF',
	'#3300CC',
	'#3300FF',
	'#3333CC',
	'#3333FF',
	'#3366CC',
	'#3366FF',
	'#3399CC',
	'#3399FF',
	'#33CC00',
	'#33CC33',
	'#33CC66',
	'#33CC99',
	'#33CCCC',
	'#33CCFF',
	'#6600CC',
	'#6600FF',
	'#6633CC',
	'#6633FF',
	'#66CC00',
	'#66CC33',
	'#9900CC',
	'#9900FF',
	'#9933CC',
	'#9933FF',
	'#99CC00',
	'#99CC33',
	'#CC0000',
	'#CC0033',
	'#CC0066',
	'#CC0099',
	'#CC00CC',
	'#CC00FF',
	'#CC3300',
	'#CC3333',
	'#CC3366',
	'#CC3399',
	'#CC33CC',
	'#CC33FF',
	'#CC6600',
	'#CC6633',
	'#CC9900',
	'#CC9933',
	'#CCCC00',
	'#CCCC33',
	'#FF0000',
	'#FF0033',
	'#FF0066',
	'#FF0099',
	'#FF00CC',
	'#FF00FF',
	'#FF3300',
	'#FF3333',
	'#FF3366',
	'#FF3399',
	'#FF33CC',
	'#FF33FF',
	'#FF6600',
	'#FF6633',
	'#FF9900',
	'#FF9933',
	'#FFCC00',
	'#FFCC33'
];

/**
 * Currently only WebKit-based Web Inspectors, Firefox >= v31,
 * and the Firebug extension (any Firefox version) are known
 * to support "%c" CSS customizations.
 *
 * TODO: add a `localStorage` variable to explicitly enable/disable colors
 */

// eslint-disable-next-line complexity
function useColors() {
	// NB: In an Electron preload script, document will be defined but not fully
	// initialized. Since we know we're in Chrome, we'll just detect this case
	// explicitly
	if (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {
		return true;
	}

	// Internet Explorer and Edge do not support colors.
	if (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)) {
		return false;
	}

	// Is webkit? http://stackoverflow.com/a/16459606/376773
	// document is undefined in react-native: https://github.com/facebook/react-native/pull/1632
	return (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||
		// Is firebug? http://stackoverflow.com/a/398120/376773
		(typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||
		// Is firefox >= v31?
		// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages
		(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||
		// Double check webkit in userAgent just in case we are in a worker
		(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/));
}

/**
 * Colorize log arguments if enabled.
 *
 * @api public
 */

function formatArgs(args) {
	args[0] = (this.useColors ? '%c' : '') +
		this.namespace +
		(this.useColors ? ' %c' : ' ') +
		args[0] +
		(this.useColors ? '%c ' : ' ') +
		'+' + module.exports.humanize(this.diff);

	if (!this.useColors) {
		return;
	}

	const c = 'color: ' + this.color;
	args.splice(1, 0, c, 'color: inherit');

	// The final "%c" is somewhat tricky, because there could be other
	// arguments passed either before or after the %c, so we need to
	// figure out the correct index to insert the CSS into
	let index = 0;
	let lastC = 0;
	args[0].replace(/%[a-zA-Z%]/g, match => {
		if (match === '%%') {
			return;
		}
		index++;
		if (match === '%c') {
			// We only are interested in the *last* %c
			// (the user may have provided their own)
			lastC = index;
		}
	});

	args.splice(lastC, 0, c);
}

/**
 * Invokes `console.debug()` when available.
 * No-op when `console.debug` is not a "function".
 * If `console.debug` is not available, falls back
 * to `console.log`.
 *
 * @api public
 */
exports.log = console.debug || console.log || (() => {});

/**
 * Save `namespaces`.
 *
 * @param {String} namespaces
 * @api private
 */
function save(namespaces) {
	try {
		if (namespaces) {
			exports.storage.setItem('debug', namespaces);
		} else {
			exports.storage.removeItem('debug');
		}
	} catch (error) {
		// Swallow
		// XXX (@Qix-) should we be logging these?
	}
}

/**
 * Load `namespaces`.
 *
 * @return {String} returns the previously persisted debug modes
 * @api private
 */
function load() {
	let r;
	try {
		r = exports.storage.getItem('debug');
	} catch (error) {
		// Swallow
		// XXX (@Qix-) should we be logging these?
	}

	// If debug isn't set in LS, and we're in Electron, try to load $DEBUG
	if (!r && typeof process !== 'undefined' && 'env' in process) {
		r = {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"}.DEBUG;
	}

	return r;
}

/**
 * Localstorage attempts to return the localstorage.
 *
 * This is necessary because safari throws
 * when a user disables cookies/localstorage
 * and you attempt to access it.
 *
 * @return {LocalStorage}
 * @api private
 */

function localstorage() {
	try {
		// TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context
		// The Browser also has localStorage in the global context.
		return localStorage;
	} catch (error) {
		// Swallow
		// XXX (@Qix-) should we be logging these?
	}
}

module.exports = __webpack_require__(/*! ./common */ "./node_modules/.pnpm/debug@4.3.4_supports-color@5.5.0/node_modules/debug/src/common.js")(exports);

const {formatters} = module.exports;

/**
 * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.
 */

formatters.j = function (v) {
	try {
		return JSON.stringify(v);
	} catch (error) {
		return '[UnexpectedJSONParseError]: ' + error.message;
	}
};


/***/ }),

/***/ "./node_modules/.pnpm/debug@4.3.4_supports-color@5.5.0/node_modules/debug/src/common.js":
/*!**********************************************************************************************!*\
  !*** ./node_modules/.pnpm/debug@4.3.4_supports-color@5.5.0/node_modules/debug/src/common.js ***!
  \**********************************************************************************************/
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


/**
 * This is the common logic for both the Node.js and web browser
 * implementations of `debug()`.
 */

function setup(env) {
	createDebug.debug = createDebug;
	createDebug.default = createDebug;
	createDebug.coerce = coerce;
	createDebug.disable = disable;
	createDebug.enable = enable;
	createDebug.enabled = enabled;
	createDebug.humanize = __webpack_require__(/*! ms */ "./node_modules/.pnpm/ms@2.1.2/node_modules/ms/index.js");
	createDebug.destroy = destroy;

	Object.keys(env).forEach(key => {
		createDebug[key] = env[key];
	});

	/**
	* The currently active debug mode names, and names to skip.
	*/

	createDebug.names = [];
	createDebug.skips = [];

	/**
	* Map of special "%n" handling functions, for the debug "format" argument.
	*
	* Valid key names are a single, lower or upper-case letter, i.e. "n" and "N".
	*/
	createDebug.formatters = {};

	/**
	* Selects a color for a debug namespace
	* @param {String} namespace The namespace string for the debug instance to be colored
	* @return {Number|String} An ANSI color code for the given namespace
	* @api private
	*/
	function selectColor(namespace) {
		let hash = 0;

		for (let i = 0; i < namespace.length; i++) {
			hash = ((hash << 5) - hash) + namespace.charCodeAt(i);
			hash |= 0; // Convert to 32bit integer
		}

		return createDebug.colors[Math.abs(hash) % createDebug.colors.length];
	}
	createDebug.selectColor = selectColor;

	/**
	* Create a debugger with the given `namespace`.
	*
	* @param {String} namespace
	* @return {Function}
	* @api public
	*/
	function createDebug(namespace) {
		let prevTime;
		let enableOverride = null;
		let namespacesCache;
		let enabledCache;

		function debug(...args) {
			// Disabled?
			if (!debug.enabled) {
				return;
			}

			const self = debug;

			// Set `diff` timestamp
			const curr = Number(new Date());
			const ms = curr - (prevTime || curr);
			self.diff = ms;
			self.prev = prevTime;
			self.curr = curr;
			prevTime = curr;

			args[0] = createDebug.coerce(args[0]);

			if (typeof args[0] !== 'string') {
				// Anything else let's inspect with %O
				args.unshift('%O');
			}

			// Apply any `formatters` transformations
			let index = 0;
			args[0] = args[0].replace(/%([a-zA-Z%])/g, (match, format) => {
				// If we encounter an escaped % then don't increase the array index
				if (match === '%%') {
					return '%';
				}
				index++;
				const formatter = createDebug.formatters[format];
				if (typeof formatter === 'function') {
					const val = args[index];
					match = formatter.call(self, val);

					// Now we need to remove `args[index]` since it's inlined in the `format`
					args.splice(index, 1);
					index--;
				}
				return match;
			});

			// Apply env-specific formatting (colors, etc.)
			createDebug.formatArgs.call(self, args);

			const logFn = self.log || createDebug.log;
			logFn.apply(self, args);
		}

		debug.namespace = namespace;
		debug.useColors = createDebug.useColors();
		debug.color = createDebug.selectColor(namespace);
		debug.extend = extend;
		debug.destroy = createDebug.destroy; // XXX Temporary. Will be removed in the next major release.

		Object.defineProperty(debug, 'enabled', {
			enumerable: true,
			configurable: false,
			get: () => {
				if (enableOverride !== null) {
					return enableOverride;
				}
				if (namespacesCache !== createDebug.namespaces) {
					namespacesCache = createDebug.namespaces;
					enabledCache = createDebug.enabled(namespace);
				}

				return enabledCache;
			},
			set: v => {
				enableOverride = v;
			}
		});

		// Env-specific initialization logic for debug instances
		if (typeof createDebug.init === 'function') {
			createDebug.init(debug);
		}

		return debug;
	}

	function extend(namespace, delimiter) {
		const newDebug = createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);
		newDebug.log = this.log;
		return newDebug;
	}

	/**
	* Enables a debug mode by namespaces. This can include modes
	* separated by a colon and wildcards.
	*
	* @param {String} namespaces
	* @api public
	*/
	function enable(namespaces) {
		createDebug.save(namespaces);
		createDebug.namespaces = namespaces;

		createDebug.names = [];
		createDebug.skips = [];

		let i;
		const split = (typeof namespaces === 'string' ? namespaces : '').split(/[\s,]+/);
		const len = split.length;

		for (i = 0; i < len; i++) {
			if (!split[i]) {
				// ignore empty strings
				continue;
			}

			namespaces = split[i].replace(/\*/g, '.*?');

			if (namespaces[0] === '-') {
				createDebug.skips.push(new RegExp('^' + namespaces.slice(1) + '$'));
			} else {
				createDebug.names.push(new RegExp('^' + namespaces + '$'));
			}
		}
	}

	/**
	* Disable debug output.
	*
	* @return {String} namespaces
	* @api public
	*/
	function disable() {
		const namespaces = [
			...createDebug.names.map(toNamespace),
			...createDebug.skips.map(toNamespace).map(namespace => '-' + namespace)
		].join(',');
		createDebug.enable('');
		return namespaces;
	}

	/**
	* Returns true if the given mode name is enabled, false otherwise.
	*
	* @param {String} name
	* @return {Boolean}
	* @api public
	*/
	function enabled(name) {
		if (name[name.length - 1] === '*') {
			return true;
		}

		let i;
		let len;

		for (i = 0, len = createDebug.skips.length; i < len; i++) {
			if (createDebug.skips[i].test(name)) {
				return false;
			}
		}

		for (i = 0, len = createDebug.names.length; i < len; i++) {
			if (createDebug.names[i].test(name)) {
				return true;
			}
		}

		return false;
	}

	/**
	* Convert regexp to namespace
	*
	* @param {RegExp} regxep
	* @return {String} namespace
	* @api private
	*/
	function toNamespace(regexp) {
		return regexp.toString()
			.substring(2, regexp.toString().length - 2)
			.replace(/\.\*\?$/, '*');
	}

	/**
	* Coerce `val`.
	*
	* @param {Mixed} val
	* @return {Mixed}
	* @api private
	*/
	function coerce(val) {
		if (val instanceof Error) {
			return val.stack || val.message;
		}
		return val;
	}

	/**
	* XXX DO NOT USE. This is a temporary stub function.
	* XXX It WILL be removed in the next major release.
	*/
	function destroy() {
		console.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.');
	}

	createDebug.enable(createDebug.load());

	return createDebug;
}

module.exports = setup;


/***/ }),

/***/ "./node_modules/.pnpm/eventemitter2@6.4.9/node_modules/eventemitter2/lib/eventemitter2.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/.pnpm/eventemitter2@6.4.9/node_modules/eventemitter2/lib/eventemitter2.js ***!
  \************************************************************************************************/
/***/ (function(module, exports, __webpack_require__) {

/* provided dependency */ var process = __webpack_require__(/*! process/browser */ "./node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");
var __WEBPACK_AMD_DEFINE_RESULT__;/*!
 * EventEmitter2
 * https://github.com/hij1nx/EventEmitter2
 *
 * Copyright (c) 2013 hij1nx
 * Licensed under the MIT license.
 */
;!function(undefined) {
  var hasOwnProperty= Object.hasOwnProperty;
  var isArray = Array.isArray ? Array.isArray : function _isArray(obj) {
    return Object.prototype.toString.call(obj) === "[object Array]";
  };
  var defaultMaxListeners = 10;
  var nextTickSupported= typeof process=='object' && typeof process.nextTick=='function';
  var symbolsSupported= typeof Symbol==='function';
  var reflectSupported= typeof Reflect === 'object';
  var setImmediateSupported= typeof setImmediate === 'function';
  var _setImmediate= setImmediateSupported ? setImmediate : setTimeout;
  var ownKeys= symbolsSupported? (reflectSupported && typeof Reflect.ownKeys==='function'? Reflect.ownKeys : function(obj){
    var arr= Object.getOwnPropertyNames(obj);
    arr.push.apply(arr, Object.getOwnPropertySymbols(obj));
    return arr;
  }) : Object.keys;

  function init() {
    this._events = {};
    if (this._conf) {
      configure.call(this, this._conf);
    }
  }

  function configure(conf) {
    if (conf) {
      this._conf = conf;

      conf.delimiter && (this.delimiter = conf.delimiter);

      if(conf.maxListeners!==undefined){
          this._maxListeners= conf.maxListeners;
      }

      conf.wildcard && (this.wildcard = conf.wildcard);
      conf.newListener && (this._newListener = conf.newListener);
      conf.removeListener && (this._removeListener = conf.removeListener);
      conf.verboseMemoryLeak && (this.verboseMemoryLeak = conf.verboseMemoryLeak);
      conf.ignoreErrors && (this.ignoreErrors = conf.ignoreErrors);

      if (this.wildcard) {
        this.listenerTree = {};
      }
    }
  }

  function logPossibleMemoryLeak(count, eventName) {
    var errorMsg = '(node) warning: possible EventEmitter memory ' +
        'leak detected. ' + count + ' listeners added. ' +
        'Use emitter.setMaxListeners() to increase limit.';

    if(this.verboseMemoryLeak){
      errorMsg += ' Event name: ' + eventName + '.';
    }

    if(typeof process !== 'undefined' && process.emitWarning){
      var e = new Error(errorMsg);
      e.name = 'MaxListenersExceededWarning';
      e.emitter = this;
      e.count = count;
      process.emitWarning(e);
    } else {
      console.error(errorMsg);

      if (console.trace){
        console.trace();
      }
    }
  }

  var toArray = function (a, b, c) {
    var n = arguments.length;
    switch (n) {
      case 0:
        return [];
      case 1:
        return [a];
      case 2:
        return [a, b];
      case 3:
        return [a, b, c];
      default:
        var arr = new Array(n);
        while (n--) {
          arr[n] = arguments[n];
        }
        return arr;
    }
  };

  function toObject(keys, values) {
    var obj = {};
    var key;
    var len = keys.length;
    var valuesCount = values ? values.length : 0;
    for (var i = 0; i < len; i++) {
      key = keys[i];
      obj[key] = i < valuesCount ? values[i] : undefined;
    }
    return obj;
  }

  function TargetObserver(emitter, target, options) {
    this._emitter = emitter;
    this._target = target;
    this._listeners = {};
    this._listenersCount = 0;

    var on, off;

    if (options.on || options.off) {
      on = options.on;
      off = options.off;
    }

    if (target.addEventListener) {
      on = target.addEventListener;
      off = target.removeEventListener;
    } else if (target.addListener) {
      on = target.addListener;
      off = target.removeListener;
    } else if (target.on) {
      on = target.on;
      off = target.off;
    }

    if (!on && !off) {
      throw Error('target does not implement any known event API');
    }

    if (typeof on !== 'function') {
      throw TypeError('on method must be a function');
    }

    if (typeof off !== 'function') {
      throw TypeError('off method must be a function');
    }

    this._on = on;
    this._off = off;

    var _observers= emitter._observers;
    if(_observers){
      _observers.push(this);
    }else{
      emitter._observers= [this];
    }
  }

  Object.assign(TargetObserver.prototype, {
    subscribe: function(event, localEvent, reducer){
      var observer= this;
      var target= this._target;
      var emitter= this._emitter;
      var listeners= this._listeners;
      var handler= function(){
        var args= toArray.apply(null, arguments);
        var eventObj= {
          data: args,
          name: localEvent,
          original: event
        };
        if(reducer){
          var result= reducer.call(target, eventObj);
          if(result!==false){
            emitter.emit.apply(emitter, [eventObj.name].concat(args))
          }
          return;
        }
        emitter.emit.apply(emitter, [localEvent].concat(args));
      };


      if(listeners[event]){
        throw Error('Event \'' + event + '\' is already listening');
      }

      this._listenersCount++;

      if(emitter._newListener && emitter._removeListener && !observer._onNewListener){

        this._onNewListener = function (_event) {
          if (_event === localEvent && listeners[event] === null) {
            listeners[event] = handler;
            observer._on.call(target, event, handler);
          }
        };

        emitter.on('newListener', this._onNewListener);

        this._onRemoveListener= function(_event){
          if(_event === localEvent && !emitter.hasListeners(_event) && listeners[event]){
            listeners[event]= null;
            observer._off.call(target, event, handler);
          }
        };

        listeners[event]= null;

        emitter.on('removeListener', this._onRemoveListener);
      }else{
        listeners[event]= handler;
        observer._on.call(target, event, handler);
      }
    },

    unsubscribe: function(event){
      var observer= this;
      var listeners= this._listeners;
      var emitter= this._emitter;
      var handler;
      var events;
      var off= this._off;
      var target= this._target;
      var i;

      if(event && typeof event!=='string'){
        throw TypeError('event must be a string');
      }

      function clearRefs(){
        if(observer._onNewListener){
          emitter.off('newListener', observer._onNewListener);
          emitter.off('removeListener', observer._onRemoveListener);
          observer._onNewListener= null;
          observer._onRemoveListener= null;
        }
        var index= findTargetIndex.call(emitter, observer);
        emitter._observers.splice(index, 1);
      }

      if(event){
        handler= listeners[event];
        if(!handler) return;
        off.call(target, event, handler);
        delete listeners[event];
        if(!--this._listenersCount){
          clearRefs();
        }
      }else{
        events= ownKeys(listeners);
        i= events.length;
        while(i-->0){
          event= events[i];
          off.call(target, event, listeners[event]);
        }
        this._listeners= {};
        this._listenersCount= 0;
        clearRefs();
      }
    }
  });

  function resolveOptions(options, schema, reducers, allowUnknown) {
    var computedOptions = Object.assign({}, schema);

    if (!options) return computedOptions;

    if (typeof options !== 'object') {
      throw TypeError('options must be an object')
    }

    var keys = Object.keys(options);
    var length = keys.length;
    var option, value;
    var reducer;

    function reject(reason) {
      throw Error('Invalid "' + option + '" option value' + (reason ? '. Reason: ' + reason : ''))
    }

    for (var i = 0; i < length; i++) {
      option = keys[i];
      if (!allowUnknown && !hasOwnProperty.call(schema, option)) {
        throw Error('Unknown "' + option + '" option');
      }
      value = options[option];
      if (value !== undefined) {
        reducer = reducers[option];
        computedOptions[option] = reducer ? reducer(value, reject) : value;
      }
    }
    return computedOptions;
  }

  function constructorReducer(value, reject) {
    if (typeof value !== 'function' || !value.hasOwnProperty('prototype')) {
      reject('value must be a constructor');
    }
    return value;
  }

  function makeTypeReducer(types) {
    var message= 'value must be type of ' + types.join('|');
    var len= types.length;
    var firstType= types[0];
    var secondType= types[1];

    if (len === 1) {
      return function (v, reject) {
        if (typeof v === firstType) {
          return v;
        }
        reject(message);
      }
    }

    if (len === 2) {
      return function (v, reject) {
        var kind= typeof v;
        if (kind === firstType || kind === secondType) return v;
        reject(message);
      }
    }

    return function (v, reject) {
      var kind = typeof v;
      var i = len;
      while (i-- > 0) {
        if (kind === types[i]) return v;
      }
      reject(message);
    }
  }

  var functionReducer= makeTypeReducer(['function']);

  var objectFunctionReducer= makeTypeReducer(['object', 'function']);

  function makeCancelablePromise(Promise, executor, options) {
    var isCancelable;
    var callbacks;
    var timer= 0;
    var subscriptionClosed;

    var promise = new Promise(function (resolve, reject, onCancel) {
      options= resolveOptions(options, {
        timeout: 0,
        overload: false
      }, {
        timeout: function(value, reject){
          value*= 1;
          if (typeof value !== 'number' || value < 0 || !Number.isFinite(value)) {
            reject('timeout must be a positive number');
          }
          return value;
        }
      });

      isCancelable = !options.overload && typeof Promise.prototype.cancel === 'function' && typeof onCancel === 'function';

      function cleanup() {
        if (callbacks) {
          callbacks = null;
        }
        if (timer) {
          clearTimeout(timer);
          timer = 0;
        }
      }

      var _resolve= function(value){
        cleanup();
        resolve(value);
      };

      var _reject= function(err){
        cleanup();
        reject(err);
      };

      if (isCancelable) {
        executor(_resolve, _reject, onCancel);
      } else {
        callbacks = [function(reason){
          _reject(reason || Error('canceled'));
        }];
        executor(_resolve, _reject, function (cb) {
          if (subscriptionClosed) {
            throw Error('Unable to subscribe on cancel event asynchronously')
          }
          if (typeof cb !== 'function') {
            throw TypeError('onCancel callback must be a function');
          }
          callbacks.push(cb);
        });
        subscriptionClosed= true;
      }

      if (options.timeout > 0) {
        timer= setTimeout(function(){
          var reason= Error('timeout');
          reason.code = 'ETIMEDOUT'
          timer= 0;
          promise.cancel(reason);
          reject(reason);
        }, options.timeout);
      }
    });

    if (!isCancelable) {
      promise.cancel = function (reason) {
        if (!callbacks) {
          return;
        }
        var length = callbacks.length;
        for (var i = 1; i < length; i++) {
          callbacks[i](reason);
        }
        // internal callback to reject the promise
        callbacks[0](reason);
        callbacks = null;
      };
    }

    return promise;
  }

  function findTargetIndex(observer) {
    var observers = this._observers;
    if(!observers){
      return -1;
    }
    var len = observers.length;
    for (var i = 0; i < len; i++) {
      if (observers[i]._target === observer) return i;
    }
    return -1;
  }

  // Attention, function return type now is array, always !
  // It has zero elements if no any matches found and one or more
  // elements (leafs) if there are matches
  //
  function searchListenerTree(handlers, type, tree, i, typeLength) {
    if (!tree) {
      return null;
    }

    if (i === 0) {
      var kind = typeof type;
      if (kind === 'string') {
        var ns, n, l = 0, j = 0, delimiter = this.delimiter, dl = delimiter.length;
        if ((n = type.indexOf(delimiter)) !== -1) {
          ns = new Array(5);
          do {
            ns[l++] = type.slice(j, n);
            j = n + dl;
          } while ((n = type.indexOf(delimiter, j)) !== -1);

          ns[l++] = type.slice(j);
          type = ns;
          typeLength = l;
        } else {
          type = [type];
          typeLength = 1;
        }
      } else if (kind === 'object') {
        typeLength = type.length;
      } else {
        type = [type];
        typeLength = 1;
      }
    }

    var listeners= null, branch, xTree, xxTree, isolatedBranch, endReached, currentType = type[i],
        nextType = type[i + 1], branches, _listeners;

    if (i === typeLength) {
      //
      // If at the end of the event(s) list and the tree has listeners
      // invoke those listeners.
      //

      if(tree._listeners) {
        if (typeof tree._listeners === 'function') {
          handlers && handlers.push(tree._listeners);
          listeners = [tree];
        } else {
          handlers && handlers.push.apply(handlers, tree._listeners);
          listeners = [tree];
        }
      }
    } else {

      if (currentType === '*') {
        //
        // If the event emitted is '*' at this part
        // or there is a concrete match at this patch
        //
        branches = ownKeys(tree);
        n = branches.length;
        while (n-- > 0) {
          branch = branches[n];
          if (branch !== '_listeners') {
            _listeners = searchListenerTree(handlers, type, tree[branch], i + 1, typeLength);
            if (_listeners) {
              if (listeners) {
                listeners.push.apply(listeners, _listeners);
              } else {
                listeners = _listeners;
              }
            }
          }
        }
        return listeners;
      } else if (currentType === '**') {
        endReached = (i + 1 === typeLength || (i + 2 === typeLength && nextType === '*'));
        if (endReached && tree._listeners) {
          // The next element has a _listeners, add it to the handlers.
          listeners = searchListenerTree(handlers, type, tree, typeLength, typeLength);
        }

        branches = ownKeys(tree);
        n = branches.length;
        while (n-- > 0) {
          branch = branches[n];
          if (branch !== '_listeners') {
            if (branch === '*' || branch === '**') {
              if (tree[branch]._listeners && !endReached) {
                _listeners = searchListenerTree(handlers, type, tree[branch], typeLength, typeLength);
                if (_listeners) {
                  if (listeners) {
                    listeners.push.apply(listeners, _listeners);
                  } else {
                    listeners = _listeners;
                  }
                }
              }
              _listeners = searchListenerTree(handlers, type, tree[branch], i, typeLength);
            } else if (branch === nextType) {
              _listeners = searchListenerTree(handlers, type, tree[branch], i + 2, typeLength);
            } else {
              // No match on this one, shift into the tree but not in the type array.
              _listeners = searchListenerTree(handlers, type, tree[branch], i, typeLength);
            }
            if (_listeners) {
              if (listeners) {
                listeners.push.apply(listeners, _listeners);
              } else {
                listeners = _listeners;
              }
            }
          }
        }
        return listeners;
      } else if (tree[currentType]) {
        listeners = searchListenerTree(handlers, type, tree[currentType], i + 1, typeLength);
      }
    }

      xTree = tree['*'];
    if (xTree) {
      //
      // If the listener tree will allow any match for this part,
      // then recursively explore all branches of the tree
      //
      searchListenerTree(handlers, type, xTree, i + 1, typeLength);
    }

    xxTree = tree['**'];
    if (xxTree) {
      if (i < typeLength) {
        if (xxTree._listeners) {
          // If we have a listener on a '**', it will catch all, so add its handler.
          searchListenerTree(handlers, type, xxTree, typeLength, typeLength);
        }

        // Build arrays of matching next branches and others.
        branches= ownKeys(xxTree);
        n= branches.length;
        while(n-->0){
          branch= branches[n];
          if (branch !== '_listeners') {
            if (branch === nextType) {
              // We know the next element will match, so jump twice.
              searchListenerTree(handlers, type, xxTree[branch], i + 2, typeLength);
            } else if (branch === currentType) {
              // Current node matches, move into the tree.
              searchListenerTree(handlers, type, xxTree[branch], i + 1, typeLength);
            } else {
              isolatedBranch = {};
              isolatedBranch[branch] = xxTree[branch];
              searchListenerTree(handlers, type, {'**': isolatedBranch}, i + 1, typeLength);
            }
          }
        }
      } else if (xxTree._listeners) {
        // We have reached the end and still on a '**'
        searchListenerTree(handlers, type, xxTree, typeLength, typeLength);
      } else if (xxTree['*'] && xxTree['*']._listeners) {
        searchListenerTree(handlers, type, xxTree['*'], typeLength, typeLength);
      }
    }

    return listeners;
  }

  function growListenerTree(type, listener, prepend) {
    var len = 0, j = 0, i, delimiter = this.delimiter, dl= delimiter.length, ns;

    if(typeof type==='string') {
      if ((i = type.indexOf(delimiter)) !== -1) {
        ns = new Array(5);
        do {
          ns[len++] = type.slice(j, i);
          j = i + dl;
        } while ((i = type.indexOf(delimiter, j)) !== -1);

        ns[len++] = type.slice(j);
      }else{
        ns= [type];
        len= 1;
      }
    }else{
      ns= type;
      len= type.length;
    }

    //
    // Looks for two consecutive '**', if so, don't add the event at all.
    //
    if (len > 1) {
      for (i = 0; i + 1 < len; i++) {
        if (ns[i] === '**' && ns[i + 1] === '**') {
          return;
        }
      }
    }



    var tree = this.listenerTree, name;

    for (i = 0; i < len; i++) {
      name = ns[i];

      tree = tree[name] || (tree[name] = {});

      if (i === len - 1) {
        if (!tree._listeners) {
          tree._listeners = listener;
        } else {
          if (typeof tree._listeners === 'function') {
            tree._listeners = [tree._listeners];
          }

          if (prepend) {
            tree._listeners.unshift(listener);
          } else {
            tree._listeners.push(listener);
          }

          if (
              !tree._listeners.warned &&
              this._maxListeners > 0 &&
              tree._listeners.length > this._maxListeners
          ) {
            tree._listeners.warned = true;
            logPossibleMemoryLeak.call(this, tree._listeners.length, name);
          }
        }
        return true;
      }
    }

    return true;
  }

  function collectTreeEvents(tree, events, root, asArray){
     var branches= ownKeys(tree);
     var i= branches.length;
     var branch, branchName, path;
     var hasListeners= tree['_listeners'];
     var isArrayPath;

     while(i-->0){
         branchName= branches[i];

         branch= tree[branchName];

         if(branchName==='_listeners'){
             path= root;
         }else {
             path = root ? root.concat(branchName) : [branchName];
         }

         isArrayPath= asArray || typeof branchName==='symbol';

         hasListeners && events.push(isArrayPath? path : path.join(this.delimiter));

         if(typeof branch==='object'){
             collectTreeEvents.call(this, branch, events, path, isArrayPath);
         }
     }

     return events;
  }

  function recursivelyGarbageCollect(root) {
    var keys = ownKeys(root);
    var i= keys.length;
    var obj, key, flag;
    while(i-->0){
      key = keys[i];
      obj = root[key];

      if(obj){
          flag= true;
          if(key !== '_listeners' && !recursivelyGarbageCollect(obj)){
             delete root[key];
          }
      }
    }

    return flag;
  }

  function Listener(emitter, event, listener){
    this.emitter= emitter;
    this.event= event;
    this.listener= listener;
  }

  Listener.prototype.off= function(){
    this.emitter.off(this.event, this.listener);
    return this;
  };

  function setupListener(event, listener, options){
      if (options === true) {
        promisify = true;
      } else if (options === false) {
        async = true;
      } else {
        if (!options || typeof options !== 'object') {
          throw TypeError('options should be an object or true');
        }
        var async = options.async;
        var promisify = options.promisify;
        var nextTick = options.nextTick;
        var objectify = options.objectify;
      }

      if (async || nextTick || promisify) {
        var _listener = listener;
        var _origin = listener._origin || listener;

        if (nextTick && !nextTickSupported) {
          throw Error('process.nextTick is not supported');
        }

        if (promisify === undefined) {
          promisify = listener.constructor.name === 'AsyncFunction';
        }

        listener = function () {
          var args = arguments;
          var context = this;
          var event = this.event;

          return promisify ? (nextTick ? Promise.resolve() : new Promise(function (resolve) {
            _setImmediate(resolve);
          }).then(function () {
            context.event = event;
            return _listener.apply(context, args)
          })) : (nextTick ? process.nextTick : _setImmediate)(function () {
            context.event = event;
            _listener.apply(context, args)
          });
        };

        listener._async = true;
        listener._origin = _origin;
      }

    return [listener, objectify? new Listener(this, event, listener): this];
  }

  function EventEmitter(conf) {
    this._events = {};
    this._newListener = false;
    this._removeListener = false;
    this.verboseMemoryLeak = false;
    configure.call(this, conf);
  }

  EventEmitter.EventEmitter2 = EventEmitter; // backwards compatibility for exporting EventEmitter property

  EventEmitter.prototype.listenTo= function(target, events, options){
    if(typeof target!=='object'){
      throw TypeError('target musts be an object');
    }

    var emitter= this;

    options = resolveOptions(options, {
      on: undefined,
      off: undefined,
      reducers: undefined
    }, {
      on: functionReducer,
      off: functionReducer,
      reducers: objectFunctionReducer
    });

    function listen(events){
      if(typeof events!=='object'){
        throw TypeError('events must be an object');
      }

      var reducers= options.reducers;
      var index= findTargetIndex.call(emitter, target);
      var observer;

      if(index===-1){
        observer= new TargetObserver(emitter, target, options);
      }else{
        observer= emitter._observers[index];
      }

      var keys= ownKeys(events);
      var len= keys.length;
      var event;
      var isSingleReducer= typeof reducers==='function';

      for(var i=0; i<len; i++){
        event= keys[i];
        observer.subscribe(
            event,
            events[event] || event,
            isSingleReducer ? reducers : reducers && reducers[event]
        );
      }
    }

    isArray(events)?
        listen(toObject(events)) :
        (typeof events==='string'? listen(toObject(events.split(/\s+/))): listen(events));

    return this;
  };

  EventEmitter.prototype.stopListeningTo = function (target, event) {
    var observers = this._observers;

    if(!observers){
      return false;
    }

    var i = observers.length;
    var observer;
    var matched= false;

    if(target && typeof target!=='object'){
      throw TypeError('target should be an object');
    }

    while (i-- > 0) {
      observer = observers[i];
      if (!target || observer._target === target) {
        observer.unsubscribe(event);
        matched= true;
      }
    }

    return matched;
  };

  // By default EventEmitters will print a warning if more than
  // 10 listeners are added to it. This is a useful default which
  // helps finding memory leaks.
  //
  // Obviously not all Emitters should be limited to 10. This function allows
  // that to be increased. Set to zero for unlimited.

  EventEmitter.prototype.delimiter = '.';

  EventEmitter.prototype.setMaxListeners = function(n) {
    if (n !== undefined) {
      this._maxListeners = n;
      if (!this._conf) this._conf = {};
      this._conf.maxListeners = n;
    }
  };

  EventEmitter.prototype.getMaxListeners = function() {
    return this._maxListeners;
  };

  EventEmitter.prototype.event = '';

  EventEmitter.prototype.once = function(event, fn, options) {
    return this._once(event, fn, false, options);
  };

  EventEmitter.prototype.prependOnceListener = function(event, fn, options) {
    return this._once(event, fn, true, options);
  };

  EventEmitter.prototype._once = function(event, fn, prepend, options) {
    return this._many(event, 1, fn, prepend, options);
  };

  EventEmitter.prototype.many = function(event, ttl, fn, options) {
    return this._many(event, ttl, fn, false, options);
  };

  EventEmitter.prototype.prependMany = function(event, ttl, fn, options) {
    return this._many(event, ttl, fn, true, options);
  };

  EventEmitter.prototype._many = function(event, ttl, fn, prepend, options) {
    var self = this;

    if (typeof fn !== 'function') {
      throw new Error('many only accepts instances of Function');
    }

    function listener() {
      if (--ttl === 0) {
        self.off(event, listener);
      }
      return fn.apply(this, arguments);
    }

    listener._origin = fn;

    return this._on(event, listener, prepend, options);
  };

  EventEmitter.prototype.emit = function() {
    if (!this._events && !this._all) {
      return false;
    }

    this._events || init.call(this);

    var type = arguments[0], ns, wildcard= this.wildcard;
    var args,l,i,j, containsSymbol;

    if (type === 'newListener' && !this._newListener) {
      if (!this._events.newListener) {
        return false;
      }
    }

    if (wildcard) {
      ns= type;
      if(type!=='newListener' && type!=='removeListener'){
        if (typeof type === 'object') {
          l = type.length;
          if (symbolsSupported) {
            for (i = 0; i < l; i++) {
              if (typeof type[i] === 'symbol') {
                containsSymbol = true;
                break;
              }
            }
          }
          if (!containsSymbol) {
            type = type.join(this.delimiter);
          }
        }
      }
    }

    var al = arguments.length;
    var handler;

    if (this._all && this._all.length) {
      handler = this._all.slice();

      for (i = 0, l = handler.length; i < l; i++) {
        this.event = type;
        switch (al) {
        case 1:
          handler[i].call(this, type);
          break;
        case 2:
          handler[i].call(this, type, arguments[1]);
          break;
        case 3:
          handler[i].call(this, type, arguments[1], arguments[2]);
          break;
        default:
          handler[i].apply(this, arguments);
        }
      }
    }

    if (wildcard) {
      handler = [];
      searchListenerTree.call(this, handler, ns, this.listenerTree, 0, l);
    } else {
      handler = this._events[type];
      if (typeof handler === 'function') {
        this.event = type;
        switch (al) {
        case 1:
          handler.call(this);
          break;
        case 2:
          handler.call(this, arguments[1]);
          break;
        case 3:
          handler.call(this, arguments[1], arguments[2]);
          break;
        default:
          args = new Array(al - 1);
          for (j = 1; j < al; j++) args[j - 1] = arguments[j];
          handler.apply(this, args);
        }
        return true;
      } else if (handler) {
        // need to make copy of handlers because list can change in the middle
        // of emit call
        handler = handler.slice();
      }
    }

    if (handler && handler.length) {
      if (al > 3) {
        args = new Array(al - 1);
        for (j = 1; j < al; j++) args[j - 1] = arguments[j];
      }
      for (i = 0, l = handler.length; i < l; i++) {
        this.event = type;
        switch (al) {
        case 1:
          handler[i].call(this);
          break;
        case 2:
          handler[i].call(this, arguments[1]);
          break;
        case 3:
          handler[i].call(this, arguments[1], arguments[2]);
          break;
        default:
          handler[i].apply(this, args);
        }
      }
      return true;
    } else if (!this.ignoreErrors && !this._all && type === 'error') {
      if (arguments[1] instanceof Error) {
        throw arguments[1]; // Unhandled 'error' event
      } else {
        throw new Error("Uncaught, unspecified 'error' event.");
      }
    }

    return !!this._all;
  };

  EventEmitter.prototype.emitAsync = function() {
    if (!this._events && !this._all) {
      return false;
    }

    this._events || init.call(this);

    var type = arguments[0], wildcard= this.wildcard, ns, containsSymbol;
    var args,l,i,j;

    if (type === 'newListener' && !this._newListener) {
        if (!this._events.newListener) { return Promise.resolve([false]); }
    }

    if (wildcard) {
      ns= type;
      if(type!=='newListener' && type!=='removeListener'){
        if (typeof type === 'object') {
          l = type.length;
          if (symbolsSupported) {
            for (i = 0; i < l; i++) {
              if (typeof type[i] === 'symbol') {
                containsSymbol = true;
                break;
              }
            }
          }
          if (!containsSymbol) {
            type = type.join(this.delimiter);
          }
        }
      }
    }

    var promises= [];

    var al = arguments.length;
    var handler;

    if (this._all) {
      for (i = 0, l = this._all.length; i < l; i++) {
        this.event = type;
        switch (al) {
        case 1:
          promises.push(this._all[i].call(this, type));
          break;
        case 2:
          promises.push(this._all[i].call(this, type, arguments[1]));
          break;
        case 3:
          promises.push(this._all[i].call(this, type, arguments[1], arguments[2]));
          break;
        default:
          promises.push(this._all[i].apply(this, arguments));
        }
      }
    }

    if (wildcard) {
      handler = [];
      searchListenerTree.call(this, handler, ns, this.listenerTree, 0);
    } else {
      handler = this._events[type];
    }

    if (typeof handler === 'function') {
      this.event = type;
      switch (al) {
      case 1:
        promises.push(handler.call(this));
        break;
      case 2:
        promises.push(handler.call(this, arguments[1]));
        break;
      case 3:
        promises.push(handler.call(this, arguments[1], arguments[2]));
        break;
      default:
        args = new Array(al - 1);
        for (j = 1; j < al; j++) args[j - 1] = arguments[j];
        promises.push(handler.apply(this, args));
      }
    } else if (handler && handler.length) {
      handler = handler.slice();
      if (al > 3) {
        args = new Array(al - 1);
        for (j = 1; j < al; j++) args[j - 1] = arguments[j];
      }
      for (i = 0, l = handler.length; i < l; i++) {
        this.event = type;
        switch (al) {
        case 1:
          promises.push(handler[i].call(this));
          break;
        case 2:
          promises.push(handler[i].call(this, arguments[1]));
          break;
        case 3:
          promises.push(handler[i].call(this, arguments[1], arguments[2]));
          break;
        default:
          promises.push(handler[i].apply(this, args));
        }
      }
    } else if (!this.ignoreErrors && !this._all && type === 'error') {
      if (arguments[1] instanceof Error) {
        return Promise.reject(arguments[1]); // Unhandled 'error' event
      } else {
        return Promise.reject("Uncaught, unspecified 'error' event.");
      }
    }

    return Promise.all(promises);
  };

  EventEmitter.prototype.on = function(type, listener, options) {
    return this._on(type, listener, false, options);
  };

  EventEmitter.prototype.prependListener = function(type, listener, options) {
    return this._on(type, listener, true, options);
  };

  EventEmitter.prototype.onAny = function(fn) {
    return this._onAny(fn, false);
  };

  EventEmitter.prototype.prependAny = function(fn) {
    return this._onAny(fn, true);
  };

  EventEmitter.prototype.addListener = EventEmitter.prototype.on;

  EventEmitter.prototype._onAny = function(fn, prepend){
    if (typeof fn !== 'function') {
      throw new Error('onAny only accepts instances of Function');
    }

    if (!this._all) {
      this._all = [];
    }

    // Add the function to the event listener collection.
    if(prepend){
      this._all.unshift(fn);
    }else{
      this._all.push(fn);
    }

    return this;
  };

  EventEmitter.prototype._on = function(type, listener, prepend, options) {
    if (typeof type === 'function') {
      this._onAny(type, listener);
      return this;
    }

    if (typeof listener !== 'function') {
      throw new Error('on only accepts instances of Function');
    }
    this._events || init.call(this);

    var returnValue= this, temp;

    if (options !== undefined) {
      temp = setupListener.call(this, type, listener, options);
      listener = temp[0];
      returnValue = temp[1];
    }

    // To avoid recursion in the case that type == "newListeners"! Before
    // adding it to the listeners, first emit "newListeners".
    if (this._newListener) {
      this.emit('newListener', type, listener);
    }

    if (this.wildcard) {
      growListenerTree.call(this, type, listener, prepend);
      return returnValue;
    }

    if (!this._events[type]) {
      // Optimize the case of one listener. Don't need the extra array object.
      this._events[type] = listener;
    } else {
      if (typeof this._events[type] === 'function') {
        // Change to array.
        this._events[type] = [this._events[type]];
      }

      // If we've already got an array, just add
      if(prepend){
        this._events[type].unshift(listener);
      }else{
        this._events[type].push(listener);
      }

      // Check for listener leak
      if (
        !this._events[type].warned &&
        this._maxListeners > 0 &&
        this._events[type].length > this._maxListeners
      ) {
        this._events[type].warned = true;
        logPossibleMemoryLeak.call(this, this._events[type].length, type);
      }
    }

    return returnValue;
  };

  EventEmitter.prototype.off = function(type, listener) {
    if (typeof listener !== 'function') {
      throw new Error('removeListener only takes instances of Function');
    }

    var handlers,leafs=[];

    if(this.wildcard) {
      var ns = typeof type === 'string' ? type.split(this.delimiter) : type.slice();
      leafs = searchListenerTree.call(this, null, ns, this.listenerTree, 0);
      if(!leafs) return this;
    } else {
      // does not use listeners(), so no side effect of creating _events[type]
      if (!this._events[type]) return this;
      handlers = this._events[type];
      leafs.push({_listeners:handlers});
    }

    for (var iLeaf=0; iLeaf<leafs.length; iLeaf++) {
      var leaf = leafs[iLeaf];
      handlers = leaf._listeners;
      if (isArray(handlers)) {

        var position = -1;

        for (var i = 0, length = handlers.length; i < length; i++) {
          if (handlers[i] === listener ||
            (handlers[i].listener && handlers[i].listener === listener) ||
            (handlers[i]._origin && handlers[i]._origin === listener)) {
            position = i;
            break;
          }
        }

        if (position < 0) {
          continue;
        }

        if(this.wildcard) {
          leaf._listeners.splice(position, 1);
        }
        else {
          this._events[type].splice(position, 1);
        }

        if (handlers.length === 0) {
          if(this.wildcard) {
            delete leaf._listeners;
          }
          else {
            delete this._events[type];
          }
        }
        if (this._removeListener)
          this.emit("removeListener", type, listener);

        return this;
      }
      else if (handlers === listener ||
        (handlers.listener && handlers.listener === listener) ||
        (handlers._origin && handlers._origin === listener)) {
        if(this.wildcard) {
          delete leaf._listeners;
        }
        else {
          delete this._events[type];
        }
        if (this._removeListener)
          this.emit("removeListener", type, listener);
      }
    }

    this.listenerTree && recursivelyGarbageCollect(this.listenerTree);

    return this;
  };

  EventEmitter.prototype.offAny = function(fn) {
    var i = 0, l = 0, fns;
    if (fn && this._all && this._all.length > 0) {
      fns = this._all;
      for(i = 0, l = fns.length; i < l; i++) {
        if(fn === fns[i]) {
          fns.splice(i, 1);
          if (this._removeListener)
            this.emit("removeListenerAny", fn);
          return this;
        }
      }
    } else {
      fns = this._all;
      if (this._removeListener) {
        for(i = 0, l = fns.length; i < l; i++)
          this.emit("removeListenerAny", fns[i]);
      }
      this._all = [];
    }
    return this;
  };

  EventEmitter.prototype.removeListener = EventEmitter.prototype.off;

  EventEmitter.prototype.removeAllListeners = function (type) {
    if (type === undefined) {
      !this._events || init.call(this);
      return this;
    }

    if (this.wildcard) {
      var leafs = searchListenerTree.call(this, null, type, this.listenerTree, 0), leaf, i;
      if (!leafs) return this;
      for (i = 0; i < leafs.length; i++) {
        leaf = leafs[i];
        leaf._listeners = null;
      }
      this.listenerTree && recursivelyGarbageCollect(this.listenerTree);
    } else if (this._events) {
      this._events[type] = null;
    }
    return this;
  };

  EventEmitter.prototype.listeners = function (type) {
    var _events = this._events;
    var keys, listeners, allListeners;
    var i;
    var listenerTree;

    if (type === undefined) {
      if (this.wildcard) {
        throw Error('event name required for wildcard emitter');
      }

      if (!_events) {
        return [];
      }

      keys = ownKeys(_events);
      i = keys.length;
      allListeners = [];
      while (i-- > 0) {
        listeners = _events[keys[i]];
        if (typeof listeners === 'function') {
          allListeners.push(listeners);
        } else {
          allListeners.push.apply(allListeners, listeners);
        }
      }
      return allListeners;
    } else {
      if (this.wildcard) {
        listenerTree= this.listenerTree;
        if(!listenerTree) return [];
        var handlers = [];
        var ns = typeof type === 'string' ? type.split(this.delimiter) : type.slice();
        searchListenerTree.call(this, handlers, ns, listenerTree, 0);
        return handlers;
      }

      if (!_events) {
        return [];
      }

      listeners = _events[type];

      if (!listeners) {
        return [];
      }
      return typeof listeners === 'function' ? [listeners] : listeners;
    }
  };

  EventEmitter.prototype.eventNames = function(nsAsArray){
    var _events= this._events;
    return this.wildcard? collectTreeEvents.call(this, this.listenerTree, [], null, nsAsArray) : (_events? ownKeys(_events) : []);
  };

  EventEmitter.prototype.listenerCount = function(type) {
    return this.listeners(type).length;
  };

  EventEmitter.prototype.hasListeners = function (type) {
    if (this.wildcard) {
      var handlers = [];
      var ns = typeof type === 'string' ? type.split(this.delimiter) : type.slice();
      searchListenerTree.call(this, handlers, ns, this.listenerTree, 0);
      return handlers.length > 0;
    }

    var _events = this._events;
    var _all = this._all;

    return !!(_all && _all.length || _events && (type === undefined ? ownKeys(_events).length : _events[type]));
  };

  EventEmitter.prototype.listenersAny = function() {

    if(this._all) {
      return this._all;
    }
    else {
      return [];
    }

  };

  EventEmitter.prototype.waitFor = function (event, options) {
    var self = this;
    var type = typeof options;
    if (type === 'number') {
      options = {timeout: options};
    } else if (type === 'function') {
      options = {filter: options};
    }

    options= resolveOptions(options, {
      timeout: 0,
      filter: undefined,
      handleError: false,
      Promise: Promise,
      overload: false
    }, {
      filter: functionReducer,
      Promise: constructorReducer
    });

    return makeCancelablePromise(options.Promise, function (resolve, reject, onCancel) {
      function listener() {
        var filter= options.filter;
        if (filter && !filter.apply(self, arguments)) {
          return;
        }
        self.off(event, listener);
        if (options.handleError) {
          var err = arguments[0];
          err ? reject(err) : resolve(toArray.apply(null, arguments).slice(1));
        } else {
          resolve(toArray.apply(null, arguments));
        }
      }

      onCancel(function(){
        self.off(event, listener);
      });

      self._on(event, listener, false);
    }, {
      timeout: options.timeout,
      overload: options.overload
    })
  };

  function once(emitter, name, options) {
    options= resolveOptions(options, {
      Promise: Promise,
      timeout: 0,
      overload: false
    }, {
      Promise: constructorReducer
    });

    var _Promise= options.Promise;

    return makeCancelablePromise(_Promise, function(resolve, reject, onCancel){
      var handler;
      if (typeof emitter.addEventListener === 'function') {
        handler=  function () {
          resolve(toArray.apply(null, arguments));
        };

        onCancel(function(){
          emitter.removeEventListener(name, handler);
        });

        emitter.addEventListener(
            name,
            handler,
            {once: true}
        );
        return;
      }

      var eventListener = function(){
        errorListener && emitter.removeListener('error', errorListener);
        resolve(toArray.apply(null, arguments));
      };

      var errorListener;

      if (name !== 'error') {
        errorListener = function (err){
          emitter.removeListener(name, eventListener);
          reject(err);
        };

        emitter.once('error', errorListener);
      }

      onCancel(function(){
        errorListener && emitter.removeListener('error', errorListener);
        emitter.removeListener(name, eventListener);
      });

      emitter.once(name, eventListener);
    }, {
      timeout: options.timeout,
      overload: options.overload
    });
  }

  var prototype= EventEmitter.prototype;

  Object.defineProperties(EventEmitter, {
    defaultMaxListeners: {
      get: function () {
        return prototype._maxListeners;
      },
      set: function (n) {
        if (typeof n !== 'number' || n < 0 || Number.isNaN(n)) {
          throw TypeError('n must be a non-negative number')
        }
        prototype._maxListeners = n;
      },
      enumerable: true
    },
    once: {
      value: once,
      writable: true,
      configurable: true
    }
  });

  Object.defineProperties(prototype, {
      _maxListeners: {
          value: defaultMaxListeners,
          writable: true,
          configurable: true
      },
      _observers: {value: null, writable: true, configurable: true}
  });

  if (true) {
     // AMD. Register as an anonymous module.
    !(__WEBPACK_AMD_DEFINE_RESULT__ = (function() {
      return EventEmitter;
    }).call(exports, __webpack_require__, exports, module),
		__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
  } else { var _global; }
}();


/***/ }),

/***/ "./node_modules/.pnpm/garfish@1.16.2/node_modules/garfish/dist/esm/index.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/.pnpm/garfish@1.16.2/node_modules/garfish/dist/esm/index.js ***!
  \**********************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Garfish: function() { return /* reexport safe */ _garfish_core__WEBPACK_IMPORTED_MODULE_0__["default"]; },
/* harmony export */   "default": function() { return /* binding */ GarfishInstance; },
/* harmony export */   defineCustomElements: function() { return /* binding */ defineCustomElements; }
/* harmony export */ });
/* harmony import */ var _garfish_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @garfish/core */ "./node_modules/.pnpm/@garfish+core@1.16.2/node_modules/@garfish/core/dist/esm/index.js");
/* harmony import */ var _garfish_router__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @garfish/router */ "./node_modules/.pnpm/@garfish+router@1.16.2/node_modules/@garfish/router/dist/esm/index.js");
/* harmony import */ var _garfish_browser_vm__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @garfish/browser-vm */ "./node_modules/.pnpm/@garfish+browser-vm@1.16.2/node_modules/@garfish/browser-vm/dist/esm/index.js");
/* harmony import */ var _garfish_browser_snapshot__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @garfish/browser-snapshot */ "./node_modules/.pnpm/@garfish+browser-snapshot@1.16.2/node_modules/@garfish/browser-snapshot/dist/esm/index.js");
/* harmony import */ var _garfish_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @garfish/utils */ "./node_modules/.pnpm/@garfish+utils@1.16.2/node_modules/@garfish/utils/dist/esm/index.js");
/* provided dependency */ var process = __webpack_require__(/*! process/browser */ "./node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");
// src/index.ts


// src/instance.ts





function createContext() {
  let fresh = false;
  if ((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_4__.inBrowser)() && window["__GARFISH__"] && window["Garfish"]) {
    return window["Garfish"];
  }
  const GarfishInstance2 = new _garfish_core__WEBPACK_IMPORTED_MODULE_0__["default"]({
    plugins: [(0,_garfish_router__WEBPACK_IMPORTED_MODULE_1__.GarfishRouter)(), (0,_garfish_browser_vm__WEBPACK_IMPORTED_MODULE_2__.GarfishBrowserVm)(), (0,_garfish_browser_snapshot__WEBPACK_IMPORTED_MODULE_3__.GarfishBrowserSnapshot)()]
  });
  const set = (namespace, val = GarfishInstance2) => {
    if ((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_4__.hasOwn)(window, namespace)) {
      if (!(window[namespace] && window[namespace].flag === _garfish_utils__WEBPACK_IMPORTED_MODULE_4__.__GARFISH_FLAG__)) {
        const next = () => {
          fresh = true;
          if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
            (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_4__.warn)(`"Window.${namespace}" will be overwritten by "garfish".`);
          }
        };
        const desc = Object.getOwnPropertyDescriptor(window, namespace);
        if (desc) {
          if (desc.configurable) {
            (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_4__.def)(window, namespace, val);
            next();
          } else if (desc.writable) {
            window[namespace] = val;
            next();
          }
        }
      }
    } else {
      fresh = true;
      (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_4__.def)(window, namespace, val);
    }
  };
  if ((0,_garfish_utils__WEBPACK_IMPORTED_MODULE_4__.inBrowser)()) {
    set("Garfish");
    (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_4__.def)(window, "__GARFISH__", true);
  }
  if (fresh) {
    if (typeof process !== "undefined" && {"WEBIDE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webide.vmoptions","PYCHARM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/pycharm.vmoptions","NVM_CD_FLAGS":"-q","SHELL":"/bin/zsh","TERM":"xterm-256color","JETBRAINSCLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrainsclient.vmoptions","TMPDIR":"/var/folders/jk/ys2t7b4n0fn86hc044wmp9w80000gn/T/","GVM_ROOT":"/Users/liangpingbo/.gvm","TERM_SESSION_ID":"c7db472b-24c8-4613-ba57-d10e8483fbec","PNPM_HOME":"/Users/liangpingbo/Library/pnpm","ZSH":"/Users/liangpingbo/.oh-my-zsh","NVM_DIR":"/Users/liangpingbo/.nvm","USER":"liangpingbo","COMMAND_MODE":"unix2003","PHPSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/phpstorm.vmoptions","SSH_AUTH_SOCK":"/private/tmp/com.apple.launchd.qZp6aPIsuM/Listeners","__CF_USER_TEXT_ENCODING":"0x1F5:0x19:0x34","GOLAND_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/goland.vmoptions","PAGER":"less","APPCODE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/appcode.vmoptions","FIG_JETBRAINS_SHELL_INTEGRATION":"1","LSCOLORS":"Gxfxcxdxbxegedabagacad","PATH":"/Library/Frameworks/Python.framework/Versions/3.9/bin:/Users/liangpingbo/.meteor:/Users/liangpingbo/Library/pnpm:/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin:/usr/local/mysql/bin","TERMINAL_EMULATOR":"JetBrains-JediTerm","__CFBundleIdentifier":"com.jetbrains.WebStorm","GVM_VERSION":"1.0.22","PWD":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo","IDEA_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/idea.vmoptions","CLION_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/clion.vmoptions","NODE_PATH":"/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/bin/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/src/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules/cross-env/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/cross-env@7.0.3/node_modules:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.pnpm/node_modules","XPC_FLAGS":"0x0","WEBSTORM_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/webstorm.vmoptions","DATASPELL_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/dataspell.vmoptions","XPC_SERVICE_NAME":"0","SHLVL":"1","HOME":"/Users/liangpingbo","LESS":"-R","LOGNAME":"liangpingbo","LC_CTYPE":"UTF-8","GATEWAY_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/gateway.vmoptions","NVM_BIN":"/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin","DATAGRIP_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/datagrip.vmoptions","JETBRAINS_CLIENT_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/jetbrains_client.vmoptions","RIDER_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rider.vmoptions","RUBYMINE_VM_OPTIONS":"/Users/liangpingbo/Desktop/ide_plugin/ja-netfilter-all/vmoptions/rubymine.vmoptions","GVM_PATH_BACKUP":"/Users/liangpingbo/.gvm/bin:/Users/liangpingbo/.nvm/versions/node/v18.14.0/bin:/Library/Frameworks/Python.framework/Versions/3.11/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/usr/local/go/bin:/usr/local/share/dotnet:~/.dotnet/tools:/Library/Apple/usr/bin:/Library/Frameworks/Mono.framework/Versions/Current/Commands:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/liangpingbo/Desktop/4399/frontend/subApplicate_demo/node_modules/.bin:/Users/liangpingbo/Desktop/个人/前端/flutter/flutter/bin","NODE_ENV":"development","API_PREFIX":"/api","API_TIMEOUT":"6000","COOKIE_NAME":"ywkf_jwt","APP_HOST":"127.0.0.1","APP_PORT":"8888","APP_CNAME":"子应用demo","APP_NAME":"demo","APP_DOMAIN":"https://nbas.gz4399.com"} && "development" ? "development" !== "production" : false) {
      if (window["Garfish"].version !== "1.16.2") {
        (0,_garfish_utils__WEBPACK_IMPORTED_MODULE_4__.warn)('The "garfish version" used by the main and sub-applications is inconsistent.');
      }
    }
  }
  return GarfishInstance2;
}
var GarfishInstance = createContext();

// src/customElement.ts
function generateCustomerElement(htmlTag, options) {
  class MicroApp extends HTMLElement {
    constructor() {
      super();
      this.appInfo = {
        name: "",
        entry: "",
        basename: ""
      };
      this.options = {
        delay: 200
      };
      this.state = this._observerAppState({
        isLoading: false,
        error: null,
        promise: null,
        loaded: null,
        pastDelay: false
      });
      this.options = options;
    }
    _observerAppState(state) {
      return new Proxy(state, {
        set: (target, p, value, receiver) => {
          const getPlaceHolderAndAppend = () => {
            if (this.placeholder && this.contains(this.placeholder)) {
              this.removeChild(this.placeholder);
            }
            const placeholder = this.options.loading && this.options.loading({
              isLoading: this.state.isLoading,
              error: this.state.error,
              pastDelay: this.state.pastDelay
            });
            placeholder && this.appendChild(placeholder);
            return placeholder;
          };
          const res = Reflect.set(target, p, value, receiver);
          if (p === "error" && value) {
            const placeholder = getPlaceHolderAndAppend();
            if (placeholder)
              this.placeholder = placeholder;
          } else if (p === "pastDelay" && value === true) {
            const placeholder = getPlaceHolderAndAppend();
            if (placeholder)
              this.placeholder = placeholder;
          } else if (p === "isLoading" && value === true) {
            const placeholder = getPlaceHolderAndAppend();
            if (placeholder)
              this.placeholder = placeholder;
          } else if (p === "isLoading" && value === false) {
            if (!this.state.error && this.contains(this.placeholder)) {
              this.removeChild(this.placeholder);
            }
          }
          return res;
        }
      });
    }
    _loadApp() {
      if (this.state.isLoading)
        return;
      this.state.isLoading = true;
      if (typeof this.options.delay === "number") {
        if (this.options.delay === 0) {
          this.state.pastDelay = true;
        } else {
          this._delay = setTimeout(() => {
            this.state.pastDelay = true;
          }, this.options.delay);
        }
      }
      this.state.promise = GarfishInstance.loadApp(this.appInfo.name, {
        entry: this.appInfo.entry,
        domGetter: () => this,
        basename: this.appInfo.basename,
        sandbox: {
          snapshot: false,
          strictIsolation: this.hasAttribute("shadow") || false
        }
      });
    }
    _clearTimeouts() {
      clearTimeout(this._delay);
    }
    async connectedCallback() {
      this.appInfo = {
        name: this.getAttribute("name") || "",
        entry: this.getAttribute("entry") || "",
        basename: this.getAttribute("basename") || "/"
      };
      try {
        this._loadApp();
        this.state.loaded = await this.state.promise;
        if (this.state.loaded.mounted) {
          this.state.loaded.show();
        } else {
          await this.state.loaded.mount();
        }
      } catch (error) {
        this.state.error = error;
      } finally {
        this.state.isLoading = false;
      }
    }
    disconnectedCallback() {
      this._clearTimeouts();
      if (this.state.loaded) {
        this.state.loaded.hide();
      }
    }
    async adoptedCallback() {
    }
    attributeChangedCallback(name, oldValue, newValue) {
      console.log("Custom square element attributes changed.", name, oldValue, newValue);
    }
  }
  if (!customElements.get(htmlTag)) {
    GarfishInstance.run(options.config || {});
    customElements.define(htmlTag, MicroApp);
  }
}
function createLoadableWebComponent(htmlTag, options) {
  if (typeof htmlTag !== "string") {
    throw new Error("garfish requires a `htmlTag` name");
  }
  if (!options.loading) {
    throw new Error("garfish requires a `loading` component");
  }
  const opts = Object.assign({
    loading: false,
    delay: 200,
    timeout: null
  }, options);
  return generateCustomerElement(htmlTag, opts);
}
function defineCustomElements(htmlTag, options) {
  return createLoadableWebComponent(htmlTag, options);
}



/***/ }),

/***/ "./node_modules/.pnpm/ms@2.1.2/node_modules/ms/index.js":
/*!**************************************************************!*\
  !*** ./node_modules/.pnpm/ms@2.1.2/node_modules/ms/index.js ***!
  \**************************************************************/
/***/ (function(module) {

/**
 * Helpers.
 */

var s = 1000;
var m = s * 60;
var h = m * 60;
var d = h * 24;
var w = d * 7;
var y = d * 365.25;

/**
 * Parse or format the given `val`.
 *
 * Options:
 *
 *  - `long` verbose formatting [false]
 *
 * @param {String|Number} val
 * @param {Object} [options]
 * @throws {Error} throw an error if val is not a non-empty string or a number
 * @return {String|Number}
 * @api public
 */

module.exports = function(val, options) {
  options = options || {};
  var type = typeof val;
  if (type === 'string' && val.length > 0) {
    return parse(val);
  } else if (type === 'number' && isFinite(val)) {
    return options.long ? fmtLong(val) : fmtShort(val);
  }
  throw new Error(
    'val is not a non-empty string or a valid number. val=' +
      JSON.stringify(val)
  );
};

/**
 * Parse the given `str` and return milliseconds.
 *
 * @param {String} str
 * @return {Number}
 * @api private
 */

function parse(str) {
  str = String(str);
  if (str.length > 100) {
    return;
  }
  var match = /^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(
    str
  );
  if (!match) {
    return;
  }
  var n = parseFloat(match[1]);
  var type = (match[2] || 'ms').toLowerCase();
  switch (type) {
    case 'years':
    case 'year':
    case 'yrs':
    case 'yr':
    case 'y':
      return n * y;
    case 'weeks':
    case 'week':
    case 'w':
      return n * w;
    case 'days':
    case 'day':
    case 'd':
      return n * d;
    case 'hours':
    case 'hour':
    case 'hrs':
    case 'hr':
    case 'h':
      return n * h;
    case 'minutes':
    case 'minute':
    case 'mins':
    case 'min':
    case 'm':
      return n * m;
    case 'seconds':
    case 'second':
    case 'secs':
    case 'sec':
    case 's':
      return n * s;
    case 'milliseconds':
    case 'millisecond':
    case 'msecs':
    case 'msec':
    case 'ms':
      return n;
    default:
      return undefined;
  }
}

/**
 * Short format for `ms`.
 *
 * @param {Number} ms
 * @return {String}
 * @api private
 */

function fmtShort(ms) {
  var msAbs = Math.abs(ms);
  if (msAbs >= d) {
    return Math.round(ms / d) + 'd';
  }
  if (msAbs >= h) {
    return Math.round(ms / h) + 'h';
  }
  if (msAbs >= m) {
    return Math.round(ms / m) + 'm';
  }
  if (msAbs >= s) {
    return Math.round(ms / s) + 's';
  }
  return ms + 'ms';
}

/**
 * Long format for `ms`.
 *
 * @param {Number} ms
 * @return {String}
 * @api private
 */

function fmtLong(ms) {
  var msAbs = Math.abs(ms);
  if (msAbs >= d) {
    return plural(ms, msAbs, d, 'day');
  }
  if (msAbs >= h) {
    return plural(ms, msAbs, h, 'hour');
  }
  if (msAbs >= m) {
    return plural(ms, msAbs, m, 'minute');
  }
  if (msAbs >= s) {
    return plural(ms, msAbs, s, 'second');
  }
  return ms + ' ms';
}

/**
 * Pluralization helper.
 */

function plural(ms, msAbs, n, name) {
  var isPlural = msAbs >= n * 1.5;
  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');
}


/***/ }),

/***/ "./node_modules/.pnpm/@alioth-org+es-module-lexer@1.1.0/node_modules/@alioth-org/es-module-lexer/dist/lexer.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@alioth-org+es-module-lexer@1.1.0/node_modules/@alioth-org/es-module-lexer/dist/lexer.js ***!
  \*********************************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   init: function() { return /* binding */ init; },
/* harmony export */   parse: function() { return /* binding */ parse; }
/* harmony export */ });
/* es-module-lexer 1.1.0 */
const A=1===new Uint8Array(new Uint16Array([1]).buffer)[0];function parse(E,g="@"){if(!C)return init().then((()=>parse(E)));const I=E.length+1,K=(C.__heap_base.value||C.__heap_base)+4*I-C.memory.buffer.byteLength;K>0&&C.memory.grow(Math.ceil(K/65536));const k=C.sa(I-1);if((A?B:Q)(E,new Uint16Array(C.memory.buffer,k,I)),!C.parse())throw Object.assign(new Error(`Parse error ${g}:${E.slice(0,C.e()).split("\n").length}:${C.e()-E.lastIndexOf("\n",C.e()-1)}`),{idx:C.e()});const o=[],D=[];for(;C.ri();){const A=C.is(),Q=C.ie(),B=C.ai(),g=C.id(),I=C.ss(),K=C.se();let k;C.ip()&&(k=w(E.slice(-1===g?A-1:A,-1===g?Q+1:Q))),o.push({n:k,s:A,e:Q,ss:I,se:K,d:g,a:B})}for(;C.re();){const A=C.es(),Q=C.ee(),B=C.els(),g=C.ele(),I=E.slice(A,Q),K=I[0],k=B<0?void 0:E.slice(B,g),o=k?k[0]:"";D.push({s:A,e:Q,ls:B,le:g,n:'"'===K||"'"===K?w(I):I,ln:'"'===o||"'"===o?w(k):k})}function w(A){try{return(0,eval)(A)}catch(A){}}return[o,D,!!C.f()]}function Q(A,Q){const B=A.length;let C=0;for(;C<B;){const B=A.charCodeAt(C);Q[C++]=(255&B)<<8|B>>>8}}function B(A,Q){const B=A.length;let C=0;for(;C<B;)Q[C]=A.charCodeAt(C++)}let C,E;const init=()=>{var A;return E||(E=WebAssembly.compile((A="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","undefined"!=typeof Buffer?Buffer.from(A,"base64"):Uint8Array.from(atob(A),(A=>A.charCodeAt(0))))).then(WebAssembly.instantiate).then((({exports:A})=>{C=A}))),E};

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfcG5wbV9hbnRkXzVfOF8wX21vbWVudF8yXzI5XzRfcmVhY3QtZG9tXzE4XzJfMF9yZWFjdF8xOF8yXzBfbm9kZV9tb2R1bGVzLTY0YmE1OC5iMjZmODlkMjFiZGE3OGM2Mjc5NC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixxQkFBcUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ2lHOztBQUVqRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQWV3QjtBQUN4QixxQkFBcUIsdURBQVE7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVC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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCxJQUFJLDRCQUE0QixJQUFJO0FBQzFGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLFlBQVk7QUFDakQsK0JBQStCLElBQUksSUFBSSxNQUFNO0FBQzdDLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QyxZQUFZO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsWUFBWTtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixhQUFhO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixhQUFhO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxzQkFBc0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsZ0NBQWdDO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsZ0JBQWdCO0FBQ3RDLE1BQU07QUFDTiw0QkFBNEIsS0FBSztBQUNqQyxrREFBa0QsS0FBSztBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsdUJBQXVCO0FBQ3JDO0FBQ0E7QUFDQSxvREFBb0QsSUFBSSxxQkFBcUIsS0FBSztBQUNsRixNQUFNO0FBQ04sY0FBYyxZQUFZO0FBQzFCLGdDQUFnQyxJQUFJO0FBQ3BDLG9EQUFvRCxJQUFJLDhCQUE4QixLQUFLO0FBQzNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsYUFBYTtBQUM5QjtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBLFlBQVk7QUFDWjtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRDtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLGdCQUFnQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxnQkFBZ0I7QUFDNUI7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGdCQUFnQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixnQkFBZ0I7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGlCQUFpQjtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxjQUFjO0FBQzNEO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGVBQWUsR0FBRyxhQUFhLEdBQUcsWUFBWTtBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxVQUFVO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxrRUFBa0UsVUFBVTtBQUM1RTtBQUNBOztBQUVBO0FBQ0Esc0JBQXNCLGFBQWE7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLE1BQU07QUFDTixzQkFBc0IsU0FBUztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQSxrQ0FBa0MsWUFBWTtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNnQztBQUNoQyxVQUFVLDRDQUFXO0FBQ3JCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLFlBQVk7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxZQUFZO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNkVFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUN6MEM2QjtBQUN4QjtBQUNQO0FBQ0EsRUFBRSxFQUFFLGtDQUFLO0FBQ0Y7QUFDUCwwREFBMEQsMkNBQWM7QUFDeEU7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiwrQ0FBa0IsaUVBQWlFO0FBQ3pHO0FBQ087QUFDUDtBQUNBOzs7Ozs7Ozs7OztBQ2ZBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxrQkFBa0I7QUFDbEIsWUFBWTtBQUNaLFlBQVk7QUFDWixpQkFBaUI7QUFDakIsZUFBZTtBQUNmLGVBQWU7QUFDZjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTs7QUFFQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0EsMENBQTBDOztBQUUxQzs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLG9CQUFvQixZQUFZO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFlBQVk7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsU0FBUztBQUM3QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7O0FBRVo7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNOztBQUVOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLE9BQU87QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxzQ0FBc0MsT0FBTztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLFFBQVE7QUFDOUI7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFFBQVE7QUFDNUI7QUFDQSxzQ0FBc0MsT0FBTztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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O0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLE1BQU07QUFDTixpQkFBaUI7QUFDakI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLOztBQUVMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FB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dUUsRUFBRSxjQUFjLElBQUksa0JBQWtCLFdBQVcsb0JBQW9CLGdCQUFnQixpQkFBaUIsUUFBUSxLQUFLLElBQUksRUFBRSx3QkFBd0IseUJBQXlCLGdCQUFnQixpQkFBaUIsUUFBUSxLQUFLLElBQUksd0JBQXdCLFFBQWUsZ0JBQWdCLE1BQU0sb3NWQUFvc1YsVUFBVSxJQUFJLElBQUkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly/lrZDlupTnlKhkZW1vLS8uL25vZGVfbW9kdWxlcy8ucG5wbS9AZ2FyZmlzaCticm93c2VyLXNuYXBzaG90QDEuMTYuMi9ub2RlX21vZHVsZXMvQGdhcmZpc2gvYnJvd3Nlci1zbmFwc2hvdC9kaXN0L2VzbS9pbmRleC5qcyIsIndlYnBhY2s6Ly/lrZDlupTnlKhkZW1vLS8uL25vZGVfbW9kdWxlcy8ucG5wbS9AZ2FyZmlzaCticm93c2VyLXZtQDEuMTYuMi9ub2RlX21vZHVsZXMvQGdhcmZpc2gvYnJvd3Nlci12bS9kaXN0L2VzbS9pbmRleC5qcyIsIndlYnBhY2s6Ly/lrZDlupTnlKhkZW1vLS8uL25vZGVfbW9kdWxlcy8ucG5wbS9AZ2FyZmlzaCtjb3JlQDEuMTYuMi9ub2RlX21vZHVsZXMvQGdhcmZpc2gvY29yZS9kaXN0L2VzbS9pbmRleC5qcyIsIndlYnBhY2s6Ly/lrZDlupTnlKhkZW1vLS8uL25vZGVfbW9kdWxlcy8ucG5wbS9AZ2FyZmlzaCtob29rc0AxLjE2LjIvbm9kZV9tb2R1bGVzL0BnYXJmaXNoL2hvb2tzL2Rpc3QvZXNtL2luZGV4LmpzIiwid2VicGFjazovL+WtkOW6lOeUqGRlbW8tLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BnYXJmaXNoK2xvYWRlckAxLjE2LjIvbm9kZV9tb2R1bGVzL0BnYXJmaXNoL2xvYWRlci9kaXN0L2VzbS9pbmRleC5qcyIsIndlYnBhY2s6Ly/lrZDlupTnlKhkZW1vLS8uL25vZGVfbW9kdWxlcy8ucG5wbS9AZ2FyZmlzaCtyb3V0ZXJAMS4xNi4yL25vZGVfbW9kdWxlcy9AZ2FyZmlzaC9yb3V0ZXIvZGlzdC9lc20vaW5kZXguanMiLCJ3ZWJwYWNrOi8v5a2Q5bqU55SoZGVtby0vLi9ub2RlX21vZHVsZXMvLnBucG0vQGdhcmZpc2grdXRpbHNAMS4xNi4yL25vZGVfbW9kdWxlcy9AZ2FyZmlzaC91dGlscy9kaXN0L2VzbS9pbmRleC5qcyIsIndlYnBhY2s6Ly/lrZDlupTnlKhkZW1vLS8uL25vZGVfbW9kdWxlcy8ucG5wbS9hbnRkQDUuOC4wX21vbWVudEAyLjI5LjRfcmVhY3QtZG9tQDE4LjIuMF9yZWFjdEAxOC4yLjAvbm9kZV9tb2R1bGVzL2FudGQvZXMvX3V0aWwvcmVhY3ROb2RlLmpzIiwid2VicGFjazovL+WtkOW6lOeUqGRlbW8tLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2RlYnVnQDQuMy40X3N1cHBvcnRzLWNvbG9yQDUuNS4wL25vZGVfbW9kdWxlcy9kZWJ1Zy9zcmMvYnJvd3Nlci5qcyIsIndlYnBhY2s6Ly/lrZDlupTnlKhkZW1vLS8uL25vZGVfbW9kdWxlcy8ucG5wbS9kZWJ1Z0A0LjMuNF9zdXBwb3J0cy1jb2xvckA1LjUuMC9ub2RlX21vZHVsZXMvZGVidWcvc3JjL2NvbW1vbi5qcyIsIndlYnBhY2s6Ly/lrZDlupTnlKhkZW1vLS8uL25vZGVfbW9kdWxlcy8ucG5wbS9ldmVudGVtaXR0ZXIyQDYuNC45L25vZGVfbW9kdWxlcy9ldmVudGVtaXR0ZXIyL2xpYi9ldmVudGVtaXR0ZXIyLmpzIiwid2VicGFjazovL+WtkOW6lOeUqGRlbW8tLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2dhcmZpc2hAMS4xNi4yL25vZGVfbW9kdWxlcy9nYXJmaXNoL2Rpc3QvZXNtL2luZGV4LmpzIiwid2VicGFjazovL+WtkOW6lOeUqGRlbW8tLy4vbm9kZV9tb2R1bGVzLy5wbnBtL21zQDIuMS4yL25vZGVfbW9kdWxlcy9tcy9pbmRleC5qcyIsIndlYnBhY2s6Ly/lrZDlupTnlKhkZW1vLS8uL25vZGVfbW9kdWxlcy8ucG5wbS9AYWxpb3RoLW9yZytlcy1tb2R1bGUtbGV4ZXJAMS4xLjAvbm9kZV9tb2R1bGVzL0BhbGlvdGgtb3JnL2VzLW1vZHVsZS1sZXhlci9kaXN0L2xleGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9wYXRjaGVycy9ldmVudC50c1xudmFyIHJhd0FkZEV2ZW50TGlzdGVuZXI7XG52YXIgcmF3UmVtb3ZlRXZlbnRMaXN0ZW5lcjtcbnZhciBQYXRjaEV2ZW50ID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmxpc3RlbmVyTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgfVxuICBhY3RpdmF0ZSgpIHtcbiAgICB0aGlzLmxpc3RlbmVyTWFwLmZvckVhY2goKGxpc3RlbmVycywgdHlwZSkgPT4gWy4uLmxpc3RlbmVyc10uZm9yRWFjaCgobGlzdGVuZXIpID0+IHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyKSkpO1xuICAgIGlmICghcmF3QWRkRXZlbnRMaXN0ZW5lciB8fCAhcmF3UmVtb3ZlRXZlbnRMaXN0ZW5lcikge1xuICAgICAgcmF3QWRkRXZlbnRMaXN0ZW5lciA9IHdpbmRvdy5hZGRFdmVudExpc3RlbmVyO1xuICAgICAgcmF3UmVtb3ZlRXZlbnRMaXN0ZW5lciA9IHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyO1xuICAgIH1cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciA9ICh0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucykgPT4ge1xuICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5saXN0ZW5lck1hcC5nZXQodHlwZSkgfHwgW107XG4gICAgICB0aGlzLmxpc3RlbmVyTWFwLnNldCh0eXBlLCBbLi4ubGlzdGVuZXJzLCBsaXN0ZW5lcl0pO1xuICAgICAgcmV0dXJuIHJhd0FkZEV2ZW50TGlzdGVuZXIuY2FsbCh3aW5kb3csIHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKTtcbiAgICB9O1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyID0gKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKSA9PiB7XG4gICAgICBjb25zdCBzdG9yZWRUeXBlTGlzdGVuZXJzID0gdGhpcy5saXN0ZW5lck1hcC5nZXQodHlwZSk7XG4gICAgICBpZiAoc3RvcmVkVHlwZUxpc3RlbmVycyAmJiBzdG9yZWRUeXBlTGlzdGVuZXJzLmxlbmd0aCAmJiBzdG9yZWRUeXBlTGlzdGVuZXJzLmluZGV4T2YobGlzdGVuZXIpICE9PSAtMSkge1xuICAgICAgICBzdG9yZWRUeXBlTGlzdGVuZXJzLnNwbGljZShzdG9yZWRUeXBlTGlzdGVuZXJzLmluZGV4T2YobGlzdGVuZXIpLCAxKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByYXdSZW1vdmVFdmVudExpc3RlbmVyLmNhbGwod2luZG93LCB0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG4gICAgfTtcbiAgfVxuICBkZWFjdGl2YXRlKCkge1xuICAgIHRoaXMubGlzdGVuZXJNYXAuZm9yRWFjaCgobGlzdGVuZXJzLCB0eXBlKSA9PiBbLi4ubGlzdGVuZXJzXS5mb3JFYWNoKChsaXN0ZW5lcikgPT4gd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpKSk7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIgPSByYXdSZW1vdmVFdmVudExpc3RlbmVyO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyID0gcmF3QWRkRXZlbnRMaXN0ZW5lcjtcbiAgfVxufTtcblxuLy8gc3JjL3BhdGNoZXJzL2ludGVyY2VwdG9yLnRzXG5mdW5jdGlvbiBpc1N0eWxlZENvbXBvbmVudHNMaWtlKGVsZW1lbnQpIHtcbiAgdmFyIF9hO1xuICByZXR1cm4gZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxTdHlsZUVsZW1lbnQgJiYgIWVsZW1lbnQudGV4dENvbnRlbnQgJiYgKChfYSA9IGVsZW1lbnQuc2hlZXQpID09IG51bGwgPyB2b2lkIDAgOiBfYS5jc3NSdWxlcy5sZW5ndGgpO1xufVxudmFyIFNuYXBzaG90ID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihhcnJEb21zKSB7XG4gICAgdGhpcy5hcnJEb21zID0gYXJyRG9tcztcbiAgICB0aGlzLmFyckRvbXMgPSBhcnJEb21zO1xuICB9XG4gIHN0YXRpYyB0YWtlKHRhcmdldCA9IGRvY3VtZW50LmhlYWQpIHtcbiAgICBsZXQgbGlzdDtcbiAgICBpZiAodGFyZ2V0LmNoaWxkTm9kZXMpIHtcbiAgICAgIGxpc3QgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0YXJnZXQuY2hpbGROb2Rlcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxpc3QgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0YXJnZXQpO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IFNuYXBzaG90KGxpc3QpO1xuICB9XG4gIGRpZmYocykge1xuICAgIGlmICghcykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY3JlYXRlZDogbmV3IFNuYXBzaG90KFtdKSxcbiAgICAgICAgcmVtb3ZlZDogbmV3IFNuYXBzaG90KFtdKVxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIGNyZWF0ZWQ6IG5ldyBTbmFwc2hvdCh0aGlzLmFyckRvbXMuZmlsdGVyKChkKSA9PiBzLmFyckRvbXMuaW5kZXhPZihkKSA9PT0gLTEpKSxcbiAgICAgIHJlbW92ZWQ6IG5ldyBTbmFwc2hvdChzLmFyckRvbXMuZmlsdGVyKChkKSA9PiB0aGlzLmFyckRvbXMuaW5kZXhPZihkKSA9PT0gLTEpKVxuICAgIH07XG4gIH1cbn07XG52YXIgSW50ZXJjZXB0b3IgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGRvbSA9IGRvY3VtZW50LmhlYWQpIHtcbiAgICB0aGlzLmRvbSA9IGRvbTtcbiAgICB0aGlzLmRvbSA9IGRvbTtcbiAgICB0aGlzLmR5bmFtaWNTdHlsZVNoZWV0RWxlbWVudFNldCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7XG4gICAgdGhpcy5zdHlsZWRDb21wb25lbnRDU1NSdWxlc01hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpO1xuICB9XG4gIGFkZChjcmVhdGVkT3JTbmFwc2hvdCwgcmVtb3ZlZCkge1xuICAgIGxldCBjcmVhdGVkO1xuICAgIGlmICghcmVtb3ZlZCkge1xuICAgICAgY29uc3QgZGlmZiA9IFNuYXBzaG90LnRha2UodGhpcy5kb20pLmRpZmYoY3JlYXRlZE9yU25hcHNob3QpO1xuICAgICAgY3JlYXRlZCA9IGRpZmYuY3JlYXRlZDtcbiAgICAgIHJlbW92ZWQgPSBkaWZmLnJlbW92ZWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNyZWF0ZWQgPSBjcmVhdGVkT3JTbmFwc2hvdDtcbiAgICB9XG4gICAgY3JlYXRlZC5hcnJEb21zLnJlZHVjZSgocHJldiwgdmFsKSA9PiB7XG4gICAgICB2YXIgX2EsIF9iO1xuICAgICAgcHJldi5hcHBlbmRDaGlsZCh2YWwpO1xuICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIEhUTUxTdHlsZUVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgY3NzUnVsZXMgPSB0aGlzLnN0eWxlZENvbXBvbmVudENTU1J1bGVzTWFwLmdldCh2YWwpO1xuICAgICAgICBpZiAoY3NzUnVsZXMgJiYgY3NzUnVsZXMubGVuZ3RoKSB7XG4gICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjc3NSdWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgY3NzUnVsZSA9IGNzc1J1bGVzW2ldO1xuICAgICAgICAgICAgKF9iID0gdmFsLnNoZWV0KSA9PSBudWxsID8gdm9pZCAwIDogX2IuaW5zZXJ0UnVsZShjc3NSdWxlLmNzc1RleHQsIChfYSA9IHZhbC5zaGVldCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmNzc1J1bGVzLmxlbmd0aCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcHJldjtcbiAgICB9LCB0aGlzLmRvbSk7XG4gICAgcmVtb3ZlZC5hcnJEb21zLnJlZHVjZSgocHJldiwgdmFsKSA9PiB7XG4gICAgICBwcmV2LnJlbW92ZUNoaWxkKHZhbCk7XG4gICAgICByZXR1cm4gcHJldjtcbiAgICB9LCB0aGlzLmRvbSk7XG4gIH1cbiAgcmVtb3ZlKGNyZWF0ZWRPclNuYXBzaG90LCByZW1vdmVkKSB7XG4gICAgbGV0IGNyZWF0ZWQ7XG4gICAgaWYgKCFyZW1vdmVkKSB7XG4gICAgICBjb25zdCBkaWZmID0gU25hcHNob3QudGFrZSh0aGlzLmRvbSkuZGlmZihjcmVhdGVkT3JTbmFwc2hvdCk7XG4gICAgICBjcmVhdGVkID0gZGlmZi5jcmVhdGVkO1xuICAgICAgcmVtb3ZlZCA9IGRpZmYucmVtb3ZlZDtcbiAgICB9IGVsc2Uge1xuICAgICAgY3JlYXRlZCA9IGNyZWF0ZWRPclNuYXBzaG90O1xuICAgIH1cbiAgICBjcmVhdGVkLmFyckRvbXMucmVkdWNlKChwcmV2LCB2YWwpID0+IHtcbiAgICAgIHZhciBfYTtcbiAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBIVE1MU3R5bGVFbGVtZW50ICYmIGlzU3R5bGVkQ29tcG9uZW50c0xpa2UodmFsKSAmJiAoKF9hID0gdmFsID09IG51bGwgPyB2b2lkIDAgOiB2YWwuc2hlZXQpID09IG51bGwgPyB2b2lkIDAgOiBfYS5jc3NSdWxlcykpIHtcbiAgICAgICAgdGhpcy5zdHlsZWRDb21wb25lbnRDU1NSdWxlc01hcC5zZXQodmFsLCB2YWwuc2hlZXQuY3NzUnVsZXMpO1xuICAgICAgfVxuICAgICAgcHJldi5yZW1vdmVDaGlsZCh2YWwpO1xuICAgICAgcmV0dXJuIHByZXY7XG4gICAgfSwgdGhpcy5kb20pO1xuICAgIHJlbW92ZWQuYXJyRG9tcy5yZWR1Y2UoKHByZXYsIHZhbCkgPT4ge1xuICAgICAgcHJldi5hcHBlbmRDaGlsZCh2YWwpO1xuICAgICAgcmV0dXJuIHByZXY7XG4gICAgfSwgdGhpcy5kb20pO1xuICB9XG59O1xuXG4vLyBzcmMvcGF0Y2hlcnMvc3R5bGUudHNcbnZhciBQYXRjaFN0eWxlID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmhlYWRJbnRlcmNlcHRvciA9IG5ldyBJbnRlcmNlcHRvcihkb2N1bWVudC5oZWFkKTtcbiAgfVxuICBhY3RpdmF0ZSgpIHtcbiAgICB0aGlzLmRvbVNuYXBzaG90QmVmb3JlID0gU25hcHNob3QudGFrZSgpO1xuICAgIGlmICh0aGlzLmRvbVNuYXBzaG90TXV0YXRlZClcbiAgICAgIHRoaXMuaGVhZEludGVyY2VwdG9yLmFkZCh0aGlzLmRvbVNuYXBzaG90TXV0YXRlZC5jcmVhdGVkLCB0aGlzLmRvbVNuYXBzaG90TXV0YXRlZC5yZW1vdmVkKTtcbiAgfVxuICBkZWFjdGl2YXRlKCkge1xuICAgIGNvbnN0IGRvbVNuYXBzaG90ID0gU25hcHNob3QudGFrZSgpO1xuICAgIHRoaXMuZG9tU25hcHNob3RNdXRhdGVkID0gZG9tU25hcHNob3QuZGlmZih0aGlzLmRvbVNuYXBzaG90QmVmb3JlKTtcbiAgICBpZiAoIXRoaXMuZG9tU25hcHNob3RNdXRhdGVkKVxuICAgICAgcmV0dXJuO1xuICAgIHRoaXMuaGVhZEludGVyY2VwdG9yLnJlbW92ZSh0aGlzLmRvbVNuYXBzaG90TXV0YXRlZC5jcmVhdGVkLCB0aGlzLmRvbVNuYXBzaG90TXV0YXRlZC5yZW1vdmVkKTtcbiAgfVxuICBmb3JtYXRlQ3R4KGFyckRvbXMpIHtcbiAgICBjb25zdCBlZmZlY3RNYXAgPSB7XG4gICAgICBzdHlsZTogW10sXG4gICAgICBzY3JpcHQ6IFtdLFxuICAgICAgb3RoZXI6IFtdXG4gICAgfTtcbiAgICBhcnJEb21zLmZvckVhY2goKGRvbSkgPT4ge1xuICAgICAgbGV0IHR5cGUgPSBcIm90aGVyXCI7XG4gICAgICBpZiAoL2Nzcy8udGVzdChkb20udHlwZSkpXG4gICAgICAgIHR5cGUgPSBcInN0eWxlXCI7XG4gICAgICBpZiAoL2phdmFzY3JpcHQvLnRlc3QoZG9tLnR5cGUpKVxuICAgICAgICB0eXBlID0gXCJzY3JpcHRcIjtcbiAgICAgIGVmZmVjdE1hcFt0eXBlXS5wdXNoKHtcbiAgICAgICAgc3JjOiBkb20uc3JjLFxuICAgICAgICBvdXRlckhUTUw6IGRvbS5vdXRlckhUTUwsXG4gICAgICAgIGNvbnRlbnQ6IGRvbS5pbm5lclRleHRcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiBlZmZlY3RNYXA7XG4gIH1cbn07XG5cbi8vIHNyYy9wYXRjaGVycy9oaXN0b3J5LnRzXG52YXIgcmF3UHVzaFN0YXRlO1xudmFyIHJhd1JlcGxhY2VTdGF0ZTtcbnZhciBQYXRjaEhpc3RvcnkgPSBjbGFzcyB7XG4gIGFjdGl2YXRlKCkge1xuICAgIGlmICghcmF3UHVzaFN0YXRlIHx8ICFyYXdSZXBsYWNlU3RhdGUpIHtcbiAgICAgIHJhd1B1c2hTdGF0ZSA9IHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZTtcbiAgICAgIHJhd1JlcGxhY2VTdGF0ZSA9IHdpbmRvdy5oaXN0b3J5LnJlcGxhY2VTdGF0ZTtcbiAgICB9XG4gIH1cbiAgZGVhY3RpdmF0ZSgpIHtcbiAgICB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUgPSByYXdQdXNoU3RhdGU7XG4gICAgd2luZG93Lmhpc3RvcnkucmVwbGFjZVN0YXRlID0gcmF3UmVwbGFjZVN0YXRlO1xuICB9XG59O1xuXG4vLyBzcmMvcGF0Y2hlcnMvaW50ZXJ2YWwudHNcbnZhciByYXdJbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbDtcbnZhciByYXdDbGVhckludGVydmFsID0gd2luZG93LmNsZWFySW50ZXJ2YWw7XG52YXIgUGF0Y2hJbnRlcnZhbCA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5pbnRlcnZhbHMgPSBbXTtcbiAgfVxuICBhY3RpdmF0ZSgpIHtcbiAgICB3aW5kb3cuc2V0SW50ZXJ2YWwgPSAoaGFuZGxlciwgdGltZW91dCwgLi4uYXJncykgPT4ge1xuICAgICAgY29uc3QgaW50ZXJ2YWxJZCA9IHJhd0ludGVydmFsKGhhbmRsZXIsIHRpbWVvdXQsIC4uLmFyZ3MpO1xuICAgICAgdGhpcy5pbnRlcnZhbHMgPSBbLi4udGhpcy5pbnRlcnZhbHMsIGludGVydmFsSWRdO1xuICAgICAgcmV0dXJuIGludGVydmFsSWQ7XG4gICAgfTtcbiAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCA9IChpbnRlcnZhbElkKSA9PiB7XG4gICAgICB0aGlzLmludGVydmFscyA9IHRoaXMuaW50ZXJ2YWxzLmZpbHRlcigoaWQpID0+IGlkICE9PSBpbnRlcnZhbElkKTtcbiAgICAgIHJldHVybiByYXdDbGVhckludGVydmFsKGludGVydmFsSWQpO1xuICAgIH07XG4gIH1cbiAgZGVhY3RpdmF0ZShfY2xlYXJFZmZlY3RzKSB7XG4gICAgaWYgKF9jbGVhckVmZmVjdHMpIHtcbiAgICAgIHRoaXMuaW50ZXJ2YWxzLmZvckVhY2goKGlkKSA9PiB3aW5kb3cuY2xlYXJJbnRlcnZhbChpZCkpO1xuICAgIH1cbiAgICB3aW5kb3cuc2V0SW50ZXJ2YWwgPSByYXdJbnRlcnZhbDtcbiAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCA9IHJhd0NsZWFySW50ZXJ2YWw7XG4gIH1cbn07XG5cbi8vIHNyYy9wYXRjaGVycy92YXJpYWJsZS50c1xudmFyIGhhc093blByb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcbmZ1bmN0aW9uIGhhc093bihvYmosIGtleSkge1xuICByZXR1cm4gaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSk7XG59XG52YXIgUGF0Y2hHbG9iYWxWYWwgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHRhcmdldFRvUHJvdGVjdCA9IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiBnbG9iYWxUaGlzLCBwcm90ZWN0VmFyaWFibGUgPSBbXSkge1xuICAgIHRoaXMudGFyZ2V0VG9Qcm90ZWN0ID0gdGFyZ2V0VG9Qcm90ZWN0O1xuICAgIHRoaXMucHJvdGVjdFZhcmlhYmxlID0gcHJvdGVjdFZhcmlhYmxlO1xuICAgIHRoaXMuc25hcHNob3RPcmlnaW5hbCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gICAgdGhpcy5zbmFwc2hvdE11dGF0ZWQgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuICAgIHRoaXMud2hpdGVMaXN0ID0gW1xuICAgICAgXCJsb2NhdGlvblwiLFxuICAgICAgXCJhZGRFdmVudExpc3RlbmVyXCIsXG4gICAgICBcInJlbW92ZUV2ZW50TGlzdGVuZXJcIixcbiAgICAgIFwid2VicGFja0pzb25wXCJcbiAgICBdO1xuICAgIHRoaXMudGFyZ2V0VG9Qcm90ZWN0ID0gdGFyZ2V0VG9Qcm90ZWN0O1xuICAgIHRoaXMucHJvdGVjdFZhcmlhYmxlID0gcHJvdGVjdFZhcmlhYmxlO1xuICAgIHRoaXMud2hpdGVMaXN0ID0gWy4uLnRoaXMud2hpdGVMaXN0LCAuLi5wcm90ZWN0VmFyaWFibGVdO1xuICB9XG4gIHNhZmVJdGVyYXRvcihmbikge1xuICAgIGZvciAoY29uc3QgaSBpbiB0aGlzLnRhcmdldFRvUHJvdGVjdCkge1xuICAgICAgaWYgKHRoaXMud2hpdGVMaXN0LmluZGV4T2YoaSkgIT09IC0xKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgY29uc3QgcHJvcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGhpcy50YXJnZXRUb1Byb3RlY3QsIGkpO1xuICAgICAgaWYgKCFwcm9wIHx8ICFwcm9wLndyaXRhYmxlKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKGhhc093bih0aGlzLnRhcmdldFRvUHJvdGVjdCwgaSkpIHtcbiAgICAgICAgZm4oaSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGFjdGl2YXRlKCkge1xuICAgIHRoaXMuc2FmZUl0ZXJhdG9yKChpKSA9PiB7XG4gICAgICB0aGlzLnNuYXBzaG90T3JpZ2luYWwuc2V0KGksIHRoaXMudGFyZ2V0VG9Qcm90ZWN0W2ldKTtcbiAgICB9KTtcbiAgICB0aGlzLnNuYXBzaG90TXV0YXRlZC5mb3JFYWNoKCh2YWwsIG11dGF0ZUtleSkgPT4ge1xuICAgICAgdGhpcy50YXJnZXRUb1Byb3RlY3RbbXV0YXRlS2V5XSA9IHRoaXMuc25hcHNob3RNdXRhdGVkLmdldChtdXRhdGVLZXkpO1xuICAgIH0pO1xuICB9XG4gIGRlYWN0aXZhdGUoKSB7XG4gICAgY29uc3QgZGVsZXRlTWFwID0ge307XG4gICAgY29uc3QgdXBkYXRlTWFwID0ge307XG4gICAgY29uc3QgYWRkTWFwID0ge307XG4gICAgdGhpcy5zYWZlSXRlcmF0b3IoKG5vcm1hbEtleSkgPT4ge1xuICAgICAgaWYgKHRoaXMuc25hcHNob3RPcmlnaW5hbC5nZXQobm9ybWFsS2V5KSAhPT0gdGhpcy50YXJnZXRUb1Byb3RlY3Rbbm9ybWFsS2V5XSkge1xuICAgICAgICB0aGlzLnNuYXBzaG90TXV0YXRlZC5zZXQobm9ybWFsS2V5LCB0aGlzLnRhcmdldFRvUHJvdGVjdFtub3JtYWxLZXldKTtcbiAgICAgICAgdGhpcy50YXJnZXRUb1Byb3RlY3Rbbm9ybWFsS2V5XSA9IHRoaXMuc25hcHNob3RPcmlnaW5hbC5nZXQobm9ybWFsS2V5KTtcbiAgICAgICAgaWYgKHRoaXMudGFyZ2V0VG9Qcm90ZWN0W25vcm1hbEtleV0gPT09IHZvaWQgMCkge1xuICAgICAgICAgIGFkZE1hcFtub3JtYWxLZXldID0gdGhpcy5zbmFwc2hvdE11dGF0ZWQuZ2V0KG5vcm1hbEtleSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdXBkYXRlTWFwW25vcm1hbEtleV0gPSB0aGlzLnNuYXBzaG90TXV0YXRlZC5nZXQobm9ybWFsS2V5KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5zbmFwc2hvdE9yaWdpbmFsLmRlbGV0ZShub3JtYWxLZXkpO1xuICAgIH0pO1xuICAgIHRoaXMuc25hcHNob3RPcmlnaW5hbC5mb3JFYWNoKCh2YWwsIGRlbGV0ZUtleSkgPT4ge1xuICAgICAgdGhpcy5zbmFwc2hvdE11dGF0ZWQuc2V0KGRlbGV0ZUtleSwgdGhpcy50YXJnZXRUb1Byb3RlY3RbZGVsZXRlS2V5XSk7XG4gICAgICB0aGlzLnRhcmdldFRvUHJvdGVjdFtkZWxldGVLZXldID0gdGhpcy5zbmFwc2hvdE9yaWdpbmFsLmdldChkZWxldGVLZXkpO1xuICAgICAgZGVsZXRlTWFwW2RlbGV0ZUtleV0gPSB0aGlzLnRhcmdldFRvUHJvdGVjdFtkZWxldGVLZXldO1xuICAgIH0pO1xuICB9XG59O1xuXG4vLyBzcmMvcGF0Y2hlcnMvd2VicGFja2pzb25wLnRzXG52YXIgUGF0Y2hXZWJwYWNrSnNvbnAgPSBjbGFzcyB7XG4gIGFjdGl2YXRlKCkge1xuICAgIHRoaXMucHJlV2VicGFja0pzb25wID0gd2luZG93LndlYnBhY2tKc29ucDtcbiAgICB3aW5kb3cud2VicGFja0pzb25wID0gdGhpcy5jdXJyZW50V2VicGFja0pzb25wO1xuICB9XG4gIGRlYWN0aXZhdGUoKSB7XG4gICAgdGhpcy5jdXJyZW50V2VicGFja0pzb25wID0gd2luZG93LndlYnBhY2tKc29ucDtcbiAgICB3aW5kb3cud2VicGFja0pzb25wID0gdGhpcy5wcmVXZWJwYWNrSnNvbnA7XG4gIH1cbn07XG5cbi8vIHNyYy9zYW5kYm94LnRzXG52YXIgU2FuZGJveCA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IobmFtZSwgcHJvdGVjdFZhcmlhYmxlID0gW10sIHRhcmdldFRvUHJvdGVjdCA9IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiBnbG9iYWxUaGlzLCBpc0luQnJvd3NlciA9IHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCIgPyBmYWxzZSA6IHRydWUpIHtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMucHJvdGVjdFZhcmlhYmxlID0gcHJvdGVjdFZhcmlhYmxlO1xuICAgIHRoaXMudGFyZ2V0VG9Qcm90ZWN0ID0gdGFyZ2V0VG9Qcm90ZWN0O1xuICAgIHRoaXMuaXNJbkJyb3dzZXIgPSBpc0luQnJvd3NlcjtcbiAgICB0aGlzLnR5cGUgPSBcInNuYXBzaG90XCI7XG4gICAgdGhpcy5pc1J1bm5pbmcgPSBmYWxzZTtcbiAgICB0aGlzLnBhdGNoTGlzdCA9IFtdO1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5pc0luQnJvd3NlciA9IGlzSW5Ccm93c2VyO1xuICAgIHRoaXMucGF0Y2hMaXN0LnB1c2gobmV3IFBhdGNoR2xvYmFsVmFsKHRhcmdldFRvUHJvdGVjdCwgcHJvdGVjdFZhcmlhYmxlKSk7XG4gICAgaWYgKHRoaXMuaXNJbkJyb3dzZXIpIHtcbiAgICAgIHRoaXMucGF0Y2hMaXN0ID0gW1xuICAgICAgICAuLi50aGlzLnBhdGNoTGlzdCxcbiAgICAgICAgbmV3IFBhdGNoU3R5bGUoKSxcbiAgICAgICAgbmV3IFBhdGNoRXZlbnQoKSxcbiAgICAgICAgbmV3IFBhdGNoSGlzdG9yeSgpLFxuICAgICAgICBuZXcgUGF0Y2hJbnRlcnZhbCgpLFxuICAgICAgICBuZXcgUGF0Y2hXZWJwYWNrSnNvbnAoKVxuICAgICAgXTtcbiAgICB9XG4gIH1cbiAgYWN0aXZhdGUoKSB7XG4gICAgaWYgKHRoaXMuaXNSdW5uaW5nKVxuICAgICAgcmV0dXJuO1xuICAgIHRoaXMucGF0Y2hMaXN0LmZvckVhY2goKHBhdGNoKSA9PiB7XG4gICAgICBwYXRjaC5hY3RpdmF0ZSgpO1xuICAgIH0pO1xuICAgIHRoaXMuaXNSdW5uaW5nID0gdHJ1ZTtcbiAgfVxuICBkZWFjdGl2YXRlKGNsZWFyRWZmZWN0cyA9IHRydWUpIHtcbiAgICBpZiAoIXRoaXMuaXNSdW5uaW5nKVxuICAgICAgcmV0dXJuO1xuICAgIFsuLi50aGlzLnBhdGNoTGlzdF0ucmV2ZXJzZSgpLmZvckVhY2goKHBhdGNoKSA9PiB7XG4gICAgICBwYXRjaC5kZWFjdGl2YXRlKGNsZWFyRWZmZWN0cyk7XG4gICAgfSk7XG4gICAgdGhpcy5pc1J1bm5pbmcgPSBmYWxzZTtcbiAgfVxufTtcblxuLy8gc3JjL2luZGV4LnRzXG5mdW5jdGlvbiBHYXJmaXNoQnJvd3NlclNuYXBzaG90KG9wKSB7XG4gIHJldHVybiBmdW5jdGlvbihHYXJmaXNoKSB7XG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgIG9wZW5Ccm93c2VyOiBmYWxzZSxcbiAgICAgIHZlcnNpb246IFwiMS4xNi4yXCIsXG4gICAgICBuYW1lOiBcImJyb3dzZXItc25hcHNob3RcIixcbiAgICAgIGFmdGVyTG9hZChhcHBJbmZvLCBhcHBJbnN0YW5jZSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IG9wIHx8IHsgb3BlbjogdHJ1ZSB9O1xuICAgICAgICBjb25zdCBzYW5kYm94Q29uZmlnID0gYXBwSW5mby5zYW5kYm94IHx8ICgoX2EgPSBHYXJmaXNoID09IG51bGwgPyB2b2lkIDAgOiBHYXJmaXNoLm9wdGlvbnMpID09IG51bGwgPyB2b2lkIDAgOiBfYS5zYW5kYm94KTtcbiAgICAgICAgaWYgKHNhbmRib3hDb25maWcgPT09IGZhbHNlIHx8IHNhbmRib3hDb25maWcub3BlbiA9PT0gZmFsc2UgfHwgKHNhbmRib3hDb25maWcgPT0gbnVsbCA/IHZvaWQgMCA6IHNhbmRib3hDb25maWcuc25hcHNob3QpID09PSBmYWxzZSkge1xuICAgICAgICAgIGNvbmZpZy5vcGVuID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNhbmRib3hDb25maWcpIHtcbiAgICAgICAgICBjb25maWcucHJvdGVjdFZhcmlhYmxlID0gW1xuICAgICAgICAgICAgLi4uKEdhcmZpc2ggPT0gbnVsbCA/IHZvaWQgMCA6IEdhcmZpc2gub3B0aW9ucy5wcm90ZWN0VmFyaWFibGUpIHx8IFtdLFxuICAgICAgICAgICAgLi4uYXBwSW5mby5wcm90ZWN0VmFyaWFibGUgfHwgW11cbiAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgICAgIG9wdGlvbnMub3BlbkJyb3dzZXIgPSAhIWNvbmZpZy5vcGVuO1xuICAgICAgICBpZiAoIWNvbmZpZy5vcGVuKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKGFwcEluc3RhbmNlKSB7XG4gICAgICAgICAgaWYgKGFwcEluc3RhbmNlLnNuYXBzaG90U2FuZGJveClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICBjb25zdCBzYW5kYm94ID0gbmV3IFNhbmRib3goYXBwSW5mby5uYW1lLCBjb25maWcucHJvdGVjdFZhcmlhYmxlKTtcbiAgICAgICAgICBhcHBJbnN0YW5jZS5zbmFwc2hvdFNhbmRib3ggPSBzYW5kYm94O1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgYmVmb3JlTW91bnQoYXBwSW5mbywgYXBwSW5zdGFuY2UpIHtcbiAgICAgICAgaWYgKCFhcHBJbnN0YW5jZS5zbmFwc2hvdFNhbmRib3gpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICBhcHBJbnN0YW5jZS5zbmFwc2hvdFNhbmRib3guYWN0aXZhdGUoKTtcbiAgICAgIH0sXG4gICAgICBhZnRlclVubW91bnQoYXBwSW5mbywgYXBwSW5zdGFuY2UpIHtcbiAgICAgICAgaWYgKCFhcHBJbnN0YW5jZS5zbmFwc2hvdFNhbmRib3gpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICBhcHBJbnN0YW5jZS5zbmFwc2hvdFNhbmRib3guZGVhY3RpdmF0ZSgpO1xuICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIG9wdGlvbnM7XG4gIH07XG59XG5leHBvcnQge1xuICBHYXJmaXNoQnJvd3NlclNuYXBzaG90LFxuICBTYW5kYm94IGFzIGRlZmF1bHRcbn07XG4iLCJ2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xudmFyIF9fZGVmUHJvcHMgPSBPYmplY3QuZGVmaW5lUHJvcGVydGllcztcbnZhciBfX2dldE93blByb3BEZXNjcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzO1xudmFyIF9fZ2V0T3duUHJvcFN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzO1xudmFyIF9faGFzT3duUHJvcCA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG52YXIgX19wcm9wSXNFbnVtID0gT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZTtcbnZhciBfX2RlZk5vcm1hbFByb3AgPSAob2JqLCBrZXksIHZhbHVlKSA9PiBrZXkgaW4gb2JqID8gX19kZWZQcm9wKG9iaiwga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUsIHZhbHVlIH0pIDogb2JqW2tleV0gPSB2YWx1ZTtcbnZhciBfX3NwcmVhZFZhbHVlcyA9IChhLCBiKSA9PiB7XG4gIGZvciAodmFyIHByb3AgaW4gYiB8fCAoYiA9IHt9KSlcbiAgICBpZiAoX19oYXNPd25Qcm9wLmNhbGwoYiwgcHJvcCkpXG4gICAgICBfX2RlZk5vcm1hbFByb3AoYSwgcHJvcCwgYltwcm9wXSk7XG4gIGlmIChfX2dldE93blByb3BTeW1ib2xzKVxuICAgIGZvciAodmFyIHByb3Agb2YgX19nZXRPd25Qcm9wU3ltYm9scyhiKSkge1xuICAgICAgaWYgKF9fcHJvcElzRW51bS5jYWxsKGIsIHByb3ApKVxuICAgICAgICBfX2RlZk5vcm1hbFByb3AoYSwgcHJvcCwgYltwcm9wXSk7XG4gICAgfVxuICByZXR1cm4gYTtcbn07XG52YXIgX19zcHJlYWRQcm9wcyA9IChhLCBiKSA9PiBfX2RlZlByb3BzKGEsIF9fZ2V0T3duUHJvcERlc2NzKGIpKTtcblxuLy8gc3JjL3BsdWdpbmlmeS50c1xuaW1wb3J0IHsgd2FybiBhcyB3YXJuNiB9IGZyb20gXCJAZ2FyZmlzaC91dGlsc1wiO1xuXG4vLyBzcmMvc2FuZGJveC50c1xuaW1wb3J0IHsgTG9hZGVyIH0gZnJvbSBcIkBnYXJmaXNoL2xvYWRlclwiO1xuaW1wb3J0IHtcbiAgd2FybiBhcyB3YXJuNSxcbiAgaGFzT3duIGFzIGhhc093bjYsXG4gIG1ha2VNYXAgYXMgbWFrZU1hcDcsXG4gIGlzT2JqZWN0IGFzIGlzT2JqZWN0MyxcbiAgZGVlcE1lcmdlLFxuICBldmFsV2l0aEVudixcbiAgc2FmZVdyYXBwZXIgYXMgc2FmZVdyYXBwZXIzLFxuICBpc1BsYWluT2JqZWN0LFxuICBzZXREb2NDdXJyZW50U2NyaXB0XG59IGZyb20gXCJAZ2FyZmlzaC91dGlsc1wiO1xuXG4vLyBzcmMvbW9kdWxlcy9oaXN0b3J5LnRzXG5pbXBvcnQgeyBoYXNPd24gYXMgaGFzT3duMiwgbWFrZU1hcCBhcyBtYWtlTWFwMyB9IGZyb20gXCJAZ2FyZmlzaC91dGlsc1wiO1xuXG4vLyBzcmMvcHJveHlJbnRlcmNlcHRvci9zaGFyZWQudHNcbmltcG9ydCB7IHdhcm4sIG1ha2VNYXAgYXMgbWFrZU1hcDIsIGlzT2JqZWN0IH0gZnJvbSBcIkBnYXJmaXNoL3V0aWxzXCI7XG5cbi8vIHNyYy91dGlscy50c1xuaW1wb3J0IHsgaGFzT3duLCBtYWtlTWFwLCBuZXh0VGljayB9IGZyb20gXCJAZ2FyZmlzaC91dGlsc1wiO1xuXG4vLyBzcmMvc3ltYm9sVHlwZXMudHNcbnZhciBHQVJGSVNIX05BTUVTUEFDRV9QUkVGSVggPSBcIl9fR2FyZmlzaF9fXCI7XG52YXIgR0FSRklTSF9PUFRJTUlaRV9OQU1FID0gXCJfX2dhcmZpc2hfb3B0aW1pemVfX1wiO1xudmFyIF9fcHJveHlOb2RlX18gPSBTeW1ib2wuZm9yKFwiZ2FyZmlzaC5wcm94eU5vZGVcIik7XG52YXIgX19kb21XcmFwcGVyX18gPSBTeW1ib2wuZm9yKFwiZ2FyZmlzaC5kb21XcmFwcGVyXCIpO1xudmFyIF9fd2luZG93QmluZF9fID0gU3ltYm9sLmZvcihcImdhcmZpc2gud2luZG93QmluZFwiKTtcbnZhciBfX3NhbmRib3hNYXBfXyA9IFN5bWJvbC5mb3IoXCJnYXJmaXNoLnNhbmRib3hNYXBcIik7XG52YXIgX19kb2N1bWVudEJpbmRfXyA9IFN5bWJvbC5mb3IoXCJnYXJmaXNoLmRvY3VtZW50QmluZFwiKTtcbnZhciBfX2dhcmZpc2hHbG9iYWxfXyA9IFN5bWJvbC5mb3IoXCJnYXJmaXNoLmdsb2JhbE9iamVjdFwiKTtcbnZhciBfX2VsZW1lbnRTYW5kYm94VGFnX18gPSBTeW1ib2wuZm9yKFwiZ2FyZmlzaC5lbGVtZW50U2FuZGJveFRhZ1wiKTtcblxuLy8gc3JjL3V0aWxzLnRzXG52YXIgZXNHbG9iYWxNZXRob2RzID0gXCJldmFsLGlzRmluaXRlLGlzTmFOLHBhcnNlRmxvYXQscGFyc2VJbnQsZGVjb2RlVVJJLGRlY29kZVVSSUNvbXBvbmVudCxlbmNvZGVVUkksZW5jb2RlVVJJQ29tcG9uZW50LEFycmF5LEFycmF5QnVmZmVyLEJpZ0ludCxCaWdJbnQ2NEFycmF5LEJpZ1VpbnQ2NEFycmF5LEJvb2xlYW4sRGF0YVZpZXcsRGF0ZSxFcnJvcixFdmFsRXJyb3IsRmluYWxpemF0aW9uUmVnaXN0cnksRmxvYXQzMkFycmF5LEZsb2F0NjRBcnJheSxGdW5jdGlvbixJbnQ4QXJyYXksSW50MTZBcnJheSxJbnQzMkFycmF5LE1hcCxOdW1iZXIsT2JqZWN0LFByb21pc2UsUHJveHksUmFuZ2VFcnJvcixSZWZlcmVuY2VFcnJvcixSZWdFeHAsU2V0LFNoYXJlZEFycmF5QnVmZmVyLFN0cmluZyxTeW1ib2wsU3ludGF4RXJyb3IsVHlwZUVycm9yLFVpbnQ4QXJyYXksVWludDhDbGFtcGVkQXJyYXksVWludDE2QXJyYXksVWludDMyQXJyYXksVVJJRXJyb3IsV2Vha01hcCxXZWFrUmVmLFdlYWtTZXQsQXRvbWljcyxKU09OLE1hdGgsUmVmbGVjdCxcIi5zcGxpdChcIixcIik7XG52YXIgbmF0aXZlQ29kZU1ldGhvZHMgPSBcImhhc093blByb3BlcnR5LFwiLnNwbGl0KFwiLFwiKTtcbnZhciBpc0VzR2xvYmFsTWV0aG9kcyA9IG1ha2VNYXAoZXNHbG9iYWxNZXRob2RzKTtcbnZhciBpc05hdGl2ZUNvZGVNZXRob2RzID0gbWFrZU1hcChuYXRpdmVDb2RlTWV0aG9kcyk7XG52YXIgb3B0aW1pemVNZXRob2RzID0gWy4uLmVzR2xvYmFsTWV0aG9kc10uZmlsdGVyKCh2KSA9PiB2ICE9PSBcImV2YWxcIik7XG52YXIgc2FuZGJveExpc3QgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuaWYgKCF3aW5kb3dbX19zYW5kYm94TWFwX19dKSB7XG4gIHdpbmRvd1tfX3NhbmRib3hNYXBfX10gPSBzYW5kYm94TGlzdDtcbn0gZWxzZSB7XG4gIHNhbmRib3hMaXN0ID0gd2luZG93W19fc2FuZGJveE1hcF9fXTtcbn1cbnZhciBzYW5kYm94TWFwID0ge1xuICBzYW5kYm94TWFwOiBzYW5kYm94TGlzdCxcbiAgZ2V0KGVsZW1lbnQpIHtcbiAgICBpZiAoIWVsZW1lbnQpXG4gICAgICByZXR1cm47XG4gICAgY29uc3Qgc2FuZGJveElkID0gZWxlbWVudFtfX2VsZW1lbnRTYW5kYm94VGFnX19dO1xuICAgIGlmICh0eXBlb2Ygc2FuZGJveElkICE9PSBcIm51bWJlclwiKVxuICAgICAgcmV0dXJuO1xuICAgIHJldHVybiB0aGlzLnNhbmRib3hNYXAuZ2V0KHNhbmRib3hJZCk7XG4gIH0sXG4gIHNldEVsZW1lbnRUYWcoZWxlbWVudCwgc2FuZGJveCkge1xuICAgIGlmICghZWxlbWVudClcbiAgICAgIHJldHVybjtcbiAgICBlbGVtZW50W19fZWxlbWVudFNhbmRib3hUYWdfX10gPSBzYW5kYm94LmlkO1xuICB9LFxuICBzZXQoc2FuZGJveCkge1xuICAgIGlmICh0aGlzLnNhbmRib3hNYXAuZ2V0KHNhbmRib3guaWQpKVxuICAgICAgcmV0dXJuO1xuICAgIHRoaXMuc2FuZGJveE1hcC5zZXQoc2FuZGJveC5pZCwgc2FuZGJveCk7XG4gIH0sXG4gIGRlbChzYW5kYm94KSB7XG4gICAgdGhpcy5zYW5kYm94TWFwLmRlbGV0ZShzYW5kYm94LmlkKTtcbiAgfVxufTtcbmZ1bmN0aW9uIGhhbmRsZXJQYXJhbXMoYXJncykge1xuICBhcmdzID0gQXJyYXkuaXNBcnJheShhcmdzKSA/IGFyZ3MgOiBBcnJheS5mcm9tKGFyZ3MpO1xuICByZXR1cm4gYXJncy5tYXAoKHYpID0+IHtcbiAgICByZXR1cm4gdiAmJiB2W19fcHJveHlOb2RlX19dID8gdltfX3Byb3h5Tm9kZV9fXSA6IHY7XG4gIH0pO1xufVxuZnVuY3Rpb24gcm9vdEVsbShzYW5kYm94KSB7XG4gIGNvbnN0IGNvbnRhaW5lciA9IHNhbmRib3ggJiYgc2FuZGJveC5vcHRpb25zLmVsO1xuICByZXR1cm4gY29udGFpbmVyICYmIGNvbnRhaW5lcigpO1xufVxuZnVuY3Rpb24gY3JlYXRlRmFrZU9iamVjdCh0YXJnZXQsIGZpbHRlciwgaXNXcml0YWJsZSkge1xuICBjb25zdCBmYWtlT2JqZWN0ID0ge307XG4gIGNvbnN0IHByb3BlcnR5TWFwID0ge307XG4gIGNvbnN0IHN0b3JhZ2VCb3ggPSAvKiBAX19QVVJFX18gKi8gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgY29uc3QgcHJvcGVydHlOYW1lcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRhcmdldCk7XG4gIGNvbnN0IGRlZjIgPSAocCkgPT4ge1xuICAgIGNvbnN0IGRlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwgcCk7XG4gICAgaWYgKGRlc2NyaXB0b3IgPT0gbnVsbCA/IHZvaWQgMCA6IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlKSB7XG4gICAgICBjb25zdCBoYXNHZXR0ZXIgPSBoYXNPd24oZGVzY3JpcHRvciwgXCJnZXRcIik7XG4gICAgICBjb25zdCBoYXNTZXR0ZXIgPSBoYXNPd24oZGVzY3JpcHRvciwgXCJzZXRcIik7XG4gICAgICBjb25zdCBjYW5Xcml0YWJsZSA9IHR5cGVvZiBpc1dyaXRhYmxlID09PSBcImZ1bmN0aW9uXCIgJiYgaXNXcml0YWJsZShwKTtcbiAgICAgIGlmIChoYXNHZXR0ZXIpIHtcbiAgICAgICAgZGVzY3JpcHRvci5nZXQgPSAoKSA9PiBoYXNPd24oc3RvcmFnZUJveCwgcCkgPyBzdG9yYWdlQm94W3BdIDogdGFyZ2V0W3BdO1xuICAgICAgfVxuICAgICAgaWYgKGhhc1NldHRlcikge1xuICAgICAgICBkZXNjcmlwdG9yLnNldCA9ICh2YWwpID0+IHtcbiAgICAgICAgICBzdG9yYWdlQm94W3BdID0gdmFsO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgaWYgKGNhbldyaXRhYmxlKSB7XG4gICAgICAgIGlmIChkZXNjcmlwdG9yLndyaXRhYmxlID09PSBmYWxzZSkge1xuICAgICAgICAgIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKGhhc1NldHRlcikge1xuICAgICAgICAgIGRlc2NyaXB0b3Iuc2V0ID0gKHZhbCkgPT4ge1xuICAgICAgICAgICAgc3RvcmFnZUJveFtwXSA9IHZhbDtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShmYWtlT2JqZWN0LCBwLCBPYmplY3QuZnJlZXplKGRlc2NyaXB0b3IpKTtcbiAgICB9XG4gIH07XG4gIHByb3BlcnR5TmFtZXMuZm9yRWFjaCgocCkgPT4ge1xuICAgIHByb3BlcnR5TWFwW3BdID0gdHJ1ZTtcbiAgICB0eXBlb2YgZmlsdGVyID09PSBcImZ1bmN0aW9uXCIgPyAhZmlsdGVyKHApICYmIGRlZjIocCkgOiBkZWYyKHApO1xuICB9KTtcbiAgZm9yIChjb25zdCBwcm9wIGluIHRhcmdldCkge1xuICAgICFwcm9wZXJ0eU1hcFtwcm9wXSAmJiBkZWYyKHByb3ApO1xuICB9XG4gIHJldHVybiBmYWtlT2JqZWN0O1xufVxudmFyIHNldHRpbmcgPSB0cnVlO1xuZnVuY3Rpb24gbWljcm9UYXNrSHRtbFByb3h5RG9jdW1lbnQocHJveHlEb2N1bWVudCkge1xuICBjb25zdCBodG1sID0gZG9jdW1lbnQuY2hpbGRyZW5bMF07XG4gIGlmIChodG1sICYmIGh0bWwucGFyZW50Tm9kZSAhPT0gcHJveHlEb2N1bWVudCkge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShodG1sLCBcInBhcmVudE5vZGVcIiwge1xuICAgICAgdmFsdWU6IHByb3h5RG9jdW1lbnQsXG4gICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBpZiAoc2V0dGluZykge1xuICAgICAgc2V0dGluZyA9IGZhbHNlO1xuICAgICAgbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICBzZXR0aW5nID0gdHJ1ZTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGh0bWwsIFwicGFyZW50Tm9kZVwiLCB7XG4gICAgICAgICAgdmFsdWU6IGRvY3VtZW50LFxuICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufVxuZnVuY3Rpb24gaXNTdHlsZWRDb21wb25lbnRzTGlrZShlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50IGluc3RhbmNlb2YgSFRNTFN0eWxlRWxlbWVudCAmJiAhZWxlbWVudC50ZXh0Q29udGVudDtcbn1cbnZhciBMb2NrUXVldWUgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuaWQgPSAwO1xuICAgIHRoaXMubG9ja1F1ZXVlID0gW107XG4gICAgdGhpcy5jdXJyZW50SWQgPSAwO1xuICB9XG4gIGdlbklkKCkge1xuICAgIGNvbnN0IGxvY2tJZCA9IHRoaXMuaWQ7XG4gICAgbGV0IHByb21pc2VSZXNvbHZlID0gKCkgPT4ge1xuICAgIH07XG4gICAgY29uc3Qgd2FpdGluZyA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICBwcm9taXNlUmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgICB0aGlzLmN1cnJlbnRJZCsrO1xuICAgIH0pO1xuICAgIGNvbnN0IGxvY2tJdGVtID0ge1xuICAgICAgaWQ6IGxvY2tJZCxcbiAgICAgIHdhaXRpbmcsXG4gICAgICByZXNvbHZlOiAoKSA9PiB7XG4gICAgICAgIHByb21pc2VSZXNvbHZlKCk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLmxvY2tRdWV1ZS5wdXNoKGxvY2tJdGVtKTtcbiAgICB0aGlzLmlkICs9IDE7XG4gICAgcmV0dXJuIGxvY2tJZDtcbiAgfVxuICBnZXRJZCgpIHtcbiAgICByZXR1cm4gdGhpcy5pZDtcbiAgfVxuICBhc3luYyB3YWl0KGlkMikge1xuICAgIGNvbnN0IHsgbG9ja1F1ZXVlIH0gPSB0aGlzO1xuICAgIGNvbnN0IGZpcnN0TG9jayA9IGxvY2tRdWV1ZVswXTtcbiAgICBjb25zdCBsb2NrSXRlbSA9IGxvY2tRdWV1ZS5maW5kKChpdGVtKSA9PiBpdGVtLmlkID09PSBpZDIpO1xuICAgIGNvbnN0IGxvY2tJbmRleCA9IGxvY2tRdWV1ZS5maW5kSW5kZXgoKGl0ZW0pID0+IGl0ZW0uaWQgPT09IGlkMik7XG4gICAgaWYgKGZpcnN0TG9jay5pZCA9PT0gaWQyKSB7XG4gICAgICBsb2NrSXRlbSA9PSBudWxsID8gdm9pZCAwIDogbG9ja0l0ZW0ucmVzb2x2ZSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAobG9ja0l0ZW0pIHtcbiAgICAgIGF3YWl0IFByb21pc2UuYWxsKGxvY2tRdWV1ZS5zbGljZSgwLCBsb2NrSW5kZXgpLm1hcCgoaXRlbSkgPT4gaXRlbS53YWl0aW5nKSk7XG4gICAgICBjb25zdCBsYXN0TG9jayA9IGxvY2tRdWV1ZVtsb2NrUXVldWUubGVuZ3RoIC0gMV07XG4gICAgICBpZiAobGFzdExvY2suaWQgPT09IGlkMikge1xuICAgICAgICB0aGlzLmNsZWFyKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJlbGVhc2UoaWQyKSB7XG4gICAgY29uc3QgeyBsb2NrUXVldWUgfSA9IHRoaXM7XG4gICAgY29uc3QgbG9ja0l0ZW0gPSBsb2NrUXVldWUuZmluZCgoaXRlbSkgPT4gaXRlbS5pZCA9PT0gaWQyKTtcbiAgICBsb2NrSXRlbSA9PSBudWxsID8gdm9pZCAwIDogbG9ja0l0ZW0ucmVzb2x2ZSgpO1xuICB9XG4gIGNsZWFyKCkge1xuICAgIHRoaXMubG9ja1F1ZXVlID0gW107XG4gIH1cbn07XG5cbi8vIHNyYy9wcm94eUludGVyY2VwdG9yL3NoYXJlZC50c1xuZnVuY3Rpb24gaXNEYXRhRGVzY3JpcHRvcihkZXNjKSB7XG4gIGlmIChkZXNjID09PSB2b2lkIDApXG4gICAgcmV0dXJuIGZhbHNlO1xuICByZXR1cm4gXCJ2YWx1ZVwiIGluIGRlc2MgfHwgXCJ3cml0YWJsZVwiIGluIGRlc2M7XG59XG5mdW5jdGlvbiBpc0FjY2Vzc29yRGVzY3JpcHRvcihkZXNjKSB7XG4gIGlmIChkZXNjID09PSB2b2lkIDApXG4gICAgcmV0dXJuIGZhbHNlO1xuICByZXR1cm4gXCJnZXRcIiBpbiBkZXNjIHx8IFwic2V0XCIgaW4gZGVzYztcbn1cbmZ1bmN0aW9uIHZlcmlmeUdldHRlckRlc2NyaXB0b3IodGFyZ2V0LCBwLCBuZXdWYWx1ZSkge1xuICBjb25zdCBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIHApO1xuICBpZiAoZGVzYyAhPT0gdm9pZCAwICYmIGRlc2MuY29uZmlndXJhYmxlID09PSBmYWxzZSkge1xuICAgIGlmIChpc0RhdGFEZXNjcmlwdG9yKGRlc2MpICYmIGRlc2Mud3JpdGFibGUgPT09IGZhbHNlKSB7XG4gICAgICBpZiAoIU9iamVjdC5pcyhuZXdWYWx1ZSwgZGVzYy52YWx1ZSkpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID8gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiIDogZmFsc2UpIHtcbiAgICAgICAgICB3YXJuKGBwcm9wZXJ0eSBcIiR7U3RyaW5nKHApfVwiIGlzIG5vbi1jb25maWd1cmFibGUgYW5kIG5vbi13cml0YWJsZS5gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGlzQWNjZXNzb3JEZXNjcmlwdG9yKGRlc2MpICYmIGRlc2MuZ2V0ID09PSB2b2lkIDApIHtcbiAgICAgIHJldHVybiAyO1xuICAgIH1cbiAgfVxuICByZXR1cm4gMDtcbn1cbmZ1bmN0aW9uIHZlcmlmeVNldHRlcihwcm94eVRhcmdldCwgdGFyZ2V0LCBwLCB2YWwsIHJlY2VpdmVyKSB7XG4gIGNvbnN0IHZlcmlmeVJlc3VsdCA9IHZlcmlmeVNldHRlckRlc2NyaXB0b3IocHJveHlUYXJnZXQgPyBwcm94eVRhcmdldCA6IHJlY2VpdmVyIHx8IHRhcmdldCwgcCwgdmFsKTtcbiAgbGV0IHJlc3VsdDtcbiAgaWYgKHZlcmlmeVJlc3VsdCA+IDApIHtcbiAgICBpZiAodmVyaWZ5UmVzdWx0ID09PSAxIHx8IHZlcmlmeVJlc3VsdCA9PT0gMilcbiAgICAgIHJlc3VsdCA9IGZhbHNlO1xuICAgIGlmICh2ZXJpZnlSZXN1bHQgPT09IDMpXG4gICAgICByZXN1bHQgPSB0cnVlO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiB2ZXJpZnlTZXR0ZXJEZXNjcmlwdG9yKHRhcmdldCwgcCwgbmV3VmFsdWUpIHtcbiAgY29uc3QgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBwKTtcbiAgaWYgKGRlc2MgIT09IHZvaWQgMCAmJiBkZXNjLmNvbmZpZ3VyYWJsZSA9PT0gZmFsc2UpIHtcbiAgICBpZiAoaXNEYXRhRGVzY3JpcHRvcihkZXNjKSAmJiBkZXNjLndyaXRhYmxlID09PSBmYWxzZSkge1xuICAgICAgaWYgKCFPYmplY3QuaXMobmV3VmFsdWUsIGRlc2MudmFsdWUpKSB7XG4gICAgICAgIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudiAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViA/IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA6IGZhbHNlKSB7XG4gICAgICAgICAgd2FybihgcHJvcGVydHkgXCIke1N0cmluZyhwKX1cIiBpcyBub24tY29uZmlndXJhYmxlIGFuZCBub24td3JpdGFibGUuYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gMztcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGlzQWNjZXNzb3JEZXNjcmlwdG9yKGRlc2MpICYmIGRlc2Muc2V0ID09PSB2b2lkIDApIHtcbiAgICAgIHJldHVybiAyO1xuICAgIH1cbiAgfVxuICByZXR1cm4gMDtcbn1cbmZ1bmN0aW9uIHNhZmVUb1N0cmluZyh0aGluZykge1xuICB0cnkge1xuICAgIHJldHVybiB0aGluZy50b1N0cmluZygpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIFwiW3RvU3RyaW5nIGZhaWxlZF1cIjtcbiAgfVxufVxuZnVuY3Rpb24gaXNDb25zdHJ1Y3Rvcihmbikge1xuICBjb25zdCBmcCA9IGZuLnByb3RvdHlwZTtcbiAgY29uc3QgaGFzQ29uc3RydWN0b3IgPSBmcCAmJiBmcC5jb25zdHJ1Y3RvciA9PT0gZm4gJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoZnApLmxlbmd0aCA+IDE7XG4gIGNvbnN0IGZ1bmN0aW9uU3RyID0gIWhhc0NvbnN0cnVjdG9yICYmIHNhZmVUb1N0cmluZyhmbik7XG4gIHJldHVybiBoYXNDb25zdHJ1Y3RvciB8fCAvXmZ1bmN0aW9uXFxzK1tBLVpdLy50ZXN0KGZ1bmN0aW9uU3RyKSB8fCAvXmNsYXNzXFxiLy50ZXN0KGZ1bmN0aW9uU3RyKTtcbn1cbnZhciBidWlsZEluUHJvcHMgPSBtYWtlTWFwMihbXG4gIFwibGVuZ3RoXCIsXG4gIFwiY2FsbGVyXCIsXG4gIFwiY2FsbGVlXCIsXG4gIFwiYXJndW1lbnRzXCIsXG4gIFwicHJvdG90eXBlXCIsXG4gIFN5bWJvbC5oYXNJbnN0YW5jZVxuXSk7XG5mdW5jdGlvbiB0cmFuc2ZlclByb3BzKG8sIG4pIHtcbiAgZm9yIChjb25zdCBrZXkgb2YgUmVmbGVjdC5vd25LZXlzKG8pKSB7XG4gICAgaWYgKGJ1aWxkSW5Qcm9wcyhrZXkpKVxuICAgICAgY29udGludWU7XG4gICAgY29uc3QgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobiwga2V5KTtcbiAgICBpZiAoZGVzYyAmJiBkZXNjLndyaXRhYmxlKSB7XG4gICAgICBuW2tleV0gPSBvW2tleV07XG4gICAgfVxuICB9XG59XG5mdW5jdGlvbiBiaW5kKGZuLCBjb250ZXh0KSB7XG4gIGNvbnN0IGZOT1AgPSBmdW5jdGlvbigpIHtcbiAgfTtcbiAgZnVuY3Rpb24gYm91bmQoKSB7XG4gICAgY29uc3QgYXJncyA9IGhhbmRsZXJQYXJhbXMoYXJndW1lbnRzKTtcbiAgICBpZiAodGhpcyBpbnN0YW5jZW9mIGJvdW5kKSB7XG4gICAgICBjb25zdCBvYmogPSBuZXcgZm4oLi4uYXJncyk7XG4gICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2Yob2JqLCBib3VuZC5wcm90b3R5cGUpO1xuICAgICAgcmV0dXJuIG9iajtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZuLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgIH1cbiAgfVxuICBib3VuZC4kbmF0aXZlID0gZm47XG4gIHRyYW5zZmVyUHJvcHMoZm4sIGJvdW5kKTtcbiAgaWYgKGZuLnByb3RvdHlwZSkge1xuICAgIGZOT1AucHJvdG90eXBlID0gZm4ucHJvdG90eXBlO1xuICB9XG4gIGJvdW5kLnByb3RvdHlwZSA9IG5ldyBmTk9QKCk7XG4gIGlmIChTeW1ib2wuaGFzSW5zdGFuY2UpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYm91bmQsIFN5bWJvbC5oYXNJbnN0YW5jZSwge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgdmFsdWUoaW5zdGFuY2UpIHtcbiAgICAgICAgY29uc3Qgb3AgPSBmbi5wcm90b3R5cGU7XG4gICAgICAgIHJldHVybiBpc09iamVjdChvcCkgfHwgdHlwZW9mIG9wID09PSBcImZ1bmN0aW9uXCIgPyBpbnN0YW5jZSBpbnN0YW5jZW9mIGZuIDogZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIGJvdW5kO1xufVxuXG4vLyBzcmMvbW9kdWxlcy9oaXN0b3J5LnRzXG52YXIgcGFzc2VkS2V5ID0gbWFrZU1hcDMoW1wic2Nyb2xsUmVzdG9yYXRpb25cIl0pO1xuZnVuY3Rpb24gaGlzdG9yeU1vZHVsZSgpIHtcbiAgY29uc3QgcHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yod2luZG93Lmhpc3RvcnkpIHx8IEhpc3RvcnkucHJvdG90eXBlO1xuICBjb25zdCBmYWtlSGlzdG9yeSA9IE9iamVjdC5jcmVhdGUocHJvdG8pO1xuICBjb25zdCBwcm94eUhpc3RvcnkgPSBuZXcgUHJveHkoZmFrZUhpc3RvcnksIHtcbiAgICBnZXQodGFyZ2V0LCBwKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IGhhc093bjIodGFyZ2V0LCBwKSA/IHRhcmdldFtwXSA6IHdpbmRvdy5oaXN0b3J5W3BdO1xuICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiID8gdmFsdWUuYmluZCh3aW5kb3cuaGlzdG9yeSkgOiB2YWx1ZTtcbiAgICB9LFxuICAgIHNldCh0YXJnZXQsIHAsIHZhbHVlLCByZWNlaXZlcikge1xuICAgICAgY29uc3QgaXNQYXNzS2V5ID0gdHlwZW9mIHAgPT09IFwic3RyaW5nXCIgJiYgcGFzc2VkS2V5KHApO1xuICAgICAgY29uc3QgdmVyaWZ5U2V0dGVyUmVzdWx0ID0gdmVyaWZ5U2V0dGVyKGlzUGFzc0tleSA/IGhpc3RvcnkgOiBudWxsLCB0YXJnZXQsIHAsIHZhbHVlLCByZWNlaXZlcik7XG4gICAgICBpZiAodmVyaWZ5U2V0dGVyUmVzdWx0ICE9PSB2b2lkIDApIHtcbiAgICAgICAgcmV0dXJuIHZlcmlmeVNldHRlclJlc3VsdDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBpc1Bhc3NLZXkgPyBSZWZsZWN0LnNldChoaXN0b3J5LCBwLCB2YWx1ZSkgOiBSZWZsZWN0LnNldCh0YXJnZXQsIHAsIHZhbHVlLCByZWNlaXZlcik7XG4gICAgICB9XG4gICAgfSxcbiAgICBnZXRQcm90b3R5cGVPZigpIHtcbiAgICAgIHJldHVybiBmYWtlSGlzdG9yeTtcbiAgICB9XG4gIH0pO1xuICBjb25zdCBmYWtlSGlzdG9yeUN0b3IgPSBmdW5jdGlvbiBIaXN0b3J5MigpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSWxsZWdhbCBjb25zdHJ1Y3RvclwiKTtcbiAgfTtcbiAgZmFrZUhpc3RvcnlDdG9yLnByb3RvdHlwZSA9IGZha2VIaXN0b3J5O1xuICBmYWtlSGlzdG9yeUN0b3IucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gZmFrZUhpc3RvcnlDdG9yO1xuICByZXR1cm4ge1xuICAgIG92ZXJyaWRlOiB7XG4gICAgICBoaXN0b3J5OiBwcm94eUhpc3RvcnksXG4gICAgICBIaXN0b3J5OiBmYWtlSGlzdG9yeUN0b3JcbiAgICB9XG4gIH07XG59XG5cbi8vIHNyYy9tb2R1bGVzL25ldHdvcmsudHNcbmltcG9ydCB7XG4gIGhhc093biBhcyBoYXNPd24zLFxuICBpc1Byb21pc2UsXG4gIGlzQWJzb2x1dGUsXG4gIHRyYW5zZm9ybVVybCxcbiAgdG9Xc1Byb3RvY29sXG59IGZyb20gXCJAZ2FyZmlzaC91dGlsc1wiO1xuZnVuY3Rpb24gbmV0d29ya01vZHVsZShzYW5kYm94KSB7XG4gIGNvbnN0IGJhc2VVcmwgPSBzYW5kYm94Lm9wdGlvbnMuYmFzZVVybDtcbiAgY29uc3Qgd3NTZXQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICBjb25zdCB4aHJTZXQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICBjb25zdCBmZXRjaFNldCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7XG4gIGNvbnN0IG5lZWRGaXggPSAodXJsKSA9PiBzYW5kYm94Lm9wdGlvbnMuZml4QmFzZVVybCAmJiBiYXNlVXJsICYmIHR5cGVvZiB1cmwgPT09IFwic3RyaW5nXCIgJiYgIWlzQWJzb2x1dGUodXJsKTtcbiAgY2xhc3MgZmFrZVhNTEh0dHBSZXF1ZXN0IGV4dGVuZHMgWE1MSHR0cFJlcXVlc3Qge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgc3VwZXIoKTtcbiAgICAgIHhoclNldC5hZGQodGhpcyk7XG4gICAgfVxuICAgIG9wZW4oKSB7XG4gICAgICBpZiAoYXJndW1lbnRzWzJdID09PSBmYWxzZSkge1xuICAgICAgICB4aHJTZXQuZGVsZXRlKHRoaXMpO1xuICAgICAgfVxuICAgICAgaWYgKG5lZWRGaXgoYXJndW1lbnRzWzFdKSkge1xuICAgICAgICBhcmd1bWVudHNbMV0gPSBiYXNlVXJsID8gdHJhbnNmb3JtVXJsKGJhc2VVcmwsIGFyZ3VtZW50c1sxXSkgOiBhcmd1bWVudHNbMV07XG4gICAgICB9XG4gICAgICBjb25zdCB1cmwgPSBhcmd1bWVudHNbMV07XG4gICAgICBpZiAoc2FuZGJveC5vcHRpb25zLmFkZFNvdXJjZUxpc3QpIHtcbiAgICAgICAgc2FuZGJveC5vcHRpb25zLmFkZFNvdXJjZUxpc3Qoe1xuICAgICAgICAgIHRhZ05hbWU6IFwieG1saHR0cHJlcXVlc3RcIixcbiAgICAgICAgICB1cmxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gc3VwZXIub3Blbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgICBhYm9ydCgpIHtcbiAgICAgIHhoclNldC5kZWxldGUodGhpcyk7XG4gICAgICByZXR1cm4gc3VwZXIuYWJvcnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG4gIH1cbiAgY2xhc3MgZmFrZVdlYlNvY2tldCBleHRlbmRzIFdlYlNvY2tldCB7XG4gICAgY29uc3RydWN0b3IodXJsLCBwcm90b2NvbHMpIHtcbiAgICAgIGlmIChuZWVkRml4KHVybCkgJiYgYmFzZVVybCkge1xuICAgICAgICBjb25zdCBiYXNlV3NVcmwgPSB0b1dzUHJvdG9jb2woYmFzZVVybCk7XG4gICAgICAgIHVybCA9IHRyYW5zZm9ybVVybChiYXNlV3NVcmwsIGFyZ3VtZW50c1sxXSk7XG4gICAgICB9XG4gICAgICBzdXBlcih1cmwsIHByb3RvY29scyk7XG4gICAgICB3c1NldC5hZGQodGhpcyk7XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgd3NTZXQuZGVsZXRlKHRoaXMpO1xuICAgICAgcmV0dXJuIHN1cGVyLmNsb3NlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuICB9XG4gIGNvbnN0IGZha2VGZXRjaCA9IChpbnB1dCwgb3B0aW9ucyA9IHt9KSA9PiB7XG4gICAgaWYgKG5lZWRGaXgoaW5wdXQpICYmIGJhc2VVcmwpIHtcbiAgICAgIGlucHV0ID0gdHJhbnNmb3JtVXJsKGJhc2VVcmwsIGlucHV0KTtcbiAgICB9XG4gICAgaWYgKHNhbmRib3gub3B0aW9ucy5hZGRTb3VyY2VMaXN0KSB7XG4gICAgICBzYW5kYm94Lm9wdGlvbnMuYWRkU291cmNlTGlzdCh7XG4gICAgICAgIHRhZ05hbWU6IFwiZmV0Y2hcIixcbiAgICAgICAgdXJsOiBpbnB1dFxuICAgICAgfSk7XG4gICAgfVxuICAgIGxldCBjb250cm9sbGVyO1xuICAgIGlmICghaGFzT3duMyhvcHRpb25zLCBcInNpZ25hbFwiKSAmJiB3aW5kb3cuQWJvcnRDb250cm9sbGVyKSB7XG4gICAgICBjb250cm9sbGVyID0gbmV3IHdpbmRvdy5BYm9ydENvbnRyb2xsZXIoKTtcbiAgICAgIGZldGNoU2V0LmFkZChjb250cm9sbGVyKTtcbiAgICAgIG9wdGlvbnMuc2lnbmFsID0gY29udHJvbGxlci5zaWduYWw7XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdCA9IHdpbmRvdy5mZXRjaChpbnB1dCwgb3B0aW9ucyk7XG4gICAgcmV0dXJuIGNvbnRyb2xsZXIgJiYgaXNQcm9taXNlKHJlc3VsdCkgPyByZXN1bHQuZmluYWxseSgoKSA9PiBmZXRjaFNldC5kZWxldGUoY29udHJvbGxlcikpIDogcmVzdWx0O1xuICB9O1xuICByZXR1cm4ge1xuICAgIG92ZXJyaWRlOiB7XG4gICAgICBXZWJTb2NrZXQ6IGZha2VXZWJTb2NrZXQsXG4gICAgICBYTUxIdHRwUmVxdWVzdDogZmFrZVhNTEh0dHBSZXF1ZXN0LFxuICAgICAgZmV0Y2g6IGZha2VGZXRjaFxuICAgIH0sXG4gICAgcmVjb3ZlcigpIHtcbiAgICAgIHdzU2V0LmZvckVhY2goKHdzKSA9PiB7XG4gICAgICAgIGlmICh0eXBlb2Ygd3MuY2xvc2UgPT09IFwiZnVuY3Rpb25cIilcbiAgICAgICAgICB3cy5jbG9zZSgpO1xuICAgICAgfSk7XG4gICAgICB4aHJTZXQuZm9yRWFjaCgoeGhyKSA9PiB7XG4gICAgICAgIGlmICh0eXBlb2YgeGhyLmFib3J0ID09PSBcImZ1bmN0aW9uXCIpXG4gICAgICAgICAgeGhyLmFib3J0KCk7XG4gICAgICB9KTtcbiAgICAgIGZldGNoU2V0LmZvckVhY2goKGN0b3IpID0+IHtcbiAgICAgICAgaWYgKHR5cGVvZiBjdG9yLmFib3J0ID09PSBcImZ1bmN0aW9uXCIpXG4gICAgICAgICAgY3Rvci5hYm9ydCgpO1xuICAgICAgfSk7XG4gICAgICB3c1NldC5jbGVhcigpO1xuICAgICAgeGhyU2V0LmNsZWFyKCk7XG4gICAgICBmZXRjaFNldC5jbGVhcigpO1xuICAgIH1cbiAgfTtcbn1cblxuLy8gc3JjL3Byb3h5SW50ZXJjZXB0b3IvZG9jdW1lbnQudHNcbmltcG9ydCB7XG4gIGhhc093biBhcyBoYXNPd240LFxuICBtYWtlTWFwIGFzIG1ha2VNYXA0LFxuICBpc09iamVjdCBhcyBpc09iamVjdDIsXG4gIGZpbmRUYXJnZXQsXG4gIHNhZmFyaTEzRGVhbCxcbiAgX19Nb2NrQm9keV9fLFxuICBfX01vY2tIZWFkX19cbn0gZnJvbSBcIkBnYXJmaXNoL3V0aWxzXCI7XG52YXIgcGFzc2VkS2V5MiA9IG1ha2VNYXA0KFtcInRpdGxlXCIsIFwiY29va2llXCIsIFwib25zZWxlY3RzdGFydFwiLCBcIm9uZHJhZ3N0YXJ0XCJdKTtcbnZhciBxdWVyeUZ1bmN0aW9ucyA9IG1ha2VNYXA0KFtcbiAgXCJxdWVyeVNlbGVjdG9yXCIsXG4gIFwicXVlcnlTZWxlY3RvckFsbFwiLFxuICBcImdldEVsZW1lbnRCeUlkXCIsXG4gIFwiZ2V0RWxlbWVudHNCeVRhZ05hbWVcIixcbiAgXCJnZXRFbGVtZW50c0J5VGFnTmFtZU5TXCIsXG4gIFwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZVwiXG5dKTtcbmZ1bmN0aW9uIGNyZWF0ZUdldHRlcihzYW5kYm94KSB7XG4gIHJldHVybiAodGFyZ2V0LCBwLCByZWNlaXZlcikgPT4ge1xuICAgIGlmIChwID09PSBcImFjdGl2ZUVsZW1lbnRcIikge1xuICAgICAgcmV0dXJuIFJlZmxlY3QuZ2V0KGRvY3VtZW50LCBwKTtcbiAgICB9XG4gICAgY29uc3Qgcm9vdE5vZGUgPSByb290RWxtKHNhbmRib3gpO1xuICAgIGNvbnN0IHN0cmljdElzb2xhdGlvbiA9IHNhbmRib3gub3B0aW9ucy5zdHJpY3RJc29sYXRpb247XG4gICAgY29uc3QgdmFsdWUgPSBoYXNPd240KHRhcmdldCwgcCkgPyBSZWZsZWN0LmdldCh0YXJnZXQsIHAsIHJlY2VpdmVyKSA6IFJlZmxlY3QuZ2V0KGRvY3VtZW50LCBwKTtcbiAgICBjb25zdCBob29rc1JlcyA9IHNhbmRib3guaG9va3MubGlmZWN5Y2xlLmRvY3VtZW50R2V0dGVyLmVtaXQoe1xuICAgICAgdmFsdWUsXG4gICAgICByb290Tm9kZSxcbiAgICAgIHByb3BOYW1lOiBwLFxuICAgICAgcHJveHlEb2N1bWVudDogdGFyZ2V0LFxuICAgICAgY3VzdG9tVmFsdWU6IG51bGxcbiAgICB9KTtcbiAgICBpZiAoaG9va3NSZXMuY3VzdG9tVmFsdWUpIHtcbiAgICAgIHJldHVybiBob29rc1Jlcy5jdXN0b21WYWx1ZTtcbiAgICB9XG4gICAgY29uc3Qgc2V0U2FuZGJveFJlZiA9IChlbCkgPT4ge1xuICAgICAgaWYgKGlzT2JqZWN0MihlbCkpIHtcbiAgICAgICAgc2FuZGJveE1hcC5zZXRFbGVtZW50VGFnKGVsLCBzYW5kYm94KTtcbiAgICAgICAgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID8gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiIDogZmFsc2UpIHtcbiAgICAgICAgICBlbC5fX1NBTkRCT1hfXyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBlbDtcbiAgICB9O1xuICAgIGlmIChyb290Tm9kZSkge1xuICAgICAgaWYgKHAgPT09IFwiY3JlYXRlRWxlbWVudFwiKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0YWdOYW1lLCBvcHRpb25zKSB7XG4gICAgICAgICAgY29uc3QgZWwgPSB2YWx1ZS5jYWxsKGRvY3VtZW50LCB0YWdOYW1lLCBvcHRpb25zKTtcbiAgICAgICAgICByZXR1cm4gc2V0U2FuZGJveFJlZihlbCk7XG4gICAgICAgIH07XG4gICAgICB9IGVsc2UgaWYgKHAgPT09IFwiY3JlYXRlVGV4dE5vZGVcIikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIGNvbnN0IGVsID0gdmFsdWUuY2FsbChkb2N1bWVudCwgZGF0YSk7XG4gICAgICAgICAgcmV0dXJuIHNldFNhbmRib3hSZWYoZWwpO1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIGlmIChwID09PSBcImhlYWRcIikge1xuICAgICAgICByZXR1cm4gZmluZFRhcmdldChyb290Tm9kZSwgW1wiaGVhZFwiLCBgZGl2WyR7X19Nb2NrSGVhZF9ffV1gXSkgfHwgdmFsdWU7XG4gICAgICB9XG4gICAgICBpZiAoc3RyaWN0SXNvbGF0aW9uKSB7XG4gICAgICAgIGlmIChwID09PSBcImJvZHlcIikge1xuICAgICAgICAgIHJldHVybiBmaW5kVGFyZ2V0KHJvb3ROb2RlLCBbXCJib2R5XCIsIGBkaXZbJHtfX01vY2tCb2R5X199XWBdKTtcbiAgICAgICAgfSBlbHNlIGlmIChxdWVyeUZ1bmN0aW9ucyhwKSkge1xuICAgICAgICAgIHJldHVybiBwID09PSBcImdldEVsZW1lbnRCeUlkXCIgPyAoaWQyKSA9PiByb290Tm9kZS5xdWVyeVNlbGVjdG9yKGAjJHtpZDJ9YCkgOiByb290Tm9kZVtwXS5iaW5kKHJvb3ROb2RlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIGxldCBuZXdWYWx1ZSA9IGhhc093bjQodmFsdWUsIF9fZG9jdW1lbnRCaW5kX18pID8gdmFsdWVbX19kb2N1bWVudEJpbmRfX10gOiBudWxsO1xuICAgICAgaWYgKCFuZXdWYWx1ZSlcbiAgICAgICAgbmV3VmFsdWUgPSBiaW5kKHZhbHVlLCBkb2N1bWVudCk7XG4gICAgICBjb25zdCB2ZXJpZnlSZXN1bHQgPSB2ZXJpZnlHZXR0ZXJEZXNjcmlwdG9yKHRhcmdldCwgcCwgbmV3VmFsdWUpO1xuICAgICAgaWYgKHZlcmlmeVJlc3VsdCA+IDApIHtcbiAgICAgICAgaWYgKHZlcmlmeVJlc3VsdCA9PT0gMSlcbiAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIGlmICh2ZXJpZnlSZXN1bHQgPT09IDIpXG4gICAgICAgICAgcmV0dXJuIHZvaWQgMDtcbiAgICAgIH1cbiAgICAgIHZhbHVlW19fZG9jdW1lbnRCaW5kX19dID0gbmV3VmFsdWU7XG4gICAgICByZXR1cm4gbmV3VmFsdWU7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfTtcbn1cbnZhciBzYWZhcmlQcm94eURvY3VtZW50RGVhbEhhbmRsZXIgPSBzYWZhcmkxM0RlYWwoKTtcbmZ1bmN0aW9uIGNyZWF0ZVNldHRlcihzYW5kYm94KSB7XG4gIHJldHVybiAodGFyZ2V0LCBwLCB2YWx1ZSwgcmVjZWl2ZXIpID0+IHtcbiAgICBjb25zdCByb290Tm9kZSA9IHJvb3RFbG0oc2FuZGJveCk7XG4gICAgY29uc3QgdmVyaWZ5UmVzdWx0ID0gdmVyaWZ5U2V0dGVyRGVzY3JpcHRvcih0eXBlb2YgcCA9PT0gXCJzdHJpbmdcIiAmJiBwYXNzZWRLZXkyKHApID8gZG9jdW1lbnQgOiByZWNlaXZlciB8fCB0YXJnZXQsIHAsIHZhbHVlKTtcbiAgICBpZiAodmVyaWZ5UmVzdWx0ID4gMCkge1xuICAgICAgaWYgKHZlcmlmeVJlc3VsdCA9PT0gMSB8fCB2ZXJpZnlSZXN1bHQgPT09IDIpXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIGlmICh2ZXJpZnlSZXN1bHQgPT09IDMpXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpZiAocCA9PT0gXCJvbnNlbGVjdHN0YXJ0XCIgfHwgcCA9PT0gXCJvbmRyYWdzdGFydFwiKSB7XG4gICAgICBpZiAocm9vdE5vZGUpIHtcbiAgICAgICAgcmV0dXJuIFJlZmxlY3Quc2V0KHJvb3ROb2RlLCBwLCB2YWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUmVmbGVjdC5zZXQoZG9jdW1lbnQsIHAsIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHR5cGVvZiBwID09PSBcInN0cmluZ1wiICYmIHBhc3NlZEtleTIocCkpIHtcbiAgICAgIHJldHVybiBSZWZsZWN0LnNldChkb2N1bWVudCwgcCwgdmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzYWZhcmlQcm94eURvY3VtZW50RGVhbEhhbmRsZXIudHJpZ2dlclNldCgpO1xuICAgICAgcmV0dXJuIFJlZmxlY3Quc2V0KHRhcmdldCwgcCwgdmFsdWUsIHJlY2VpdmVyKTtcbiAgICB9XG4gIH07XG59XG5mdW5jdGlvbiBjcmVhdGVEZWZpbmVQcm9wZXJ0eSgpIHtcbiAgcmV0dXJuICh0YXJnZXQsIHAsIGRlc2NyaXB0b3IpID0+IHtcbiAgICBzYWZhcmlQcm94eURvY3VtZW50RGVhbEhhbmRsZXIuaGFuZGxlRGVzY3JpcHRvcihkZXNjcmlwdG9yKTtcbiAgICByZXR1cm4gcGFzc2VkS2V5MihwKSA/IFJlZmxlY3QuZGVmaW5lUHJvcGVydHkoZG9jdW1lbnQsIHAsIGRlc2NyaXB0b3IpIDogUmVmbGVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHAsIGRlc2NyaXB0b3IpO1xuICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlSGFzKCkge1xuICByZXR1cm4gKHRhcmdldCwgcCkgPT4ge1xuICAgIGlmIChwID09PSBcImFjdGl2ZUVsZW1lbnRcIilcbiAgICAgIHJldHVybiBSZWZsZWN0Lmhhcyhkb2N1bWVudCwgcCk7XG4gICAgcmV0dXJuIGhhc093bjQodGFyZ2V0LCBwKSB8fCBSZWZsZWN0Lmhhcyhkb2N1bWVudCwgcCk7XG4gIH07XG59XG5cbi8vIHNyYy9tb2R1bGVzL2RvY3VtZW50LnRzXG52YXIgZG9jdW1lbnRNb2R1bGUgPSAoc2FuZGJveCkgPT4ge1xuICBsZXQgcHJveHlEb2N1bWVudCA9IE9iamVjdC5jcmVhdGUoZG9jdW1lbnQpO1xuICBjb25zdCBnZXR0ZXIgPSBjcmVhdGVHZXR0ZXIoc2FuZGJveCk7XG4gIGNvbnN0IGZha2VEb2N1bWVudCA9IGNyZWF0ZUZha2VPYmplY3QoZG9jdW1lbnQpO1xuICBjb25zdCBmYWtlRG9jdW1lbnRQcm90byA9IG5ldyBQcm94eShmYWtlRG9jdW1lbnQsIHtcbiAgICBnZXQ6ICguLi5hcmdzKSA9PiB7XG4gICAgICBtaWNyb1Rhc2tIdG1sUHJveHlEb2N1bWVudChwcm94eURvY3VtZW50KTtcbiAgICAgIHJldHVybiBnZXR0ZXIoLi4uYXJncyk7XG4gICAgfSxcbiAgICBoYXM6IGNyZWF0ZUhhcygpXG4gIH0pO1xuICBwcm94eURvY3VtZW50ID0gbmV3IFByb3h5KE9iamVjdC5jcmVhdGUoZmFrZURvY3VtZW50UHJvdG8sIHtcbiAgICBjdXJyZW50U2NyaXB0OiB7XG4gICAgICB2YWx1ZTogbnVsbCxcbiAgICAgIHdyaXRhYmxlOiB0cnVlXG4gICAgfSxcbiAgICBbX19wcm94eU5vZGVfX106IHtcbiAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgICB2YWx1ZTogZG9jdW1lbnRcbiAgICB9XG4gIH0pLCB7XG4gICAgc2V0OiBjcmVhdGVTZXR0ZXIoc2FuZGJveCksXG4gICAgZGVmaW5lUHJvcGVydHk6IGNyZWF0ZURlZmluZVByb3BlcnR5KCksXG4gICAgZ2V0UHJvdG90eXBlT2YoKSB7XG4gICAgICByZXR1cm4gSFRNTERvY3VtZW50LnByb3RvdHlwZSB8fCBEb2N1bWVudC5wcm90b3R5cGU7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHtcbiAgICBvdmVycmlkZToge1xuICAgICAgZG9jdW1lbnQ6IHByb3h5RG9jdW1lbnRcbiAgICB9XG4gIH07XG59O1xuXG4vLyBzcmMvbW9kdWxlcy91aUV2ZW50LnRzXG5pbXBvcnQgeyBnZXRUeXBlIH0gZnJvbSBcIkBnYXJmaXNoL3V0aWxzXCI7XG52YXIgTW91c2VFdmVudFBhdGNoID0gY2xhc3MgZXh0ZW5kcyBNb3VzZUV2ZW50IHtcbiAgY29uc3RydWN0b3IodHlwZUFyZywgbW91c2VFdmVudEluaXQpIHtcbiAgICBpZiAobW91c2VFdmVudEluaXQgJiYgZ2V0VHlwZShtb3VzZUV2ZW50SW5pdC52aWV3KSA9PT0gXCJ3aW5kb3dcIikge1xuICAgICAgbW91c2VFdmVudEluaXQudmlldyA9IHdpbmRvdztcbiAgICB9XG4gICAgc3VwZXIodHlwZUFyZywgbW91c2VFdmVudEluaXQpO1xuICB9XG59O1xuZnVuY3Rpb24gVWlFdmVudE92ZXJyaWRlKCkge1xuICByZXR1cm4ge1xuICAgIG92ZXJyaWRlOiB7XG4gICAgICBNb3VzZUV2ZW50OiBNb3VzZUV2ZW50UGF0Y2hcbiAgICB9XG4gIH07XG59XG5cbi8vIHNyYy9tb2R1bGVzL3N0b3JhZ2UudHNcbnZhciBDdXNTdG9yYWdlID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihuYW1lc3BhY2UsIHJhd1N0b3JhZ2UpIHtcbiAgICB0aGlzLnJhd1N0b3JhZ2UgPSByYXdTdG9yYWdlO1xuICAgIHRoaXMubmFtZXNwYWNlID0gbmFtZXNwYWNlO1xuICAgIHRoaXMucHJlZml4ID0gYCR7R0FSRklTSF9OQU1FU1BBQ0VfUFJFRklYfSR7bmFtZXNwYWNlfV9fYDtcbiAgfVxuICBnZXQgbGVuZ3RoKCkge1xuICAgIHJldHVybiB0aGlzLmdldEtleXMoKS5sZW5ndGg7XG4gIH1cbiAgZ2V0S2V5cygpIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5yYXdTdG9yYWdlKS5maWx0ZXIoKGtleSkgPT4ga2V5LnN0YXJ0c1dpdGgodGhpcy5wcmVmaXgpKTtcbiAgfVxuICBrZXkobikge1xuICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0S2V5cygpW25dO1xuICAgIHJldHVybiBrZXkgPyBrZXkuc3Vic3RyaW5nKHRoaXMucHJlZml4Lmxlbmd0aCkgOiBudWxsO1xuICB9XG4gIGdldEl0ZW0oa2V5TmFtZSkge1xuICAgIHJldHVybiB0aGlzLnJhd1N0b3JhZ2UuZ2V0SXRlbShgJHt0aGlzLnByZWZpeCArIGtleU5hbWV9YCk7XG4gIH1cbiAgc2V0SXRlbShrZXlOYW1lLCBrZXlWYWx1ZSkge1xuICAgIHRoaXMucmF3U3RvcmFnZS5zZXRJdGVtKGAke3RoaXMucHJlZml4ICsga2V5TmFtZX1gLCBrZXlWYWx1ZSk7XG4gIH1cbiAgcmVtb3ZlSXRlbShrZXlOYW1lKSB7XG4gICAgdGhpcy5yYXdTdG9yYWdlLnJlbW92ZUl0ZW0oYCR7dGhpcy5wcmVmaXggKyBrZXlOYW1lfWApO1xuICB9XG4gIGNsZWFyKCkge1xuICAgIHRoaXMuZ2V0S2V5cygpLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgdGhpcy5yYXdTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcbiAgICB9KTtcbiAgfVxufTtcbmZ1bmN0aW9uIGxvY2FsU3RvcmFnZU1vZHVsZShzYW5kYm94KSB7XG4gIGNvbnN0IG5hbWVzcGFjZSA9IHNhbmRib3gub3B0aW9ucy5uYW1lc3BhY2U7XG4gIHJldHVybiB7XG4gICAgb3ZlcnJpZGU6IHtcbiAgICAgIGxvY2FsU3RvcmFnZTogbmV3IEN1c1N0b3JhZ2UobmFtZXNwYWNlLCBsb2NhbFN0b3JhZ2UpLFxuICAgICAgc2Vzc2lvblN0b3JhZ2U6IG5ldyBDdXNTdG9yYWdlKG5hbWVzcGFjZSwgc2Vzc2lvblN0b3JhZ2UpXG4gICAgfVxuICB9O1xufVxuXG4vLyBzcmMvbW9kdWxlcy9ldmVudExpc3RlbmVyLnRzXG5mdW5jdGlvbiBsaXN0ZW5lck1vZHVsZShfc2FuZGJveCkge1xuICBjb25zdCBsaXN0ZW5lcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuICBjb25zdCByYXdBZGRFdmVudExpc3RlbmVyID0gd2luZG93LmFkZEV2ZW50TGlzdGVuZXI7XG4gIGNvbnN0IHJhd1JlbW92ZUV2ZW50TGlzdGVuZXIgPSB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcjtcbiAgZnVuY3Rpb24gYWRkTGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpIHtcbiAgICBjb25zdCBjdXJMaXN0ZW5lcnMgPSBsaXN0ZW5lcnMuZ2V0KHR5cGUpIHx8IFtdO1xuICAgIGxpc3RlbmVycy5zZXQodHlwZSwgWy4uLmN1ckxpc3RlbmVycywgbGlzdGVuZXJdKTtcbiAgICByYXdBZGRFdmVudExpc3RlbmVyLmNhbGwodGhpcywgdHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpO1xuICB9XG4gIGZ1bmN0aW9uIHJlbW92ZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKSB7XG4gICAgY29uc3QgY3VyTGlzdGVuZXJzID0gbGlzdGVuZXJzLmdldCh0eXBlKSB8fCBbXTtcbiAgICBjb25zdCBpZHggPSBjdXJMaXN0ZW5lcnMuaW5kZXhPZihsaXN0ZW5lcik7XG4gICAgaWYgKGlkeCAhPT0gLTEpIHtcbiAgICAgIGN1ckxpc3RlbmVycy5zcGxpY2UoaWR4LCAxKTtcbiAgICB9XG4gICAgbGlzdGVuZXJzLnNldCh0eXBlLCBbLi4uY3VyTGlzdGVuZXJzXSk7XG4gICAgcmF3UmVtb3ZlRXZlbnRMaXN0ZW5lci5jYWxsKHRoaXMsIHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKTtcbiAgfVxuICBjb25zdCByZWNvdmVyID0gKCkgPT4ge1xuICAgIGxpc3RlbmVycy5mb3JFYWNoKChsaXN0ZW5lciwga2V5KSA9PiB7XG4gICAgICBsaXN0ZW5lci5mb3JFYWNoKChmbikgPT4ge1xuICAgICAgICByYXdSZW1vdmVFdmVudExpc3RlbmVyLmNhbGwod2luZG93LCBrZXksIGZuKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIGxpc3RlbmVycy5jbGVhcigpO1xuICB9O1xuICByZXR1cm4ge1xuICAgIHJlY292ZXIsXG4gICAgb3ZlcnJpZGU6IHtcbiAgICAgIGFkZEV2ZW50TGlzdGVuZXI6IGFkZExpc3RlbmVyLmJpbmQod2luZG93KSxcbiAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXI6IHJlbW92ZUxpc3RlbmVyLmJpbmQod2luZG93KVxuICAgIH0sXG4gICAgY3JlYXRlZChnbG9iYWwpIHtcbiAgICAgIGNvbnN0IGZha2VEb2N1bWVudCA9IGdsb2JhbCA9PSBudWxsID8gdm9pZCAwIDogZ2xvYmFsLmRvY3VtZW50O1xuICAgICAgaWYgKGZha2VEb2N1bWVudCkge1xuICAgICAgICBmYWtlRG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciA9IGFkZExpc3RlbmVyLmJpbmQoZG9jdW1lbnQpO1xuICAgICAgICBmYWtlRG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IHJlbW92ZUxpc3RlbmVyLmJpbmQoZG9jdW1lbnQpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cblxuLy8gc3JjL21vZHVsZXMvbXV0YXRpb25PYnNlcnZlci50c1xuZnVuY3Rpb24gb2JzZXJ2ZXJNb2R1bGUoX3NhbmRib3gpIHtcbiAgY29uc3Qgb2JzZXJ2ZXJTZXQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICBjbGFzcyBQcm94eU11dGF0aW9uT2JzZXJ2ZXIgZXh0ZW5kcyBNdXRhdGlvbk9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3RvcihjYikge1xuICAgICAgc3VwZXIoY2IpO1xuICAgICAgb2JzZXJ2ZXJTZXQuYWRkKHRoaXMpO1xuICAgIH1cbiAgfVxuICBjb25zdCByZWNvdmVyID0gKCkgPT4ge1xuICAgIG9ic2VydmVyU2V0LmZvckVhY2goKG9ic2VydmVyKSA9PiB7XG4gICAgICBpZiAodHlwZW9mIG9ic2VydmVyLmRpc2Nvbm5lY3QgPT09IFwiZnVuY3Rpb25cIilcbiAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgIH0pO1xuICAgIG9ic2VydmVyU2V0LmNsZWFyKCk7XG4gIH07XG4gIHJldHVybiB7XG4gICAgcmVjb3ZlcixcbiAgICBvdmVycmlkZToge1xuICAgICAgTXV0YXRpb25PYnNlcnZlcjogUHJveHlNdXRhdGlvbk9ic2VydmVyXG4gICAgfVxuICB9O1xufVxuXG4vLyBzcmMvbW9kdWxlcy90aW1lci50c1xudmFyIHJhd1NldFRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dDtcbnZhciByYXdDbGVhclRpbWVvdXQgPSB3aW5kb3cuY2xlYXJUaW1lb3V0O1xudmFyIHJhd1NldEludGVydmFsID0gd2luZG93LnNldEludGVydmFsO1xudmFyIHJhd0NsZWFySW50ZXJ2YWwgPSB3aW5kb3cuY2xlYXJJbnRlcnZhbDtcbnZhciB0aW1lb3V0TW9kdWxlID0gKCkgPT4ge1xuICBjb25zdCB0aW1lb3V0ID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbiAgY29uc3Qgc2V0VGltZW91dDIgPSAoaGFuZGxlciwgbXMsIC4uLmFyZ3MpID0+IHtcbiAgICBjb25zdCB0aW1lb3V0SWQgPSByYXdTZXRUaW1lb3V0KGhhbmRsZXIsIG1zLCAuLi5hcmdzKTtcbiAgICB0aW1lb3V0LmFkZCh0aW1lb3V0SWQpO1xuICAgIHJldHVybiB0aW1lb3V0SWQ7XG4gIH07XG4gIGNvbnN0IGNsZWFyVGltZW91dCA9ICh0aW1lb3V0SWQpID0+IHtcbiAgICB0aW1lb3V0LmRlbGV0ZSh0aW1lb3V0SWQpO1xuICAgIHJhd0NsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICB9O1xuICBjb25zdCByZWNvdmVyID0gKCkgPT4ge1xuICAgIHRpbWVvdXQuZm9yRWFjaCgodGltZW91dElkKSA9PiB7XG4gICAgICByYXdDbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICB9KTtcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICByZWNvdmVyLFxuICAgIG92ZXJyaWRlOiB7XG4gICAgICBzZXRUaW1lb3V0OiBzZXRUaW1lb3V0MixcbiAgICAgIGNsZWFyVGltZW91dFxuICAgIH1cbiAgfTtcbn07XG52YXIgaW50ZXJ2YWxNb2R1bGUgPSAoKSA9PiB7XG4gIGNvbnN0IHRpbWVvdXQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICBjb25zdCBzZXRJbnRlcnZhbCA9IChjYWxsYmFjaywgbXMsIC4uLmFyZ3MpID0+IHtcbiAgICBjb25zdCBpbnRlcnZhbElkID0gcmF3U2V0SW50ZXJ2YWwoY2FsbGJhY2ssIG1zLCAuLi5hcmdzKTtcbiAgICB0aW1lb3V0LmFkZChpbnRlcnZhbElkKTtcbiAgICByZXR1cm4gaW50ZXJ2YWxJZDtcbiAgfTtcbiAgY29uc3QgY2xlYXJJbnRlcnZhbCA9IChpbnRlcnZhbElkKSA9PiB7XG4gICAgdGltZW91dC5kZWxldGUoaW50ZXJ2YWxJZCk7XG4gICAgcmF3Q2xlYXJJbnRlcnZhbChpbnRlcnZhbElkKTtcbiAgfTtcbiAgY29uc3QgcmVjb3ZlciA9ICgpID0+IHtcbiAgICB0aW1lb3V0LmZvckVhY2goKGludGVydmFsSWQpID0+IHtcbiAgICAgIHJhd0NsZWFySW50ZXJ2YWwoaW50ZXJ2YWxJZCk7XG4gICAgfSk7XG4gIH07XG4gIHJldHVybiB7XG4gICAgcmVjb3ZlcixcbiAgICBvdmVycmlkZToge1xuICAgICAgc2V0SW50ZXJ2YWwsXG4gICAgICBjbGVhckludGVydmFsLFxuICAgICAgc2V0SW1tZWRpYXRlOiAoZm4pID0+IHNldFRpbWVvdXQoZm4sIDApXG4gICAgfVxuICB9O1xufTtcblxuLy8gc3JjL2R5bmFtaWNOb2RlL2luZGV4LnRzXG5pbXBvcnQgeyBtYWtlTWFwIGFzIG1ha2VNYXA2LCBzYWZlV3JhcHBlciBhcyBzYWZlV3JhcHBlcjIsIHdhcm4gYXMgd2FybjMgfSBmcm9tIFwiQGdhcmZpc2gvdXRpbHNcIjtcblxuLy8gc3JjL2R5bmFtaWNOb2RlL3Byb2Nlc3NQYXJhbXMudHNcbmZ1bmN0aW9uIGluamVjdEhhbmRsZXJQYXJhbXMoKSB7XG4gIGlmICh3aW5kb3cuTXV0YXRpb25PYnNlcnZlcikge1xuICAgIGNvbnN0IHJhd09ic2VydmVyID0gd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIucHJvdG90eXBlLm9ic2VydmU7XG4gICAgTXV0YXRpb25PYnNlcnZlci5wcm90b3R5cGUub2JzZXJ2ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJhd09ic2VydmVyLmFwcGx5KHRoaXMsIGhhbmRsZXJQYXJhbXMoYXJndW1lbnRzKSk7XG4gICAgfTtcbiAgfVxuICBjb25zdCBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih3aW5kb3cuRG9jdW1lbnQucHJvdG90eXBlLCBcImFjdGl2ZUVsZW1lbnRcIik7XG4gIGNvbnN0IHJhd0FjdGl2ZUVsID0gZGVzYyAmJiBkZXNjLmdldDtcbiAgaWYgKHJhd0FjdGl2ZUVsKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5Eb2N1bWVudC5wcm90b3R5cGUsIFwiYWN0aXZlRWxlbWVudFwiLCB7XG4gICAgICBnZXQoLi4uYXJncykge1xuICAgICAgICByZXR1cm4gcmF3QWN0aXZlRWwuYXBwbHkoaGFuZGxlclBhcmFtcyhbdGhpc10pWzBdLCBoYW5kbGVyUGFyYW1zKGFyZ3MpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG4vLyBzcmMvZHluYW1pY05vZGUvcHJvY2Vzc29yLnRzXG5pbXBvcnQge1xuICBkZWYsXG4gIHdhcm4gYXMgd2FybjIsXG4gIERPTUFwaXMsXG4gIG1ha2VNYXAgYXMgbWFrZU1hcDUsXG4gIGlzSnNUeXBlLFxuICBpc0Nzc1R5cGUsXG4gIHNhZmVXcmFwcGVyLFxuICBmaW5kVGFyZ2V0IGFzIGZpbmRUYXJnZXQyLFxuICBfX01vY2tCb2R5X18gYXMgX19Nb2NrQm9keV9fMixcbiAgX19Nb2NrSGVhZF9fIGFzIF9fTW9ja0hlYWRfXzIsXG4gIHRyYW5zZm9ybVVybCBhcyB0cmFuc2Zvcm1VcmwyLFxuICBzb3VyY2VMaXN0VGFncyxcbiAgX19SRU1PVkVfTk9ERV9fXG59IGZyb20gXCJAZ2FyZmlzaC91dGlsc1wiO1xudmFyIGlzSW5zZXJ0TWV0aG9kID0gbWFrZU1hcDUoW1wiaW5zZXJ0QmVmb3JlXCIsIFwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50XCJdKTtcbnZhciByYXdFbGVtZW50TWV0aG9kcyA9IC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuY3JlYXRlKG51bGwpO1xudmFyIF9EeW5hbWljTm9kZVByb2Nlc3NvciA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoZWwsIHNhbmRib3gsIG1ldGhvZE5hbWUpIHtcbiAgICB0aGlzLm5hdGl2ZUFwcGVuZCA9IHJhd0VsZW1lbnRNZXRob2RzW1wiYXBwZW5kQ2hpbGRcIl07XG4gICAgdGhpcy5uYXRpdmVSZW1vdmUgPSByYXdFbGVtZW50TWV0aG9kc1tcInJlbW92ZUNoaWxkXCJdO1xuICAgIHRoaXMuZWwgPSBlbDtcbiAgICB0aGlzLnNhbmRib3ggPSBzYW5kYm94O1xuICAgIHRoaXMubWV0aG9kTmFtZSA9IG1ldGhvZE5hbWU7XG4gICAgdGhpcy5yb290RWxlbWVudCA9IHJvb3RFbG0oc2FuZGJveCkgfHwgZG9jdW1lbnQ7XG4gICAgdGhpcy5ET01BcGlzID0gbmV3IERPTUFwaXMoc2FuZGJveC5nbG9iYWwuZG9jdW1lbnQpO1xuICAgIHRoaXMudGFnTmFtZSA9IGVsLnRhZ05hbWUgPyBlbC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgOiBcIlwiO1xuICB9XG4gIGlzKHRhZykge1xuICAgIHJldHVybiB0aGlzLnRhZ05hbWUgPT09IHRhZztcbiAgfVxuICBmaXhSZXNvdXJjZU5vZGVVcmwoZWwpIHtcbiAgICBjb25zdCBiYXNlVXJsID0gdGhpcy5zYW5kYm94Lm9wdGlvbnMuYmFzZVVybDtcbiAgICBpZiAoYmFzZVVybCkge1xuICAgICAgY29uc3Qgc3JjID0gZWwuZ2V0QXR0cmlidXRlKFwic3JjXCIpO1xuICAgICAgY29uc3QgaHJlZiA9IGVsLmdldEF0dHJpYnV0ZShcImhyZWZcIik7XG4gICAgICBpZiAodGhpcy5zYW5kYm94Lm9wdGlvbnMuZml4U3RhdGljUmVzb3VyY2VCYXNlVXJsKSB7XG4gICAgICAgIHNyYyAmJiAoZWwuc3JjID0gdHJhbnNmb3JtVXJsMihiYXNlVXJsLCBzcmMpKTtcbiAgICAgICAgaHJlZiAmJiAoZWwuaHJlZiA9IHRyYW5zZm9ybVVybDIoYmFzZVVybCwgaHJlZikpO1xuICAgICAgfVxuICAgICAgY29uc3QgdXJsID0gZWwuc3JjIHx8IGVsLmhyZWY7XG4gICAgICBpZiAodXJsICYmIHRoaXMuc2FuZGJveC5vcHRpb25zLmFkZFNvdXJjZUxpc3QpIHtcbiAgICAgICAgdGhpcy5zYW5kYm94Lm9wdGlvbnMuYWRkU291cmNlTGlzdCh7XG4gICAgICAgICAgdGFnTmFtZTogZWwudGFnTmFtZSxcbiAgICAgICAgICB1cmxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGRpc3BhdGNoRXZlbnQodHlwZSwgZXJySW5mbykge1xuICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCkgPT4ge1xuICAgICAgdmFyIF9hO1xuICAgICAgY29uc3QgaXNFcnJvciA9IHR5cGUgPT09IFwiZXJyb3JcIjtcbiAgICAgIGxldCBldmVudDtcbiAgICAgIGlmIChpc0Vycm9yICYmIGVyckluZm8pIHtcbiAgICAgICAgZXZlbnQgPSBuZXcgRXJyb3JFdmVudCh0eXBlLCBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBlcnJJbmZvKSwge1xuICAgICAgICAgIG1lc3NhZ2U6IChfYSA9IGVyckluZm8uZXJyb3IpID09IG51bGwgPyB2b2lkIDAgOiBfYS5tZXNzYWdlXG4gICAgICAgIH0pKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGV2ZW50ID0gbmV3IEV2ZW50KHR5cGUpO1xuICAgICAgfVxuICAgICAgZXZlbnQuX19ieUdhcmZpc2hfXyA9IHRydWU7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXZlbnQsIFwidGFyZ2V0XCIsIHsgdmFsdWU6IHRoaXMuZWwgfSk7XG4gICAgICB0aGlzLmVsLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgICAgaXNFcnJvciAmJiB3aW5kb3cuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgfSk7XG4gIH1cbiAgYWRkRHluYW1pY0xpbmtOb2RlKGNhbGxiYWNrKSB7XG4gICAgY29uc3QgeyBocmVmLCB0eXBlIH0gPSB0aGlzLmVsO1xuICAgIGlmICghdHlwZSB8fCBpc0Nzc1R5cGUoeyBzcmM6IGhyZWYsIHR5cGUgfSkpIHtcbiAgICAgIGlmIChocmVmKSB7XG4gICAgICAgIGNvbnN0IHsgYmFzZVVybCwgbmFtZXNwYWNlLCBzdHlsZVNjb3BlSWQgfSA9IHRoaXMuc2FuZGJveC5vcHRpb25zO1xuICAgICAgICBjb25zdCBmZXRjaFVybCA9IGJhc2VVcmwgPyB0cmFuc2Zvcm1VcmwyKGJhc2VVcmwsIGhyZWYpIDogaHJlZjtcbiAgICAgICAgY29uc3QgbG9ja0lkID0gX0R5bmFtaWNOb2RlUHJvY2Vzc29yLmxpbmtMb2NrLmdlbklkKCk7XG4gICAgICAgIHRoaXMuc2FuZGJveC5sb2FkZXIubG9hZCh7XG4gICAgICAgICAgc2NvcGU6IG5hbWVzcGFjZSxcbiAgICAgICAgICB1cmw6IGZldGNoVXJsLFxuICAgICAgICAgIGRlZmF1bHRDb250ZW50VHlwZTogdHlwZVxuICAgICAgICB9KS50aGVuKGFzeW5jICh7IHJlc291cmNlTWFuYWdlcjogc3R5bGVNYW5hZ2VyIH0pID0+IHtcbiAgICAgICAgICBhd2FpdCBfRHluYW1pY05vZGVQcm9jZXNzb3IubGlua0xvY2sud2FpdChsb2NrSWQpO1xuICAgICAgICAgIGlmIChzdHlsZU1hbmFnZXIpIHtcbiAgICAgICAgICAgIHN0eWxlTWFuYWdlci5jb3JyZWN0UGF0aCgpO1xuICAgICAgICAgICAgaWYgKHN0eWxlU2NvcGVJZCkge1xuICAgICAgICAgICAgICBzdHlsZU1hbmFnZXIuc2V0U2NvcGUoe1xuICAgICAgICAgICAgICAgIGFwcE5hbWU6IG5hbWVzcGFjZSxcbiAgICAgICAgICAgICAgICByb290RWxJZDogc3R5bGVTY29wZUlkKClcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYWxsYmFjayhzdHlsZU1hbmFnZXIucmVuZGVyQXNTdHlsZUVsZW1lbnQoKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHdhcm4yKGBJbnZhbGlkIHJlc291cmNlIHR5cGUgXCIke3R5cGV9XCIsIFwiJHtocmVmfVwiIGNhbid0IGdlbmVyYXRlIHN0eWxlTWFuYWdlcmApO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXCJsb2FkXCIpO1xuICAgICAgICAgIF9EeW5hbWljTm9kZVByb2Nlc3Nvci5saW5rTG9jay5yZWxlYXNlKGxvY2tJZCk7XG4gICAgICAgIH0pLmNhdGNoKChlKSA9PiB7XG4gICAgICAgICAgX0R5bmFtaWNOb2RlUHJvY2Vzc29yLmxpbmtMb2NrLnJlbGVhc2UobG9ja0lkKTtcbiAgICAgICAgICAodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPyBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgOiBmYWxzZSkgJiYgd2FybjIoZSk7XG4gICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwiZXJyb3JcIiwge1xuICAgICAgICAgICAgZXJyb3I6IGUsXG4gICAgICAgICAgICBmaWxlbmFtZTogZmV0Y2hVcmxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudiAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViA/IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA6IGZhbHNlKSB7XG4gICAgICAgIHdhcm4yKGBJbnZhbGlkIHJlc291cmNlIHR5cGUgXCIke3R5cGV9XCIsIFwiJHtocmVmfVwiYCk7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGxpbmtDb21tZW50Tm9kZSA9IHRoaXMuRE9NQXBpcy5jcmVhdGVMaW5rQ29tbWVudE5vZGUoaHJlZik7XG4gICAgdGhpcy5lbFtfX1JFTU9WRV9OT0RFX19dID0gKCkgPT4gdGhpcy5ET01BcGlzLnJlbW92ZUVsZW1lbnQobGlua0NvbW1lbnROb2RlKTtcbiAgICByZXR1cm4gbGlua0NvbW1lbnROb2RlO1xuICB9XG4gIGFkZER5bmFtaWNTY3JpcHROb2RlKCkge1xuICAgIGNvbnN0IHsgc3JjLCB0eXBlLCBjcm9zc09yaWdpbiB9ID0gdGhpcy5lbDtcbiAgICBjb25zdCBpc01vZHVsZTIgPSB0eXBlID09PSBcIm1vZHVsZVwiO1xuICAgIGNvbnN0IGNvZGUgPSB0aGlzLmVsLnRleHRDb250ZW50IHx8IHRoaXMuZWwudGV4dCB8fCBcIlwiO1xuICAgIGlmICghdHlwZSB8fCBpc0pzVHlwZSh7IHNyYywgdHlwZSB9KSkge1xuICAgICAgY29uc3QgeyBiYXNlVXJsLCBuYW1lc3BhY2UgfSA9IHRoaXMuc2FuZGJveC5vcHRpb25zO1xuICAgICAgaWYgKHNyYykge1xuICAgICAgICBjb25zdCBmZXRjaFVybCA9IGJhc2VVcmwgPyB0cmFuc2Zvcm1VcmwyKGJhc2VVcmwsIHNyYykgOiBzcmM7XG4gICAgICAgIHRoaXMuc2FuZGJveC5sb2FkZXIubG9hZCh7XG4gICAgICAgICAgc2NvcGU6IG5hbWVzcGFjZSxcbiAgICAgICAgICB1cmw6IGZldGNoVXJsLFxuICAgICAgICAgIGNyb3NzT3JpZ2luLFxuICAgICAgICAgIGRlZmF1bHRDb250ZW50VHlwZTogdHlwZVxuICAgICAgICB9KS50aGVuKChtYW5hZ2VyKSA9PiB7XG4gICAgICAgICAgaWYgKG1hbmFnZXIucmVzb3VyY2VNYW5hZ2VyKSB7XG4gICAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICAgIHJlc291cmNlTWFuYWdlcjogeyB1cmwsIHNjcmlwdENvZGUgfVxuICAgICAgICAgICAgfSA9IG1hbmFnZXI7XG4gICAgICAgICAgICB0aGlzLnNhbmRib3guZXhlY1NjcmlwdChzY3JpcHRDb2RlLCB7fSwgdXJsLCB7XG4gICAgICAgICAgICAgIGlzTW9kdWxlOiBpc01vZHVsZTIsXG4gICAgICAgICAgICAgIGRlZmVyOiBmYWxzZSxcbiAgICAgICAgICAgICAgYXN5bmM6IGZhbHNlLFxuICAgICAgICAgICAgICBub0VudHJ5OiB0cnVlLFxuICAgICAgICAgICAgICBvcmlnaW5TY3JpcHQ6IHRoaXMuZWxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB3YXJuMihgSW52YWxpZCByZXNvdXJjZSB0eXBlIFwiJHt0eXBlfVwiLCBcIiR7c3JjfVwiIGNhbid0IGdlbmVyYXRlIHNjcmlwdE1hbmFnZXJgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwibG9hZFwiKTtcbiAgICAgICAgfSwgKGUpID0+IHtcbiAgICAgICAgICAodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPyBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgOiBmYWxzZSkgJiYgd2FybjIoZSk7XG4gICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFwiZXJyb3JcIiwge1xuICAgICAgICAgICAgZXJyb3I6IGUsXG4gICAgICAgICAgICBmaWxlbmFtZTogZmV0Y2hVcmxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKGNvZGUpIHtcbiAgICAgICAgdGhpcy5zYW5kYm94LmV4ZWNTY3JpcHQoY29kZSwge30sIGJhc2VVcmwsIHtcbiAgICAgICAgICBub0VudHJ5OiB0cnVlLFxuICAgICAgICAgIG9yaWdpblNjcmlwdDogdGhpcy5lbFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHNjcmlwdENvbW1lbnROb2RlID0gdGhpcy5ET01BcGlzLmNyZWF0ZVNjcmlwdENvbW1lbnROb2RlKHtcbiAgICAgICAgc3JjLFxuICAgICAgICBjb2RlXG4gICAgICB9KTtcbiAgICAgIHRoaXMuZWxbX19SRU1PVkVfTk9ERV9fXSA9ICgpID0+IHRoaXMuRE9NQXBpcy5yZW1vdmVFbGVtZW50KHNjcmlwdENvbW1lbnROb2RlKTtcbiAgICAgIHJldHVybiBzY3JpcHRDb21tZW50Tm9kZTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuZWw7XG4gIH1cbiAgbW9uaXRvckNoYW5nZXNPZkxpbmtOb2RlKCkge1xuICAgIGlmICh0aGlzLmVsLm1vZGlmeUZsYWcpXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgbXV0YXRvciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnMpID0+IHtcbiAgICAgIHZhciBfYTtcbiAgICAgIGlmICh0aGlzLmVsLm1vZGlmeUZsYWcpXG4gICAgICAgIHJldHVybjtcbiAgICAgIGZvciAoY29uc3QgeyB0eXBlLCBhdHRyaWJ1dGVOYW1lIH0gb2YgbXV0YXRpb25zKSB7XG4gICAgICAgIGlmICh0eXBlID09PSBcImF0dHJpYnV0ZXNcIikge1xuICAgICAgICAgIGlmIChhdHRyaWJ1dGVOYW1lID09PSBcInJlbFwiIHx8IGF0dHJpYnV0ZU5hbWUgPT09IFwic3R5bGVzaGVldFwiKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5lbC5tb2RpZnlGbGFnKVxuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBpZiAodGhpcy5lbC5yZWwgPT09IFwic3R5bGVzaGVldFwiICYmIHRoaXMuZWwuaHJlZikge1xuICAgICAgICAgICAgICB0aGlzLmVsLmRpc2FibGVkID0gdGhpcy5lbC5tb2RpZnlGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgY29uc3QgY29tbWVudE5vZGUgPSB0aGlzLmFkZER5bmFtaWNMaW5rTm9kZSgoc3R5bGVOb2RlKSA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIF9hMjtcbiAgICAgICAgICAgICAgICAoX2EyID0gY29tbWVudE5vZGUucGFyZW50Tm9kZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMi5yZXBsYWNlQ2hpbGQoc3R5bGVOb2RlLCBjb21tZW50Tm9kZSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAoX2EgPSB0aGlzLmVsLnBhcmVudE5vZGUpID09IG51bGwgPyB2b2lkIDAgOiBfYS5yZXBsYWNlQ2hpbGQoY29tbWVudE5vZGUsIHRoaXMuZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIG11dGF0b3Iub2JzZXJ2ZSh0aGlzLmVsLCB7IGF0dHJpYnV0ZXM6IHRydWUgfSk7XG4gIH1cbiAgbW9uaXRvckNoYW5nZXNPZlN0eWxlKCkge1xuICAgIGNvbnN0IHsgYmFzZVVybCwgbmFtZXNwYWNlLCBzdHlsZVNjb3BlSWQgfSA9IHRoaXMuc2FuZGJveC5vcHRpb25zO1xuICAgIGNvbnN0IHJvb3RFbElkID0gc3R5bGVTY29wZUlkID09IG51bGwgPyB2b2lkIDAgOiBzdHlsZVNjb3BlSWQoKTtcbiAgICBjb25zdCBtb2RpZnlTdHlsZUNvZGUgPSAoc3R5bGVDb2RlKSA9PiB7XG4gICAgICBpZiAoc3R5bGVDb2RlKSB7XG4gICAgICAgIGNvbnN0IG1hbmFnZXIgPSBuZXcgdGhpcy5zYW5kYm94LmxvYWRlci5TdHlsZU1hbmFnZXIoc3R5bGVDb2RlKTtcbiAgICAgICAgbWFuYWdlci5jb3JyZWN0UGF0aChiYXNlVXJsKTtcbiAgICAgICAgaWYgKHJvb3RFbElkKSB7XG4gICAgICAgICAgbWFuYWdlci5zZXRTY29wZSh7XG4gICAgICAgICAgICByb290RWxJZCxcbiAgICAgICAgICAgIGFwcE5hbWU6IG5hbWVzcGFjZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHN0eWxlQ29kZSA9IG1hbmFnZXIudHJhbnNmb3JtQ29kZShzdHlsZUNvZGUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHN0eWxlQ29kZTtcbiAgICB9O1xuICAgIGNvbnN0IG11dGF0b3IgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zKSA9PiB7XG4gICAgICB2YXIgX2E7XG4gICAgICBmb3IgKGNvbnN0IHsgdHlwZSwgYWRkZWROb2RlcyB9IG9mIG11dGF0aW9ucykge1xuICAgICAgICBpZiAodHlwZSA9PT0gXCJjaGlsZExpc3RcIikge1xuICAgICAgICAgIGlmICgoX2EgPSBhZGRlZE5vZGVzWzBdKSA9PSBudWxsID8gdm9pZCAwIDogX2EudGV4dENvbnRlbnQpIHtcbiAgICAgICAgICAgIGFkZGVkTm9kZXNbMF0udGV4dENvbnRlbnQgPSBtb2RpZnlTdHlsZUNvZGUoYWRkZWROb2Rlc1swXS50ZXh0Q29udGVudCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgbXV0YXRvci5vYnNlcnZlKHRoaXMuZWwsIHsgY2hpbGRMaXN0OiB0cnVlIH0pO1xuICAgIGxldCBmYWtlU2hlZXQgPSBudWxsO1xuICAgIFJlZmxlY3QuZGVmaW5lUHJvcGVydHkodGhpcy5lbCwgXCJzaGVldFwiLCB7XG4gICAgICBnZXQ6ICgpID0+IHtcbiAgICAgICAgaWYgKCFmYWtlU2hlZXQpIHtcbiAgICAgICAgICBmYWtlU2hlZXQgPSB0aGlzLmNyZWF0ZUZha2VTaGVldChtb2RpZnlTdHlsZUNvZGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWtlU2hlZXQ7XG4gICAgICB9LFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gIH1cbiAgZmluZFBhcmVudE5vZGVJbkFwcChwYXJlbnROb2RlLCBkZWZhdWx0SW5zZXJ0KSB7XG4gICAgaWYgKHBhcmVudE5vZGUgPT09IGRvY3VtZW50LmJvZHkpIHtcbiAgICAgIHJldHVybiBmaW5kVGFyZ2V0Mih0aGlzLnJvb3RFbGVtZW50LCBbXG4gICAgICAgIFwiYm9keVwiLFxuICAgICAgICBgZGl2WyR7X19Nb2NrQm9keV9fMn1dYFxuICAgICAgXSk7XG4gICAgfSBlbHNlIGlmIChwYXJlbnROb2RlID09PSBkb2N1bWVudC5oZWFkKSB7XG4gICAgICByZXR1cm4gZmluZFRhcmdldDIodGhpcy5yb290RWxlbWVudCwgW1xuICAgICAgICBcImhlYWRcIixcbiAgICAgICAgYGRpdlske19fTW9ja0hlYWRfXzJ9XWBcbiAgICAgIF0pO1xuICAgIH1cbiAgICBpZiAodGhpcy5yb290RWxlbWVudC5jb250YWlucyhwYXJlbnROb2RlKSB8fCAhZG9jdW1lbnQuY29udGFpbnMocGFyZW50Tm9kZSkpIHtcbiAgICAgIHJldHVybiBwYXJlbnROb2RlO1xuICAgIH1cbiAgICBpZiAoZGVmYXVsdEluc2VydCA9PT0gXCJoZWFkXCIpIHtcbiAgICAgIHJldHVybiBmaW5kVGFyZ2V0Mih0aGlzLnJvb3RFbGVtZW50LCBbXG4gICAgICAgIFwiaGVhZFwiLFxuICAgICAgICBgZGl2WyR7X19Nb2NrSGVhZF9fMn1dYFxuICAgICAgXSk7XG4gICAgfSBlbHNlIGlmIChkZWZhdWx0SW5zZXJ0ID09PSBcImJvZHlcIikge1xuICAgICAgcmV0dXJuIGZpbmRUYXJnZXQyKHRoaXMucm9vdEVsZW1lbnQsIFtcbiAgICAgICAgXCJib2R5XCIsXG4gICAgICAgIGBkaXZbJHtfX01vY2tCb2R5X18yfV1gXG4gICAgICBdKTtcbiAgICB9XG4gICAgcmV0dXJuIHBhcmVudE5vZGU7XG4gIH1cbiAgYXBwZW5kKGNvbnRleHQsIGFyZ3MsIG9yaWdpblByb2Nlc3MpIHtcbiAgICB2YXIgX2E7XG4gICAgbGV0IGNvbnZlcnRlZE5vZGU7XG4gICAgbGV0IHBhcmVudE5vZGUgPSBjb250ZXh0O1xuICAgIGNvbnN0IHsgYmFzZVVybCwgbmFtZXNwYWNlLCBzdHlsZVNjb3BlSWQgfSA9IHRoaXMuc2FuZGJveC5vcHRpb25zO1xuICAgIGlmIChzb3VyY2VMaXN0VGFncy5pbmNsdWRlcyh0aGlzLnRhZ05hbWUpKSB7XG4gICAgICB0aGlzLmZpeFJlc291cmNlTm9kZVVybCh0aGlzLmVsKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuaXMoXCJzY3JpcHRcIikpIHtcbiAgICAgIHBhcmVudE5vZGUgPSB0aGlzLmZpbmRQYXJlbnROb2RlSW5BcHAoY29udGV4dCwgXCJib2R5XCIpO1xuICAgICAgY29udmVydGVkTm9kZSA9IHRoaXMuYWRkRHluYW1pY1NjcmlwdE5vZGUoKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuaXMoXCJzdHlsZVwiKSkge1xuICAgICAgcGFyZW50Tm9kZSA9IHRoaXMuZmluZFBhcmVudE5vZGVJbkFwcChjb250ZXh0LCBcImhlYWRcIik7XG4gICAgICBjb25zdCBtYW5hZ2VyID0gbmV3IHRoaXMuc2FuZGJveC5sb2FkZXIuU3R5bGVNYW5hZ2VyKHRoaXMuZWwudGV4dENvbnRlbnQpO1xuICAgICAgbWFuYWdlci5jb3JyZWN0UGF0aChiYXNlVXJsKTtcbiAgICAgIGlmIChzdHlsZVNjb3BlSWQpIHtcbiAgICAgICAgbWFuYWdlci5zZXRTY29wZSh7XG4gICAgICAgICAgYXBwTmFtZTogbmFtZXNwYWNlLFxuICAgICAgICAgIHJvb3RFbElkOiBzdHlsZVNjb3BlSWQoKVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZWwudGV4dENvbnRlbnQgPSBtYW5hZ2VyLnRyYW5zZm9ybUNvZGUobWFuYWdlci5zdHlsZUNvZGUpO1xuICAgICAgY29udmVydGVkTm9kZSA9IHRoaXMuZWw7XG4gICAgICB0aGlzLnNhbmRib3guZHluYW1pY1N0eWxlU2hlZXRFbGVtZW50U2V0LmFkZCh0aGlzLmVsKTtcbiAgICAgIHRoaXMubW9uaXRvckNoYW5nZXNPZlN0eWxlKCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmlzKFwibGlua1wiKSkge1xuICAgICAgcGFyZW50Tm9kZSA9IHRoaXMuZmluZFBhcmVudE5vZGVJbkFwcChjb250ZXh0LCBcImhlYWRcIik7XG4gICAgICBpZiAodGhpcy5lbC5yZWwgPT09IFwic3R5bGVzaGVldFwiICYmIHRoaXMuZWwuaHJlZikge1xuICAgICAgICBjb252ZXJ0ZWROb2RlID0gdGhpcy5hZGREeW5hbWljTGlua05vZGUoKHN0eWxlTm9kZSkgPT4ge1xuICAgICAgICAgIHRoaXMubmF0aXZlQXBwZW5kLmNhbGwocGFyZW50Tm9kZSwgc3R5bGVOb2RlKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb252ZXJ0ZWROb2RlID0gdGhpcy5lbDtcbiAgICAgICAgdGhpcy5tb25pdG9yQ2hhbmdlc09mTGlua05vZGUoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCF0aGlzLnJvb3RFbGVtZW50LmNvbnRhaW5zKHBhcmVudE5vZGUpICYmIGRvY3VtZW50LmNvbnRhaW5zKHBhcmVudE5vZGUpKSB7XG4gICAgICBpZiAocGFyZW50Tm9kZSAhPT0gdGhpcy5yb290RWxlbWVudCkge1xuICAgICAgICB0aGlzLnNhbmRib3guZGVmZXJDbGVhckVmZmVjdHMuYWRkKCgpID0+IHtcbiAgICAgICAgICB0aGlzLkRPTUFwaXMucmVtb3ZlRWxlbWVudCh0aGlzLmVsKTtcbiAgICAgICAgICByZXR1cm4gdGhpcy5lbDtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0aGlzLmVsICYmIHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbCkge1xuICAgICAgY29uc3QgbmVlZEZpeERvbSA9IHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbChcImlmcmFtZSxpbWcsdmlkZW8sbGluayxzY3JpcHQsYXVkaW8sc3R5bGVcIik7XG4gICAgICBpZiAobmVlZEZpeERvbS5sZW5ndGggPiAwKSB7XG4gICAgICAgIG5lZWRGaXhEb20uZm9yRWFjaCgoZG9tKSA9PiB7XG4gICAgICAgICAgc2FmZVdyYXBwZXIoKCkgPT4gdGhpcy5maXhSZXNvdXJjZU5vZGVVcmwoZG9tKSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAodGhpcy5pcyhcImlmcmFtZVwiKSAmJiB0eXBlb2YgdGhpcy5lbC5vbmxvYWQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgY29uc3QgeyBlbCwgc2FuZGJveCB9ID0gdGhpcztcbiAgICAgIGNvbnN0IG9yaWdpbk9ubG9hZCA9IGVsLm9ubG9hZDtcbiAgICAgIGVsLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBzYWZlV3JhcHBlcigoKSA9PiBkZWYoZWwuY29udGVudFdpbmRvdywgXCJwYXJlbnRcIiwgc2FuZGJveC5nbG9iYWwpKTtcbiAgICAgICAgcmV0dXJuIG9yaWdpbk9ubG9hZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKGNvbnZlcnRlZE5vZGUpIHtcbiAgICAgIGlmIChpc0luc2VydE1ldGhvZCh0aGlzLm1ldGhvZE5hbWUpICYmIHRoaXMucm9vdEVsZW1lbnQuY29udGFpbnMoY29udGV4dCkgJiYgKChfYSA9IGFyZ3NbMV0pID09IG51bGwgPyB2b2lkIDAgOiBfYS5wYXJlbnROb2RlKSA9PT0gY29udGV4dCkge1xuICAgICAgICByZXR1cm4gb3JpZ2luUHJvY2VzcygpO1xuICAgICAgfVxuICAgICAgdGhpcy5zYW5kYm94Lmhvb2tzLmxpZmVjeWNsZS5hcHBlbmROb2RlLmVtaXQocGFyZW50Tm9kZSwgdGhpcy5lbCwgY29udmVydGVkTm9kZSwgdGhpcy50YWdOYW1lKTtcbiAgICAgIHJldHVybiB0aGlzLm5hdGl2ZUFwcGVuZC5jYWxsKHBhcmVudE5vZGUsIGNvbnZlcnRlZE5vZGUpO1xuICAgIH1cbiAgICByZXR1cm4gb3JpZ2luUHJvY2VzcygpO1xuICB9XG4gIHJlbW92ZUNoaWxkKGNvbnRleHQsIG9yaWdpblByb2Nlc3MpIHtcbiAgICBpZiAodHlwZW9mIHRoaXMuZWxbX19SRU1PVkVfTk9ERV9fXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICB0aGlzLmVsW19fUkVNT1ZFX05PREVfX10oKTtcbiAgICAgIHJldHVybiB0aGlzLmVsO1xuICAgIH1cbiAgICBpZiAodGhpcy5pcyhcInN0eWxlXCIpIHx8IHRoaXMuaXMoXCJsaW5rXCIpIHx8IHRoaXMuaXMoXCJzY3JpcHRcIikpIHtcbiAgICAgIGNvbnN0IHBhcmVudE5vZGUgPSB0aGlzLmZpbmRQYXJlbnROb2RlSW5BcHAoY29udGV4dCwgdGhpcy5pcyhcInNjcmlwdFwiKSA/IFwiYm9keVwiIDogXCJoZWFkXCIpO1xuICAgICAgaWYgKHRoaXMuZWwucGFyZW50Tm9kZSA9PT0gcGFyZW50Tm9kZSkge1xuICAgICAgICBpZiAodGhpcy5zYW5kYm94LmR5bmFtaWNTdHlsZVNoZWV0RWxlbWVudFNldC5oYXModGhpcy5lbCkpIHtcbiAgICAgICAgICB0aGlzLnNhbmRib3guZHluYW1pY1N0eWxlU2hlZXRFbGVtZW50U2V0LmRlbGV0ZSh0aGlzLmVsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVSZW1vdmUuY2FsbChwYXJlbnROb2RlLCB0aGlzLmVsKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG9yaWdpblByb2Nlc3MoKTtcbiAgfVxuICBnZXRSZWFsU2hlZXQoKSB7XG4gICAgcmV0dXJuIFJlZmxlY3QuZ2V0KEhUTUxTdHlsZUVsZW1lbnQucHJvdG90eXBlLCBcInNoZWV0XCIsIHRoaXMuZWwpO1xuICB9XG4gIGNyZWF0ZUZha2VTaGVldChzdHlsZVRyYW5zZm9ybWVyKSB7XG4gICAgY29uc3QgcHJvY2Vzc29yID0gdGhpcztcbiAgICBjb25zdCBydWxlc0RhdGEgPSBbXTtcbiAgICB0aGlzLnNhbmRib3guc3R5bGVkQ29tcG9uZW50Q1NTUnVsZXNNYXAuc2V0KHRoaXMuZWwsIHJ1bGVzRGF0YSk7XG4gICAgY29uc3QgZmFrZVNoZWV0ID0ge1xuICAgICAgZ2V0IGNzc1J1bGVzKCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IHJlYWxTaGVldCA9IHByb2Nlc3Nvci5nZXRSZWFsU2hlZXQoKTtcbiAgICAgICAgcmV0dXJuIChfYSA9IHJlYWxTaGVldCA9PSBudWxsID8gdm9pZCAwIDogcmVhbFNoZWV0LmNzc1J1bGVzKSAhPSBudWxsID8gX2EgOiBbXTtcbiAgICAgIH0sXG4gICAgICBpbnNlcnRSdWxlKHJ1bGUsIGluZGV4KSB7XG4gICAgICAgIGNvbnN0IHJlYWxTaGVldCA9IHByb2Nlc3Nvci5nZXRSZWFsU2hlZXQoKTtcbiAgICAgICAgY29uc3QgdHJhbnNmb3JtZWQgPSBzdHlsZVRyYW5zZm9ybWVyKHJ1bGUpO1xuICAgICAgICBpZiAocmVhbFNoZWV0KSB7XG4gICAgICAgICAgcmVhbFNoZWV0Lmluc2VydFJ1bGUodHJhbnNmb3JtZWQsIGluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICBydWxlc0RhdGEuc3BsaWNlKGluZGV4IHx8IDAsIDAsIHRyYW5zZm9ybWVkKTtcbiAgICAgICAgcmV0dXJuIGluZGV4IHx8IDA7XG4gICAgICB9LFxuICAgICAgZGVsZXRlUnVsZShpbmRleCkge1xuICAgICAgICBjb25zdCByZWFsU2hlZXQgPSBwcm9jZXNzb3IuZ2V0UmVhbFNoZWV0KCk7XG4gICAgICAgIGlmIChyZWFsU2hlZXQpIHtcbiAgICAgICAgICByZWFsU2hlZXQuZGVsZXRlUnVsZShpbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgcnVsZXNEYXRhLnNwbGljZShpbmRleCwgMSk7XG4gICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gZmFrZVNoZWV0O1xuICB9XG59O1xudmFyIER5bmFtaWNOb2RlUHJvY2Vzc29yID0gX0R5bmFtaWNOb2RlUHJvY2Vzc29yO1xuRHluYW1pY05vZGVQcm9jZXNzb3IubGlua0xvY2sgPSBuZXcgTG9ja1F1ZXVlKCk7XG5cbi8vIHNyYy9keW5hbWljTm9kZS9pbmRleC50c1xudmFyIG1vdW50RWxlbWVudE1ldGhvZHMgPSBbXG4gIFwiYXBwZW5kXCIsXG4gIFwiYXBwZW5kQ2hpbGRcIixcbiAgXCJpbnNlcnRCZWZvcmVcIixcbiAgXCJpbnNlcnRBZGphY2VudEVsZW1lbnRcIlxuXTtcbnZhciByZW1vdmVDaGlsZEVsZW1lbnRNZXRob2RzID0gW1wicmVtb3ZlQ2hpbGRcIl07XG52YXIgaWdub3JlRWxlbWVudFRpbWluZ1RhZ3MgPSBtYWtlTWFwNihbXG4gIFwiU1RZTEVcIixcbiAgXCJTQ1JJUFRTXCIsXG4gIFwiTElOS1wiLFxuICBcIk1FVEFcIixcbiAgXCJUSVRMRVwiXG5dKTtcbmZ1bmN0aW9uIGluamVjdG9yKGN1cnJlbnQsIG1ldGhvZE5hbWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBlbCA9IG1ldGhvZE5hbWUgPT09IFwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50XCIgPyBhcmd1bWVudHNbMV0gOiBhcmd1bWVudHNbMF07XG4gICAgY29uc3Qgc2FuZGJveCA9IHNhbmRib3hNYXAuZ2V0KGVsKTtcbiAgICBjb25zdCBvcmlnaW5Qcm9jZXNzID0gKCkgPT4gY3VycmVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIHNhZmVXcmFwcGVyMigoKSA9PiB7XG4gICAgICBpZiAoaWdub3JlRWxlbWVudFRpbWluZ1RhZ3MoZWwudGFnTmFtZSkpXG4gICAgICAgIHJldHVybjtcbiAgICAgIGlmICgoZWwgPT0gbnVsbCA/IHZvaWQgMCA6IGVsLnNldEF0dHJpYnV0ZSkgJiYgdHlwZW9mIChlbCA9PSBudWxsID8gdm9pZCAwIDogZWwuc2V0QXR0cmlidXRlKSA9PT0gXCJmdW5jdGlvblwiICYmICEoZWwgPT0gbnVsbCA/IHZvaWQgMCA6IGVsLmdldEF0dHJpYnV0ZShcImVsZW1lbnR0aW1pbmdcIikpICYmIHNhbmRib3ggJiYgc2FuZGJveC5vcHRpb25zLmRpc2FibGVFbGVtZW50dGltaW5nICE9PSB0cnVlKSB7XG4gICAgICAgIGVsID09IG51bGwgPyB2b2lkIDAgOiBlbC5zZXRBdHRyaWJ1dGUoXCJlbGVtZW50dGltaW5nXCIsIHNhbmRib3ggPyBgJHtzYW5kYm94Lm9wdGlvbnMubmFtZXNwYWNlfS1lbGVtZW50LXRpbWluZ2AgOiBcImVsZW1lbnQtdGltaW5nXCIpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChzYW5kYm94KSB7XG4gICAgICBpZiAoZWwgJiYgKChfYSA9IHRoaXMgPT0gbnVsbCA/IHZvaWQgMCA6IHRoaXMudGFnTmFtZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLnRvTG93ZXJDYXNlKCkpID09PSBcInN0eWxlXCIpIHtcbiAgICAgICAgY29uc3QgbWFuYWdlciA9IG5ldyBzYW5kYm94LmxvYWRlci5TdHlsZU1hbmFnZXIoZWwudGV4dENvbnRlbnQpO1xuICAgICAgICBjb25zdCB7IGJhc2VVcmwsIG5hbWVzcGFjZSwgc3R5bGVTY29wZUlkIH0gPSBzYW5kYm94Lm9wdGlvbnM7XG4gICAgICAgIG1hbmFnZXIuY29ycmVjdFBhdGgoYmFzZVVybCk7XG4gICAgICAgIG1hbmFnZXIuc2V0U2NvcGUoe1xuICAgICAgICAgIGFwcE5hbWU6IG5hbWVzcGFjZSxcbiAgICAgICAgICByb290RWxJZDogc3R5bGVTY29wZUlkKClcbiAgICAgICAgfSk7XG4gICAgICAgIGVsLnRleHRDb250ZW50ID0gbWFuYWdlci50cmFuc2Zvcm1Db2RlKG1hbmFnZXIuc3R5bGVDb2RlKTtcbiAgICAgICAgcmV0dXJuIG9yaWdpblByb2Nlc3MoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHByb2Nlc3NvciA9IG5ldyBEeW5hbWljTm9kZVByb2Nlc3NvcihlbCwgc2FuZGJveCwgbWV0aG9kTmFtZSk7XG4gICAgICAgIHJldHVybiBwcm9jZXNzb3IuYXBwZW5kKHRoaXMsIGFyZ3VtZW50cywgb3JpZ2luUHJvY2Vzcyk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBvcmlnaW5Qcm9jZXNzKCk7XG4gICAgfVxuICB9O1xufVxuZnVuY3Rpb24gaW5qZWN0b3JSZW1vdmVDaGlsZChjdXJyZW50LCBtZXRob2ROYW1lKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICBjb25zdCBlbCA9IGFyZ3VtZW50c1swXTtcbiAgICBjb25zdCBzYW5kYm94ID0gZWwgJiYgc2FuZGJveE1hcC5nZXQoZWwpO1xuICAgIGNvbnN0IG9yaWdpblByb2Nlc3MgPSAoKSA9PiB7XG4gICAgICByZXR1cm4gY3VycmVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH07XG4gICAgaWYgKHNhbmRib3gpIHtcbiAgICAgIGNvbnN0IHByb2Nlc3NvciA9IG5ldyBEeW5hbWljTm9kZVByb2Nlc3NvcihlbCwgc2FuZGJveCwgbWV0aG9kTmFtZSk7XG4gICAgICByZXR1cm4gcHJvY2Vzc29yLnJlbW92ZUNoaWxkKHRoaXMsIG9yaWdpblByb2Nlc3MpO1xuICAgIH1cbiAgICByZXR1cm4gb3JpZ2luUHJvY2VzcygpO1xuICB9O1xufVxuZnVuY3Rpb24gaGFuZGxlT3duZXJEb2N1bWVudCgpIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5FbGVtZW50LnByb3RvdHlwZSwgXCJvd25lckRvY3VtZW50XCIsIHtcbiAgICBnZXQoKSB7XG4gICAgICBjb25zdCBzYW5kYm94ID0gdGhpcyAmJiBzYW5kYm94TWFwLmdldCh0aGlzKTtcbiAgICAgIGNvbnN0IHJlYWxWYWx1ZSA9IFJlZmxlY3QuZ2V0KHdpbmRvdy5Ob2RlLnByb3RvdHlwZSwgXCJvd25lckRvY3VtZW50XCIsIHRoaXMpO1xuICAgICAgcmV0dXJuIHNhbmRib3ggPyBzYW5kYm94Lmdsb2JhbC5kb2N1bWVudCA6IHJlYWxWYWx1ZTtcbiAgICB9LFxuICAgIHNldCgpIHtcbiAgICAgICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudiAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViA/IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA6IGZhbHNlKSAmJiB3YXJuMygnXCJvd25lckRvY3VtZW50XCIgaXMgYSByZWFkLW9ubHkgYXR0cmlidXRlLicpO1xuICAgIH1cbiAgfSk7XG59XG5mdW5jdGlvbiBtYWtlRWxJbmplY3RvcihzYW5kYm94Q29uZmlnKSB7XG4gIGlmIChtYWtlRWxJbmplY3Rvci5oYXNJbmplY3QpXG4gICAgcmV0dXJuO1xuICBtYWtlRWxJbmplY3Rvci5oYXNJbmplY3QgPSB0cnVlO1xuICBpZiAodHlwZW9mIHdpbmRvdy5FbGVtZW50ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICBpZiAoc2FuZGJveENvbmZpZy5maXhCYXNlVXJsKVxuICAgICAgc2FmZVdyYXBwZXIyKCgpID0+IGhhbmRsZU93bmVyRG9jdW1lbnQoKSk7XG4gICAgY29uc3QgcmV3cml0ZSA9IChtZXRob2RzLCBidWlsZGVyKSA9PiB7XG4gICAgICBmb3IgKGNvbnN0IG5hbWUgb2YgbWV0aG9kcykge1xuICAgICAgICBjb25zdCBmbiA9IHdpbmRvdy5FbGVtZW50LnByb3RvdHlwZVtuYW1lXTtcbiAgICAgICAgaWYgKHR5cGVvZiBmbiAhPT0gXCJmdW5jdGlvblwiIHx8IGZuW19fZG9tV3JhcHBlcl9fXSkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHJhd0VsZW1lbnRNZXRob2RzW25hbWVdID0gZm47XG4gICAgICAgIGNvbnN0IHdyYXBwZXIgPSBidWlsZGVyKGZuLCBuYW1lKTtcbiAgICAgICAgd3JhcHBlcltfX2RvbVdyYXBwZXJfX10gPSB0cnVlO1xuICAgICAgICB3aW5kb3cuRWxlbWVudC5wcm90b3R5cGVbbmFtZV0gPSB3cmFwcGVyO1xuICAgICAgfVxuICAgIH07XG4gICAgcmV3cml0ZShtb3VudEVsZW1lbnRNZXRob2RzLCBpbmplY3Rvcik7XG4gICAgcmV3cml0ZShyZW1vdmVDaGlsZEVsZW1lbnRNZXRob2RzLCBpbmplY3RvclJlbW92ZUNoaWxkKTtcbiAgfVxuICBpbmplY3RIYW5kbGVyUGFyYW1zKCk7XG59XG5mdW5jdGlvbiByZWJ1aWxkQ1NTUnVsZXMoZHluYW1pY1N0eWxlU2hlZXRFbGVtZW50U2V0LCBzdHlsZWRDb21wb25lbnRDU1NSdWxlc01hcCkge1xuICBkeW5hbWljU3R5bGVTaGVldEVsZW1lbnRTZXQuZm9yRWFjaCgoc3R5bGVFbGVtZW50KSA9PiB7XG4gICAgY29uc3QgcnVsZXMgPSBzdHlsZWRDb21wb25lbnRDU1NSdWxlc01hcC5nZXQoc3R5bGVFbGVtZW50KTtcbiAgICBpZiAocnVsZXMgJiYgKGlzU3R5bGVkQ29tcG9uZW50c0xpa2Uoc3R5bGVFbGVtZW50KSB8fCBydWxlcy5sZW5ndGgpKSB7XG4gICAgICBjb25zdCByZWFsU2hlZXQgPSBSZWZsZWN0LmdldChIVE1MU3R5bGVFbGVtZW50LnByb3RvdHlwZSwgXCJzaGVldFwiLCBzdHlsZUVsZW1lbnQpO1xuICAgICAgaWYgKHJlYWxTaGVldCkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJ1bGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY29uc3QgY3NzUnVsZSA9IHJ1bGVzW2ldO1xuICAgICAgICAgIHJlYWxTaGVldC5pbnNlcnRSdWxlKGNzc1J1bGUsIGkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn1cblxuLy8gc3JjL2xpZmVjeWNsZS50c1xuaW1wb3J0IHsgU3luY0hvb2ssIFN5bmNXYXRlcmZhbGxIb29rLCBQbHVnaW5TeXN0ZW0gfSBmcm9tIFwiQGdhcmZpc2gvaG9va3NcIjtcbmZ1bmN0aW9uIHNhbmRib3hMaWZlY3ljbGUoKSB7XG4gIHJldHVybiBuZXcgUGx1Z2luU3lzdGVtKHtcbiAgICBjbG9zZWQ6IG5ldyBTeW5jSG9vaygpLFxuICAgIHN0YXJlZDogbmV3IFN5bmNIb29rKCksXG4gICAgYXBwZW5kTm9kZTogbmV3IFN5bmNIb29rKCksXG4gICAgZG9jdW1lbnRHZXR0ZXI6IG5ldyBTeW5jV2F0ZXJmYWxsSG9vayhcImRvY3VtZW50R2V0dGVyXCIpLFxuICAgIGJlZm9yZUNsZWFyRWZmZWN0OiBuZXcgU3luY0hvb2soKSxcbiAgICBhZnRlckNsZWFyRWZmZWN0OiBuZXcgU3luY0hvb2soKSxcbiAgICBiZWZvcmVJbnZva2U6IG5ldyBTeW5jSG9vaygpLFxuICAgIGFmdGVySW52b2tlOiBuZXcgU3luY0hvb2soKSxcbiAgICBpbnZva2VFcnJvcjogbmV3IFN5bmNIb29rKClcbiAgfSk7XG59XG5cbi8vIHNyYy9wcm94eUludGVyY2VwdG9yL2dsb2JhbC50c1xuaW1wb3J0IHsgd2FybiBhcyB3YXJuNCwgaGFzT3duIGFzIGhhc093bjUsIHNhZmFyaTEzRGVhbCBhcyBzYWZhcmkxM0RlYWwyIH0gZnJvbSBcIkBnYXJmaXNoL3V0aWxzXCI7XG5mdW5jdGlvbiBjcmVhdGVHZXR0ZXIyKHNhbmRib3gpIHtcbiAgcmV0dXJuICh0YXJnZXQsIHAsIHJlY2VpdmVyKSA9PiB7XG4gICAgaWYgKHAgPT09IFN5bWJvbC51bnNjb3BhYmxlcylcbiAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgbGV0IHZhbHVlO1xuICAgIGNvbnN0IHsgb3ZlcnJpZGVMaXN0IH0gPSBzYW5kYm94LnJlcGxhY2VHbG9iYWxWYXJpYWJsZXM7XG4gICAgaWYgKHNhbmRib3guaXNQcm90ZWN0VmFyaWFibGUocCkpIHtcbiAgICAgIHJldHVybiBSZWZsZWN0LmdldCh3aW5kb3csIHApO1xuICAgIH0gZWxzZSBpZiAoc2FuZGJveC5pc0luc3VsYXRpb25WYXJpYWJsZShwKSkge1xuICAgICAgdmFsdWUgPSBSZWZsZWN0LmdldCh0YXJnZXQsIHAsIHJlY2VpdmVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWUgPSBoYXNPd241KHRhcmdldCwgcCkgPyBSZWZsZWN0LmdldCh0YXJnZXQsIHAsIHJlY2VpdmVyKSA6IFJlZmxlY3QuZ2V0KHdpbmRvdywgcCk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgaWYgKGlzRXNHbG9iYWxNZXRob2RzKHApIHx8IGlzTmF0aXZlQ29kZU1ldGhvZHMocCkgfHwgaGFzT3duNShvdmVycmlkZUxpc3QsIHApIHx8IGlzQ29uc3RydWN0b3IodmFsdWUpIHx8IHNhbmRib3guaXNFeHRlcm5hbEdsb2JhbFZhcmlhYmxlLmhhcyhwKSkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgY29uc3QgbmV3VmFsdWUgPSBoYXNPd241KHZhbHVlLCBfX3dpbmRvd0JpbmRfXykgPyB2YWx1ZVtfX3dpbmRvd0JpbmRfX10gOiBiaW5kKHZhbHVlLCB3aW5kb3cpO1xuICAgIGNvbnN0IHZlcmlmeVJlc3VsdCA9IHZlcmlmeUdldHRlckRlc2NyaXB0b3IodGFyZ2V0LCBwLCBuZXdWYWx1ZSk7XG4gICAgaWYgKHZlcmlmeVJlc3VsdCA+IDApIHtcbiAgICAgIGlmICh2ZXJpZnlSZXN1bHQgPT09IDEpXG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIGlmICh2ZXJpZnlSZXN1bHQgPT09IDIpXG4gICAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgfVxuICAgIHZhbHVlW19fd2luZG93QmluZF9fXSA9IG5ld1ZhbHVlO1xuICAgIHJldHVybiBuZXdWYWx1ZTtcbiAgfTtcbn1cbnZhciBzYWZhcmlQcm94eVdpbmRvd0RlYWxIYW5kbGVyID0gc2FmYXJpMTNEZWFsMigpO1xuZnVuY3Rpb24gY3JlYXRlU2V0dGVyMihzYW5kYm94KSB7XG4gIHJldHVybiAodGFyZ2V0LCBwLCB2YWx1ZSwgcmVjZWl2ZXIpID0+IHtcbiAgICBjb25zdCB2ZXJpZnlSZXN1bHQgPSB2ZXJpZnlTZXR0ZXJEZXNjcmlwdG9yKHNhbmRib3guaXNQcm90ZWN0VmFyaWFibGUocCkgPyB3aW5kb3cgOiByZWNlaXZlciA/IHJlY2VpdmVyIDogdGFyZ2V0LCBwLCB2YWx1ZSk7XG4gICAgaWYgKHZlcmlmeVJlc3VsdCA+IDApIHtcbiAgICAgIGlmICh2ZXJpZnlSZXN1bHQgPT09IDEgfHwgdmVyaWZ5UmVzdWx0ID09PSAyKVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICBpZiAodmVyaWZ5UmVzdWx0ID09PSAzKVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKHNhbmRib3guaXNQcm90ZWN0VmFyaWFibGUocCkpIHtcbiAgICAgIHJldHVybiBSZWZsZWN0LnNldCh3aW5kb3csIHAsIHZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2FmYXJpUHJveHlXaW5kb3dEZWFsSGFuZGxlci50cmlnZ2VyU2V0KCk7XG4gICAgICBjb25zdCBzdWNjZXNzID0gUmVmbGVjdC5zZXQodGFyZ2V0LCBwLCB2YWx1ZSwgcmVjZWl2ZXIpO1xuICAgICAgaWYgKHN1Y2Nlc3MpIHtcbiAgICAgICAgaWYgKHNhbmRib3guaW5pdENvbXBsZXRlKSB7XG4gICAgICAgICAgc2FuZGJveC5pc0V4dGVybmFsR2xvYmFsVmFyaWFibGUuYWRkKHApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzYW5kYm94Lmdsb2JhbCkge1xuICAgICAgICAgIGNvbnN0IG1ldGhvZHMgPSBzYW5kYm94Lmdsb2JhbFtgJHtHQVJGSVNIX09QVElNSVpFX05BTUV9TWV0aG9kc2BdO1xuICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KG1ldGhvZHMpKSB7XG4gICAgICAgICAgICBpZiAobWV0aG9kcy5pbmNsdWRlcyhwKSkge1xuICAgICAgICAgICAgICBjb25zdCB1cGRhdGVTdGFjayA9IHNhbmRib3guZ2xvYmFsW2Ake0dBUkZJU0hfT1BUSU1JWkVfTkFNRX1VcGRhdGVTdGFja2BdO1xuICAgICAgICAgICAgICB1cGRhdGVTdGFjay5mb3JFYWNoKChmbikgPT4gZm4ocCwgdmFsdWUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBzdWNjZXNzO1xuICAgIH1cbiAgfTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZURlZmluZVByb3BlcnR5MihzYW5kYm94KSB7XG4gIHJldHVybiAodGFyZ2V0LCBwLCBkZXNjcmlwdG9yKSA9PiB7XG4gICAgc2FmYXJpUHJveHlXaW5kb3dEZWFsSGFuZGxlci5oYW5kbGVEZXNjcmlwdG9yKGRlc2NyaXB0b3IpO1xuICAgIGlmIChzYW5kYm94LmlzUHJvdGVjdFZhcmlhYmxlKHApKSB7XG4gICAgICByZXR1cm4gUmVmbGVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csIHAsIGRlc2NyaXB0b3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBzdWNjZXNzID0gUmVmbGVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHAsIGRlc2NyaXB0b3IpO1xuICAgICAgaWYgKHNhbmRib3guaW5pdENvbXBsZXRlICYmIHN1Y2Nlc3MpIHtcbiAgICAgICAgc2FuZGJveC5pc0V4dGVybmFsR2xvYmFsVmFyaWFibGUuYWRkKHApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHN1Y2Nlc3M7XG4gICAgfVxuICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlRGVsZXRlUHJvcGVydHkoc2FuZGJveCkge1xuICByZXR1cm4gKHRhcmdldCwgcCkgPT4ge1xuICAgIGlmIChoYXNPd241KHRhcmdldCwgcCkpIHtcbiAgICAgIGRlbGV0ZSB0YXJnZXRbcF07XG4gICAgICBpZiAoc2FuZGJveC5pbml0Q29tcGxldGUgJiYgc2FuZGJveC5pc0V4dGVybmFsR2xvYmFsVmFyaWFibGUuaGFzKHApKSB7XG4gICAgICAgIHNhbmRib3guaXNFeHRlcm5hbEdsb2JhbFZhcmlhYmxlLmRlbGV0ZShwKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID8gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiIDogZmFsc2UpIHtcbiAgICAgIGlmIChoYXNPd241KHdpbmRvdywgcCkgJiYgc2FuZGJveC5pc1Byb3RlY3RWYXJpYWJsZShwKSkge1xuICAgICAgICB3YXJuNChgVGhlIFwiJHtTdHJpbmcocCl9XCIgaXMgZ2xvYmFsIHByb3RlY3QgdmFyaWFibGUuXCJgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG59XG5mdW5jdGlvbiBjcmVhdGVIYXMyKHNhbmRib3gpIHtcbiAgcmV0dXJuIChfdGFyZ2V0LCBwKSA9PiB7XG4gICAgaWYgKHNhbmRib3guaXNQcm90ZWN0VmFyaWFibGUocCkpXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgaWYgKHNhbmRib3guZW52VmFyaWFibGUgPT09IHApXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG59XG5cbi8vIHNyYy9zYW5kYm94LnRzXG52YXIgaWQgPSAwO1xudmFyIGRlZmF1bHRNb2R1bGVzID0gW1xuICBuZXR3b3JrTW9kdWxlLFxuICB0aW1lb3V0TW9kdWxlLFxuICBpbnRlcnZhbE1vZHVsZSxcbiAgaGlzdG9yeU1vZHVsZSxcbiAgZG9jdW1lbnRNb2R1bGUsXG4gIGxpc3RlbmVyTW9kdWxlLFxuICBvYnNlcnZlck1vZHVsZSxcbiAgVWlFdmVudE92ZXJyaWRlLFxuICBsb2NhbFN0b3JhZ2VNb2R1bGVcbl07XG52YXIgaXNNb2R1bGUgPSAobW9kdWxlKSA9PiB7XG4gIHJldHVybiBpc09iamVjdDMobW9kdWxlKSA/IG1vZHVsZVtfX2dhcmZpc2hHbG9iYWxfX10gIT09IHZvaWQgMCA6IGZhbHNlO1xufTtcbnZhciBhZGRQcm94eVdpbmRvd1R5cGUgPSAobW9kdWxlLCBwYXJlbnRNb2R1bGUpID0+IHtcbiAgaWYgKCFpc01vZHVsZShtb2R1bGUpKSB7XG4gICAgbW9kdWxlW19fZ2FyZmlzaEdsb2JhbF9fXSA9IHBhcmVudE1vZHVsZTtcbiAgfVxuICByZXR1cm4gbW9kdWxlO1xufTtcbnZhciBTYW5kYm94ID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgdGhpcy5pZCA9IGlkKys7XG4gICAgdGhpcy50eXBlID0gXCJ2bVwiO1xuICAgIHRoaXMuY2xvc2VkID0gdHJ1ZTtcbiAgICB0aGlzLmluaXRDb21wbGV0ZSA9IGZhbHNlO1xuICAgIHRoaXMudmVyc2lvbiA9IFwiMS4xNi4yXCI7XG4gICAgdGhpcy5ob29rcyA9IHNhbmRib3hMaWZlY3ljbGUoKTtcbiAgICB0aGlzLmRlZmVyQ2xlYXJFZmZlY3RzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbiAgICB0aGlzLmlzRXh0ZXJuYWxHbG9iYWxWYXJpYWJsZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7XG4gICAgdGhpcy5keW5hbWljU3R5bGVTaGVldEVsZW1lbnRTZXQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICAgIHRoaXMuc3R5bGVkQ29tcG9uZW50Q1NTUnVsZXNNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTtcbiAgICB0aGlzLm9wdGltaXplQ29kZSA9IFwiXCI7XG4gICAgdGhpcy5lbnZWYXJpYWJsZSA9IFwiX19HQVJGSVNIX1NBTkRCT1hfRU5WX1ZBUl9fXCI7XG4gICAgY29uc3QgZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgICBiYXNlVXJsOiBcIlwiLFxuICAgICAgbmFtZXNwYWNlOiBcIlwiLFxuICAgICAgbW9kdWxlczogW10sXG4gICAgICBmaXhCYXNlVXJsOiBmYWxzZSxcbiAgICAgIGZpeFN0YXRpY1Jlc291cmNlQmFzZVVybDogdHJ1ZSxcbiAgICAgIGRpc2FibGVXaXRoOiBmYWxzZSxcbiAgICAgIHN0cmljdElzb2xhdGlvbjogZmFsc2UsXG4gICAgICBlbDogKCkgPT4gbnVsbCxcbiAgICAgIHN0eWxlU2NvcGVJZDogKCkgPT4gXCJcIixcbiAgICAgIHByb3RlY3RWYXJpYWJsZTogKCkgPT4gW10sXG4gICAgICBpbnN1bGF0aW9uVmFyaWFibGU6ICgpID0+IFtdXG4gICAgfTtcbiAgICB0aGlzLm9wdGlvbnMgPSBpc1BsYWluT2JqZWN0KG9wdGlvbnMpID8gZGVlcE1lcmdlKGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKSA6IGRlZmF1bHRPcHRpb25zO1xuICAgIGNvbnN0IHsgbG9hZGVyT3B0aW9ucywgcHJvdGVjdFZhcmlhYmxlLCBpbnN1bGF0aW9uVmFyaWFibGUgfSA9IHRoaXMub3B0aW9ucztcbiAgICB0aGlzLmxvYWRlciA9IG5ldyBMb2FkZXIobG9hZGVyT3B0aW9ucyk7XG4gICAgdGhpcy5pc1Byb3RlY3RWYXJpYWJsZSA9IG1ha2VNYXA3KChwcm90ZWN0VmFyaWFibGUgPT0gbnVsbCA/IHZvaWQgMCA6IHByb3RlY3RWYXJpYWJsZSgpKSB8fCBbXSk7XG4gICAgdGhpcy5pc0luc3VsYXRpb25WYXJpYWJsZSA9IG1ha2VNYXA3KChpbnN1bGF0aW9uVmFyaWFibGUgPT0gbnVsbCA/IHZvaWQgMCA6IGluc3VsYXRpb25WYXJpYWJsZSgpKSB8fCBbXSk7XG4gICAgdGhpcy5yZXBsYWNlR2xvYmFsVmFyaWFibGVzID0ge1xuICAgICAgY3JlYXRlZExpc3Q6IFtdLFxuICAgICAgcHJlcGFyZUxpc3Q6IFtdLFxuICAgICAgcmVjb3Zlckxpc3Q6IFtdLFxuICAgICAgb3ZlcnJpZGVMaXN0OiB7fVxuICAgIH07XG4gICAgbWFrZUVsSW5qZWN0b3IodGhpcy5vcHRpb25zKTtcbiAgICB0aGlzLnN0YXJ0KCk7XG4gICAgc2FuZGJveE1hcC5zZXQodGhpcyk7XG4gIH1cbiAgc3RhcnQoKSB7XG4gICAgdGhpcy5jbG9zZWQgPSBmYWxzZTtcbiAgICB0aGlzLnJlcGxhY2VHbG9iYWxWYXJpYWJsZXMgPSB0aGlzLmdldE1vZHVsZURhdGEoKTtcbiAgICBjb25zdCB7IGNyZWF0ZWRMaXN0LCBvdmVycmlkZUxpc3QgfSA9IHRoaXMucmVwbGFjZUdsb2JhbFZhcmlhYmxlcztcbiAgICB0aGlzLmdsb2JhbCA9IHRoaXMuY3JlYXRlUHJveHlXaW5kb3coT2JqZWN0LmtleXMob3ZlcnJpZGVMaXN0KSk7XG4gICAgaWYgKG92ZXJyaWRlTGlzdCAmJiB0aGlzLmdsb2JhbCkge1xuICAgICAgZm9yIChjb25zdCBrZXkgaW4gb3ZlcnJpZGVMaXN0KSB7XG4gICAgICAgIHRoaXMuZ2xvYmFsW2tleV0gPSBvdmVycmlkZUxpc3Rba2V5XTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGNyZWF0ZWRMaXN0KSB7XG4gICAgICBjcmVhdGVkTGlzdC5mb3JFYWNoKChmbikgPT4gZm4gJiYgZm4odGhpcy5nbG9iYWwpKTtcbiAgICB9XG4gICAgaWYgKCF0aGlzLm9wdGlvbnMuZGlzYWJsZVdpdGgpIHtcbiAgICAgIHRoaXMub3B0aW1pemVDb2RlID0gdGhpcy5vcHRpbWl6ZUdsb2JhbE1ldGhvZCgpO1xuICAgIH1cbiAgICB0aGlzLmluaXRDb21wbGV0ZSA9IHRydWU7XG4gICAgdGhpcy5ob29rcy5saWZlY3ljbGUuc3RhcmVkLmVtaXQodGhpcy5nbG9iYWwpO1xuICB9XG4gIGNsb3NlKCkge1xuICAgIGlmICh0aGlzLmNsb3NlZClcbiAgICAgIHJldHVybjtcbiAgICB0aGlzLmNsZWFyRWZmZWN0cygpO1xuICAgIHRoaXMuY2xvc2VkID0gdHJ1ZTtcbiAgICB0aGlzLmdsb2JhbCA9IHZvaWQgMDtcbiAgICB0aGlzLm9wdGltaXplQ29kZSA9IFwiXCI7XG4gICAgdGhpcy5pbml0Q29tcGxldGUgPSBmYWxzZTtcbiAgICB0aGlzLmRlZmVyQ2xlYXJFZmZlY3RzLmNsZWFyKCk7XG4gICAgdGhpcy5pc0V4dGVybmFsR2xvYmFsVmFyaWFibGUuY2xlYXIoKTtcbiAgICB0aGlzLmR5bmFtaWNTdHlsZVNoZWV0RWxlbWVudFNldC5jbGVhcigpO1xuICAgIHRoaXMucmVwbGFjZUdsb2JhbFZhcmlhYmxlcy5jcmVhdGVkTGlzdCA9IFtdO1xuICAgIHRoaXMucmVwbGFjZUdsb2JhbFZhcmlhYmxlcy5wcmVwYXJlTGlzdCA9IFtdO1xuICAgIHRoaXMucmVwbGFjZUdsb2JhbFZhcmlhYmxlcy5yZWNvdmVyTGlzdCA9IFtdO1xuICAgIHRoaXMucmVwbGFjZUdsb2JhbFZhcmlhYmxlcy5vdmVycmlkZUxpc3QgPSBbXTtcbiAgICB0aGlzLmhvb2tzLmxpZmVjeWNsZS5jbG9zZWQuZW1pdCgpO1xuICB9XG4gIHJlc2V0KCkge1xuICAgIHRoaXMuY2xvc2UoKTtcbiAgICB0aGlzLnN0YXJ0KCk7XG4gIH1cbiAgY3JlYXRlUHJveHlXaW5kb3cobW9kdWxlS2V5cyA9IFtdKSB7XG4gICAgY29uc3QgZmFrZVdpbmRvdyA9IGNyZWF0ZUZha2VPYmplY3Qod2luZG93LCB0aGlzLmlzSW5zdWxhdGlvblZhcmlhYmxlLCBtYWtlTWFwNyhtb2R1bGVLZXlzKSk7XG4gICAgY29uc3QgYmFzZUhhbmRsZXJzID0ge1xuICAgICAgZ2V0OiBjcmVhdGVHZXR0ZXIyKHRoaXMpLFxuICAgICAgc2V0OiBjcmVhdGVTZXR0ZXIyKHRoaXMpLFxuICAgICAgZGVmaW5lUHJvcGVydHk6IGNyZWF0ZURlZmluZVByb3BlcnR5Mih0aGlzKSxcbiAgICAgIGRlbGV0ZVByb3BlcnR5OiBjcmVhdGVEZWxldGVQcm9wZXJ0eSh0aGlzKSxcbiAgICAgIGdldFByb3RvdHlwZU9mKCkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmdldFByb3RvdHlwZU9mKHdpbmRvdyk7XG4gICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBwYXJlbnRIYW5kbGVycyA9IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIGJhc2VIYW5kbGVycyksIHtcbiAgICAgIGhhczogY3JlYXRlSGFzMih0aGlzKSxcbiAgICAgIGdldFByb3RvdHlwZU9mKCkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmdldFByb3RvdHlwZU9mKHdpbmRvdyk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgY29uc3QgcHJveHkgPSBuZXcgUHJveHkoZmFrZVdpbmRvdywgcGFyZW50SGFuZGxlcnMpO1xuICAgIGNvbnN0IHN1YlByb3h5ID0gbmV3IFByb3h5KGZha2VXaW5kb3csIGJhc2VIYW5kbGVycyk7XG4gICAgcHJveHkuc2VsZiA9IHN1YlByb3h5O1xuICAgIHByb3h5LndpbmRvdyA9IHN1YlByb3h5O1xuICAgIHByb3h5Lmdsb2JhbFRoaXMgPSBzdWJQcm94eTtcbiAgICBwcm94eS5fX2RlYnVnX3NhbmRib3hfXyA9IHRoaXM7XG4gICAgc2FmZVdyYXBwZXIzKCgpID0+IHtcbiAgICAgIHByb3h5LnRvcCA9IHdpbmRvdy50b3AgPT09IHdpbmRvdyA/IHN1YlByb3h5IDogd2luZG93LnRvcDtcbiAgICAgIHByb3h5LnBhcmVudCA9IHdpbmRvdy5wYXJlbnQgPT09IHdpbmRvdyA/IHN1YlByb3h5IDogd2luZG93LnBhcmVudDtcbiAgICB9KTtcbiAgICBhZGRQcm94eVdpbmRvd1R5cGUocHJveHksIHdpbmRvdyk7XG4gICAgcmV0dXJuIHByb3h5O1xuICB9XG4gIGdldE1vZHVsZURhdGEoKSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IHJlY292ZXJMaXN0ID0gW107XG4gICAgY29uc3QgY3JlYXRlZExpc3QgPSBbXTtcbiAgICBjb25zdCBwcmVwYXJlTGlzdCA9IFtdO1xuICAgIGNvbnN0IG92ZXJyaWRlTGlzdCA9IHt9O1xuICAgIGNvbnN0IGFsbE1vZHVsZXMgPSBkZWZhdWx0TW9kdWxlcy5jb25jYXQoKF9hID0gdGhpcy5vcHRpb25zLm1vZHVsZXMpICE9IG51bGwgPyBfYSA6IFtdKTtcbiAgICBmb3IgKGNvbnN0IG1vZHVsZSBvZiBhbGxNb2R1bGVzKSB7XG4gICAgICBpZiAodHlwZW9mIG1vZHVsZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGNvbnN0IHsgcmVjb3Zlciwgb3ZlcnJpZGUsIGNyZWF0ZWQsIHByZXBhcmUgfSA9IG1vZHVsZSh0aGlzKSB8fCB7fTtcbiAgICAgICAgaWYgKHJlY292ZXIpXG4gICAgICAgICAgcmVjb3Zlckxpc3QucHVzaChyZWNvdmVyKTtcbiAgICAgICAgaWYgKGNyZWF0ZWQpXG4gICAgICAgICAgY3JlYXRlZExpc3QucHVzaChjcmVhdGVkKTtcbiAgICAgICAgaWYgKHByZXBhcmUpXG4gICAgICAgICAgcHJlcGFyZUxpc3QucHVzaChwcmVwYXJlKTtcbiAgICAgICAgaWYgKG92ZXJyaWRlKSB7XG4gICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gb3ZlcnJpZGUpIHtcbiAgICAgICAgICAgIGlmICgodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPyBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgOiBmYWxzZSkgJiYgb3ZlcnJpZGVMaXN0W2tleV0pIHtcbiAgICAgICAgICAgICAgd2FybjUoYFwiJHtrZXl9XCIgZ2xvYmFsIHZhcmlhYmxlcyBhcmUgb3ZlcndyaXR0ZW4uYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvdmVycmlkZUxpc3Rba2V5XSA9IG92ZXJyaWRlW2tleV07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7IHJlY292ZXJMaXN0LCBjcmVhdGVkTGlzdCwgb3ZlcnJpZGVMaXN0LCBwcmVwYXJlTGlzdCB9O1xuICB9XG4gIGNsZWFyRWZmZWN0cygpIHtcbiAgICB0aGlzLmhvb2tzLmxpZmVjeWNsZS5iZWZvcmVDbGVhckVmZmVjdC5lbWl0KCk7XG4gICAgdGhpcy5yZXBsYWNlR2xvYmFsVmFyaWFibGVzLnJlY292ZXJMaXN0LmZvckVhY2goKGZuKSA9PiBmbiAmJiBmbigpKTtcbiAgICB0aGlzLmRlZmVyQ2xlYXJFZmZlY3RzLmZvckVhY2goKGZuKSA9PiBmbiAmJiBmbigpKTtcbiAgICB0aGlzLmhvb2tzLmxpZmVjeWNsZS5hZnRlckNsZWFyRWZmZWN0LmVtaXQoKTtcbiAgfVxuICBvcHRpbWl6ZUdsb2JhbE1ldGhvZCh0ZW1wRW52S2V5cyA9IFtdKSB7XG4gICAgbGV0IGNvZGUgPSBcIlwiO1xuICAgIGNvbnN0IG1ldGhvZHMgPSBvcHRpbWl6ZU1ldGhvZHMuZmlsdGVyKChwKSA9PiB7XG4gICAgICByZXR1cm4gcCAmJiAhdGhpcy5pc1Byb3RlY3RWYXJpYWJsZShwKSAmJiAhdGVtcEVudktleXMuaW5jbHVkZXMocCkgJiYgaGFzT3duNih0aGlzLmdsb2JhbCwgcCk7XG4gICAgfSk7XG4gICAgaWYgKG1ldGhvZHMubGVuZ3RoID4gMCkge1xuICAgICAgY29kZSA9IG1ldGhvZHMucmVkdWNlKChwcmV2Q29kZSwgbmFtZSkgPT4ge1xuICAgICAgICByZXR1cm4gYCR7cHJldkNvZGV9IGxldCAke25hbWV9ID0gd2luZG93LiR7bmFtZX07YDtcbiAgICAgIH0sIGNvZGUpO1xuICAgICAgaWYgKHRoaXMuZ2xvYmFsKSB7XG4gICAgICAgIHRoaXMuZ2xvYmFsW2Ake0dBUkZJU0hfT1BUSU1JWkVfTkFNRX1NZXRob2RzYF0gPSBtZXRob2RzO1xuICAgICAgICB0aGlzLmdsb2JhbFtgJHtHQVJGSVNIX09QVElNSVpFX05BTUV9VXBkYXRlU3RhY2tgXSA9IFtdO1xuICAgICAgfVxuICAgICAgY29kZSArPSBgd2luZG93LiR7R0FSRklTSF9PUFRJTUlaRV9OQU1FfVVwZGF0ZVN0YWNrLnB1c2goZnVuY3Rpb24oayx2KXtldmFsKGsrXCI9dlwiKX0pO2A7XG4gICAgfVxuICAgIGlmICh0ZW1wRW52S2V5cy5sZW5ndGggPiAwKSB7XG4gICAgICBjb2RlID0gdGVtcEVudktleXMucmVkdWNlKChwcmV2Q29kZSwgbmFtZSkgPT4ge1xuICAgICAgICByZXR1cm4gYCR7cHJldkNvZGV9IGxldCAke25hbWV9ID0gJHt0aGlzLmVudlZhcmlhYmxlfS4ke25hbWV9O2A7XG4gICAgICB9LCBjb2RlKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvZGU7XG4gIH1cbiAgY3JlYXRlRXhlY1BhcmFtcyhjb2RlUmVmLCBlbnYpIHtcbiAgICBjb25zdCB7IGRpc2FibGVXaXRoIH0gPSB0aGlzLm9wdGlvbnM7XG4gICAgY29uc3QgeyBwcmVwYXJlTGlzdCwgb3ZlcnJpZGVMaXN0IH0gPSB0aGlzLnJlcGxhY2VHbG9iYWxWYXJpYWJsZXM7XG4gICAgaWYgKHByZXBhcmVMaXN0KSB7XG4gICAgICBwcmVwYXJlTGlzdC5mb3JFYWNoKChmbikgPT4gZm4gJiYgZm4oKSk7XG4gICAgfVxuICAgIGNvbnN0IHBhcmFtcyA9IF9fc3ByZWFkVmFsdWVzKHtcbiAgICAgIHdpbmRvdzogdGhpcy5nbG9iYWxcbiAgICB9LCBvdmVycmlkZUxpc3QpO1xuICAgIGlmIChkaXNhYmxlV2l0aCkge1xuICAgICAgT2JqZWN0LmFzc2lnbihwYXJhbXMsIGVudik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGVudktleXMgPSBPYmplY3Qua2V5cyhlbnYpO1xuICAgICAgY29uc3Qgb3B0aW1pemVDb2RlID0gZW52S2V5cy5sZW5ndGggPiAwID8gdGhpcy5vcHRpbWl6ZUdsb2JhbE1ldGhvZChlbnZLZXlzKSA6IHRoaXMub3B0aW1pemVDb2RlO1xuICAgICAgY29kZVJlZi5jb2RlID0gYHdpdGgod2luZG93KSB7OyR7b3B0aW1pemVDb2RlICsgY29kZVJlZi5jb2RlfVxufWA7XG4gICAgICBwYXJhbXNbdGhpcy5lbnZWYXJpYWJsZV0gPSBlbnY7XG4gICAgfVxuICAgIHJldHVybiBwYXJhbXM7XG4gIH1cbiAgcHJvY2Vzc0V4ZWNFcnJvcihlLCB1cmwsIGVudiwgb3B0aW9ucykge1xuICAgIHRoaXMuaG9va3MubGlmZWN5Y2xlLmludm9rZUVycm9yLmVtaXQoZSwgdXJsLCBlbnYsIG9wdGlvbnMpO1xuICAgIGlmICh0aGlzLmdsb2JhbCAmJiB0eXBlb2YgdGhpcy5nbG9iYWwub25lcnJvciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBjb25zdCBzb3VyY2UgPSB1cmwgfHwgdGhpcy5vcHRpb25zLmJhc2VVcmw7XG4gICAgICBjb25zdCBtZXNzYWdlID0gZSBpbnN0YW5jZW9mIEVycm9yID8gZS5tZXNzYWdlIDogU3RyaW5nKGUpO1xuICAgICAgc2FmZVdyYXBwZXIzKCgpID0+IHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgKF9iID0gKF9hID0gdGhpcy5nbG9iYWwpID09IG51bGwgPyB2b2lkIDAgOiBfYS5vbmVycm9yKSA9PSBudWxsID8gdm9pZCAwIDogX2IuY2FsbCh0aGlzLmdsb2JhbCwgbWVzc2FnZSwgc291cmNlLCBudWxsLCBudWxsLCBlKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aHJvdyBlO1xuICB9XG4gIGV4ZWNTY3JpcHQoY29kZSwgZW52ID0ge30sIHVybCA9IFwiXCIsIG9wdGlvbnMpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgY29kZVJlZiA9IHsgY29kZSB9O1xuICAgIGNvbnN0IHsgYXN5bmMsIGRlZmVyIH0gPSBvcHRpb25zIHx8IHt9O1xuICAgIHRoaXMuaG9va3MubGlmZWN5Y2xlLmJlZm9yZUludm9rZS5lbWl0KGNvZGVSZWYsIHVybCwgZW52LCBvcHRpb25zKTtcbiAgICBjb25zdCByZXZlcnRDdXJyZW50U2NyaXB0ID0gc2V0RG9jQ3VycmVudFNjcmlwdCgoX2EgPSB0aGlzLmdsb2JhbCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmRvY3VtZW50LCBjb2RlUmVmLmNvZGUsIGZhbHNlLCB1cmwsIGFzeW5jLCBkZWZlciwgb3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5vcmlnaW5TY3JpcHQpO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBwYXJhbXMgPSB0aGlzLmNyZWF0ZUV4ZWNQYXJhbXMoY29kZVJlZiwgZW52KTtcbiAgICAgIGNvZGVSZWYuY29kZSArPSBgXG4ke3VybCA/IGAvLyMgc291cmNlVVJMPSR7dXJsfVxuYCA6IFwiXCJ9YDtcbiAgICAgIGV2YWxXaXRoRW52KGNvZGVSZWYuY29kZSwgcGFyYW1zLCB0aGlzLmdsb2JhbCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgdGhpcy5wcm9jZXNzRXhlY0Vycm9yKGUsIHVybCwgZW52LCBvcHRpb25zKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihyZXZlcnRDdXJyZW50U2NyaXB0KTtcbiAgICB9XG4gICAgdGhpcy5ob29rcy5saWZlY3ljbGUuYWZ0ZXJJbnZva2UuZW1pdChjb2RlUmVmLCB1cmwsIGVudiwgb3B0aW9ucyk7XG4gIH1cbiAgc3RhdGljIGdldE5hdGl2ZVdpbmRvdygpIHtcbiAgICBsZXQgbW9kdWxlID0gd2luZG93O1xuICAgIHdoaWxlIChpc01vZHVsZShtb2R1bGUpKSB7XG4gICAgICBtb2R1bGUgPSBtb2R1bGVbX19nYXJmaXNoR2xvYmFsX19dO1xuICAgIH1cbiAgICByZXR1cm4gbW9kdWxlO1xuICB9XG4gIHN0YXRpYyBjYW5TdXBwb3J0KCkge1xuICAgIGxldCBzdXBwb3J0ID0gdHJ1ZTtcbiAgICBpZiAoIXdpbmRvdy5Qcm94eSB8fCAhQXJyYXkucHJvdG90eXBlLmluY2x1ZGVzIHx8ICFTdHJpbmcucHJvdG90eXBlLmluY2x1ZGVzKSB7XG4gICAgICBzdXBwb3J0ID0gZmFsc2U7XG4gICAgfVxuICAgIGlmIChzdXBwb3J0KSB7XG4gICAgICB0cnkge1xuICAgICAgICBuZXcgRnVuY3Rpb24oXCJsZXQgYSA9IDY2NjtcIik7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHN1cHBvcnQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFzdXBwb3J0KSB7XG4gICAgICB3YXJuNSgnVGhlIGN1cnJlbnQgZW52aXJvbm1lbnQgZG9lcyBub3Qgc3VwcG9ydCBcInZtIHNhbmRib3hcIixQbGVhc2UgdXNlIHRoZSBcInNuYXBzaG90IHNhbmRib3hcIiBpbnN0ZWFkLicpO1xuICAgIH1cbiAgICByZXR1cm4gc3VwcG9ydDtcbiAgfVxufTtcblxuLy8gc3JjL3BsdWdpbmlmeS50c1xudmFyIHNwZWNpYWxFeHRlcm5hbFZhcmlhYmxlcyA9IFtcbiAgXCJvbmVycm9yXCIsXG4gIFwid2VicGFja2pzb25wXCIsXG4gIFwiX19SRUFDVF9FUlJPUl9PVkVSTEFZX0dMT0JBTF9IT09LX19cIixcbiAgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID8gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiIDogZmFsc2UpID8gXCJ3ZWJwYWNrSG90VXBkYXRlXCIgOiBcIlwiXG5dO1xuZnVuY3Rpb24gY29tcGF0aWJsZU9sZE1vZHVsZShtb2R1bGVzKSB7XG4gIGlmICghQXJyYXkuaXNBcnJheShtb2R1bGVzKSkge1xuICAgICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudiAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViA/IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA6IGZhbHNlKSAmJiB3YXJuNignXCJ2bSBzYW5kYm94XCIgbW9kdWxlcyBzaG91bGQgYmUgYW4gYXJyYXknKTtcbiAgICBjb25zdCBsaXN0ID0gW107XG4gICAgZm9yIChjb25zdCBrZXkgaW4gbW9kdWxlcykge1xuICAgICAgbGlzdC5wdXNoKG1vZHVsZXNba2V5XSk7XG4gICAgfVxuICAgIG1vZHVsZXMgPSBsaXN0O1xuICB9XG4gIHJldHVybiBtb2R1bGVzO1xufVxuZnVuY3Rpb24gcmV3cml0ZUFwcEFuZFNhbmRib3goR2FyZmlzaCwgYXBwLCBzYW5kYm94KSB7XG4gIHZhciBfYTtcbiAgY29uc3Qgb3JpZ2luRXhlY1NjcmlwdCA9IHNhbmRib3guZXhlY1NjcmlwdDtcbiAgc2FuZGJveC5sb2FkZXIgPSBHYXJmaXNoLmxvYWRlcjtcbiAgc2FuZGJveC5leGVjU2NyaXB0ID0gKGNvZGUsIGVudiwgdXJsLCBvcHRpb25zKSA9PiB7XG4gICAgY29uc3QgZXZhbEhvb2tzQXJncyA9IFthcHAuYXBwSW5mbywgY29kZSwgZW52LCB1cmwsIG9wdGlvbnNdO1xuICAgIGFwcC5ob29rcy5saWZlY3ljbGUuYmVmb3JlRXZhbC5lbWl0KC4uLmV2YWxIb29rc0FyZ3MpO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXMgPSBvcmlnaW5FeGVjU2NyaXB0LmNhbGwoc2FuZGJveCwgY29kZSwgX19zcHJlYWRWYWx1ZXMoX19zcHJlYWRWYWx1ZXMoe30sIGVudiksIGFwcC5nZXRFeGVjU2NyaXB0RW52KG9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdGlvbnMubm9FbnRyeSkpLCB1cmwsIG9wdGlvbnMpO1xuICAgICAgYXBwLmhvb2tzLmxpZmVjeWNsZS5hZnRlckV2YWwuZW1pdCguLi5ldmFsSG9va3NBcmdzKTtcbiAgICAgIHJldHVybiByZXM7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBhcHAuaG9va3MubGlmZWN5Y2xlLmVycm9yRXhlY0NvZGUuZW1pdChlcnIsIC4uLmV2YWxIb29rc0FyZ3MpO1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgfTtcbiAgYXBwLnZtU2FuZGJveCA9IHNhbmRib3g7XG4gIGFwcC5nbG9iYWwgPSBzYW5kYm94Lmdsb2JhbDtcbiAgYXBwLnN0cmljdElzb2xhdGlvbiA9IChfYSA9IHNhbmRib3gub3B0aW9ucy5zdHJpY3RJc29sYXRpb24pICE9IG51bGwgPyBfYSA6IGZhbHNlO1xuICBhcHAucnVuQ29kZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBvcmlnaW5FeGVjU2NyaXB0LmFwcGx5KHNhbmRib3gsIGFyZ3VtZW50cyk7XG4gIH07XG4gIGlmIChhcHAuZW50cnlNYW5hZ2VyLkRPTUFwaXMgJiYgc2FuZGJveC5nbG9iYWwpIHtcbiAgICBhcHAuZW50cnlNYW5hZ2VyLkRPTUFwaXMuZG9jdW1lbnQgPSBzYW5kYm94Lmdsb2JhbC5kb2N1bWVudDtcbiAgfVxufVxuZnVuY3Rpb24gY3JlYXRlT3B0aW9ucyhHYXJmaXNoKSB7XG4gIGNvbnN0IGNhblN1cHBvcnQgPSBTYW5kYm94LmNhblN1cHBvcnQoKTtcbiAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICBuYW1lOiBcImJyb3dzZXItdm1cIixcbiAgICB2ZXJzaW9uOiBcIjEuMTYuMlwiLFxuICAgIGFmdGVyTG9hZChhcHBJbmZvLCBhcHBJbnN0YW5jZSkge1xuICAgICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2Y7XG4gICAgICBpZiAoIWNhblN1cHBvcnQgfHwgIWFwcEluc3RhbmNlIHx8IChhcHBJbnN0YW5jZSA9PSBudWxsID8gdm9pZCAwIDogYXBwSW5zdGFuY2Uudm1TYW5kYm94KSB8fCBhcHBJbmZvLnNhbmRib3ggPT09IGZhbHNlIHx8IGFwcEluZm8uc2FuZGJveCAmJiBhcHBJbmZvLnNhbmRib3gub3BlbiA9PT0gZmFsc2UgfHwgYXBwSW5mby5zYW5kYm94ICYmIGFwcEluZm8uc2FuZGJveC5zbmFwc2hvdCkge1xuICAgICAgICBpZiAoYXBwSW5zdGFuY2UgPT0gbnVsbCA/IHZvaWQgMCA6IGFwcEluc3RhbmNlLnZtU2FuZGJveCkge1xuICAgICAgICAgIGFwcEluc3RhbmNlLmdsb2JhbCA9IGFwcEluc3RhbmNlLnZtU2FuZGJveC5nbG9iYWw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgcmV3cml0ZUFwcEFuZFNhbmRib3goR2FyZmlzaCwgYXBwSW5zdGFuY2UsIG5ldyBTYW5kYm94KHtcbiAgICAgICAgbmFtZXNwYWNlOiBhcHBJbmZvLm5hbWUsXG4gICAgICAgIGFkZFNvdXJjZUxpc3Q6IGFwcEluc3RhbmNlLmFkZFNvdXJjZUxpc3QuYmluZChhcHBJbnN0YW5jZSksXG4gICAgICAgIGJhc2VVcmw6IGFwcEluc3RhbmNlLmVudHJ5TWFuYWdlci51cmwsXG4gICAgICAgIG1vZHVsZXM6IGNvbXBhdGlibGVPbGRNb2R1bGUoKChfYSA9IGFwcEluZm8uc2FuZGJveCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLm1vZHVsZXMpIHx8IFtdKSxcbiAgICAgICAgZml4QmFzZVVybDogQm9vbGVhbigoX2IgPSBhcHBJbmZvLnNhbmRib3gpID09IG51bGwgPyB2b2lkIDAgOiBfYi5maXhCYXNlVXJsKSxcbiAgICAgICAgZml4U3RhdGljUmVzb3VyY2VCYXNlVXJsOiBCb29sZWFuKChfYyA9IGFwcEluZm8uc2FuZGJveCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9jLmZpeFN0YXRpY1Jlc291cmNlQmFzZVVybCksXG4gICAgICAgIGRpc2FibGVXaXRoOiBCb29sZWFuKChfZCA9IGFwcEluZm8uc2FuZGJveCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9kLmRpc2FibGVXaXRoKSxcbiAgICAgICAgZGlzYWJsZUVsZW1lbnR0aW1pbmc6IEJvb2xlYW4oKF9lID0gYXBwSW5mby5zYW5kYm94KSA9PSBudWxsID8gdm9pZCAwIDogX2UuZGlzYWJsZUVsZW1lbnR0aW1pbmcpLFxuICAgICAgICBzdHJpY3RJc29sYXRpb246IEJvb2xlYW4oKF9mID0gYXBwSW5mby5zYW5kYm94KSA9PSBudWxsID8gdm9pZCAwIDogX2Yuc3RyaWN0SXNvbGF0aW9uKSxcbiAgICAgICAgZWw6ICgpID0+IGFwcEluc3RhbmNlLmh0bWxOb2RlLFxuICAgICAgICBzdHlsZVNjb3BlSWQ6ICgpID0+IGFwcEluc3RhbmNlLmFwcENvbnRhaW5lci5pZCxcbiAgICAgICAgcHJvdGVjdFZhcmlhYmxlOiAoKSA9PiBhcHBJbmZvLnByb3RlY3RWYXJpYWJsZSB8fCBbXSxcbiAgICAgICAgaW5zdWxhdGlvblZhcmlhYmxlOiAoKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIC4uLnNwZWNpYWxFeHRlcm5hbFZhcmlhYmxlcyxcbiAgICAgICAgICAgIC4uLmFwcEluZm8uaW5zdWxhdGlvblZhcmlhYmxlIHx8IFtdXG4gICAgICAgICAgXS5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgIH1cbiAgICAgIH0pKTtcbiAgICB9LFxuICAgIGFmdGVyVW5tb3VudChhcHBJbmZvLCBhcHBJbnN0YW5jZSwgaXNDYWNoZU1vZGUpIHtcbiAgICAgIGlmIChhcHBJbnN0YW5jZS52bVNhbmRib3ggJiYgIWlzQ2FjaGVNb2RlKSB7XG4gICAgICAgIGFwcEluc3RhbmNlLnZtU2FuZGJveC5yZXNldCgpO1xuICAgICAgfVxuICAgIH0sXG4gICAgYWZ0ZXJNb3VudChhcHBJbmZvLCBhcHBJbnN0YW5jZSkge1xuICAgICAgaWYgKGFwcEluc3RhbmNlLnZtU2FuZGJveCkge1xuICAgICAgICByZWJ1aWxkQ1NTUnVsZXMoYXBwSW5zdGFuY2Uudm1TYW5kYm94LmR5bmFtaWNTdHlsZVNoZWV0RWxlbWVudFNldCwgYXBwSW5zdGFuY2Uudm1TYW5kYm94LnN0eWxlZENvbXBvbmVudENTU1J1bGVzTWFwKTtcbiAgICAgICAgYXBwSW5zdGFuY2Uudm1TYW5kYm94LmV4ZWNTY3JpcHQoYFxuICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93Lm9ubG9hZCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgd2luZG93Lm9ubG9hZC5jYWxsKHdpbmRvdyk7XG4gICAgICAgICAgfVxuICAgICAgICBgKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIHJldHVybiBvcHRpb25zO1xufVxuZnVuY3Rpb24gR2FyZmlzaEJyb3dzZXJWbSgpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKEdhcmZpc2gpIHtcbiAgICBHYXJmaXNoLmdldEdsb2JhbE9iamVjdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFNhbmRib3guZ2V0TmF0aXZlV2luZG93KCk7XG4gICAgfTtcbiAgICBHYXJmaXNoLnNldEdsb2JhbFZhbHVlID0gZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0R2xvYmFsT2JqZWN0KClba2V5XSA9IHZhbHVlO1xuICAgIH07XG4gICAgR2FyZmlzaC5jbGVhckVzY2FwZUVmZmVjdCA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgIGNvbnN0IGdsb2JhbCA9IHRoaXMuZ2V0R2xvYmFsT2JqZWN0KCk7XG4gICAgICBpZiAoa2V5IGluIGdsb2JhbCkge1xuICAgICAgICBnbG9iYWxba2V5XSA9IHZhbHVlO1xuICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIGNyZWF0ZU9wdGlvbnMoR2FyZmlzaCk7XG4gIH07XG59XG5leHBvcnQge1xuICBHYXJmaXNoQnJvd3NlclZtLFxuICBTYW5kYm94IGFzIGRlZmF1bHRcbn07XG4iLCJ2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xudmFyIF9fZGVmUHJvcHMgPSBPYmplY3QuZGVmaW5lUHJvcGVydGllcztcbnZhciBfX2dldE93blByb3BEZXNjcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzO1xudmFyIF9fZ2V0T3duUHJvcFN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzO1xudmFyIF9faGFzT3duUHJvcCA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG52YXIgX19wcm9wSXNFbnVtID0gT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZTtcbnZhciBfX2RlZk5vcm1hbFByb3AgPSAob2JqLCBrZXksIHZhbHVlKSA9PiBrZXkgaW4gb2JqID8gX19kZWZQcm9wKG9iaiwga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUsIHZhbHVlIH0pIDogb2JqW2tleV0gPSB2YWx1ZTtcbnZhciBfX3NwcmVhZFZhbHVlcyA9IChhLCBiKSA9PiB7XG4gIGZvciAodmFyIHByb3AgaW4gYiB8fCAoYiA9IHt9KSlcbiAgICBpZiAoX19oYXNPd25Qcm9wLmNhbGwoYiwgcHJvcCkpXG4gICAgICBfX2RlZk5vcm1hbFByb3AoYSwgcHJvcCwgYltwcm9wXSk7XG4gIGlmIChfX2dldE93blByb3BTeW1ib2xzKVxuICAgIGZvciAodmFyIHByb3Agb2YgX19nZXRPd25Qcm9wU3ltYm9scyhiKSkge1xuICAgICAgaWYgKF9fcHJvcElzRW51bS5jYWxsKGIsIHByb3ApKVxuICAgICAgICBfX2RlZk5vcm1hbFByb3AoYSwgcHJvcCwgYltwcm9wXSk7XG4gICAgfVxuICByZXR1cm4gYTtcbn07XG52YXIgX19zcHJlYWRQcm9wcyA9IChhLCBiKSA9PiBfX2RlZlByb3BzKGEsIF9fZ2V0T3duUHJvcERlc2NzKGIpKTtcbnZhciBfX29ialJlc3QgPSAoc291cmNlLCBleGNsdWRlKSA9PiB7XG4gIHZhciB0YXJnZXQgPSB7fTtcbiAgZm9yICh2YXIgcHJvcCBpbiBzb3VyY2UpXG4gICAgaWYgKF9faGFzT3duUHJvcC5jYWxsKHNvdXJjZSwgcHJvcCkgJiYgZXhjbHVkZS5pbmRleE9mKHByb3ApIDwgMClcbiAgICAgIHRhcmdldFtwcm9wXSA9IHNvdXJjZVtwcm9wXTtcbiAgaWYgKHNvdXJjZSAhPSBudWxsICYmIF9fZ2V0T3duUHJvcFN5bWJvbHMpXG4gICAgZm9yICh2YXIgcHJvcCBvZiBfX2dldE93blByb3BTeW1ib2xzKHNvdXJjZSkpIHtcbiAgICAgIGlmIChleGNsdWRlLmluZGV4T2YocHJvcCkgPCAwICYmIF9fcHJvcElzRW51bS5jYWxsKHNvdXJjZSwgcHJvcCkpXG4gICAgICAgIHRhcmdldFtwcm9wXSA9IHNvdXJjZVtwcm9wXTtcbiAgICB9XG4gIHJldHVybiB0YXJnZXQ7XG59O1xuXG4vLyBzcmMvZ2FyZmlzaC50c1xuaW1wb3J0IHsgTG9hZGVyIGFzIExvYWRlcjIgfSBmcm9tIFwiQGdhcmZpc2gvbG9hZGVyXCI7XG5pbXBvcnQgeyBFdmVudEVtaXR0ZXIyIH0gZnJvbSBcImV2ZW50ZW1pdHRlcjJcIjtcbmltcG9ydCB7IHdhcm4gYXMgd2FybjUsIGFzc2VydCBhcyBhc3NlcnQ0LCBpc1BsYWluT2JqZWN0LCBfX0dBUkZJU0hfRkxBR19fIH0gZnJvbSBcIkBnYXJmaXNoL3V0aWxzXCI7XG5pbXBvcnQge1xuICBTeW5jSG9vayBhcyBTeW5jSG9vazIsXG4gIEFzeW5jSG9vayBhcyBBc3luY0hvb2syLFxuICBTeW5jV2F0ZXJmYWxsSG9vayBhcyBTeW5jV2F0ZXJmYWxsSG9vazIsXG4gIEFzeW5jV2F0ZXJmYWxsSG9vayxcbiAgUGx1Z2luU3lzdGVtIGFzIFBsdWdpblN5c3RlbTJcbn0gZnJvbSBcIkBnYXJmaXNoL2hvb2tzXCI7XG5cbi8vIHNyYy9jb25maWcudHNcbmltcG9ydCB7XG4gIGVycm9yLFxuICBkZWVwTWVyZ2UsXG4gIGZpbHRlclVuZGVmaW5lZFZhbFxufSBmcm9tIFwiQGdhcmZpc2gvdXRpbHNcIjtcbnZhciBmaWx0ZXJBcHBDb25maWdLZXlzID0ge1xuICBiZWZvcmVCb290c3RyYXA6IHRydWUsXG4gIGJvb3RzdHJhcDogdHJ1ZSxcbiAgYmVmb3JlUmVnaXN0ZXJBcHA6IHRydWUsXG4gIHJlZ2lzdGVyQXBwOiB0cnVlLFxuICBiZWZvcmVMb2FkOiB0cnVlLFxuICBhZnRlckxvYWQ6IHRydWUsXG4gIGVycm9yTG9hZEFwcDogdHJ1ZSxcbiAgYXBwSUQ6IHRydWUsXG4gIGFwcHM6IHRydWUsXG4gIGRpc2FibGVTdGF0aXN0aWNzOiB0cnVlLFxuICBkaXNhYmxlUHJlbG9hZEFwcDogdHJ1ZSxcbiAgcGx1Z2luczogdHJ1ZSxcbiAgYXV0b1JlZnJlc2hBcHA6IHRydWUsXG4gIG9uTm90TWF0Y2hSb3V0ZXI6IHRydWUsXG4gIGxvYWRlcjogdHJ1ZVxufTtcbnZhciBkZWVwTWVyZ2VDb25maWcgPSAoZ2xvYmFsQ29uZmlnLCBsb2NhbENvbmZpZykgPT4ge1xuICBjb25zdCBfYSA9IGdsb2JhbENvbmZpZywgeyBwcm9wczogZ2xvYmFsUHJvcHMgfSA9IF9hLCBuZXdHbG9iYWxDb25maWcgPSBfX29ialJlc3QoX2EsIFtcInByb3BzXCJdKTtcbiAgY29uc3QgX2IgPSBsb2NhbENvbmZpZywgeyBwcm9wczogbG9jYWxQcm9wcyB9ID0gX2IsIG5ld0xvY2FsQ29uZmlnID0gX19vYmpSZXN0KF9iLCBbXCJwcm9wc1wiXSk7XG4gIGNvbnN0IHByb3BzID0gX19zcHJlYWRWYWx1ZXMoX19zcHJlYWRWYWx1ZXMoe30sIGdsb2JhbFByb3BzIHx8IHt9KSwgbG9jYWxQcm9wcyB8fCB7fSk7XG4gIGNvbnN0IHJlc3VsdCA9IGRlZXBNZXJnZShmaWx0ZXJVbmRlZmluZWRWYWwobmV3R2xvYmFsQ29uZmlnKSwgZmlsdGVyVW5kZWZpbmVkVmFsKG5ld0xvY2FsQ29uZmlnKSk7XG4gIHJldHVybiBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCByZXN1bHQpLCB7XG4gICAgcHJvcHNcbiAgfSk7XG59O1xudmFyIGdldEFwcENvbmZpZyA9IChnbG9iYWxDb25maWcsIGxvY2FsQ29uZmlnKSA9PiB7XG4gIGNvbnN0IG1lcmdlUmVzdWx0ID0gZGVlcE1lcmdlQ29uZmlnKGdsb2JhbENvbmZpZywgbG9jYWxDb25maWcpO1xuICBPYmplY3Qua2V5cyhtZXJnZVJlc3VsdCkuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgaWYgKGZpbHRlckFwcENvbmZpZ0tleXNba2V5XSkge1xuICAgICAgZGVsZXRlIG1lcmdlUmVzdWx0W2tleV07XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIG1lcmdlUmVzdWx0O1xufTtcbnZhciBnZW5lcmF0ZUFwcE9wdGlvbnMgPSAoYXBwTmFtZSwgZ2FyZmlzaCwgb3B0aW9ucykgPT4ge1xuICBsZXQgYXBwSW5mbyA9IGdhcmZpc2guYXBwSW5mb3NbYXBwTmFtZV0gfHwgeyBuYW1lOiBhcHBOYW1lIH07XG4gIGFwcEluZm8gPSBnZXRBcHBDb25maWcoZ2FyZmlzaC5vcHRpb25zLCBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKF9fc3ByZWFkVmFsdWVzKHt9LCBhcHBJbmZvKSwgb3B0aW9ucyksIHtcbiAgICBwcm9wczogX19zcHJlYWRWYWx1ZXMoX19zcHJlYWRWYWx1ZXMoe30sIGFwcEluZm8ucHJvcHMgfHwge30pLCAob3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5wcm9wcykgfHwge30pXG4gIH0pKTtcbiAgcmV0dXJuIGFwcEluZm87XG59O1xudmFyIGNyZWF0ZURlZmF1bHRPcHRpb25zID0gKCkgPT4ge1xuICBjb25zdCBjb25maWcgPSB7XG4gICAgYXBwSUQ6IFwiXCIsXG4gICAgYXBwczogW10sXG4gICAgYXV0b1JlZnJlc2hBcHA6IHRydWUsXG4gICAgZGlzYWJsZVN0YXRpc3RpY3M6IGZhbHNlLFxuICAgIGRpc2FibGVQcmVsb2FkQXBwOiBmYWxzZSxcbiAgICBiYXNlbmFtZTogXCIvXCIsXG4gICAgcHJvcHM6IHt9LFxuICAgIGFzeW5jUHJvdmlkZXJUaW1lb3V0OiAyZTMsXG4gICAgZG9tR2V0dGVyOiAoKSA9PiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLFxuICAgIHNhbmRib3g6IHtcbiAgICAgIHNuYXBzaG90OiBmYWxzZSxcbiAgICAgIGZpeEJhc2VVcmw6IGZhbHNlLFxuICAgICAgZml4U3RhdGljUmVzb3VyY2VCYXNlVXJsOiB0cnVlLFxuICAgICAgZGlzYWJsZVdpdGg6IGZhbHNlLFxuICAgICAgc3RyaWN0SXNvbGF0aW9uOiBmYWxzZSxcbiAgICAgIGRpc2FibGVFbGVtZW50dGltaW5nOiBmYWxzZVxuICAgIH0sXG4gICAgYmVmb3JlTG9hZDogKCkgPT4ge1xuICAgIH0sXG4gICAgYWZ0ZXJMb2FkOiAoKSA9PiB7XG4gICAgfSxcbiAgICBlcnJvckxvYWRBcHA6IChlKSA9PiBlcnJvcihlKSxcbiAgICBvbk5vdE1hdGNoUm91dGVyOiAoKSA9PiB7XG4gICAgfSxcbiAgICBiZWZvcmVFdmFsOiAoKSA9PiB7XG4gICAgfSxcbiAgICBhZnRlckV2YWw6ICgpID0+IHtcbiAgICB9LFxuICAgIGJlZm9yZU1vdW50OiAoKSA9PiB7XG4gICAgfSxcbiAgICBhZnRlck1vdW50OiAoKSA9PiB7XG4gICAgfSxcbiAgICBiZWZvcmVVbm1vdW50OiAoKSA9PiB7XG4gICAgfSxcbiAgICBhZnRlclVubW91bnQ6ICgpID0+IHtcbiAgICB9LFxuICAgIGVycm9yTW91bnRBcHA6IChlKSA9PiBlcnJvcihlKSxcbiAgICBlcnJvclVubW91bnRBcHA6IChlKSA9PiBlcnJvcihlKSxcbiAgICBjdXN0b21Mb2FkZXI6IHZvaWQgMFxuICB9O1xuICByZXR1cm4gY29uZmlnO1xufTtcblxuLy8gc3JjL21vZHVsZS9hcHAudHNcbmltcG9ydCB7XG4gIHdhcm4sXG4gIGFzc2VydCBhcyBhc3NlcnQyLFxuICBoYXNPd24sXG4gIHJlbW92ZSxcbiAgUXVldWUsXG4gIGNvcmVMb2csXG4gIGlzSnNUeXBlLFxuICBpc09iamVjdCBhcyBpc09iamVjdDIsXG4gIGlzUHJvbWlzZSxcbiAgaXNHYXJmaXNoQ29uZmlnVHlwZSxcbiAgdG9Cb29sZWFuLFxuICBmaW5kVGFyZ2V0LFxuICBldmFsV2l0aEVudixcbiAgdHJhbnNmb3JtVXJsIGFzIHRyYW5zZm9ybVVybDIsXG4gIF9fTW9ja0JvZHlfXyxcbiAgX19Nb2NrSGVhZF9fLFxuICBnZXRSZW5kZXJOb2RlLFxuICBzb3VyY2VMaXN0VGFncyxcbiAgY3JlYXRlQXBwQ29udGFpbmVyLFxuICBzZXREb2NDdXJyZW50U2NyaXB0LFxuICBnZXRTb3VyY2VVUkxcbn0gZnJvbSBcIkBnYXJmaXNoL3V0aWxzXCI7XG5cbi8vIHNyYy9saWZlY3ljbGUudHNcbmltcG9ydCB7XG4gIFN5bmNIb29rLFxuICBTeW5jV2F0ZXJmYWxsSG9vayxcbiAgQXN5bmNIb29rLFxuICBQbHVnaW5TeXN0ZW1cbn0gZnJvbSBcIkBnYXJmaXNoL2hvb2tzXCI7XG5mdW5jdGlvbiBnbG9iYWxMaWZlY3ljbGUoKSB7XG4gIHJldHVybiBuZXcgUGx1Z2luU3lzdGVtKHtcbiAgICBiZWZvcmVCb290c3RyYXA6IG5ldyBTeW5jSG9vaygpLFxuICAgIGJvb3RzdHJhcDogbmV3IFN5bmNIb29rKCksXG4gICAgYmVmb3JlUmVnaXN0ZXJBcHA6IG5ldyBTeW5jSG9vaygpLFxuICAgIHJlZ2lzdGVyQXBwOiBuZXcgU3luY0hvb2soKSxcbiAgICBiZWZvcmVMb2FkOiBuZXcgQXN5bmNIb29rKCksXG4gICAgYWZ0ZXJMb2FkOiBuZXcgQXN5bmNIb29rKCksXG4gICAgZXJyb3JMb2FkQXBwOiBuZXcgU3luY0hvb2soKVxuICB9KTtcbn1cbmZ1bmN0aW9uIGFwcExpZmVjeWNsZSgpIHtcbiAgcmV0dXJuIG5ldyBQbHVnaW5TeXN0ZW0oe1xuICAgIGJlZm9yZUV2YWw6IG5ldyBTeW5jSG9vaygpLFxuICAgIGFmdGVyRXZhbDogbmV3IFN5bmNIb29rKCksXG4gICAgYmVmb3JlTW91bnQ6IG5ldyBTeW5jSG9vaygpLFxuICAgIGFmdGVyTW91bnQ6IG5ldyBTeW5jSG9vaygpLFxuICAgIGVycm9yTW91bnRBcHA6IG5ldyBTeW5jSG9vaygpLFxuICAgIGJlZm9yZVVubW91bnQ6IG5ldyBTeW5jSG9vaygpLFxuICAgIGFmdGVyVW5tb3VudDogbmV3IFN5bmNIb29rKCksXG4gICAgZXJyb3JVbm1vdW50QXBwOiBuZXcgU3luY0hvb2soKSxcbiAgICBlcnJvckV4ZWNDb2RlOiBuZXcgU3luY0hvb2soKSxcbiAgICBjdXN0b21SZW5kZXI6IG5ldyBTeW5jV2F0ZXJmYWxsSG9vayhcImN1c3RvbVJlbmRlclwiKVxuICB9KTtcbn1cblxuLy8gc3JjL21vZHVsZS9lc01vZHVsZS50c1xuaW1wb3J0IHsgaW5pdCwgcGFyc2UgfSBmcm9tIFwiQGFsaW90aC1vcmcvZXMtbW9kdWxlLWxleGVyXCI7XG5pbXBvcnQgeyBMb2NrIH0gZnJvbSBcIkBnYXJmaXNoL3V0aWxzXCI7XG5pbXBvcnQge1xuICBpc0Fic29sdXRlLFxuICB0cmFuc2Zvcm1VcmwsXG4gIGhhdmVTb3VyY2VtYXAsXG4gIGNyZWF0ZVNvdXJjZW1hcFxufSBmcm9tIFwiQGdhcmZpc2gvdXRpbHNcIjtcbnZhciBfX0dBUkZJU0hfRVNNX0VOVl9fID0gXCJfX0dBUkZJU0hfRVNNX0VOVl9fXCI7XG52YXIgZ2V0TW9kdWxlSW1wb3J0UHJvY2Vzc29yID0gKGNvZGUpID0+IHtcbiAgbGV0IGZpbmFsQ29kZSA9IFwiXCI7XG4gIGxldCByZXNldENvZGUgPSBjb2RlO1xuICBsZXQgcHJldkNvZGVJbmRleCA9IDA7XG4gIGNvbnN0IHJhd0ltcG9ydCA9IFwiaW1wb3J0XCI7XG4gIGNvbnN0IHdyYXBJbXBvcnQgPSBcIl9pbXBvcnRfXCI7XG4gIHJldHVybiAoaW1wb3J0QW5hbHlzaXMsIG5ld01vZHVsZU5hbWUgPSBcIlwiKSA9PiB7XG4gICAgY29uc3QgeyBkOiBpbXBvcnRUeXBlLCBuOiBtb2R1bGVOYW1lLCBzLCBlLCBzcywgc2UgfSA9IGltcG9ydEFuYWx5c2lzO1xuICAgIGNvbnN0IGlzRHluYW1pY0ltcG9ydCA9IGltcG9ydFR5cGUgPiAtMTtcbiAgICBpZiAoaXNEeW5hbWljSW1wb3J0KSB7XG4gICAgICBjb25zdCBjb2RlU3RhcnQgPSBzcyAtIHByZXZDb2RlSW5kZXg7XG4gICAgICBjb25zdCBjb2RlRW5kID0gc2UgLSBwcmV2Q29kZUluZGV4O1xuICAgICAgY29uc3QgZHluYW1pY0ltcG9ydFN0YXRlbWVudCA9IHJlc2V0Q29kZS5zbGljZShjb2RlU3RhcnQsIGNvZGVFbmQpO1xuICAgICAgZmluYWxDb2RlICs9IHJlc2V0Q29kZS5zbGljZSgwLCBjb2RlU3RhcnQpO1xuICAgICAgZmluYWxDb2RlICs9IGR5bmFtaWNJbXBvcnRTdGF0ZW1lbnQucmVwbGFjZShyYXdJbXBvcnQsIHdyYXBJbXBvcnQpO1xuICAgICAgcmVzZXRDb2RlID0gcmVzZXRDb2RlLnNsaWNlKGNvZGVFbmQpO1xuICAgICAgcHJldkNvZGVJbmRleCA9IHNlO1xuICAgIH0gZWxzZSBpZiAobW9kdWxlTmFtZSkge1xuICAgICAgY29uc3QgY29kZVN0YXJ0ID0gcyAtIHByZXZDb2RlSW5kZXg7XG4gICAgICBjb25zdCBjb2RlRW5kID0gZSAtIHByZXZDb2RlSW5kZXg7XG4gICAgICBmaW5hbENvZGUgKz0gcmVzZXRDb2RlLnNsaWNlKDAsIGNvZGVTdGFydCk7XG4gICAgICBmaW5hbENvZGUgKz0gbmV3TW9kdWxlTmFtZTtcbiAgICAgIHJlc2V0Q29kZSA9IHJlc2V0Q29kZS5zbGljZShjb2RlRW5kKTtcbiAgICAgIHByZXZDb2RlSW5kZXggPSBlO1xuICAgIH1cbiAgICByZXR1cm4gW2ZpbmFsQ29kZSwgcmVzZXRDb2RlXTtcbiAgfTtcbn07XG52YXIgZ2VuU2hlbGxFeGVjdXRpb25Db2RlID0gKGlkLCBzb3VyY2VNb2R1bGVOYW1lLCBzaGVsbFVybCkgPT4gYDtpbXBvcnQqYXMgbSQkXyR7aWR9IGZyb20nJHtzb3VyY2VNb2R1bGVOYW1lfSc7aW1wb3J0e3UkJF8gYXMgdSQkXyR7aWR9fWZyb20nJHtzaGVsbFVybH0nO3UkJF8ke2lkfShtJCRfJHtpZH0pYDtcbnZhciBFU01vZHVsZUxvYWRlciA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoYXBwKSB7XG4gICAgdGhpcy5tb2R1bGVDYWNoZSA9IHt9O1xuICAgIHRoaXMubG9jayA9IG5ldyBMb2NrKCk7XG4gICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgdGhpcy5nbG9iYWxWYXJLZXkgPSBgJHtfX0dBUkZJU0hfRVNNX0VOVl9ffV8ke3RoaXMuYXBwLmFwcElkfWA7XG4gIH1cbiAgZXhlY01vZHVsZUNvZGUoYmxvYlVybCkge1xuICAgIGNvbnN0IHJlc3VsdCA9ICgwLCBldmFsKShgaW1wb3J0KCcke2Jsb2JVcmx9JylgKTtcbiAgICB0aGlzLmxvY2sucmVsZWFzZSgpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiAgY3JlYXRlQmxvYlVybChjb2RlKSB7XG4gICAgcmV0dXJuIFVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW2NvZGVdLCB7IHR5cGU6IFwidGV4dC9qYXZhc2NyaXB0XCIgfSkpO1xuICB9XG4gIHNldEJsb2JVcmwoc2F2ZUlkLCBibG9iVXJsKSB7XG4gICAgdGhpcy5tb2R1bGVDYWNoZVtzYXZlSWRdLmJsb2JVcmwgPSBibG9iVXJsO1xuICB9XG4gIGFzeW5jIGZldGNoTW9kdWxlUmVzb3VyY2UobG9ja0lkLCBlbnZWYXJTdHIsIG5vRW50cnlFbnZWYXJTdHIsIHNhdmVVcmwsIHJlcXVlc3RVcmwpIHtcbiAgICBjb25zdCB7IHJlc291cmNlTWFuYWdlciB9ID0gYXdhaXQgdGhpcy5hcHAuY29udGV4dC5sb2FkZXIubG9hZCh7XG4gICAgICBzY29wZTogdGhpcy5hcHAubmFtZSxcbiAgICAgIHVybDogcmVxdWVzdFVybFxuICAgIH0pO1xuICAgIGlmIChyZXNvdXJjZU1hbmFnZXIpIHtcbiAgICAgIGxldCBzb3VyY2VtYXAgPSBcIlwiO1xuICAgICAgbGV0IHsgdXJsLCBzY3JpcHRDb2RlIH0gPSByZXNvdXJjZU1hbmFnZXI7XG4gICAgICBpZiAoIWhhdmVTb3VyY2VtYXAoc2NyaXB0Q29kZSkpIHtcbiAgICAgICAgc291cmNlbWFwID0gYXdhaXQgY3JlYXRlU291cmNlbWFwKHNjcmlwdENvZGUsIHJlcXVlc3RVcmwpO1xuICAgICAgfVxuICAgICAgc2NyaXB0Q29kZSA9IGF3YWl0IHRoaXMuYW5hbHlzaXNNb2R1bGUobG9ja0lkLCBzY3JpcHRDb2RlLCBlbnZWYXJTdHIsIG5vRW50cnlFbnZWYXJTdHIsIHNhdmVVcmwsIHVybCk7XG4gICAgICBjb25zdCBibG9iVXJsID0gdGhpcy5jcmVhdGVCbG9iVXJsKGBpbXBvcnQubWV0YS51cmw9JyR7dXJsfSc7JHt0aGlzLmFwcC5pc05vRW50cnlTY3JpcHQodXJsKSA/IG5vRW50cnlFbnZWYXJTdHIgOiBlbnZWYXJTdHJ9JHtzY3JpcHRDb2RlfVxuJHtzb3VyY2VtYXB9YCk7XG4gICAgICB0aGlzLnNldEJsb2JVcmwoc2F2ZVVybCwgYmxvYlVybCk7XG4gICAgfVxuICB9XG4gIGdldFVybChyZWZlclVybCwgdGFyZ2V0VXJsKSB7XG4gICAgcmV0dXJuICFpc0Fic29sdXRlKHRhcmdldFVybCkgJiYgcmVmZXJVcmwgPyB0cmFuc2Zvcm1VcmwocmVmZXJVcmwsIHRhcmdldFVybCkgOiB0YXJnZXRVcmw7XG4gIH1cbiAgcHJlbG9hZFN0YXRpY01vZHVsZUFzeW5jKGFuYWx5c2lzLCByZWFsVXJsKSB7XG4gICAgY29uc3QgW2ltcG9ydHNdID0gYW5hbHlzaXM7XG4gICAgZm9yIChsZXQgaSA9IDAsIGxlbmd0aCA9IGltcG9ydHMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGltcG9ydEFuYWx5c2lzID0gaW1wb3J0c1tpXTtcbiAgICAgIGNvbnN0IHsgZDogaW1wb3J0VHlwZSwgbjogbW9kdWxlTmFtZSB9ID0gaW1wb3J0QW5hbHlzaXM7XG4gICAgICBjb25zdCBpc0R5bmFtaWNJbXBvcnQgPSBpbXBvcnRUeXBlID4gLTE7XG4gICAgICBpZiAobW9kdWxlTmFtZSAmJiAhaXNEeW5hbWljSW1wb3J0KSB7XG4gICAgICAgIHRoaXMuYXBwLmNvbnRleHQubG9hZGVyLmxvYWQoe1xuICAgICAgICAgIHNjb3BlOiB0aGlzLmFwcC5uYW1lLFxuICAgICAgICAgIHVybDogdGhpcy5nZXRVcmwocmVhbFVybCwgbW9kdWxlTmFtZSlcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGFzeW5jIGFuYWx5c2lzTW9kdWxlKGxvY2tJZCwgY29kZSwgZW52VmFyU3RyLCBub0VudHJ5RW52VmFyU3RyLCBiYXNlVXJsLCByZWFsVXJsKSB7XG4gICAgYXdhaXQgdGhpcy5sb2NrLndhaXQobG9ja0lkKTtcbiAgICBhd2FpdCBpbml0KCk7XG4gICAgY29uc3QgYW5hbHlzaXMgPSBwYXJzZShjb2RlLCByZWFsVXJsIHx8IFwiXCIpO1xuICAgIGNvbnN0IHRoaXNNb2R1bGUgPSB7XG4gICAgICBhbmFseXNpcyxcbiAgICAgIHNvdXJjZTogY29kZVxuICAgIH07XG4gICAgaWYgKGJhc2VVcmwpIHtcbiAgICAgIHRoaXMubW9kdWxlQ2FjaGVbYmFzZVVybF0gPSB0aGlzTW9kdWxlO1xuICAgIH1cbiAgICBsZXQgcmVzdWx0ID0gW1wiXCIsIGNvZGVdO1xuICAgIGxldCBzaGVsbEV4ZWN1dGlvbkNvZGUgPSBcIlwiO1xuICAgIGNvbnN0IGR5bmFtaWNJbXBvcnQgPSBgdmFyIF9pbXBvcnRfPSh1cmwpPT53aW5kb3cuJHt0aGlzLmdsb2JhbFZhcktleX0uaW1wb3J0KHVybCwnJHtiYXNlVXJsfScsJyR7cmVhbFVybH0nKTtgO1xuICAgIGNvbnN0IHByb2Nlc3NJbXBvcnRNb2R1bGUgPSBnZXRNb2R1bGVJbXBvcnRQcm9jZXNzb3IoY29kZSk7XG4gICAgY29uc3QgW2ltcG9ydHNdID0gYW5hbHlzaXM7XG4gICAgdGhpcy5wcmVsb2FkU3RhdGljTW9kdWxlQXN5bmMoYW5hbHlzaXMsIHJlYWxVcmwpO1xuICAgIGZvciAobGV0IGkgPSAwLCBsZW5ndGggPSBpbXBvcnRzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBpbXBvcnRBbmFseXNpcyA9IGltcG9ydHNbaV07XG4gICAgICBjb25zdCB7IGQ6IGltcG9ydFR5cGUsIG46IG1vZHVsZU5hbWUgfSA9IGltcG9ydEFuYWx5c2lzO1xuICAgICAgY29uc3QgaXNEeW5hbWljSW1wb3J0ID0gaW1wb3J0VHlwZSA+IC0xO1xuICAgICAgbGV0IHNhdmVVcmwgPSBtb2R1bGVOYW1lIHx8IFwiXCI7XG4gICAgICBsZXQgbmV3TW9kdWxlTmFtZSA9IFwiXCI7XG4gICAgICBpZiAobW9kdWxlTmFtZSAmJiAhaXNEeW5hbWljSW1wb3J0KSB7XG4gICAgICAgIGNvbnN0IHJlcXVlc3RVcmwgPSB0aGlzLmdldFVybChyZWFsVXJsLCBtb2R1bGVOYW1lKTtcbiAgICAgICAgc2F2ZVVybCA9IHRoaXMuZ2V0VXJsKGJhc2VVcmwsIG1vZHVsZU5hbWUpO1xuICAgICAgICBsZXQgY3VycmVudE1vZHVsZSA9IHRoaXMubW9kdWxlQ2FjaGVbc2F2ZVVybF07XG4gICAgICAgIGlmIChjdXJyZW50TW9kdWxlICYmICFjdXJyZW50TW9kdWxlLmJsb2JVcmwpIHtcbiAgICAgICAgICBpZiAoIWN1cnJlbnRNb2R1bGUuc2hlbGxVcmwpIHtcbiAgICAgICAgICAgIGNvbnN0IFtjdXJyZW50TW9kdWxlSW1wb3J0cywgY3VycmVudE1vZHVsZUV4cG9ydHNdID0gY3VycmVudE1vZHVsZS5hbmFseXNpcztcbiAgICAgICAgICAgIGNvbnN0IHdpbGRjYXJkRXhwb3J0cyA9IGN1cnJlbnRNb2R1bGVJbXBvcnRzLmZpbHRlcigoaW1wb3J0SXRlbSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBzdGF0ZW1lbnQgPSBjdXJyZW50TW9kdWxlLnNvdXJjZS5zdWJzdHJpbmcoaW1wb3J0SXRlbS5zcywgaW1wb3J0SXRlbS5zZSk7XG4gICAgICAgICAgICAgIHJldHVybiAvXmV4cG9ydFxccypcXCpcXHMqZnJvbVxccyovLnRlc3Qoc3RhdGVtZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3Qgd2lsZGNhcmRFeHBvcnRTdGF0ZW1lbnRzID0gW107XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMCwgbCA9IHdpbGRjYXJkRXhwb3J0cy5sZW5ndGg7IGogPCBsOyBqKyspIHtcbiAgICAgICAgICAgICAgY29uc3Qgd2lsZGNhcmRFeHBvcnQgPSB3aWxkY2FyZEV4cG9ydHNbal07XG4gICAgICAgICAgICAgIGNvbnN0IHdpbGRjYXJkRXhwb3J0VXJsID0gd2lsZGNhcmRFeHBvcnQubiB8fCBcIlwiO1xuICAgICAgICAgICAgICBjb25zdCB3aWxkY2FyZEV4cG9ydFNhdmVVcmwgPSB0aGlzLmdldFVybChiYXNlVXJsLCB3aWxkY2FyZEV4cG9ydFVybCk7XG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMuZmV0Y2hNb2R1bGVSZXNvdXJjZShsb2NrSWQsIGVudlZhclN0ciwgbm9FbnRyeUVudlZhclN0ciwgd2lsZGNhcmRFeHBvcnRTYXZlVXJsLCB0aGlzLmdldFVybChyZWFsVXJsLCB3aWxkY2FyZEV4cG9ydFVybCkpO1xuICAgICAgICAgICAgICBjb25zdCB3aWxkY2FyZE1vZHVsZSA9IHRoaXMubW9kdWxlQ2FjaGVbd2lsZGNhcmRFeHBvcnRTYXZlVXJsXTtcbiAgICAgICAgICAgICAgaWYgKHdpbGRjYXJkTW9kdWxlID09IG51bGwgPyB2b2lkIDAgOiB3aWxkY2FyZE1vZHVsZS5ibG9iVXJsKSB7XG4gICAgICAgICAgICAgICAgd2lsZGNhcmRFeHBvcnRTdGF0ZW1lbnRzLnB1c2goYGV4cG9ydCAqIGZyb20gJyR7d2lsZGNhcmRNb2R1bGUuYmxvYlVybH0nYCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN1cnJlbnRNb2R1bGUuc2hlbGxVcmwgPSB0aGlzLmNyZWF0ZUJsb2JVcmwoYGV4cG9ydCBmdW5jdGlvbiB1JCRfKG0peyR7Y3VycmVudE1vZHVsZUV4cG9ydHMubWFwKChleHBvcnRTcGVjaWZpZXIpID0+IGV4cG9ydFNwZWNpZmllci5uID09PSBcImRlZmF1bHRcIiA/IFwiZCQkXz1tLmRlZmF1bHRcIiA6IGAke2V4cG9ydFNwZWNpZmllci5ufT1tLiR7ZXhwb3J0U3BlY2lmaWVyLm59YCkuam9pbihcIixcIil9fSR7Y3VycmVudE1vZHVsZUV4cG9ydHMubWFwKChleHBvcnRTcGVjaWZpZXIpID0+IGV4cG9ydFNwZWNpZmllci5uID09PSBcImRlZmF1bHRcIiA/IFwibGV0IGQkJF87ZXhwb3J0e2QkJF8gYXMgZGVmYXVsdH1cIiA6IGBleHBvcnQgbGV0ICR7ZXhwb3J0U3BlY2lmaWVyLm59YCkuam9pbihcIjtcIil9JHt3aWxkY2FyZEV4cG9ydFN0YXRlbWVudHMubGVuZ3RoID8gYDske3dpbGRjYXJkRXhwb3J0U3RhdGVtZW50cy5qb2luKFwiO1wiKX1gIDogXCJcIn1cbi8vIyBzb3VyY2VVUkw9JHtzYXZlVXJsfT9jeWNsZWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBuZXdNb2R1bGVOYW1lID0gY3VycmVudE1vZHVsZS5zaGVsbFVybDtcbiAgICAgICAgfSBlbHNlIGlmICghY3VycmVudE1vZHVsZSkge1xuICAgICAgICAgIGF3YWl0IHRoaXMuZmV0Y2hNb2R1bGVSZXNvdXJjZShsb2NrSWQsIGVudlZhclN0ciwgbm9FbnRyeUVudlZhclN0ciwgc2F2ZVVybCwgcmVxdWVzdFVybCk7XG4gICAgICAgICAgY3VycmVudE1vZHVsZSA9IHRoaXMubW9kdWxlQ2FjaGVbc2F2ZVVybF07XG4gICAgICAgICAgY29uc3QgeyBibG9iVXJsLCBzaGVsbFVybCwgc2hlbGxFeGVjdXRlZCB9ID0gY3VycmVudE1vZHVsZTtcbiAgICAgICAgICBuZXdNb2R1bGVOYW1lID0gYmxvYlVybDtcbiAgICAgICAgICBpZiAoc2hlbGxVcmwgJiYgIXNoZWxsRXhlY3V0ZWQpIHtcbiAgICAgICAgICAgIHNoZWxsRXhlY3V0aW9uQ29kZSArPSBnZW5TaGVsbEV4ZWN1dGlvbkNvZGUoaSwgbmV3TW9kdWxlTmFtZSwgc2hlbGxVcmwpO1xuICAgICAgICAgICAgY3VycmVudE1vZHVsZS5zaGVsbEV4ZWN1dGVkID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV3TW9kdWxlTmFtZSA9IGN1cnJlbnRNb2R1bGUuYmxvYlVybDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmVzdWx0ID0gcHJvY2Vzc0ltcG9ydE1vZHVsZShpbXBvcnRBbmFseXNpcywgbmV3TW9kdWxlTmFtZSB8fCBtb2R1bGVOYW1lKTtcbiAgICB9XG4gICAgdGhpc01vZHVsZS5zb3VyY2UgPSBcIlwiO1xuICAgIGRlbGV0ZSB0aGlzTW9kdWxlLmFuYWx5c2lzO1xuICAgIHJldHVybiBgJHtkeW5hbWljSW1wb3J0fSR7c2hlbGxFeGVjdXRpb25Db2RlfTske3Jlc3VsdC5qb2luKFwiXCIpfWA7XG4gIH1cbiAgZGVzdHJveSgpIHtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLm1vZHVsZUNhY2hlKSB7XG4gICAgICBjb25zdCB7IGJsb2JVcmwsIHNoZWxsVXJsIH0gPSB0aGlzLm1vZHVsZUNhY2hlW2tleV07XG4gICAgICBpZiAoYmxvYlVybCkge1xuICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKGJsb2JVcmwpO1xuICAgICAgfVxuICAgICAgaWYgKHNoZWxsVXJsKSB7XG4gICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwoc2hlbGxVcmwpO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLm1vZHVsZUNhY2hlID0ge307XG4gICAgdGhpcy5sb2NrLmNsZWFyKCk7XG4gICAgZGVsZXRlIHRoaXMuYXBwLmdsb2JhbFt0aGlzLmdsb2JhbFZhcktleV07XG4gIH1cbiAgbG9hZChjb2RlLCBlbnYsIHVybCwgb3B0aW9ucykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShhc3luYyAocmVzb2x2ZSkgPT4ge1xuICAgICAgaWYgKHVybCAmJiB0aGlzLm1vZHVsZUNhY2hlW3VybF0pIHtcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGdlblNoZWxsQ29kZVdyYXBwZXIgPSAoYmxvYlVybDIsIHNoZWxsVXJsLCBzb3VyY2VVcmwpID0+IHtcbiAgICAgICAgcmV0dXJuIGBleHBvcnQgKiBmcm9tICcke2Jsb2JVcmwyfScke2dlblNoZWxsRXhlY3V0aW9uQ29kZSgwLCBibG9iVXJsMiwgc2hlbGxVcmwpfVxuLy8jIHNvdXJjZVVSTD0ke3NvdXJjZVVybH0/Y3ljbGVgO1xuICAgICAgfTtcbiAgICAgIGVudiA9IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIGVudiksIHtcbiAgICAgICAgcmVzb2x2ZSxcbiAgICAgICAgaW1wb3J0OiBhc3luYyAobW9kdWxlSWQsIGJhc2VVcmwsIHJlYWxVcmwpID0+IHtcbiAgICAgICAgICBsZXQgc2F2ZVVybCA9IG1vZHVsZUlkO1xuICAgICAgICAgIGxldCByZXF1ZXN0VXJsID0gbW9kdWxlSWQ7XG4gICAgICAgICAgaWYgKCFpc0Fic29sdXRlKG1vZHVsZUlkKSkge1xuICAgICAgICAgICAgc2F2ZVVybCA9IHRyYW5zZm9ybVVybChiYXNlVXJsLCBtb2R1bGVJZCk7XG4gICAgICAgICAgICByZXF1ZXN0VXJsID0gdHJhbnNmb3JtVXJsKHJlYWxVcmwsIG1vZHVsZUlkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbGV0IHRhcmdldE1vZHVsZSA9IHRoaXMubW9kdWxlQ2FjaGVbc2F2ZVVybF07XG4gICAgICAgICAgaWYgKCEodGFyZ2V0TW9kdWxlID09IG51bGwgPyB2b2lkIDAgOiB0YXJnZXRNb2R1bGUuYmxvYlVybCkpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZmV0Y2hNb2R1bGVSZXNvdXJjZSh0aGlzLmxvY2suZ2VuSWQoKSwgZW52VmFyU3RyLCBub0VudHJ5RW52VmFyU3RyLCBzYXZlVXJsLCByZXF1ZXN0VXJsKTtcbiAgICAgICAgICAgIHRhcmdldE1vZHVsZSA9IHRoaXMubW9kdWxlQ2FjaGVbc2F2ZVVybF07XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0YXJnZXRNb2R1bGUgJiYgdGFyZ2V0TW9kdWxlLnNoZWxsVXJsICYmICF0YXJnZXRNb2R1bGUuc2hlbGxFeGVjdXRlZCAmJiB0YXJnZXRNb2R1bGUuYmxvYlVybCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXhlY01vZHVsZUNvZGUodGhpcy5jcmVhdGVCbG9iVXJsKGdlblNoZWxsQ29kZVdyYXBwZXIodGFyZ2V0TW9kdWxlLmJsb2JVcmwsIHRhcmdldE1vZHVsZS5zaGVsbFVybCwgc2F2ZVVybCkpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRoaXMuZXhlY01vZHVsZUNvZGUodGFyZ2V0TW9kdWxlLmJsb2JVcmwpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGdlbkVudlZhclN0ciA9ICh0YXJnZXRFbnYsIG5vRW50cnkpID0+IHtcbiAgICAgICAgY29uc3QgbmV3RW52ID0gX19zcHJlYWRWYWx1ZXMoe30sIHRhcmdldEVudik7XG4gICAgICAgIGlmIChub0VudHJ5KSB7XG4gICAgICAgICAgZGVsZXRlIG5ld0Vudi5leHBvcnRzO1xuICAgICAgICAgIGRlbGV0ZSBuZXdFbnYubW9kdWxlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhuZXdFbnYpLnJlZHVjZSgocHJldkNvZGUsIG5hbWUpID0+IHtcbiAgICAgICAgICBpZiAobmFtZSA9PT0gXCJyZXNvbHZlXCIgfHwgbmFtZSA9PT0gXCJpbXBvcnRcIilcbiAgICAgICAgICAgIHJldHVybiBwcmV2Q29kZTtcbiAgICAgICAgICByZXR1cm4gYCR7cHJldkNvZGV9IHZhciAke25hbWV9ID0gd2luZG93LiR7dGhpcy5nbG9iYWxWYXJLZXl9LiR7bmFtZX07YDtcbiAgICAgICAgfSwgXCJcIik7XG4gICAgICB9O1xuICAgICAgY29uc3QgZW52VmFyU3RyID0gZ2VuRW52VmFyU3RyKGVudik7XG4gICAgICBjb25zdCBub0VudHJ5RW52VmFyU3RyID0gZ2VuRW52VmFyU3RyKGVudiwgdHJ1ZSk7XG4gICAgICBsZXQgc291cmNlbWFwID0gXCJcIjtcbiAgICAgIGlmICghaGF2ZVNvdXJjZW1hcChjb2RlKSAmJiB1cmwpIHtcbiAgICAgICAgc291cmNlbWFwID0gYXdhaXQgY3JlYXRlU291cmNlbWFwKGNvZGUsIG9wdGlvbnMgJiYgb3B0aW9ucy5pc0lubGluZSA/IGBpbmRleC5odG1sKGlubGluZS4ke3RoaXMuYXBwLnNjcmlwdENvdW50fS5qcylgIDogdXJsKTtcbiAgICAgIH1cbiAgICAgIGNvZGUgPSBhd2FpdCB0aGlzLmFuYWx5c2lzTW9kdWxlKHRoaXMubG9jay5nZW5JZCgpLCBjb2RlLCBlbnZWYXJTdHIsIG5vRW50cnlFbnZWYXJTdHIsIHVybCwgdXJsKTtcbiAgICAgIGNvZGUgPSBgaW1wb3J0Lm1ldGEudXJsPScke3VybH0nOyR7KG9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdGlvbnMubm9FbnRyeSkgPyBub0VudHJ5RW52VmFyU3RyIDogZW52VmFyU3RyfSR7Y29kZX1cbjt3aW5kb3cuJHt0aGlzLmdsb2JhbFZhcktleX0ucmVzb2x2ZSgpO1xuJHtzb3VyY2VtYXB9YDtcbiAgICAgIHRoaXMuYXBwLmdsb2JhbFt0aGlzLmdsb2JhbFZhcktleV0gPSBlbnY7XG4gICAgICBsZXQgYmxvYlVybCA9IHRoaXMuY3JlYXRlQmxvYlVybChjb2RlKTtcbiAgICAgIGlmIChvcHRpb25zICYmICFvcHRpb25zLmlzSW5saW5lICYmIHVybCkge1xuICAgICAgICB0aGlzLnNldEJsb2JVcmwodXJsLCBibG9iVXJsKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGN1cnJlbnRNb2R1bGUgPSB0aGlzLm1vZHVsZUNhY2hlW3VybCB8fCBcIlwiXTtcbiAgICAgIGlmICgoY3VycmVudE1vZHVsZSA9PSBudWxsID8gdm9pZCAwIDogY3VycmVudE1vZHVsZS5zaGVsbFVybCkgJiYgIWN1cnJlbnRNb2R1bGUuc2hlbGxFeGVjdXRlZCkge1xuICAgICAgICBibG9iVXJsID0gdGhpcy5jcmVhdGVCbG9iVXJsKGdlblNoZWxsQ29kZVdyYXBwZXIoYmxvYlVybCwgY3VycmVudE1vZHVsZS5zaGVsbFVybCwgdXJsIHx8IFwiXCIpKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZXhlY01vZHVsZUNvZGUoYmxvYlVybCk7XG4gICAgfSk7XG4gIH1cbn07XG5cbi8vIHNyYy9tb2R1bGUvYXBwLnRzXG52YXIgYXBwSWQgPSAwO1xudmFyIF9fR0FSRklTSF9HTE9CQUxfRU5WX18gPSBcIl9fR0FSRklTSF9HTE9CQUxfRU5WX19cIjtcbnZhciBfX0dBUkZJU0hfRVhQT1JUU19fID0gXCJfX0dBUkZJU0hfRVhQT1JUU19fXCI7XG52YXIgQXBwID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihjb250ZXh0LCBhcHBJbmZvLCBlbnRyeU1hbmFnZXIsIHJlc291cmNlcywgaXNIdG1sTW9kZSwgY3VzdG9tTG9hZGVyKSB7XG4gICAgdGhpcy5hcHBJZCA9IGFwcElkKys7XG4gICAgdGhpcy5zY3JpcHRDb3VudCA9IDA7XG4gICAgdGhpcy5kaXNwbGF5ID0gZmFsc2U7XG4gICAgdGhpcy5tb3VudGVkID0gZmFsc2U7XG4gICAgdGhpcy5tb3VudGluZyA9IGZhbHNlO1xuICAgIHRoaXMuc3RyaWN0SXNvbGF0aW9uID0gZmFsc2U7XG4gICAgdGhpcy5lc21RdWV1ZSA9IG5ldyBRdWV1ZSgpO1xuICAgIHRoaXMuZXNNb2R1bGVMb2FkZXIgPSBuZXcgRVNNb2R1bGVMb2FkZXIodGhpcyk7XG4gICAgdGhpcy5nbG9iYWwgPSB3aW5kb3c7XG4gICAgdGhpcy5jdXN0b21FeHBvcnRzID0ge307XG4gICAgdGhpcy5zb3VyY2VMaXN0ID0gW107XG4gICAgdGhpcy5zb3VyY2VMaXN0TWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgICB0aGlzLmNoaWxkR2FyZmlzaENvbmZpZyA9IHt9O1xuICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7XG4gICAgdGhpcy51bm1vdW50aW5nID0gZmFsc2U7XG4gICAgdGhpcy5kZWZlck5vZGVNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuICAgIHZhciBfYTtcbiAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgIHRoaXMuYXBwSW5mbyA9IGFwcEluZm87XG4gICAgdGhpcy5uYW1lID0gYXBwSW5mby5uYW1lO1xuICAgIHRoaXMucmVzb3VyY2VzID0gcmVzb3VyY2VzO1xuICAgIHRoaXMuaXNIdG1sTW9kZSA9IGlzSHRtbE1vZGU7XG4gICAgdGhpcy5lbnRyeU1hbmFnZXIgPSBlbnRyeU1hbmFnZXI7XG4gICAgdGhpcy5hcHBJbmZvLmFwcElkID0gdGhpcy5hcHBJZDtcbiAgICB0aGlzLmdsb2JhbEVudlZhcmlhYmxlcyA9IHtcbiAgICAgIGN1cnJlbnRBcHA6IHRoaXMsXG4gICAgICBsb2FkZXI6IGNvbnRleHQubG9hZGVyLFxuICAgICAgZXh0ZXJuYWxzOiBjb250ZXh0LmV4dGVybmFscyxcbiAgICAgIHJlbW90ZU1vZHVsZXNDb2RlOiByZXNvdXJjZXMubW9kdWxlc1xuICAgIH07XG4gICAgdGhpcy5janNNb2R1bGVzID0ge1xuICAgICAgZXhwb3J0czoge30sXG4gICAgICBtb2R1bGU6IG51bGwsXG4gICAgICByZXF1aXJlOiAoa2V5KSA9PiB7XG4gICAgICAgIGNvbnN0IHBrZyA9IHRoaXMuZ2xvYmFsW2tleV0gfHwgY29udGV4dC5leHRlcm5hbHNba2V5XSB8fCB3aW5kb3dba2V5XTtcbiAgICAgICAgaWYgKCFwa2cpIHtcbiAgICAgICAgICB3YXJuKGBQYWNrYWdlIFwiJHtrZXl9XCIgaXMgbm90IGZvdW5kYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBrZztcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMuY2pzTW9kdWxlcy5tb2R1bGUgPSB0aGlzLmNqc01vZHVsZXM7XG4gICAgdGhpcy5jdXN0b21Mb2FkZXIgPSBjdXN0b21Mb2FkZXI7XG4gICAgdGhpcy5ob29rcyA9IGFwcExpZmVjeWNsZSgpO1xuICAgIHRoaXMuaG9va3MudXNlUGx1Z2luKF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIGFwcEluZm8pLCB7XG4gICAgICBuYW1lOiBgJHthcHBJbmZvLm5hbWV9LWxpZmVjeWNsZWBcbiAgICB9KSk7XG4gICAgY29uc3Qgbm9kZXMgPSBlbnRyeU1hbmFnZXIuZ2V0Tm9kZXNCeVRhZ05hbWUoLi4uc291cmNlTGlzdFRhZ3MpO1xuICAgIGZvciAoY29uc3Qga2V5IGluIG5vZGVzKSB7XG4gICAgICBub2Rlc1trZXldLmZvckVhY2goKG5vZGUpID0+IHtcbiAgICAgICAgdmFyIF9hMiwgX2I7XG4gICAgICAgIGNvbnN0IHVybCA9IGVudHJ5TWFuYWdlci5maW5kQXR0cmlidXRlVmFsdWUobm9kZSwgXCJocmVmXCIpIHx8IGVudHJ5TWFuYWdlci5maW5kQXR0cmlidXRlVmFsdWUobm9kZSwgXCJzcmNcIik7XG4gICAgICAgIGlmICh1cmwpIHtcbiAgICAgICAgICB0aGlzLmFkZFNvdXJjZUxpc3Qoe1xuICAgICAgICAgICAgdGFnTmFtZTogbm9kZS50YWdOYW1lLFxuICAgICAgICAgICAgdXJsOiBlbnRyeU1hbmFnZXIudXJsID8gdHJhbnNmb3JtVXJsMihlbnRyeU1hbmFnZXIudXJsLCB1cmwpIDogdXJsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzR2FyZmlzaENvbmZpZ1R5cGUoe1xuICAgICAgICAgIHR5cGU6IGVudHJ5TWFuYWdlci5maW5kQXR0cmlidXRlVmFsdWUobm9kZSwgXCJ0eXBlXCIpXG4gICAgICAgIH0pKSB7XG4gICAgICAgICAgdGhpcy5jaGlsZEdhcmZpc2hDb25maWcgPSBKU09OLnBhcnNlKChfYiA9IChfYTIgPSBub2RlLmNoaWxkcmVuKSA9PSBudWxsID8gdm9pZCAwIDogX2EyWzBdKSA9PSBudWxsID8gdm9pZCAwIDogX2IuY29udGVudCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aGlzLmFwcEluZm8uZW50cnkgJiYgdGhpcy5hZGRTb3VyY2VMaXN0KHsgdGFnTmFtZTogXCJodG1sXCIsIHVybDogdGhpcy5hcHBJbmZvLmVudHJ5IH0pO1xuICAgIHRoaXMuYXN5bmNQcm92aWRlclRpbWVvdXQgPSAoX2EgPSB0aGlzLmFwcEluZm8uYXN5bmNQcm92aWRlclRpbWVvdXQpICE9IG51bGwgPyBfYSA6IDA7XG4gIH1cbiAgZ2V0IHJvb3RFbGVtZW50KCkge1xuICAgIHJldHVybiBmaW5kVGFyZ2V0KHRoaXMuaHRtbE5vZGUsIFtgZGl2WyR7X19Nb2NrQm9keV9ffV1gLCBcImJvZHlcIl0pO1xuICB9XG4gIGdldCBnZXRTb3VyY2VMaXN0KCkge1xuICAgIHJldHVybiB0aGlzLnNvdXJjZUxpc3Q7XG4gIH1cbiAgYWRkU291cmNlTGlzdChzb3VyY2VJbmZvKSB7XG4gICAgaWYgKHRoaXMuYXBwSW5mby5kaXNhYmxlU291cmNlTGlzdENvbGxlY3QpXG4gICAgICByZXR1cm47XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoc291cmNlSW5mbykpIHtcbiAgICAgIGNvbnN0IG5Tb3VyY2VMaXN0ID0gc291cmNlSW5mby5maWx0ZXIoKGl0ZW0pID0+IHtcbiAgICAgICAgY29uc3QgdXJsID0gZ2V0U291cmNlVVJMKGl0ZW0udXJsKTtcbiAgICAgICAgaWYgKCF0aGlzLnNvdXJjZUxpc3RNYXAuaGFzKHVybCkgJiYgdXJsLnN0YXJ0c1dpdGgoXCJodHRwXCIpKSB7XG4gICAgICAgICAgdGhpcy5zb3VyY2VMaXN0TWFwLnNldCh1cmwsIGl0ZW0pO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5zb3VyY2VMaXN0ID0gdGhpcy5zb3VyY2VMaXN0LmNvbmNhdChuU291cmNlTGlzdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHVybCA9IGdldFNvdXJjZVVSTChzb3VyY2VJbmZvLnVybCk7XG4gICAgICBpZiAoIXRoaXMuc291cmNlTGlzdE1hcC5nZXQodXJsKSAmJiB1cmwuc3RhcnRzV2l0aChcImh0dHBcIikpIHtcbiAgICAgICAgdGhpcy5zb3VyY2VMaXN0LnB1c2goc291cmNlSW5mbyk7XG4gICAgICAgIHRoaXMuc291cmNlTGlzdE1hcC5zZXQodXJsLCBzb3VyY2VJbmZvKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaW5pdEFzeW5jUHJvdmlkZXJSZWdpc3RyYXRpb24oKSB7XG4gICAgY29uc3QgeyBhc3luY1Byb3ZpZGVyVGltZW91dCwgY3VzdG9tRXhwb3J0cyB9ID0gdGhpcztcbiAgICBpZiAoYXN5bmNQcm92aWRlclRpbWVvdXQpIHtcbiAgICAgIGN1c3RvbUV4cG9ydHMucmVnaXN0ZXJQcm92aWRlciA9IChwcm92aWRlcikgPT4ge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHRoaXMuYXN5bmNQcm92aWRlciA9IHByb3ZpZGVyO1xuICAgICAgICAoX2EgPSB0aGlzLnJlc29sdmVBc3luY1Byb3ZpZGVyKSA9PSBudWxsID8gdm9pZCAwIDogX2EuY2FsbCh0aGlzKTtcbiAgICAgIH07XG4gICAgfVxuICB9XG4gIGF3YWl0QXN5bmNQcm92aWRlclJlZ2lzdHJhdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgIGlmICh0aGlzLmFzeW5jUHJvdmlkZXIpIHtcbiAgICAgICAgcmVzb2x2ZSh0aGlzLmFzeW5jUHJvdmlkZXIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgcmVzb2x2ZSh0aGlzLmFzeW5jUHJvdmlkZXIpO1xuICAgICAgfSwgdGhpcy5hc3luY1Byb3ZpZGVyVGltZW91dCk7XG4gICAgICB0aGlzLnJlc29sdmVBc3luY1Byb3ZpZGVyID0gKCkgPT4ge1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgICAgcmVzb2x2ZSh0aGlzLmFzeW5jUHJvdmlkZXIpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuICBnZXRQcm92aWRlcigpIHtcbiAgICByZXR1cm4gdGhpcy5wcm92aWRlciA/IFByb21pc2UucmVzb2x2ZSh0aGlzLnByb3ZpZGVyKSA6IHRoaXMuY2hlY2tBbmRHZXRQcm92aWRlcigpO1xuICB9XG4gIGlzTm9FbnRyeVNjcmlwdCh1cmwgPSBcIlwiKSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICByZXR1cm4gKF9iID0gKF9hID0gdGhpcy5jaGlsZEdhcmZpc2hDb25maWcuc2FuZGJveCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLm5vRW50cnlTY3JpcHRzKSA9PSBudWxsID8gdm9pZCAwIDogX2Iuc29tZSgoaXRlbSkgPT4gdXJsLmluZGV4T2YoaXRlbSkgPiAtMSk7XG4gIH1cbiAgZXhlY1NjcmlwdChjb2RlLCBlbnYsIHVybCwgb3B0aW9ucykge1xuICAgIGVudiA9IF9fc3ByZWFkVmFsdWVzKF9fc3ByZWFkVmFsdWVzKHt9LCB0aGlzLmdldEV4ZWNTY3JpcHRFbnYob3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5ub0VudHJ5KSksIGVudiB8fCB7fSk7XG4gICAgdGhpcy5zY3JpcHRDb3VudCsrO1xuICAgIGNvbnN0IGFyZ3MgPSBbdGhpcy5hcHBJbmZvLCBjb2RlLCBlbnYsIHVybCwgb3B0aW9uc107XG4gICAgdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlRXZhbC5lbWl0KC4uLmFyZ3MpO1xuICAgIHRyeSB7XG4gICAgICB0aGlzLnJ1bkNvZGUoY29kZSwgZW52LCB1cmwsIG9wdGlvbnMpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgdGhpcy5ob29rcy5saWZlY3ljbGUuZXJyb3JFeGVjQ29kZS5lbWl0KGVyciwgLi4uYXJncyk7XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICAgIHRoaXMuaG9va3MubGlmZWN5Y2xlLmFmdGVyRXZhbC5lbWl0KC4uLmFyZ3MpO1xuICB9XG4gIHJ1bkNvZGUoY29kZSwgZW52LCB1cmwsIG9wdGlvbnMpIHtcbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmlzTW9kdWxlKSB7XG4gICAgICB0aGlzLmVzbVF1ZXVlLmFkZChhc3luYyAobmV4dCkgPT4ge1xuICAgICAgICBhd2FpdCB0aGlzLmVzTW9kdWxlTG9hZGVyLmxvYWQoY29kZSwgX19zcHJlYWRWYWx1ZXMoX19zcHJlYWRWYWx1ZXMoe30sIHRoaXMuZ2V0RXhlY1NjcmlwdEVudigpKSwgZW52KSwgdXJsLCBvcHRpb25zKTtcbiAgICAgICAgbmV4dCgpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHJldmVydEN1cnJlbnRTY3JpcHQgPSBzZXREb2NDdXJyZW50U2NyaXB0KHRoaXMuZ2xvYmFsLmRvY3VtZW50LCBjb2RlLCB0cnVlLCB1cmwsIG9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdGlvbnMuYXN5bmMsIG9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdGlvbnMuZGVmZXIsIG9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdGlvbnMub3JpZ2luU2NyaXB0KTtcbiAgICAgIGNvZGUgKz0gdXJsID8gYFxuLy8jIHNvdXJjZVVSTD0ke3VybH1cbmAgOiBcIlwiO1xuICAgICAgaWYgKCFoYXNPd24oZW52LCBcIndpbmRvd1wiKSkge1xuICAgICAgICBlbnYgPSBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBlbnYpLCB7XG4gICAgICAgICAgd2luZG93OiB0aGlzLmdsb2JhbFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGV2YWxXaXRoRW52KGA7JHtjb2RlfWAsIGVudiwgdGhpcy5nbG9iYWwpO1xuICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihyZXZlcnRDdXJyZW50U2NyaXB0KTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgc2hvdygpIHtcbiAgICB0aGlzLmFjdGl2ZSA9IHRydWU7XG4gICAgY29uc3QgeyBkaXNwbGF5LCBtb3VudGVkLCBwcm92aWRlciB9ID0gdGhpcztcbiAgICBpZiAoZGlzcGxheSlcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICBpZiAoIW1vdW50ZWQpIHtcbiAgICAgICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudiAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViA/IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA6IGZhbHNlKSAmJiB3YXJuKCdOZWVkIHRvIGNhbGwgdGhlIFwiYXBwLm1vdW50KClcIiBtZXRob2QgZmlyc3QuJyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHRoaXMuaG9va3MubGlmZWN5Y2xlLmJlZm9yZU1vdW50LmVtaXQodGhpcy5hcHBJbmZvLCB0aGlzLCB0cnVlKTtcbiAgICB0aGlzLmNvbnRleHQuYWN0aXZlQXBwcy5wdXNoKHRoaXMpO1xuICAgIGF3YWl0IHRoaXMuYWRkQ29udGFpbmVyKCk7XG4gICAgdGhpcy5jYWxsUmVuZGVyKHByb3ZpZGVyLCBmYWxzZSk7XG4gICAgdGhpcy5kaXNwbGF5ID0gdHJ1ZTtcbiAgICB0aGlzLmhvb2tzLmxpZmVjeWNsZS5hZnRlck1vdW50LmVtaXQodGhpcy5hcHBJbmZvLCB0aGlzLCB0cnVlKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBoaWRlKCkge1xuICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7XG4gICAgdGhpcy5tb3VudGluZyA9IGZhbHNlO1xuICAgIGNvbnN0IHsgZGlzcGxheSwgbW91bnRlZCwgcHJvdmlkZXIgfSA9IHRoaXM7XG4gICAgaWYgKCFkaXNwbGF5KVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIGlmICghbW91bnRlZCkge1xuICAgICAgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID8gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiIDogZmFsc2UpICYmIHdhcm4oJ05lZWQgdG8gY2FsbCB0aGUgXCJhcHAubW91bnQoKVwiIG1ldGhvZCBmaXJzdC4nKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlVW5tb3VudC5lbWl0KHRoaXMuYXBwSW5mbywgdGhpcywgdHJ1ZSk7XG4gICAgdGhpcy5jYWxsRGVzdHJveShwcm92aWRlciwgZmFsc2UpO1xuICAgIHRoaXMuZGlzcGxheSA9IGZhbHNlO1xuICAgIHJlbW92ZSh0aGlzLmNvbnRleHQuYWN0aXZlQXBwcywgdGhpcyk7XG4gICAgdGhpcy5ob29rcy5saWZlY3ljbGUuYWZ0ZXJVbm1vdW50LmVtaXQodGhpcy5hcHBJbmZvLCB0aGlzLCB0cnVlKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBhc3luYyBtb3VudCgpIHtcbiAgICBpZiAoIXRoaXMuY2FuTW91bnQoKSlcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB0aGlzLmhvb2tzLmxpZmVjeWNsZS5iZWZvcmVNb3VudC5lbWl0KHRoaXMuYXBwSW5mbywgdGhpcywgZmFsc2UpO1xuICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTtcbiAgICB0aGlzLm1vdW50aW5nID0gdHJ1ZTtcbiAgICB0cnkge1xuICAgICAgdGhpcy5jb250ZXh0LmFjdGl2ZUFwcHMucHVzaCh0aGlzKTtcbiAgICAgIHRoaXMuaW5pdEFzeW5jUHJvdmlkZXJSZWdpc3RyYXRpb24oKTtcbiAgICAgIGNvbnN0IHsgYXN5bmNTY3JpcHRzLCBkZWZlclNjcmlwdHMgfSA9IGF3YWl0IHRoaXMuY29tcGlsZUFuZFJlbmRlckNvbnRhaW5lcigpO1xuICAgICAgaWYgKCF0aGlzLnN0b3BNb3VudEFuZENsZWFyRWZmZWN0KCkpXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIGRlZmVyU2NyaXB0cygpO1xuICAgICAgY29uc3QgcHJvdmlkZXIgPSBhd2FpdCB0aGlzLmdldFByb3ZpZGVyKCk7XG4gICAgICBpZiAoIXRoaXMuc3RvcE1vdW50QW5kQ2xlYXJFZmZlY3QoKSlcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgdGhpcy5jYWxsUmVuZGVyKHByb3ZpZGVyLCB0cnVlKTtcbiAgICAgIHRoaXMuZGlzcGxheSA9IHRydWU7XG4gICAgICB0aGlzLm1vdW50ZWQgPSB0cnVlO1xuICAgICAgdGhpcy5ob29rcy5saWZlY3ljbGUuYWZ0ZXJNb3VudC5lbWl0KHRoaXMuYXBwSW5mbywgdGhpcywgZmFsc2UpO1xuICAgICAgYXdhaXQgYXN5bmNTY3JpcHRzO1xuICAgICAgaWYgKCF0aGlzLnN0b3BNb3VudEFuZENsZWFyRWZmZWN0KCkpXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aGlzLmVudHJ5TWFuYWdlci5ET01BcGlzLnJlbW92ZUVsZW1lbnQodGhpcy5hcHBDb250YWluZXIpO1xuICAgICAgdGhpcy5ob29rcy5saWZlY3ljbGUuZXJyb3JNb3VudEFwcC5lbWl0KGUsIHRoaXMuYXBwSW5mbyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMubW91bnRpbmcgPSBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgdW5tb3VudCgpIHtcbiAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICAgIHRoaXMubW91bnRpbmcgPSBmYWxzZTtcbiAgICBpZiAoIXRoaXMubW91bnRlZCB8fCAhdGhpcy5hcHBDb250YWluZXIpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHRoaXMudW5tb3VudGluZykge1xuICAgICAgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID8gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiIDogZmFsc2UpICYmIHdhcm4oYFRoZSAke3RoaXMubmFtZX0gYXBwIHVubW91bnRpbmcuYCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHRoaXMudW5tb3VudGluZyA9IHRydWU7XG4gICAgdGhpcy5ob29rcy5saWZlY3ljbGUuYmVmb3JlVW5tb3VudC5lbWl0KHRoaXMuYXBwSW5mbywgdGhpcywgZmFsc2UpO1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmNhbGxEZXN0cm95KHRoaXMucHJvdmlkZXIsIHRydWUpO1xuICAgICAgdGhpcy5kaXNwbGF5ID0gZmFsc2U7XG4gICAgICB0aGlzLm1vdW50ZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMucHJvdmlkZXIgPSB2b2lkIDA7XG4gICAgICB0aGlzLmN1c3RvbUV4cG9ydHMgPSB7fTtcbiAgICAgIHRoaXMuY2pzTW9kdWxlcy5leHBvcnRzID0ge307XG4gICAgICB0aGlzLmVzTW9kdWxlTG9hZGVyLmRlc3Ryb3koKTtcbiAgICAgIHJlbW92ZSh0aGlzLmNvbnRleHQuYWN0aXZlQXBwcywgdGhpcyk7XG4gICAgICB0aGlzLmhvb2tzLmxpZmVjeWNsZS5hZnRlclVubW91bnQuZW1pdCh0aGlzLmFwcEluZm8sIHRoaXMsIGZhbHNlKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZW1vdmUodGhpcy5jb250ZXh0LmFjdGl2ZUFwcHMsIHRoaXMpO1xuICAgICAgdGhpcy5lbnRyeU1hbmFnZXIuRE9NQXBpcy5yZW1vdmVFbGVtZW50KHRoaXMuYXBwQ29udGFpbmVyKTtcbiAgICAgIHRoaXMuaG9va3MubGlmZWN5Y2xlLmVycm9yVW5tb3VudEFwcC5lbWl0KGUsIHRoaXMuYXBwSW5mbyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMudW5tb3VudGluZyA9IGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBnZXRFeGVjU2NyaXB0RW52KG5vRW50cnkpIHtcbiAgICBjb25zdCBlbnZzID0ge1xuICAgICAgW19fR0FSRklTSF9FWFBPUlRTX19dOiB0aGlzLmN1c3RvbUV4cG9ydHMsXG4gICAgICBbX19HQVJGSVNIX0dMT0JBTF9FTlZfX106IHRoaXMuZ2xvYmFsRW52VmFyaWFibGVzXG4gICAgfTtcbiAgICBpZiAobm9FbnRyeSkge1xuICAgICAgcmV0dXJuIF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIGVudnMpLCB7XG4gICAgICAgIHJlcXVpcmU6IHRoaXMuY2pzTW9kdWxlcy5yZXF1aXJlXG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIF9fc3ByZWFkVmFsdWVzKF9fc3ByZWFkVmFsdWVzKHt9LCBlbnZzKSwgdGhpcy5janNNb2R1bGVzKTtcbiAgfVxuICBhc3luYyBjb21waWxlQW5kUmVuZGVyQ29udGFpbmVyKCkge1xuICAgIGF3YWl0IHRoaXMucmVuZGVyVGVtcGxhdGUoKTtcbiAgICBjb25zdCBleGVjU2NyaXB0ID0gKHR5cGUpID0+IHtcbiAgICAgIGZvciAoY29uc3QganNNYW5hZ2VyIG9mIHRoaXMucmVzb3VyY2VzLmpzKSB7XG4gICAgICAgIGlmIChqc01hbmFnZXJbdHlwZV0pIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgbGV0IG5vRW50cnkgPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldFVybCA9IGpzTWFuYWdlci51cmwgfHwgdGhpcy5hcHBJbmZvLmVudHJ5O1xuICAgICAgICAgICAgaWYgKHR5cGUgPT09IFwiZGVmZXJcIikge1xuICAgICAgICAgICAgICBjb25zdCBub2RlID0gdGhpcy5kZWZlck5vZGVNYXAuZ2V0KGpzTWFuYWdlcik7XG4gICAgICAgICAgICAgIGlmIChub2RlKSB7XG4gICAgICAgICAgICAgICAgbm9FbnRyeSA9IHRvQm9vbGVhbih0aGlzLmVudHJ5TWFuYWdlci5maW5kQXR0cmlidXRlVmFsdWUobm9kZSwgXCJuby1lbnRyeVwiKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKCFub0VudHJ5KSB7XG4gICAgICAgICAgICAgICAgbm9FbnRyeSA9IHRvQm9vbGVhbih0aGlzLmlzTm9FbnRyeVNjcmlwdCh0YXJnZXRVcmwpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5leGVjU2NyaXB0KGpzTWFuYWdlci5zY3JpcHRDb2RlLCB7fSwgdGFyZ2V0VXJsLCB7XG4gICAgICAgICAgICAgIG5vRW50cnksXG4gICAgICAgICAgICAgIGRlZmVyOiB0eXBlID09PSBcImRlZmVyXCIsXG4gICAgICAgICAgICAgIGFzeW5jOiB0eXBlID09PSBcImFzeW5jXCIsXG4gICAgICAgICAgICAgIGlzTW9kdWxlOiBqc01hbmFnZXIuaXNNb2R1bGUoKSxcbiAgICAgICAgICAgICAgaXNJbmxpbmU6IGpzTWFuYWdlci5pc0lubGluZVNjcmlwdCgpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBpZiAodHlwZSAhPT0gXCJkZWZlclwiKSB7XG4gICAgICAgICAgICAgIHRoaXMuaG9va3MubGlmZWN5Y2xlLmVycm9yTW91bnRBcHAuZW1pdChlLCB0aGlzLmFwcEluZm8pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiB7XG4gICAgICBkZWZlclNjcmlwdHM6ICgpID0+IGV4ZWNTY3JpcHQoXCJkZWZlclwiKSxcbiAgICAgIGFzeW5jU2NyaXB0czogbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgaWYgKHRoaXMuc3RvcE1vdW50QW5kQ2xlYXJFZmZlY3QoKSkge1xuICAgICAgICAgICAgZXhlY1NjcmlwdChcImFzeW5jXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSlcbiAgICB9O1xuICB9XG4gIGNhbk1vdW50KCkge1xuICAgIGlmICh0aGlzLm1vdW50aW5nKSB7XG4gICAgICAodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPyBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgOiBmYWxzZSkgJiYgd2FybihgVGhlICR7dGhpcy5hcHBJbmZvLm5hbWV9IGFwcCBtb3VudGluZy5gKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHRoaXMubW91bnRlZCkge1xuICAgICAgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID8gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiIDogZmFsc2UpICYmIHdhcm4oYFRoZSAke3RoaXMuYXBwSW5mby5uYW1lfSBhcHAgYWxyZWFkeSBtb3VudGVkLmApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAodGhpcy51bm1vdW50aW5nKSB7XG4gICAgICAodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPyBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgOiBmYWxzZSkgJiYgd2FybihgVGhlICR7dGhpcy5hcHBJbmZvLm5hbWV9IGFwcCBpcyB1bm1vdW50aW5nIGNhbid0IFBlcmZvcm0gYXBwbGljYXRpb24gcmVuZGVyaW5nLmApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBzdG9wTW91bnRBbmRDbGVhckVmZmVjdCgpIHtcbiAgICBpZiAoIXRoaXMuYWN0aXZlKSB7XG4gICAgICBpZiAodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPyBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgOiBmYWxzZSkge1xuICAgICAgICB3YXJuKGBUaGUgYXBwIFwiJHt0aGlzLm5hbWV9XCIgcmVuZGVyaW5nIHByb2Nlc3MgaGFzIGJlZW4gYmxvY2tlZC5gKTtcbiAgICAgIH1cbiAgICAgIHRoaXMubW91bnRpbmcgPSBmYWxzZTtcbiAgICAgIGlmICh0aGlzLmFwcENvbnRhaW5lcikge1xuICAgICAgICB0aGlzLmVudHJ5TWFuYWdlci5ET01BcGlzLnJlbW92ZUVsZW1lbnQodGhpcy5hcHBDb250YWluZXIpO1xuICAgICAgfVxuICAgICAgY29yZUxvZyhgJHt0aGlzLmFwcEluZm8ubmFtZX0gaWQ6JHt0aGlzLmFwcElkfSBzdG9wTW91bnRBbmRDbGVhckVmZmVjdGAsIHRoaXMuYXBwQ29udGFpbmVyKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgY2FsbFJlbmRlcihwcm92aWRlciwgaXNNb3VudCkge1xuICAgIGlmIChwcm92aWRlciAmJiBwcm92aWRlci5yZW5kZXIpIHtcbiAgICAgIHByb3ZpZGVyLnJlbmRlcih7XG4gICAgICAgIGFwcE5hbWU6IHRoaXMuYXBwSW5mby5uYW1lLFxuICAgICAgICBkb206IHRoaXMucm9vdEVsZW1lbnQsXG4gICAgICAgIGJhc2VuYW1lOiB0aGlzLmFwcEluZm8uYmFzZW5hbWUsXG4gICAgICAgIGFwcFJlbmRlckluZm86IHsgaXNNb3VudCB9LFxuICAgICAgICBwcm9wczogdGhpcy5hcHBJbmZvLnByb3BzXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgY2FsbERlc3Ryb3kocHJvdmlkZXIsIGlzVW5tb3VudCkge1xuICAgIGNvbnN0IHsgcm9vdEVsZW1lbnQsIGFwcENvbnRhaW5lciB9ID0gdGhpcztcbiAgICBpZiAocHJvdmlkZXIgJiYgcHJvdmlkZXIuZGVzdHJveSkge1xuICAgICAgcHJvdmlkZXIuZGVzdHJveSh7XG4gICAgICAgIGFwcE5hbWU6IHRoaXMuYXBwSW5mby5uYW1lLFxuICAgICAgICBkb206IHJvb3RFbGVtZW50LFxuICAgICAgICBhcHBSZW5kZXJJbmZvOiB7IGlzVW5tb3VudCB9LFxuICAgICAgICBwcm9wczogdGhpcy5hcHBJbmZvLnByb3BzXG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5lbnRyeU1hbmFnZXIuRE9NQXBpcy5yZW1vdmVFbGVtZW50KGFwcENvbnRhaW5lcik7XG4gIH1cbiAgYXN5bmMgYWRkQ29udGFpbmVyKCkge1xuICAgIGNvbnN0IHdyYXBwZXJOb2RlID0gYXdhaXQgZ2V0UmVuZGVyTm9kZSh0aGlzLmFwcEluZm8uZG9tR2V0dGVyKTtcbiAgICBpZiAodHlwZW9mIHdyYXBwZXJOb2RlLmFwcGVuZENoaWxkID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHdyYXBwZXJOb2RlLmFwcGVuZENoaWxkKHRoaXMuYXBwQ29udGFpbmVyKTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgcmVuZGVyVGVtcGxhdGUoKSB7XG4gICAgY29uc3QgeyBhcHBJbmZvLCBlbnRyeU1hbmFnZXIsIHJlc291cmNlcyB9ID0gdGhpcztcbiAgICBjb25zdCB7IHVybDogYmFzZVVybCwgRE9NQXBpcyB9ID0gZW50cnlNYW5hZ2VyO1xuICAgIGNvbnN0IHsgaHRtbE5vZGUsIGFwcENvbnRhaW5lciB9ID0gY3JlYXRlQXBwQ29udGFpbmVyKGFwcEluZm8pO1xuICAgIGNvbnN0IGZpeFN0YXRpY1Jlc291cmNlQmFzZVVybCA9ICF0aGlzLmFwcEluZm8uc2FuZGJveCB8fCB0aGlzLmFwcEluZm8uc2FuZGJveCAmJiB0aGlzLmFwcEluZm8uc2FuZGJveC5maXhTdGF0aWNSZXNvdXJjZUJhc2VVcmwgPT09IHRydWU7XG4gICAgdGhpcy5odG1sTm9kZSA9IGh0bWxOb2RlO1xuICAgIHRoaXMuYXBwQ29udGFpbmVyID0gYXBwQ29udGFpbmVyO1xuICAgIGF3YWl0IHRoaXMuYWRkQ29udGFpbmVyKCk7XG4gICAgY29uc3QgY3VzdG9tUmVuZGVyZXIgPSB7XG4gICAgICBtZXRhOiAoKSA9PiBudWxsLFxuICAgICAgaW1nOiAobm9kZSkgPT4ge1xuICAgICAgICBmaXhTdGF0aWNSZXNvdXJjZUJhc2VVcmwgJiYgYmFzZVVybCAmJiBlbnRyeU1hbmFnZXIudG9SZXNvbHZlVXJsKG5vZGUsIFwic3JjXCIsIGJhc2VVcmwpO1xuICAgICAgICByZXR1cm4gRE9NQXBpcy5jcmVhdGVFbGVtZW50KG5vZGUpO1xuICAgICAgfSxcbiAgICAgIHZpZGVvOiAobm9kZSkgPT4ge1xuICAgICAgICBmaXhTdGF0aWNSZXNvdXJjZUJhc2VVcmwgJiYgYmFzZVVybCAmJiBlbnRyeU1hbmFnZXIudG9SZXNvbHZlVXJsKG5vZGUsIFwic3JjXCIsIGJhc2VVcmwpO1xuICAgICAgICByZXR1cm4gRE9NQXBpcy5jcmVhdGVFbGVtZW50KG5vZGUpO1xuICAgICAgfSxcbiAgICAgIGF1ZGlvOiAobm9kZSkgPT4ge1xuICAgICAgICBmaXhTdGF0aWNSZXNvdXJjZUJhc2VVcmwgJiYgYmFzZVVybCAmJiBlbnRyeU1hbmFnZXIudG9SZXNvbHZlVXJsKG5vZGUsIFwic3JjXCIsIGJhc2VVcmwpO1xuICAgICAgICByZXR1cm4gRE9NQXBpcy5jcmVhdGVFbGVtZW50KG5vZGUpO1xuICAgICAgfSxcbiAgICAgIGlmcmFtZTogKG5vZGUpID0+IHtcbiAgICAgICAgZml4U3RhdGljUmVzb3VyY2VCYXNlVXJsICYmIGJhc2VVcmwgJiYgZW50cnlNYW5hZ2VyLnRvUmVzb2x2ZVVybChub2RlLCBcInNyY1wiLCBiYXNlVXJsKTtcbiAgICAgICAgcmV0dXJuIERPTUFwaXMuY3JlYXRlRWxlbWVudChub2RlKTtcbiAgICAgIH0sXG4gICAgICBib2R5OiAobm9kZSkgPT4ge1xuICAgICAgICBpZiAoIXRoaXMuc3RyaWN0SXNvbGF0aW9uKSB7XG4gICAgICAgICAgbm9kZSA9IGVudHJ5TWFuYWdlci5jbG9uZU5vZGUobm9kZSk7XG4gICAgICAgICAgbm9kZS50YWdOYW1lID0gXCJkaXZcIjtcbiAgICAgICAgICBub2RlLmF0dHJpYnV0ZXMucHVzaCh7XG4gICAgICAgICAgICBrZXk6IF9fTW9ja0JvZHlfXyxcbiAgICAgICAgICAgIHZhbHVlOiBudWxsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIERPTUFwaXMuY3JlYXRlRWxlbWVudChub2RlKTtcbiAgICAgIH0sXG4gICAgICBoZWFkOiAobm9kZSkgPT4ge1xuICAgICAgICBpZiAoIXRoaXMuc3RyaWN0SXNvbGF0aW9uKSB7XG4gICAgICAgICAgbm9kZSA9IGVudHJ5TWFuYWdlci5jbG9uZU5vZGUobm9kZSk7XG4gICAgICAgICAgbm9kZS50YWdOYW1lID0gXCJkaXZcIjtcbiAgICAgICAgICBub2RlLmF0dHJpYnV0ZXMucHVzaCh7XG4gICAgICAgICAgICBrZXk6IF9fTW9ja0hlYWRfXyxcbiAgICAgICAgICAgIHZhbHVlOiBudWxsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIERPTUFwaXMuY3JlYXRlRWxlbWVudChub2RlKTtcbiAgICAgIH0sXG4gICAgICBzY3JpcHQ6IChub2RlKSA9PiB7XG4gICAgICAgIGNvbnN0IG1pbWVUeXBlID0gZW50cnlNYW5hZ2VyLmZpbmRBdHRyaWJ1dGVWYWx1ZShub2RlLCBcInR5cGVcIik7XG4gICAgICAgIGNvbnN0IGlzTW9kdWxlID0gbWltZVR5cGUgPT09IFwibW9kdWxlXCI7XG4gICAgICAgIGlmIChtaW1lVHlwZSkge1xuICAgICAgICAgIGlmICghaXNNb2R1bGUgJiYgIWlzSnNUeXBlKHsgdHlwZTogbWltZVR5cGUgfSkpIHtcbiAgICAgICAgICAgIHJldHVybiBET01BcGlzLmNyZWF0ZUVsZW1lbnQobm9kZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGpzTWFuYWdlciA9IHJlc291cmNlcy5qcy5maW5kKChtYW5hZ2VyKSA9PiB7XG4gICAgICAgICAgcmV0dXJuICFtYW5hZ2VyLmFzeW5jID8gbWFuYWdlci5pc1NhbWVPcmlnaW4obm9kZSkgOiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChqc01hbmFnZXIpIHtcbiAgICAgICAgICBpZiAoanNNYW5hZ2VyLmRlZmVyKSB7XG4gICAgICAgICAgICB0aGlzLmRlZmVyTm9kZU1hcC5zZXQoanNNYW5hZ2VyLCBub2RlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgeyB1cmwsIHNjcmlwdENvZGUgfSA9IGpzTWFuYWdlcjtcbiAgICAgICAgICAgIGNvbnN0IG1vY2tPcmlnaW5TY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpO1xuICAgICAgICAgICAgbm9kZS5hdHRyaWJ1dGVzLmZvckVhY2goKGF0dHJpYnV0ZSkgPT4ge1xuICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlLmtleSkge1xuICAgICAgICAgICAgICAgIG1vY2tPcmlnaW5TY3JpcHQuc2V0QXR0cmlidXRlKGF0dHJpYnV0ZS5rZXksIGF0dHJpYnV0ZS52YWx1ZSB8fCBcIlwiKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRVcmwgPSB1cmwgfHwgdGhpcy5hcHBJbmZvLmVudHJ5O1xuICAgICAgICAgICAgdGhpcy5leGVjU2NyaXB0KHNjcmlwdENvZGUsIHt9LCB0YXJnZXRVcmwsIHtcbiAgICAgICAgICAgICAgaXNNb2R1bGUsXG4gICAgICAgICAgICAgIGFzeW5jOiBmYWxzZSxcbiAgICAgICAgICAgICAgZGVmZXI6IGZhbHNlLFxuICAgICAgICAgICAgICBpc0lubGluZToganNNYW5hZ2VyLmlzSW5saW5lU2NyaXB0KCksXG4gICAgICAgICAgICAgIG5vRW50cnk6IHRvQm9vbGVhbihlbnRyeU1hbmFnZXIuZmluZEF0dHJpYnV0ZVZhbHVlKG5vZGUsIFwibm8tZW50cnlcIikgfHwgdGhpcy5pc05vRW50cnlTY3JpcHQodGFyZ2V0VXJsKSksXG4gICAgICAgICAgICAgIG9yaWdpblNjcmlwdDogbW9ja09yaWdpblNjcmlwdFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID8gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiIDogZmFsc2UpIHtcbiAgICAgICAgICBjb25zdCBhc3luYyA9IGVudHJ5TWFuYWdlci5maW5kQXR0cmlidXRlVmFsdWUobm9kZSwgXCJhc3luY1wiKTtcbiAgICAgICAgICBpZiAodHlwZW9mIGFzeW5jID09PSBcInVuZGVmaW5lZFwiIHx8IGFzeW5jID09PSBcImZhbHNlXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IHRpcEluZm8gPSBKU09OLnN0cmluZ2lmeShub2RlLCBudWxsLCAyKTtcbiAgICAgICAgICAgIHdhcm4oYEN1cnJlbnQganMgbm9kZSBjYW5ub3QgYmUgZm91bmQsIHRoZSByZXNvdXJjZSBtYXkgbm90IGV4aXN0LlxuXG4gJHt0aXBJbmZvfWApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gRE9NQXBpcy5jcmVhdGVTY3JpcHRDb21tZW50Tm9kZShub2RlKTtcbiAgICAgIH0sXG4gICAgICBzdHlsZTogKG5vZGUpID0+IHtcbiAgICAgICAgY29uc3QgdGV4dCA9IG5vZGUuY2hpbGRyZW5bMF07XG4gICAgICAgIGlmICh0ZXh0KSB7XG4gICAgICAgICAgY29uc3Qgc3R5bGVNYW5hZ2VyID0gbmV3IHRoaXMuY29udGV4dC5sb2FkZXIuU3R5bGVNYW5hZ2VyKHRleHQuY29udGVudCwgYmFzZVVybCk7XG4gICAgICAgICAgc3R5bGVNYW5hZ2VyLnNldFNjb3BlKHtcbiAgICAgICAgICAgIGFwcE5hbWU6IHRoaXMubmFtZSxcbiAgICAgICAgICAgIHJvb3RFbElkOiB0aGlzLmFwcENvbnRhaW5lci5pZFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGJhc2VVcmwgJiYgc3R5bGVNYW5hZ2VyLmNvcnJlY3RQYXRoKGJhc2VVcmwpO1xuICAgICAgICAgIHJldHVybiBlbnRyeU1hbmFnZXIuaWdub3JlQ2hpbGROb2Rlc0NyZWF0aW9uKHN0eWxlTWFuYWdlci5yZW5kZXJBc1N0eWxlRWxlbWVudCgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gRE9NQXBpcy5jcmVhdGVFbGVtZW50KG5vZGUpO1xuICAgICAgfSxcbiAgICAgIGxpbms6IChub2RlKSA9PiB7XG4gICAgICAgIGlmIChET01BcGlzLmlzQ3NzTGlua05vZGUobm9kZSkpIHtcbiAgICAgICAgICBjb25zdCBzdHlsZU1hbmFnZXIgPSB0aGlzLnJlc291cmNlcy5saW5rLmZpbmQoKG1hbmFnZXIpID0+IG1hbmFnZXIuaXNTYW1lT3JpZ2luKG5vZGUpKTtcbiAgICAgICAgICBpZiAoc3R5bGVNYW5hZ2VyKSB7XG4gICAgICAgICAgICBzdHlsZU1hbmFnZXIuc2V0U2NvcGUoe1xuICAgICAgICAgICAgICBhcHBOYW1lOiB0aGlzLm5hbWUsXG4gICAgICAgICAgICAgIHJvb3RFbElkOiB0aGlzLmFwcENvbnRhaW5lci5pZFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gc3R5bGVNYW5hZ2VyLnJlbmRlckFzU3R5bGVFbGVtZW50KCh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudiAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViA/IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA6IGZhbHNlKSA/IGBcbi8qJHtET01BcGlzLmNyZWF0ZUxpbmtDb21tZW50Tm9kZShub2RlKX0qL1xuYCA6IFwiXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gRE9NQXBpcy5pc1ByZWZldGNoSnNMaW5rTm9kZShub2RlKSA/IERPTUFwaXMuY3JlYXRlU2NyaXB0Q29tbWVudE5vZGUobm9kZSkgOiBET01BcGlzLmlzSWNvbkxpbmtOb2RlKG5vZGUpID8gbnVsbCA6IERPTUFwaXMuY3JlYXRlRWxlbWVudChub2RlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGVudHJ5TWFuYWdlci5jcmVhdGVFbGVtZW50cyhjdXN0b21SZW5kZXJlciwgaHRtbE5vZGUsIChub2RlLCBwYXJlbnQpID0+IHtcbiAgICAgIHJldHVybiB0aGlzLmhvb2tzLmxpZmVjeWNsZS5jdXN0b21SZW5kZXIuZW1pdCh7XG4gICAgICAgIG5vZGUsXG4gICAgICAgIHBhcmVudCxcbiAgICAgICAgYXBwOiB0aGlzLFxuICAgICAgICBjdXN0b21FbGVtZW50OiBudWxsXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICBhc3luYyBjaGVja0FuZEdldFByb3ZpZGVyKCkge1xuICAgIGNvbnN0IHsgYXBwSW5mbywgcm9vdEVsZW1lbnQsIGNqc01vZHVsZXMsIGN1c3RvbUV4cG9ydHMgfSA9IHRoaXM7XG4gICAgY29uc3QgeyBuYW1lLCBwcm9wcywgYmFzZW5hbWUgfSA9IGFwcEluZm87XG4gICAgbGV0IHByb3ZpZGVyID0gdm9pZCAwO1xuICAgIGF3YWl0IHRoaXMuZXNtUXVldWUuYXdhaXRDb21wbGV0aW9uKCk7XG4gICAgaWYgKGNqc01vZHVsZXMuZXhwb3J0cykge1xuICAgICAgaWYgKGlzUHJvbWlzZShjanNNb2R1bGVzLmV4cG9ydHMpKVxuICAgICAgICBjanNNb2R1bGVzLmV4cG9ydHMgPSBhd2FpdCBjanNNb2R1bGVzLmV4cG9ydHM7XG4gICAgICBpZiAoY2pzTW9kdWxlcy5leHBvcnRzLnByb3ZpZGVyKVxuICAgICAgICBwcm92aWRlciA9IGNqc01vZHVsZXMuZXhwb3J0cy5wcm92aWRlcjtcbiAgICB9XG4gICAgaWYgKGN1c3RvbUV4cG9ydHMucHJvdmlkZXIpIHtcbiAgICAgIHByb3ZpZGVyID0gY3VzdG9tRXhwb3J0cy5wcm92aWRlcjtcbiAgICB9XG4gICAgaWYgKHRoaXMuYXN5bmNQcm92aWRlclRpbWVvdXQgJiYgIXByb3ZpZGVyKSB7XG4gICAgICBwcm92aWRlciA9IGF3YWl0IHRoaXMuYXdhaXRBc3luY1Byb3ZpZGVyUmVnaXN0cmF0aW9uKCk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgcHJvdmlkZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgcHJvdmlkZXIgPSBhd2FpdCBwcm92aWRlcihfX3NwcmVhZFZhbHVlcyh7XG4gICAgICAgIGJhc2VuYW1lLFxuICAgICAgICBkb206IHJvb3RFbGVtZW50XG4gICAgICB9LCBwcm9wcyB8fCB7fSksIHByb3BzKTtcbiAgICB9IGVsc2UgaWYgKGlzUHJvbWlzZShwcm92aWRlcikpIHtcbiAgICAgIHByb3ZpZGVyID0gYXdhaXQgcHJvdmlkZXI7XG4gICAgfVxuICAgIGlmICghaXNPYmplY3QyKHByb3ZpZGVyKSAmJiB0eXBlb2YgcHJvdmlkZXIgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgd2FybihgIEludmFsaWQgbW9kdWxlIGNvbnRlbnQ6ICR7bmFtZX0sIHlvdSBzaG91bGQgcmV0dXJuIGJvdGggcmVuZGVyIGFuZCBkZXN0cm95IGZ1bmN0aW9ucyBpbiBwcm92aWRlciBmdW5jdGlvbi5gKTtcbiAgICB9XG4gICAgY29uc3QgaG9va1JlcyA9IGF3YWl0ICh0aGlzLmN1c3RvbUxvYWRlciAmJiB0aGlzLmN1c3RvbUxvYWRlcihwcm92aWRlciwgYXBwSW5mbywgYmFzZW5hbWUpKTtcbiAgICBpZiAoaG9va1Jlcykge1xuICAgICAgY29uc3QgeyBtb3VudCwgdW5tb3VudCB9ID0gaG9va1JlcyB8fCB7fTtcbiAgICAgIGlmICh0eXBlb2YgbW91bnQgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgdW5tb3VudCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHByb3ZpZGVyLnJlbmRlciA9IG1vdW50O1xuICAgICAgICBwcm92aWRlci5kZXN0cm95ID0gdW5tb3VudDtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFhcHBJbmZvLm5vQ2hlY2tQcm92aWRlcikge1xuICAgICAgYXNzZXJ0Mihwcm92aWRlciwgYFwicHJvdmlkZXJcIiBpcyBcIiR7cHJvdmlkZXJ9XCIuYCk7XG4gICAgICBhc3NlcnQyKFwicmVuZGVyXCIgaW4gcHJvdmlkZXIsICdcInJlbmRlclwiIGlzIHJlcXVpcmVkIGluIHByb3ZpZGVyLicpO1xuICAgICAgYXNzZXJ0MihcImRlc3Ryb3lcIiBpbiBwcm92aWRlciwgJ1wiZGVzdHJveVwiIGlzIHJlcXVpcmVkIGluIHByb3ZpZGVyLicpO1xuICAgIH1cbiAgICB0aGlzLnByb3ZpZGVyID0gcHJvdmlkZXI7XG4gICAgcmV0dXJuIHByb3ZpZGVyO1xuICB9XG59O1xuXG4vLyBzcmMvbW9kdWxlL3Jlc291cmNlLnRzXG5pbXBvcnQgeyB3YXJuIGFzIHdhcm4yLCBlcnJvciBhcyBlcnJvcjIsIHRyYW5zZm9ybVVybCBhcyB0cmFuc2Zvcm1VcmwzLCBhc3NlcnQgYXMgYXNzZXJ0MyB9IGZyb20gXCJAZ2FyZmlzaC91dGlsc1wiO1xuZnVuY3Rpb24gZmV0Y2hTdGF0aWNSZXNvdXJjZXMoYXBwTmFtZSwgbG9hZGVyLCBlbnRyeU1hbmFnZXIpIHtcbiAgY29uc3QgdG9Cb29sZWFuMiA9ICh2YWwpID0+IHR5cGVvZiB2YWwgIT09IFwidW5kZWZpbmVkXCIgJiYgdmFsICE9PSBcImZhbHNlXCI7XG4gIGNvbnN0IGpzTm9kZXMgPSBQcm9taXNlLmFsbChlbnRyeU1hbmFnZXIuZmluZEFsbEpzTm9kZXMoKS5tYXAoKG5vZGUpID0+IHtcbiAgICBjb25zdCBzcmMgPSBlbnRyeU1hbmFnZXIuZmluZEF0dHJpYnV0ZVZhbHVlKG5vZGUsIFwic3JjXCIpO1xuICAgIGNvbnN0IHR5cGUgPSBlbnRyeU1hbmFnZXIuZmluZEF0dHJpYnV0ZVZhbHVlKG5vZGUsIFwidHlwZVwiKTtcbiAgICBjb25zdCBjcm9zc09yaWdpbiA9IGVudHJ5TWFuYWdlci5maW5kQXR0cmlidXRlVmFsdWUobm9kZSwgXCJjcm9zc29yaWdpblwiKTtcbiAgICBpZiAoc3JjKSB7XG4gICAgICBjb25zdCBmZXRjaFVybCA9IGVudHJ5TWFuYWdlci51cmwgPyB0cmFuc2Zvcm1VcmwzKGVudHJ5TWFuYWdlci51cmwsIHNyYykgOiBzcmM7XG4gICAgICBjb25zdCBhc3luYyA9IGVudHJ5TWFuYWdlci5maW5kQXR0cmlidXRlVmFsdWUobm9kZSwgXCJhc3luY1wiKTtcbiAgICAgIGNvbnN0IGRlZmVyID0gZW50cnlNYW5hZ2VyLmZpbmRBdHRyaWJ1dGVWYWx1ZShub2RlLCBcImRlZmVyXCIpO1xuICAgICAgcmV0dXJuIGxvYWRlci5sb2FkKHtcbiAgICAgICAgc2NvcGU6IGFwcE5hbWUsXG4gICAgICAgIHVybDogZmV0Y2hVcmwsXG4gICAgICAgIGNyb3NzT3JpZ2luLFxuICAgICAgICBkZWZhdWx0Q29udGVudFR5cGU6IHR5cGVcbiAgICAgIH0pLnRoZW4oKHsgcmVzb3VyY2VNYW5hZ2VyOiBqc01hbmFnZXIgfSkgPT4ge1xuICAgICAgICBpZiAoanNNYW5hZ2VyKSB7XG4gICAgICAgICAganNNYW5hZ2VyLnNldERlcChub2RlKTtcbiAgICAgICAgICB0eXBlICYmIGpzTWFuYWdlci5zZXRNaW1lVHlwZSh0eXBlKTtcbiAgICAgICAgICBqc01hbmFnZXIuc2V0QXN5bmNBdHRyaWJ1dGUodG9Cb29sZWFuMihhc3luYykpO1xuICAgICAgICAgIGpzTWFuYWdlci5zZXREZWZmZXJBdHRyaWJ1dGUodG9Cb29sZWFuMihkZWZlcikpO1xuICAgICAgICAgIHJldHVybiBqc01hbmFnZXI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgd2FybjIoYFske2FwcE5hbWV9XSBGYWlsZWQgdG8gbG9hZCBzY3JpcHQ6ICR7ZmV0Y2hVcmx9YCk7XG4gICAgICAgIH1cbiAgICAgIH0pLmNhdGNoKCgpID0+IG51bGwpO1xuICAgIH0gZWxzZSBpZiAobm9kZS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBjb2RlID0gbm9kZS5jaGlsZHJlblswXS5jb250ZW50O1xuICAgICAgaWYgKGNvZGUpIHtcbiAgICAgICAgY29uc3QganNNYW5hZ2VyID0gbmV3IGxvYWRlci5KYXZhU2NyaXB0TWFuYWdlcihjb2RlLCBcIlwiKTtcbiAgICAgICAganNNYW5hZ2VyLnNldERlcChub2RlKTtcbiAgICAgICAgdHlwZSAmJiBqc01hbmFnZXIuc2V0TWltZVR5cGUodHlwZSk7XG4gICAgICAgIHJldHVybiBqc01hbmFnZXI7XG4gICAgICB9XG4gICAgfVxuICB9KS5maWx0ZXIoQm9vbGVhbikpO1xuICBjb25zdCBsaW5rTm9kZXMgPSBQcm9taXNlLmFsbChlbnRyeU1hbmFnZXIuZmluZEFsbExpbmtOb2RlcygpLm1hcCgobm9kZSkgPT4ge1xuICAgIGlmICghZW50cnlNYW5hZ2VyLkRPTUFwaXMuaXNDc3NMaW5rTm9kZShub2RlKSlcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBocmVmID0gZW50cnlNYW5hZ2VyLmZpbmRBdHRyaWJ1dGVWYWx1ZShub2RlLCBcImhyZWZcIik7XG4gICAgaWYgKGhyZWYpIHtcbiAgICAgIGNvbnN0IGZldGNoVXJsID0gZW50cnlNYW5hZ2VyLnVybCA/IHRyYW5zZm9ybVVybDMoZW50cnlNYW5hZ2VyLnVybCwgaHJlZikgOiBocmVmO1xuICAgICAgcmV0dXJuIGxvYWRlci5sb2FkKHsgc2NvcGU6IGFwcE5hbWUsIHVybDogZmV0Y2hVcmwgfSkudGhlbigoeyByZXNvdXJjZU1hbmFnZXI6IHN0eWxlTWFuYWdlciB9KSA9PiB7XG4gICAgICAgIGlmIChzdHlsZU1hbmFnZXIpIHtcbiAgICAgICAgICBzdHlsZU1hbmFnZXIuc2V0RGVwKG5vZGUpO1xuICAgICAgICAgIHN0eWxlTWFuYWdlciA9PSBudWxsID8gdm9pZCAwIDogc3R5bGVNYW5hZ2VyLmNvcnJlY3RQYXRoKCk7XG4gICAgICAgICAgcmV0dXJuIHN0eWxlTWFuYWdlcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB3YXJuMihgJHthcHBOYW1lfSBGYWlsZWQgdG8gbG9hZCBsaW5rOiAke2ZldGNoVXJsfWApO1xuICAgICAgICB9XG4gICAgICB9KS5jYXRjaCgoKSA9PiBudWxsKTtcbiAgICB9XG4gIH0pLmZpbHRlcihCb29sZWFuKSk7XG4gIGNvbnN0IG1ldGFOb2RlcyA9IFByb21pc2UuYWxsKGVudHJ5TWFuYWdlci5maW5kQWxsTWV0YU5vZGVzKCkubWFwKChub2RlKSA9PiB7XG4gICAgaWYgKCFlbnRyeU1hbmFnZXIuRE9NQXBpcy5pc1JlbW90ZU1vZHVsZShub2RlKSlcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBhc3luYyA9IGVudHJ5TWFuYWdlci5maW5kQXR0cmlidXRlVmFsdWUobm9kZSwgXCJhc3luY1wiKTtcbiAgICBjb25zdCBhbGlhcyA9IGVudHJ5TWFuYWdlci5maW5kQXR0cmlidXRlVmFsdWUobm9kZSwgXCJhbGlhc1wiKTtcbiAgICBpZiAoIXRvQm9vbGVhbjIoYXN5bmMpKSB7XG4gICAgICBjb25zdCBzcmMgPSBlbnRyeU1hbmFnZXIuZmluZEF0dHJpYnV0ZVZhbHVlKG5vZGUsIFwic3JjXCIpO1xuICAgICAgaWYgKHNyYykge1xuICAgICAgICByZXR1cm4gbG9hZGVyLmxvYWRNb2R1bGUoc3JjKS50aGVuKCh7IHJlc291cmNlTWFuYWdlcjogbW9kdWxlTWFuYWdlciB9KSA9PiB7XG4gICAgICAgICAgaWYgKG1vZHVsZU1hbmFnZXIgJiYgYWxpYXMpIHtcbiAgICAgICAgICAgIG1vZHVsZU1hbmFnZXIgJiYgbW9kdWxlTWFuYWdlci5zZXRBbGlhcyhhbGlhcyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBtb2R1bGVNYW5hZ2VyO1xuICAgICAgICB9KS5jYXRjaCgoKSA9PiBudWxsKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGFsaWFzKSB7XG4gICAgICB3YXJuMihgQXN5bmNocm9ub3VzIGxvYWRpbmcgbW9kdWxlLCB0aGUgYWxpYXMgXCIke2FsaWFzfVwiIGlzIGludmFsaWQuYCk7XG4gICAgfVxuICB9KS5maWx0ZXIoQm9vbGVhbikpO1xuICByZXR1cm4gUHJvbWlzZS5hbGwoW2pzTm9kZXMsIGxpbmtOb2RlcywgbWV0YU5vZGVzXSkudGhlbigobHMpID0+IGxzLm1hcCgobnMpID0+IG5zLmZpbHRlcihCb29sZWFuKSkpO1xufVxuYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0FwcFJlc291cmNlcyhsb2FkZXIsIGFwcEluZm8pIHtcbiAgbGV0IGlzSHRtbE1vZGUgPSBmYWxzZSwgZmFrZUVudHJ5TWFuYWdlcjtcbiAgY29uc3QgcmVzb3VyY2VzID0geyBqczogW10sIGxpbms6IFtdLCBtb2R1bGVzOiBbXSB9O1xuICBhc3NlcnQzKGFwcEluZm8uZW50cnksIGBbJHthcHBJbmZvLm5hbWV9XSBFbnRyeSBpcyBub3Qgc3BlY2lmaWVkLmApO1xuICBjb25zdCB7IHJlc291cmNlTWFuYWdlcjogZW50cnlNYW5hZ2VyIH0gPSBhd2FpdCBsb2FkZXIubG9hZCh7XG4gICAgc2NvcGU6IGFwcEluZm8ubmFtZSxcbiAgICB1cmw6IHRyYW5zZm9ybVVybDMobG9jYXRpb24uaHJlZiwgYXBwSW5mby5lbnRyeSlcbiAgfSk7XG4gIGlmIChlbnRyeU1hbmFnZXIgaW5zdGFuY2VvZiBsb2FkZXIuVGVtcGxhdGVNYW5hZ2VyKSB7XG4gICAgaXNIdG1sTW9kZSA9IHRydWU7XG4gICAgY29uc3QgW2pzLCBsaW5rLCBtb2R1bGVzXSA9IGF3YWl0IGZldGNoU3RhdGljUmVzb3VyY2VzKGFwcEluZm8ubmFtZSwgbG9hZGVyLCBlbnRyeU1hbmFnZXIpO1xuICAgIHJlc291cmNlcy5qcyA9IGpzO1xuICAgIHJlc291cmNlcy5saW5rID0gbGluaztcbiAgICByZXNvdXJjZXMubW9kdWxlcyA9IG1vZHVsZXM7XG4gIH0gZWxzZSBpZiAoZW50cnlNYW5hZ2VyIGluc3RhbmNlb2YgbG9hZGVyLkphdmFTY3JpcHRNYW5hZ2VyKSB7XG4gICAgaXNIdG1sTW9kZSA9IGZhbHNlO1xuICAgIGNvbnN0IG1vY2tUZW1wbGF0ZUNvZGUgPSBgPHNjcmlwdCBzcmM9XCIke2VudHJ5TWFuYWdlci51cmx9XCI+PFxcL3NjcmlwdD5gO1xuICAgIGZha2VFbnRyeU1hbmFnZXIgPSBuZXcgbG9hZGVyLlRlbXBsYXRlTWFuYWdlcihtb2NrVGVtcGxhdGVDb2RlLCBlbnRyeU1hbmFnZXIudXJsKTtcbiAgICBlbnRyeU1hbmFnZXIuc2V0RGVwKGZha2VFbnRyeU1hbmFnZXIuZmluZEFsbEpzTm9kZXMoKVswXSk7XG4gICAgcmVzb3VyY2VzLmpzID0gW2VudHJ5TWFuYWdlcl07XG4gIH0gZWxzZSB7XG4gICAgZXJyb3IyKGBFbnRyYW5jZSB3cm9uZyB0eXBlIG9mIHJlc291cmNlIG9mIFwiJHthcHBJbmZvLm5hbWV9XCIuYCk7XG4gIH1cbiAgcmV0dXJuIFtmYWtlRW50cnlNYW5hZ2VyIHx8IGVudHJ5TWFuYWdlciwgcmVzb3VyY2VzLCBpc0h0bWxNb2RlXTtcbn1cblxuLy8gc3JjL3BsdWdpbnMvZml4SE1SLnRzXG5mdW5jdGlvbiBHYXJmaXNoSE1SUGx1Z2luKCkge1xuICBsZXQgaGFzSW5pdCA9IGZhbHNlO1xuICBsZXQgaXNIb3RVcGRhdGUgPSBmYWxzZTtcbiAgcmV0dXJuIGZ1bmN0aW9uKEdhcmZpc2gyKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IFwiZml4LWhtclwiLFxuICAgICAgdmVyc2lvbjogXCIxLjE2LjJcIixcbiAgICAgIGJvb3RzdHJhcCgpIHtcbiAgICAgICAgaWYgKGhhc0luaXQpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICBoYXNJbml0ID0gdHJ1ZTtcbiAgICAgICAgbGV0IHdlYnBhY2tIb3RVcGRhdGVOYW1lID0gXCJ3ZWJwYWNrSG90VXBkYXRlXCI7XG4gICAgICAgIGxldCB3ZWJwYWNrSG90VXBkYXRlID0gd2luZG93W3dlYnBhY2tIb3RVcGRhdGVOYW1lXTtcbiAgICAgICAgZm9yIChjb25zdCBpIGluIHdpbmRvdykge1xuICAgICAgICAgIGlmIChpLmluY2x1ZGVzKFwid2VicGFja0hvdFVwZGF0ZVwiKSkge1xuICAgICAgICAgICAgd2VicGFja0hvdFVwZGF0ZU5hbWUgPSBpO1xuICAgICAgICAgICAgd2VicGFja0hvdFVwZGF0ZSA9IHdpbmRvd1tpXTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiB3ZWJwYWNrSG90VXBkYXRlID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICB3aW5kb3dbd2VicGFja0hvdFVwZGF0ZU5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpc0hvdFVwZGF0ZSA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gd2VicGFja0hvdFVwZGF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgIH07XG4gICAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWlzSG90VXBkYXRlKVxuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBpc0hvdFVwZGF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgR2FyZmlzaDIuYWN0aXZlQXBwcy5mb3JFYWNoKChhcHApID0+IHtcbiAgICAgICAgICAgICAgaWYgKGFwcC5tb3VudGVkKSB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICBhcHAuZGlzcGxheSAmJiBhcHAuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgYXBwLnNob3coKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIHtcbiAgICAgICAgICAgIHN1YnRyZWU6IHRydWUsXG4gICAgICAgICAgICBjaGlsZExpc3Q6IHRydWUsXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICB9O1xufVxuXG4vLyBzcmMvcGx1Z2lucy9saWZlY3ljbGUudHNcbmZ1bmN0aW9uIEdhcmZpc2hPcHRpb25zTGlmZShvcHRpb25zLCBuYW1lKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX19zcHJlYWRWYWx1ZXMoe1xuICAgICAgbmFtZSxcbiAgICAgIHZlcnNpb246IFwiMS4xNi4yXCJcbiAgICB9LCBvcHRpb25zKTtcbiAgfTtcbn1cblxuLy8gc3JjL3BsdWdpbnMvcHJlbG9hZC50c1xuaW1wb3J0IHtcbiAgd2FybiBhcyB3YXJuMyxcbiAgUXVldWUgYXMgUXVldWUyLFxuICBpc0Fic29sdXRlIGFzIGlzQWJzb2x1dGUyLFxuICB0cmFuc2Zvcm1VcmwgYXMgdHJhbnNmb3JtVXJsNCxcbiAgaWRsZUNhbGxiYWNrLFxuICBzYWZlV3JhcHBlclxufSBmcm9tIFwiQGdhcmZpc2gvdXRpbHNcIjtcbmltcG9ydCB7IFRlbXBsYXRlTWFuYWdlciB9IGZyb20gXCJAZ2FyZmlzaC9sb2FkZXJcIjtcbnZhciBzdG9yYWdlS2V5ID0gXCJfX2dhcmZpc2hQcmVsb2FkQXBwX19cIjtcbnZhciBpc01vYmlsZSA9IC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtcbnZhciByZXF1ZXN0UXVldWUgPSBuZXcgUXVldWUyKCk7XG52YXIgaXNTbG93TmV0d29yayA9ICgpID0+IG5hdmlnYXRvci5jb25uZWN0aW9uID8gbmF2aWdhdG9yLmNvbm5lY3Rpb24uc2F2ZURhdGEgfHwgLygyfDMpZy8udGVzdChuYXZpZ2F0b3IuY29ubmVjdGlvbi5lZmZlY3RpdmVUeXBlKSA6IGZhbHNlO1xudmFyIHJlcXVlc3RJZGxlQ2FsbGJhY2sgPSB0eXBlb2YgaWRsZUNhbGxiYWNrICE9PSBcImZ1bmN0aW9uXCIgPyB3aW5kb3cuc2V0VGltZW91dCA6IGlkbGVDYWxsYmFjaztcbmZ1bmN0aW9uIHNhZmVMb2FkKHtcbiAgbG9hZGVyLFxuICBhcHBOYW1lLFxuICB1cmwsXG4gIGlzTW9kdWxlLFxuICBpbW1lZGlhdGVseSxcbiAgY2FsbGJhY2tcbn0pIHtcbiAgY29uc3QgZ2VuZXJhdGVTdWNjZXNzID0gKG5leHQgPSAoKSA9PiB7XG4gIH0pID0+ICh7IHJlc291cmNlTWFuYWdlciB9KSA9PiB7XG4gICAgY2FsbGJhY2sgJiYgY2FsbGJhY2socmVzb3VyY2VNYW5hZ2VyKTtcbiAgICBzZXRUaW1lb3V0KG5leHQsIDUwMCk7XG4gIH07XG4gIGNvbnN0IGdlbmVyYXRlVGhyb3dXYXJuID0gKG5leHQgPSAoKSA9PiB7XG4gIH0pID0+IChlKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID8gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiIDogZmFsc2UpIHtcbiAgICAgIHdhcm4zKGUpO1xuICAgICAgd2FybjMoYFByZWxvYWQgZmFpbGVkLiBcIiR7dXJsfVwiYCk7XG4gICAgfVxuICAgIG5leHQoKTtcbiAgfTtcbiAgY29uc3QgbG9hZFJlc291cmNlID0gKG5leHQgPSAoKSA9PiB7XG4gIH0pID0+IHtcbiAgICBjb25zdCB0aHJvd1dhcm4gPSBnZW5lcmF0ZVRocm93V2FybihuZXh0KTtcbiAgICBjb25zdCBzdWNjZXNzID0gZ2VuZXJhdGVTdWNjZXNzKG5leHQpO1xuICAgIHRyeSB7XG4gICAgICBpZiAoaXNNb2R1bGUpIHtcbiAgICAgICAgbG9hZGVyLmxvYWRNb2R1bGUodXJsKS50aGVuKHN1Y2Nlc3MsIHRocm93V2Fybik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsb2FkZXIubG9hZCh7IHNjb3BlOiBhcHBOYW1lLCB1cmwgfSkudGhlbihzdWNjZXNzLCB0aHJvd1dhcm4pO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRocm93V2FybihlKTtcbiAgICAgIG5leHQoKTtcbiAgICB9XG4gIH07XG4gIGlmIChpbW1lZGlhdGVseSkge1xuICAgIGxvYWRSZXNvdXJjZSgpO1xuICB9IGVsc2Uge1xuICAgIHJlcXVlc3RRdWV1ZS5hZGQoKG5leHQpID0+IHtcbiAgICAgIHJlcXVlc3RJZGxlQ2FsbGJhY2soKCkgPT4gbG9hZFJlc291cmNlKG5leHQpKTtcbiAgICB9KTtcbiAgfVxufVxuZnVuY3Rpb24gbG9hZEFwcFJlc291cmNlKGxvYWRlciwgaW5mbywgaW1tZWRpYXRlbHkgPSBmYWxzZSkge1xuICBmYWxzZTtcbiAgY29uc3QgZmV0Y2hVcmwgPSB0cmFuc2Zvcm1Vcmw0KGxvY2F0aW9uLmhyZWYsIGluZm8uZW50cnkpO1xuICBzYWZlTG9hZCh7XG4gICAgbG9hZGVyLFxuICAgIGFwcE5hbWU6IGluZm8ubmFtZSxcbiAgICB1cmw6IGZldGNoVXJsLFxuICAgIGlzTW9kdWxlOiBmYWxzZSxcbiAgICBpbW1lZGlhdGVseSxcbiAgICBjYWxsYmFjazogKG1hbmFnZXIpID0+IHtcbiAgICAgIGNvbnN0IGxvYWRTdGF0aWNSZXNvdXJjZSA9ICgpID0+IHtcbiAgICAgICAgaWYgKG1hbmFnZXIgaW5zdGFuY2VvZiBUZW1wbGF0ZU1hbmFnZXIpIHtcbiAgICAgICAgICBjb25zdCBiYXNlVXJsID0gbWFuYWdlci51cmw7XG4gICAgICAgICAgY29uc3QganNOb2RlcyA9IG1hbmFnZXIuZmluZEFsbEpzTm9kZXMoKTtcbiAgICAgICAgICBjb25zdCBsaW5rTm9kZXMgPSBtYW5hZ2VyLmZpbmRBbGxMaW5rTm9kZXMoKTtcbiAgICAgICAgICBjb25zdCBtZXRhTm9kZXMgPSBtYW5hZ2VyLmZpbmRBbGxNZXRhTm9kZXMoKTtcbiAgICAgICAgICBpZiAoanNOb2Rlcykge1xuICAgICAgICAgICAganNOb2Rlcy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHNyYyA9IG1hbmFnZXIuZmluZEF0dHJpYnV0ZVZhbHVlKG5vZGUsIFwic3JjXCIpO1xuICAgICAgICAgICAgICBzcmMgJiYgc2FmZUxvYWQoe1xuICAgICAgICAgICAgICAgIGxvYWRlcixcbiAgICAgICAgICAgICAgICBhcHBOYW1lOiBpbmZvLm5hbWUsXG4gICAgICAgICAgICAgICAgdXJsOiBiYXNlVXJsID8gdHJhbnNmb3JtVXJsNChiYXNlVXJsLCBzcmMpIDogc3JjLFxuICAgICAgICAgICAgICAgIGlzTW9kdWxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBpbW1lZGlhdGVseVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobGlua05vZGVzKSB7XG4gICAgICAgICAgICBsaW5rTm9kZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xuICAgICAgICAgICAgICBpZiAobWFuYWdlci5ET01BcGlzLmlzQ3NzTGlua05vZGUobm9kZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBocmVmID0gbWFuYWdlci5maW5kQXR0cmlidXRlVmFsdWUobm9kZSwgXCJocmVmXCIpO1xuICAgICAgICAgICAgICAgIGhyZWYgJiYgc2FmZUxvYWQoe1xuICAgICAgICAgICAgICAgICAgbG9hZGVyLFxuICAgICAgICAgICAgICAgICAgYXBwTmFtZTogaW5mby5uYW1lLFxuICAgICAgICAgICAgICAgICAgdXJsOiBiYXNlVXJsID8gdHJhbnNmb3JtVXJsNChiYXNlVXJsLCBocmVmKSA6IGhyZWYsXG4gICAgICAgICAgICAgICAgICBpc01vZHVsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICBpbW1lZGlhdGVseVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG1ldGFOb2Rlcykge1xuICAgICAgICAgICAgbWV0YU5vZGVzLmZvckVhY2goKG5vZGUpID0+IHtcbiAgICAgICAgICAgICAgaWYgKG1hbmFnZXIuRE9NQXBpcy5pc1JlbW90ZU1vZHVsZShub2RlKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNyYyA9IG1hbmFnZXIuZmluZEF0dHJpYnV0ZVZhbHVlKG5vZGUsIFwic3JjXCIpO1xuICAgICAgICAgICAgICAgIGlmIChzcmMgJiYgaXNBYnNvbHV0ZTIoc3JjKSkge1xuICAgICAgICAgICAgICAgICAgc2FmZUxvYWQoe1xuICAgICAgICAgICAgICAgICAgICBsb2FkZXIsXG4gICAgICAgICAgICAgICAgICAgIGFwcE5hbWU6IGluZm8ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBzcmMsXG4gICAgICAgICAgICAgICAgICAgIGlzTW9kdWxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpbW1lZGlhdGVseVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHdhcm4zKGBUaGUgbG9hZGluZyBvZiB0aGUgcmVtb3RlIG1vZHVsZSBtdXN0IGJlIGFuIGFic29sdXRlIHBhdGguIFwiJHtzcmN9XCJgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIGlmIChpbW1lZGlhdGVseSkge1xuICAgICAgICBsb2FkU3RhdGljUmVzb3VyY2UoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcXVlc3RJZGxlQ2FsbGJhY2sobG9hZFN0YXRpY1Jlc291cmNlKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufVxuZnVuY3Rpb24gZ2V0UmFua2luZygpIHtcbiAgY29uc3Qgc3RyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oc3RvcmFnZUtleSk7XG4gIGlmIChzdHIpIHtcbiAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShzdHIpO1xuICAgIHJldHVybiBkYXRhLnNvcnQoKGEsIGIpID0+IGIuY291bnQgLSBhLmNvdW50KTtcbiAgfVxuICByZXR1cm4gW107XG59XG5mdW5jdGlvbiBzZXRSYW5raW5nKGFwcE5hbWUpIHtcbiAgY29uc3Qgc3RyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oc3RvcmFnZUtleSk7XG4gIGNvbnN0IG5ld0N1cnJlbnQgPSB7IGFwcE5hbWUsIGNvdW50OiAxIH07XG4gIGlmICghc3RyKSB7XG4gICAgc2FmZVdyYXBwZXIoKCkgPT4gbG9jYWxTdG9yYWdlLnNldEl0ZW0oc3RvcmFnZUtleSwgSlNPTi5zdHJpbmdpZnkoW25ld0N1cnJlbnRdKSkpO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHN0cik7XG4gICAgY29uc3QgY3VycmVudCA9IGRhdGEuZmluZCgoYXBwKSA9PiBhcHAuYXBwTmFtZSA9PT0gYXBwTmFtZSk7XG4gICAgY3VycmVudCA/IGN1cnJlbnQuY291bnQrKyA6IGRhdGEucHVzaChuZXdDdXJyZW50KTtcbiAgICBzYWZlV3JhcHBlcigoKSA9PiBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShzdG9yYWdlS2V5LCBKU09OLnN0cmluZ2lmeShkYXRhKSkpO1xuICB9XG59XG52YXIgbG9hZGVkTWFwID0gLyogQF9fUFVSRV9fICovIE9iamVjdC5jcmVhdGUobnVsbCk7XG5mdW5jdGlvbiBHYXJmaXNoUHJlbG9hZFBsdWdpbigpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKEdhcmZpc2gyKSB7XG4gICAgR2FyZmlzaDIucHJlbG9hZEFwcCA9IChhcHBOYW1lKSA9PiB7XG4gICAgICBpZiAobG9hZGVkTWFwW2FwcE5hbWVdKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGxvYWRlZE1hcFthcHBOYW1lXSA9IHRydWU7XG4gICAgICBsb2FkQXBwUmVzb3VyY2UoR2FyZmlzaDIubG9hZGVyLCBHYXJmaXNoMi5hcHBJbmZvc1thcHBOYW1lXSwgdHJ1ZSk7XG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogXCJwcmVsb2FkXCIsXG4gICAgICB2ZXJzaW9uOiBcIjEuMTYuMlwiLFxuICAgICAgYmVmb3JlTG9hZChhcHBJbmZvKSB7XG4gICAgICAgIGlmIChHYXJmaXNoMi5vcHRpb25zLmRpc2FibGVQcmVsb2FkQXBwKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHNldFJhbmtpbmcoYXBwSW5mby5uYW1lKTtcbiAgICAgIH0sXG4gICAgICByZWdpc3RlckFwcChhcHBJbmZvcykge1xuICAgICAgICBpZiAoR2FyZmlzaDIub3B0aW9ucy5kaXNhYmxlUHJlbG9hZEFwcCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBpZiAoaXNNb2JpbGUgfHwgaXNTbG93TmV0d29yaygpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIGNvbnN0IHJhbmtpbmcgPSBnZXRSYW5raW5nKCk7XG4gICAgICAgICAgZm9yIChjb25zdCB7IGFwcE5hbWUgfSBvZiByYW5raW5nKSB7XG4gICAgICAgICAgICBpZiAoYXBwSW5mb3NbYXBwTmFtZV0gJiYgIWxvYWRlZE1hcFthcHBOYW1lXSkge1xuICAgICAgICAgICAgICBsb2FkZWRNYXBbYXBwTmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgICBsb2FkQXBwUmVzb3VyY2UoR2FyZmlzaDIubG9hZGVyLCBhcHBJbmZvc1thcHBOYW1lXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIGFwcEluZm9zKSB7XG4gICAgICAgICAgICBpZiAoIWxvYWRlZE1hcFtrZXldKSB7XG4gICAgICAgICAgICAgIGxvYWRBcHBSZXNvdXJjZShHYXJmaXNoMi5sb2FkZXIsIGFwcEluZm9zW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgZmFsc2UgPyAwIDogNWUzKTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xufVxuXG4vLyBzcmMvcGx1Z2lucy9wZXJmb3JtYW5jZS9zdWJBcHBPYnNlcnZlci50c1xuaW1wb3J0IHsgZ2V0UmVuZGVyTm9kZSBhcyBnZXRSZW5kZXJOb2RlMiwgd2FybiBhcyB3YXJuNCB9IGZyb20gXCJAZ2FyZmlzaC91dGlsc1wiO1xudmFyIFN1YkFwcE9ic2VydmVyID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgdGhpcy5vYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKHRoaXMuX211dGF0aW9uT2JzZXJ2ZXJDYWxsYmFjay5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLnN1YkFwcEJlZm9yZUxvYWRUaW1lID0gMDtcbiAgICB0aGlzLnN1YkFwcEJlZm9yZU1vdW50VGltZSA9IDA7XG4gICAgdGhpcy5zdWJBcHBTdGFydFBhZ2VTaG93VGltZSA9IDA7XG4gICAgdGhpcy5zdWJBcHBQYWdlU2hvd1RpbWUgPSAwO1xuICAgIHRoaXMuZW50cnkgPSBcIlwiO1xuICAgIHRoaXMub2JzZXJ2ZVRpbWVyID0gMDtcbiAgICB0aGlzLmRhdGFUaW1lciA9IDA7XG4gICAgdGhpcy5kb21RdWVyeVNlbGVjdG9yID0gb3B0aW9ucy5zdWJBcHBSb290U2VsZWN0b3I7XG4gICAgdGhpcy5jb25maWcgPSB7IGF0dHJpYnV0ZXM6IHRydWUsIGNoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZSB9O1xuICAgIHRoaXMudGFyZ2V0U3Vic2NyaWJlciA9IFtdO1xuICAgIHRoaXMudGltZUxhZyA9IG9wdGlvbnMuZG9tT2JzZXJ2ZXJNYXhUaW1lIHx8IDNlMztcbiAgICB0aGlzLnJlcG9ydFRpbWVMYWcgPSBvcHRpb25zLndhaXRTdWJBcHBOb3RpZnlNYXhUaW1lIHx8IDFlNDtcbiAgICB0aGlzLmlzUmVjb3JkRmluaXNoID0gZmFsc2U7XG4gICAgdGhpcy5jYkVudHJ5TGlzdCA9IFtdO1xuICAgIHRoaXMuaXNTdGFydFNob3dGbGFnID0gdHJ1ZTtcbiAgICB0aGlzLmlzQ2FsbEJhY2tGaW5pc2ggPSBmYWxzZTtcbiAgICB0aGlzLmlzU3ViQXBwTm90aWZ5RmluaXNoID0gZmFsc2U7XG4gICAgdGhpcy5maW5pc2hBY3Rpb24gPSBcIlwiO1xuICAgIHRoaXMucGVyZm9ybWFuY2VEYXRhID0ge1xuICAgICAgcmVzb3VyY2VMb2FkVGltZTogMCxcbiAgICAgIGJsYW5rU2NyZWVuVGltZTogMCxcbiAgICAgIGZpcnN0U2NyZWVuVGltZTogMCxcbiAgICAgIGlzRmlyc3RSZW5kZXI6IHRydWUsXG4gICAgICBlbnRyeTogXCJcIixcbiAgICAgIGFjdGlvbjogXCJcIlxuICAgIH07XG4gIH1cbiAgc3Vic2NyaWJlUGVyZm9ybWFuY2VEYXRhKGNhbGxiYWNrKSB7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMudGFyZ2V0U3Vic2NyaWJlci5wdXNoKGNhbGxiYWNrKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB3YXJuNChlKTtcbiAgICB9XG4gIH1cbiAgc3Vic2NyaWJlUGVyZm9ybWFuY2VEYXRhT25jZShjYWxsYmFjaykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB3cmFwQ2FsbGJhY2sgPSAocGVyZm9ybWFuY2VEYXRhKSA9PiB7XG4gICAgICAgIGNhbGxiYWNrKHBlcmZvcm1hbmNlRGF0YSk7XG4gICAgICAgIHRoaXMudW5zdWJzY3JpYmVQZXJmb3JtYW5jZURhdGEod3JhcENhbGxiYWNrKTtcbiAgICAgIH07XG4gICAgICB0aGlzLnRhcmdldFN1YnNjcmliZXIucHVzaCh3cmFwQ2FsbGJhY2spO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHdhcm40KGUpO1xuICAgIH1cbiAgfVxuICB1bnN1YnNjcmliZVBlcmZvcm1hbmNlRGF0YShjYWxsYmFjaykge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLnRhcmdldFN1YnNjcmliZXIgPSB0aGlzLnRhcmdldFN1YnNjcmliZXIuZmlsdGVyKChzdWIpID0+IHN1YiA9PT0gY2FsbGJhY2spO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHdhcm40KGUpO1xuICAgIH1cbiAgfVxuICBzdWJBcHBCZWZvcmVMb2FkKGVudHJ5KSB7XG4gICAgdGhpcy5lbnRyeSA9IGVudHJ5O1xuICAgIHRoaXMuaXNSZWNvcmRGaW5pc2ggPSBmYWxzZTtcbiAgICB0aGlzLmlzU3ViQXBwTm90aWZ5RmluaXNoID0gZmFsc2U7XG4gICAgdGhpcy5zdWJBcHBCZWZvcmVMb2FkVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgIHRoaXMuaXNDYWxsQmFja0ZpbmlzaCA9IGZhbHNlO1xuICAgIHRoaXMuX2hhbmRsZVN1YnNjcmliZUNhbGxiYWNrKGZhbHNlKTtcbiAgfVxuICBzdWJBcHBCZWZvcmVNb3VudCgpIHtcbiAgICB0aGlzLnN1YkFwcEJlZm9yZU1vdW50VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgIHRoaXMuX3N1YkFwcFN0YXJ0T2JzZXJ2ZXIoKTtcbiAgfVxuICBzdWJBcHBVbm1vdW50KCkge1xuICAgIGlmICghdGhpcy5pc1JlY29yZEZpbmlzaCkge1xuICAgICAgdGhpcy5fc3ViQXBwRW5kT2JzZXJ2ZXIoXCJzdWJBcHBVbm1vdW50XCIpO1xuICAgIH1cbiAgICB0aGlzLl9oYW5kbGVTdWJzY3JpYmVDYWxsYmFjayh0cnVlKTtcbiAgfVxuICBhZnRlclJlbmRlck5vdGlmeSgpIHtcbiAgICBpZiAoIXRoaXMuaXNSZWNvcmRGaW5pc2gpIHtcbiAgICAgIHRoaXMuX3N1YkFwcEVuZE9ic2VydmVyKFwiU3ViQXBwUmVuZGVyTm90aWZ5XCIpO1xuICAgIH0gZWxzZSBpZiAoIXRoaXMuaXNTdWJBcHBOb3RpZnlGaW5pc2gpIHtcbiAgICAgIHRoaXMuaXNTdWJBcHBOb3RpZnlGaW5pc2ggPSB0cnVlO1xuICAgICAgdGhpcy5pc1JlY29yZEZpbmlzaCA9IHRydWU7XG4gICAgICB0aGlzLmZpbmlzaEFjdGlvbiA9IFwiU3ViQXBwUmVuZGVyTm90aWZ5XCI7XG4gICAgICB0aGlzLl9zdWJBcHBQZXJmb3JtYW5jZURhdGFIYW5kbGUoKTtcbiAgICB9XG4gIH1cbiAgX211dGF0aW9uT2JzZXJ2ZXJDYWxsYmFjaygpIHtcbiAgICBpZiAodGhpcy5pc1N0YXJ0U2hvd0ZsYWcpIHtcbiAgICAgIHRoaXMuc3ViQXBwU3RhcnRQYWdlU2hvd1RpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgIHRoaXMuaXNTdGFydFNob3dGbGFnID0gZmFsc2U7XG4gICAgfVxuICAgIGNsZWFyVGltZW91dCh0aGlzLm9ic2VydmVUaW1lcik7XG4gICAgdGhpcy5vYnNlcnZlVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLm9ic2VydmVUaW1lcik7XG4gICAgICBpZiAoIXRoaXMuaXNSZWNvcmRGaW5pc2gpIHtcbiAgICAgICAgdGhpcy5fc3ViQXBwRW5kT2JzZXJ2ZXIoXCJNdXRhdGlvbk9ic2VydmVyXCIpO1xuICAgICAgfVxuICAgIH0sIHRoaXMudGltZUxhZyk7XG4gIH1cbiAgX3N1YkFwcEVuZE9ic2VydmVyKGZpbmlzaEFjdGlvbikge1xuICAgIHRoaXMuaXNSZWNvcmRGaW5pc2ggPSB0cnVlO1xuICAgIHRoaXMuZmluaXNoQWN0aW9uID0gZmluaXNoQWN0aW9uO1xuICAgIHRoaXMuc3ViQXBwUGFnZVNob3dUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgdGhpcy5vYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgdGhpcy5fc3ViQXBwUGVyZm9ybWFuY2VEYXRhSGFuZGxlKCk7XG4gICAgdGhpcy5pc1N0YXJ0U2hvd0ZsYWcgPSB0cnVlO1xuICB9XG4gIGFzeW5jIF9zdWJBcHBTdGFydE9ic2VydmVyKCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0YXJnZXROb2RlID0gYXdhaXQgZ2V0UmVuZGVyTm9kZTIodGhpcy5kb21RdWVyeVNlbGVjdG9yKTtcbiAgICAgIHRoaXMub2JzZXJ2ZXIub2JzZXJ2ZSh0YXJnZXROb2RlLCB0aGlzLmNvbmZpZyk7XG4gICAgICB0aGlzLl9zdWJBcHBDbGlja0V2ZW50T2JzZXJ2ZXIodGFyZ2V0Tm9kZSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgd2FybjQoZSk7XG4gICAgfVxuICB9XG4gIF9zdWJBcHBQZXJmb3JtYW5jZURhdGFIYW5kbGUoKSB7XG4gICAgY29uc3QgdGltZURpZmZlcmVuY2UgPSB0aGlzLmZpbmlzaEFjdGlvbiA9PT0gXCJNdXRhdGlvbk9ic2VydmVyXCIgPyB0aGlzLnRpbWVMYWcgOiAwO1xuICAgIHRoaXMucGVyZm9ybWFuY2VEYXRhID0ge1xuICAgICAgcmVzb3VyY2VMb2FkVGltZTogdGhpcy5zdWJBcHBCZWZvcmVNb3VudFRpbWUgLSB0aGlzLnN1YkFwcEJlZm9yZUxvYWRUaW1lLFxuICAgICAgYmxhbmtTY3JlZW5UaW1lOiB0aGlzLnN1YkFwcFN0YXJ0UGFnZVNob3dUaW1lIC0gdGhpcy5zdWJBcHBCZWZvcmVMb2FkVGltZSxcbiAgICAgIGZpcnN0U2NyZWVuVGltZTogdGhpcy5zdWJBcHBQYWdlU2hvd1RpbWUgLSB0aGlzLnN1YkFwcEJlZm9yZUxvYWRUaW1lIC0gdGltZURpZmZlcmVuY2UsXG4gICAgICBpc0ZpcnN0UmVuZGVyOiB0aGlzLmNiRW50cnlMaXN0LmluZGV4T2YodGhpcy5lbnRyeSkgPT09IC0xLFxuICAgICAgZW50cnk6IHRoaXMuZW50cnksXG4gICAgICBhY3Rpb246IHRoaXMuZmluaXNoQWN0aW9uXG4gICAgfTtcbiAgfVxuICBfc3ViQXBwQ2xpY2tFdmVudE9ic2VydmVyKHRhcmdldE5vZGUpIHtcbiAgICBjb25zdCBldmVudENhbGxiYWNrID0gKCkgPT4ge1xuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMub2JzZXJ2ZVRpbWVyKTtcbiAgICAgIGlmICghdGhpcy5pc1JlY29yZEZpbmlzaCkge1xuICAgICAgICB0aGlzLl9zdWJBcHBFbmRPYnNlcnZlcihcIlVzZXJFdmVudFwiKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRhcmdldE5vZGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGV2ZW50Q2FsbGJhY2spO1xuICAgIHRhcmdldE5vZGUuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGV2ZW50Q2FsbGJhY2spO1xuICAgIHRhcmdldE5vZGUuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgZXZlbnRDYWxsYmFjayk7XG4gICAgdGFyZ2V0Tm9kZS5hZGRFdmVudExpc3RlbmVyKFwia2V5cHJlc3NcIiwgZXZlbnRDYWxsYmFjayk7XG4gIH1cbiAgX2hhbmRsZUNhbGxiYWNrKCkge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmlzQ2FsbEJhY2tGaW5pc2ggPSB0cnVlO1xuICAgICAgdGhpcy50YXJnZXRTdWJzY3JpYmVyLmZvckVhY2goKGNhbGxiYWNrKSA9PiB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBmaXJzdFNjcmVlblRpbWUsXG4gICAgICAgICAgYmxhbmtTY3JlZW5UaW1lLFxuICAgICAgICAgIHJlc291cmNlTG9hZFRpbWUsXG4gICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgIGVudHJ5XG4gICAgICAgIH0gPSB0aGlzLnBlcmZvcm1hbmNlRGF0YTtcbiAgICAgICAgaWYgKGZpcnN0U2NyZWVuVGltZSA+IDAgJiYgYmxhbmtTY3JlZW5UaW1lID4gMCAmJiByZXNvdXJjZUxvYWRUaW1lID4gMCAmJiBhY3Rpb24gJiYgZW50cnkpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPyBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgOiBmYWxzZSkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFwiU1VDQ0VTUzogXCIsIHRoaXMucGVyZm9ybWFuY2VEYXRhKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5jYkVudHJ5TGlzdC5wdXNoKHRoaXMuZW50cnkpO1xuICAgICAgICAgIGNhbGxiYWNrKHRoaXMucGVyZm9ybWFuY2VEYXRhKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudiAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViA/IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA6IGZhbHNlKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKFwiRVJST1I6IFwiLCB0aGlzLnBlcmZvcm1hbmNlRGF0YSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHdhcm40KGUpO1xuICAgIH1cbiAgfVxuICBfaGFuZGxlU3Vic2NyaWJlQ2FsbGJhY2soaXNJbW1lZGlhdGVseSkge1xuICAgIHRyeSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5kYXRhVGltZXIpO1xuICAgICAgaWYgKGlzSW1tZWRpYXRlbHkgJiYgIXRoaXMuaXNDYWxsQmFja0ZpbmlzaCkge1xuICAgICAgICB0aGlzLl9oYW5kbGVDYWxsYmFjaygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5kYXRhVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB0aGlzLl9oYW5kbGVDYWxsYmFjaygpO1xuICAgICAgICB9LCB0aGlzLnJlcG9ydFRpbWVMYWcpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHdhcm40KGUpO1xuICAgIH1cbiAgfVxufTtcblxuLy8gc3JjL3BsdWdpbnMvcGVyZm9ybWFuY2UvaW5kZXgudHNcbmZ1bmN0aW9uIEdhcmZpc2hQZXJmb3JtYW5jZSgpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIGNvbnN0IHN1YkFwcE1hcCA9IHt9O1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBcInBlcmZvcm1hbmNlXCIsXG4gICAgICBiZWZvcmVMb2FkKGFwcEluZm8pIHtcbiAgICAgICAgaWYgKCFzdWJBcHBNYXBbYXBwSW5mby5uYW1lXSAmJiBhcHBJbmZvLmRvbUdldHRlcikge1xuICAgICAgICAgIHN1YkFwcE1hcFthcHBJbmZvLm5hbWVdID0gbmV3IFN1YkFwcE9ic2VydmVyKHtcbiAgICAgICAgICAgIHN1YkFwcFJvb3RTZWxlY3RvcjogYXBwSW5mby5kb21HZXR0ZXJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBzdWJBcHBNYXBbYXBwSW5mby5uYW1lXS5zdWJBcHBCZWZvcmVMb2FkKGFwcEluZm8uZW50cnkpO1xuICAgICAgfSxcbiAgICAgIGFmdGVyTG9hZChhcHBJbmZvLCBhcHBJbnN0YW5jZSkge1xuICAgICAgICBpZiAoYXBwSW5zdGFuY2UpIHtcbiAgICAgICAgICBhcHBJbnN0YW5jZS5hcHBQZXJmb3JtYW5jZSA9IHN1YkFwcE1hcFthcHBJbmZvLm5hbWVdO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgYmVmb3JlTW91bnQoYXBwSW5mbykge1xuICAgICAgICBzdWJBcHBNYXBbYXBwSW5mby5uYW1lXS5zdWJBcHBCZWZvcmVNb3VudChhcHBJbmZvLmVudHJ5KTtcbiAgICAgIH0sXG4gICAgICBiZWZvcmVVbm1vdW50KGFwcEluZm8pIHtcbiAgICAgICAgc3ViQXBwTWFwW2FwcEluZm8ubmFtZV0uc3ViQXBwVW5tb3VudChhcHBJbmZvLmVudHJ5KTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xufVxuXG4vLyBzcmMvcGx1Z2lucy9sb2dnZXIudHNcbmltcG9ydCB7IGNvcmVMb2cgYXMgY29yZUxvZzIgfSBmcm9tIFwiQGdhcmZpc2gvdXRpbHNcIjtcbmZ1bmN0aW9uIEdhcmZpc2hMb2dnZXIoKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogXCJnYXJmaXNoLWxvZ2dlclwiLFxuICAgICAgdmVyc2lvbjogXCIxLjE2LjJcIixcbiAgICAgIGJlZm9yZUxvYWQoYXBwSW5mbywgLi4uYXJncykge1xuICAgICAgICBjb3JlTG9nMihgJHthcHBJbmZvLm5hbWV9IGJlZm9yZUxvYWRgLCBbYXBwSW5mbywgLi4uYXJnc10pO1xuICAgICAgfSxcbiAgICAgIGFmdGVyTG9hZChhcHBJbmZvLCBhcHBJbnN0YW5jZSwgLi4uYXJncykge1xuICAgICAgICBpZiAoYXBwSW5zdGFuY2UpIHtcbiAgICAgICAgICBjb3JlTG9nMihgJHthcHBJbmZvLm5hbWV9IGlkOiAke2FwcEluc3RhbmNlLmFwcElkfSBhZnRlckxvYWRgLCBbXG4gICAgICAgICAgICBhcHBJbmZvLFxuICAgICAgICAgICAgLi4uYXJnc1xuICAgICAgICAgIF0pO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgYmVmb3JlTW91bnQoYXBwSW5mbywgYXBwSW5zdGFuY2UsIC4uLmFyZ3MpIHtcbiAgICAgICAgY29yZUxvZzIoYCR7YXBwSW5mby5uYW1lfSBpZDogJHthcHBJbnN0YW5jZS5hcHBJZH0gYmVmb3JlTW91bnRgLCBbXG4gICAgICAgICAgYXBwSW5mbyxcbiAgICAgICAgICAuLi5hcmdzXG4gICAgICAgIF0pO1xuICAgICAgfSxcbiAgICAgIGFmdGVyTW91bnQoYXBwSW5mbywgYXBwSW5zdGFuY2UsIC4uLmFyZ3MpIHtcbiAgICAgICAgY29yZUxvZzIoYCR7YXBwSW5mby5uYW1lfSBpZDogJHthcHBJbnN0YW5jZS5hcHBJZH0gYWZ0ZXJNb3VudGAsIFtcbiAgICAgICAgICBhcHBJbmZvLFxuICAgICAgICAgIC4uLmFyZ3NcbiAgICAgICAgXSk7XG4gICAgICB9LFxuICAgICAgYmVmb3JlVW5tb3VudChhcHBJbmZvLCBhcHBJbnN0YW5jZSwgLi4uYXJncykge1xuICAgICAgICBjb3JlTG9nMihgJHthcHBJbmZvLm5hbWV9IGlkOiAke2FwcEluc3RhbmNlLmFwcElkfSBiZWZvcmVVbm1vdW50YCwgW1xuICAgICAgICAgIGFwcEluZm8sXG4gICAgICAgICAgLi4uYXJnc1xuICAgICAgICBdKTtcbiAgICAgIH0sXG4gICAgICBhZnRlclVubW91bnQoYXBwSW5mbywgYXBwSW5zdGFuY2UsIC4uLmFyZ3MpIHtcbiAgICAgICAgY29yZUxvZzIoYCR7YXBwSW5mby5uYW1lfSBpZDogJHthcHBJbnN0YW5jZS5hcHBJZH0gYWZ0ZXJVbm1vdW50YCwgW1xuICAgICAgICAgIGFwcEluZm8sXG4gICAgICAgICAgLi4uYXJnc1xuICAgICAgICBdKTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xufVxuXG4vLyBzcmMvZ2FyZmlzaC50c1xudmFyIERFRkFVTFRfUFJPUFMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTtcbnZhciBIT09LU19BUEkgPSB7XG4gIFN5bmNIb29rOiBTeW5jSG9vazIsXG4gIEFzeW5jSG9vazogQXN5bmNIb29rMixcbiAgU3luY1dhdGVyZmFsbEhvb2s6IFN5bmNXYXRlcmZhbGxIb29rMixcbiAgQXN5bmNXYXRlcmZhbGxIb29rXG59O1xudmFyIEdhcmZpc2ggPSBjbGFzcyBleHRlbmRzIEV2ZW50RW1pdHRlcjIge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLnJ1bm5pbmcgPSBmYWxzZTtcbiAgICB0aGlzLnZlcnNpb24gPSBcIjEuMTYuMlwiO1xuICAgIHRoaXMuZmxhZyA9IF9fR0FSRklTSF9GTEFHX187XG4gICAgdGhpcy5sb2FkZXIgPSBuZXcgTG9hZGVyMigpO1xuICAgIHRoaXMuaG9va3MgPSBnbG9iYWxMaWZlY3ljbGUoKTtcbiAgICB0aGlzLmNoYW5uZWwgPSBuZXcgRXZlbnRFbWl0dGVyMigpO1xuICAgIHRoaXMub3B0aW9ucyA9IGNyZWF0ZURlZmF1bHRPcHRpb25zKCk7XG4gICAgdGhpcy5leHRlcm5hbHMgPSB7fTtcbiAgICB0aGlzLmFjdGl2ZUFwcHMgPSBbXTtcbiAgICB0aGlzLnBsdWdpbnMgPSB7fTtcbiAgICB0aGlzLmNhY2hlQXBwcyA9IHt9O1xuICAgIHRoaXMuYXBwSW5mb3MgPSB7fTtcbiAgICB0aGlzLmxvYWRpbmcgPSB7fTtcbiAgICB2YXIgX2E7XG4gICAgdGhpcy5zZXRPcHRpb25zKG9wdGlvbnMpO1xuICAgIERFRkFVTFRfUFJPUFMuc2V0KHRoaXMsIHt9KTtcbiAgICAoX2EgPSB0aGlzLm9wdGlvbnMucGx1Z2lucykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmZvckVhY2goKHBsdWdpbikgPT4gdGhpcy51c2VQbHVnaW4ocGx1Z2luKSk7XG4gICAgdGhpcy51c2VQbHVnaW4oR2FyZmlzaEhNUlBsdWdpbigpKTtcbiAgICB0aGlzLnVzZVBsdWdpbihHYXJmaXNoUGVyZm9ybWFuY2UoKSk7XG4gICAgdGhpcy51c2VQbHVnaW4oR2FyZmlzaFByZWxvYWRQbHVnaW4oKSk7XG4gICAgdGhpcy51c2VQbHVnaW4oR2FyZmlzaExvZ2dlcigpKTtcbiAgfVxuICBnZXQgcHJvcHMoKSB7XG4gICAgcmV0dXJuIHRoaXMub3B0aW9ucyAmJiB0aGlzLm9wdGlvbnMucHJvcHMgfHwgREVGQVVMVF9QUk9QUy5nZXQodGhpcyk7XG4gIH1cbiAgc2V0T3B0aW9ucyhvcHRpb25zKSB7XG4gICAgYXNzZXJ0NCghdGhpcy5ydW5uaW5nLCBcIkdhcmZpc2ggaXMgcnVubmluZywgY2FuYHQgc2V0IG9wdGlvbnNcIik7XG4gICAgaWYgKGlzUGxhaW5PYmplY3Qob3B0aW9ucykpIHtcbiAgICAgIHRoaXMub3B0aW9ucyA9IGRlZXBNZXJnZUNvbmZpZyh0aGlzLm9wdGlvbnMsIG9wdGlvbnMpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBjcmVhdGVQbHVnaW5TeXN0ZW0oY2FsbGJhY2spIHtcbiAgICBjb25zdCBob29rcyA9IGNhbGxiYWNrKEhPT0tTX0FQSSk7XG4gICAgcmV0dXJuIG5ldyBQbHVnaW5TeXN0ZW0yKGhvb2tzKTtcbiAgfVxuICB1c2VQbHVnaW4ocGx1Z2luLCAuLi5hcmdzKSB7XG4gICAgYXNzZXJ0NCghdGhpcy5ydW5uaW5nLCBcIkNhbm5vdCByZWdpc3RlciBwbHVnaW4gYWZ0ZXIgR2FyZmlzaCBpcyBzdGFydGVkLlwiKTtcbiAgICBhc3NlcnQ0KHR5cGVvZiBwbHVnaW4gPT09IFwiZnVuY3Rpb25cIiwgXCJQbHVnaW4gbXVzdCBiZSBhIGZ1bmN0aW9uLlwiKTtcbiAgICBhcmdzLnVuc2hpZnQodGhpcyk7XG4gICAgY29uc3QgcGx1Z2luQ29uZmlnID0gcGx1Z2luLmFwcGx5KG51bGwsIGFyZ3MpO1xuICAgIGFzc2VydDQocGx1Z2luQ29uZmlnLm5hbWUsIFwiVGhlIHBsdWdpbiBtdXN0IGhhdmUgYSBuYW1lLlwiKTtcbiAgICBpZiAoIXRoaXMucGx1Z2luc1twbHVnaW5Db25maWcubmFtZV0pIHtcbiAgICAgIHRoaXMucGx1Z2luc1twbHVnaW5Db25maWcubmFtZV0gPSBwbHVnaW5Db25maWc7XG4gICAgICB0aGlzLmhvb2tzLnVzZVBsdWdpbihwbHVnaW5Db25maWcpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPyBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgOiBmYWxzZSkge1xuICAgICAgd2FybjUoXCJQbGVhc2UgZG8gbm90IHJlZ2lzdGVyIHRoZSBwbHVnaW4gcmVwZWF0ZWRseS5cIik7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIHJ1bihvcHRpb25zID0ge30pIHtcbiAgICB2YXIgX2E7XG4gICAgaWYgKHRoaXMucnVubmluZykge1xuICAgICAgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID8gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiIDogZmFsc2UpIHtcbiAgICAgICAgd2FybjUoXCJHYXJmaXNoIGlzIGFscmVhZHkgcnVubmluZyBub3csIENhbm5vdCBydW4gR2FyZmlzaCByZXBlYXRlZGx5LlwiKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB0aGlzLnNldE9wdGlvbnMob3B0aW9ucyk7XG4gICAgKF9hID0gb3B0aW9ucy5wbHVnaW5zKSA9PSBudWxsID8gdm9pZCAwIDogX2EuZm9yRWFjaCgocGx1Z2luKSA9PiB0aGlzLnVzZVBsdWdpbihwbHVnaW4pKTtcbiAgICB0aGlzLnVzZVBsdWdpbihHYXJmaXNoT3B0aW9uc0xpZmUodGhpcy5vcHRpb25zLCBcImdsb2JhbC1saWZlY3ljbGVcIikpO1xuICAgIHRoaXMuaG9va3MubGlmZWN5Y2xlLmJlZm9yZUJvb3RzdHJhcC5lbWl0KHRoaXMub3B0aW9ucyk7XG4gICAgdGhpcy5yZWdpc3RlckFwcCh0aGlzLm9wdGlvbnMuYXBwcyB8fCBbXSk7XG4gICAgdGhpcy5ydW5uaW5nID0gdHJ1ZTtcbiAgICB0aGlzLmhvb2tzLmxpZmVjeWNsZS5ib290c3RyYXAuZW1pdCh0aGlzLm9wdGlvbnMpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIHJlZ2lzdGVyQXBwKGxpc3QpIHtcbiAgICBjb25zdCBjdXJyZW50QWRkcyA9IHt9O1xuICAgIHRoaXMuaG9va3MubGlmZWN5Y2xlLmJlZm9yZVJlZ2lzdGVyQXBwLmVtaXQobGlzdCk7XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGxpc3QpKVxuICAgICAgbGlzdCA9IFtsaXN0XTtcbiAgICBmb3IgKGNvbnN0IGFwcEluZm8gb2YgbGlzdCkge1xuICAgICAgYXNzZXJ0NChhcHBJbmZvLm5hbWUsIFwiTWlzcyBhcHAubmFtZS5cIik7XG4gICAgICBpZiAoIXRoaXMuYXBwSW5mb3NbYXBwSW5mby5uYW1lXSkge1xuICAgICAgICBhc3NlcnQ0KGFwcEluZm8uZW50cnksIGAke2FwcEluZm8ubmFtZX0gYXBwbGljYXRpb24gZW50cnkgaXMgbm90IHVybDogJHthcHBJbmZvLmVudHJ5fWApO1xuICAgICAgICBjdXJyZW50QWRkc1thcHBJbmZvLm5hbWVdID0gYXBwSW5mbztcbiAgICAgICAgdGhpcy5hcHBJbmZvc1thcHBJbmZvLm5hbWVdID0gYXBwSW5mbztcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPyBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgOiBmYWxzZSkge1xuICAgICAgICB3YXJuNShgVGhlIFwiJHthcHBJbmZvLm5hbWV9XCIgYXBwIGlzIGFscmVhZHkgcmVnaXN0ZXJlZC5gKTtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5ob29rcy5saWZlY3ljbGUucmVnaXN0ZXJBcHAuZW1pdChjdXJyZW50QWRkcyk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgc2V0RXh0ZXJuYWwobmFtZU9yRXh0T2JqLCB2YWx1ZSkge1xuICAgIGFzc2VydDQobmFtZU9yRXh0T2JqLCBcIkludmFsaWQgcGFyYW1ldGVyLlwiKTtcbiAgICBpZiAodHlwZW9mIG5hbWVPckV4dE9iaiA9PT0gXCJvYmplY3RcIikge1xuICAgICAgZm9yIChjb25zdCBrZXkgaW4gbmFtZU9yRXh0T2JqKSB7XG4gICAgICAgIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudiAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViA/IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA6IGZhbHNlKSB7XG4gICAgICAgICAgdGhpcy5leHRlcm5hbHNba2V5XSAmJiB3YXJuNShgVGhlIFwiJHtrZXl9XCIgd2lsbCBiZSBvdmVyd3JpdHRlbiBpbiBleHRlcm5hbC5gKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmV4dGVybmFsc1trZXldID0gbmFtZU9yRXh0T2JqW2tleV07XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZXh0ZXJuYWxzW25hbWVPckV4dE9ial0gPSB2YWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgbG9hZEFwcChhcHBOYW1lLCBvcHRpb25zKSB7XG4gICAgYXNzZXJ0NChhcHBOYW1lLCBcIk1pc3MgYXBwTmFtZS5cIik7XG4gICAgbGV0IGFwcEluZm8gPSBnZW5lcmF0ZUFwcE9wdGlvbnMoYXBwTmFtZSwgdGhpcywgb3B0aW9ucyk7XG4gICAgY29uc3QgYXN5bmNMb2FkUHJvY2VzcyA9IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN0b3AgPSBhd2FpdCB0aGlzLmhvb2tzLmxpZmVjeWNsZS5iZWZvcmVMb2FkLmVtaXQoYXBwSW5mbyk7XG4gICAgICBpZiAoc3RvcCA9PT0gZmFsc2UpIHtcbiAgICAgICAgd2FybjUoYExvYWQgJHthcHBOYW1lfSBhcHBsaWNhdGlvbiBpcyB0ZXJtaW5hdGVkIGJ5IGJlZm9yZUxvYWQuYCk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgYXBwSW5mbyA9IGdlbmVyYXRlQXBwT3B0aW9ucyhhcHBOYW1lLCB0aGlzLCBhcHBJbmZvKTtcbiAgICAgIGFzc2VydDQoYXBwSW5mby5lbnRyeSwgYENhbid0IGxvYWQgdW5leHBlY3RlZCBjaGlsZCBhcHAgXCIke2FwcE5hbWV9XCIsIFBsZWFzZSBwcm92aWRlIHRoZSBlbnRyeSBwYXJhbWV0ZXJzIG9yIHJlZ2lzdGVyZWQgaW4gYWR2YW5jZSBvZiB0aGUgYXBwLmApO1xuICAgICAgbGV0IGFwcEluc3RhbmNlID0gbnVsbDtcbiAgICAgIGNvbnN0IGNhY2hlQXBwID0gdGhpcy5jYWNoZUFwcHNbYXBwTmFtZV07XG4gICAgICBpZiAoYXBwSW5mby5jYWNoZSAmJiBjYWNoZUFwcCkge1xuICAgICAgICBhcHBJbnN0YW5jZSA9IGNhY2hlQXBwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBbbWFuYWdlciwgcmVzb3VyY2VzLCBpc0h0bWxNb2RlXSA9IGF3YWl0IHByb2Nlc3NBcHBSZXNvdXJjZXModGhpcy5sb2FkZXIsIGFwcEluZm8pO1xuICAgICAgICAgIGFwcEluc3RhbmNlID0gbmV3IEFwcCh0aGlzLCBhcHBJbmZvLCBtYW5hZ2VyLCByZXNvdXJjZXMsIGlzSHRtbE1vZGUsIGFwcEluZm8uY3VzdG9tTG9hZGVyKTtcbiAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLnBsdWdpbnMpIHtcbiAgICAgICAgICAgIGFwcEluc3RhbmNlLmhvb2tzLnVzZVBsdWdpbih0aGlzLnBsdWdpbnNba2V5XSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChhcHBJbmZvLmNhY2hlKSB7XG4gICAgICAgICAgICB0aGlzLmNhY2hlQXBwc1thcHBOYW1lXSA9IGFwcEluc3RhbmNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudiAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViA/IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA6IGZhbHNlKSAmJiB3YXJuNShlKTtcbiAgICAgICAgICB0aGlzLmhvb2tzLmxpZmVjeWNsZS5lcnJvckxvYWRBcHAuZW1pdChlLCBhcHBJbmZvKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgYXdhaXQgdGhpcy5ob29rcy5saWZlY3ljbGUuYWZ0ZXJMb2FkLmVtaXQoYXBwSW5mbywgYXBwSW5zdGFuY2UpO1xuICAgICAgcmV0dXJuIGFwcEluc3RhbmNlO1xuICAgIH07XG4gICAgaWYgKCF0aGlzLmxvYWRpbmdbYXBwTmFtZV0pIHtcbiAgICAgIHRoaXMubG9hZGluZ1thcHBOYW1lXSA9IGFzeW5jTG9hZFByb2Nlc3MoKS5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgZGVsZXRlIHRoaXMubG9hZGluZ1thcHBOYW1lXTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5sb2FkaW5nW2FwcE5hbWVdO1xuICB9XG59O1xuZXhwb3J0IHtcbiAgR2FyZmlzaCBhcyBkZWZhdWx0XG59O1xuIiwiLy8gc3JjL3N5bmNIb29rLnRzXG5pbXBvcnQgeyB3YXJuIH0gZnJvbSBcIkBnYXJmaXNoL3V0aWxzXCI7XG52YXIgU3luY0hvb2sgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHR5cGUpIHtcbiAgICB0aGlzLnR5cGUgPSBcIlwiO1xuICAgIHRoaXMubGlzdGVuZXJzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbiAgICBpZiAodHlwZSlcbiAgICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gIH1cbiAgb24oZm4pIHtcbiAgICBpZiAodHlwZW9mIGZuID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHRoaXMubGlzdGVuZXJzLmFkZChmbik7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudiAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViA/IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA6IGZhbHNlKSB7XG4gICAgICB3YXJuKCdJbnZhbGlkIHBhcmFtZXRlciBpbiBcIkhvb2tcIi4nKTtcbiAgICB9XG4gIH1cbiAgb25jZShmbikge1xuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuICAgIHRoaXMub24oZnVuY3Rpb24gd3JhcHBlciguLi5hcmdzKSB7XG4gICAgICBzZWxmLnJlbW92ZSh3cmFwcGVyKTtcbiAgICAgIHJldHVybiBmbi5hcHBseShudWxsLCBhcmdzKTtcbiAgICB9KTtcbiAgfVxuICBlbWl0KC4uLmRhdGEpIHtcbiAgICBpZiAodGhpcy5saXN0ZW5lcnMuc2l6ZSA+IDApIHtcbiAgICAgIHRoaXMubGlzdGVuZXJzLmZvckVhY2goKGZuKSA9PiBmbi5hcHBseShudWxsLCBkYXRhKSk7XG4gICAgfVxuICB9XG4gIHJlbW92ZShmbikge1xuICAgIHJldHVybiB0aGlzLmxpc3RlbmVycy5kZWxldGUoZm4pO1xuICB9XG4gIHJlbW92ZUFsbCgpIHtcbiAgICB0aGlzLmxpc3RlbmVycy5jbGVhcigpO1xuICB9XG59O1xuXG4vLyBzcmMvYXN5bmNIb29rLnRzXG52YXIgQXN5bmNIb29rID0gY2xhc3MgZXh0ZW5kcyBTeW5jSG9vayB7XG4gIGVtaXQoLi4uZGF0YSkge1xuICAgIGxldCByZXN1bHQ7XG4gICAgY29uc3QgbHMgPSBBcnJheS5mcm9tKHRoaXMubGlzdGVuZXJzKTtcbiAgICBpZiAobHMubGVuZ3RoID4gMCkge1xuICAgICAgbGV0IGkgPSAwO1xuICAgICAgY29uc3QgY2FsbCA9IChwcmV2KSA9PiB7XG4gICAgICAgIGlmIChwcmV2ID09PSBmYWxzZSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSBlbHNlIGlmIChpIDwgbHMubGVuZ3RoKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShsc1tpKytdLmFwcGx5KG51bGwsIGRhdGEpKS50aGVuKGNhbGwpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBwcmV2O1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgcmVzdWx0ID0gY2FsbCgpO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3VsdCk7XG4gIH1cbn07XG5cbi8vIHNyYy9zeW5jV2F0ZXJmYWxsSG9vay50c1xuaW1wb3J0IHsgd2FybiBhcyB3YXJuMiwgZXJyb3IsIGlzT2JqZWN0IH0gZnJvbSBcIkBnYXJmaXNoL3V0aWxzXCI7XG5mdW5jdGlvbiBjaGVja1JldHVybkRhdGEob3JpZ2luRGF0YSwgcmV0dXJuRGF0YSkge1xuICBpZiAoIWlzT2JqZWN0KHJldHVybkRhdGEpKVxuICAgIHJldHVybiBmYWxzZTtcbiAgaWYgKG9yaWdpbkRhdGEgIT09IHJldHVybkRhdGEpIHtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBvcmlnaW5EYXRhKSB7XG4gICAgICBpZiAoIShrZXkgaW4gcmV0dXJuRGF0YSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cbnZhciBTeW5jV2F0ZXJmYWxsSG9vayA9IGNsYXNzIGV4dGVuZHMgU3luY0hvb2sge1xuICBjb25zdHJ1Y3Rvcih0eXBlKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLm9uZXJyb3IgPSBlcnJvcjtcbiAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICB9XG4gIGVtaXQoZGF0YSkge1xuICAgIGlmICghaXNPYmplY3QoZGF0YSkpIHtcbiAgICAgIGVycm9yKGBcIiR7dGhpcy50eXBlfVwiIGhvb2sgcmVzcG9uc2UgZGF0YSBtdXN0IGJlIGFuIG9iamVjdC5gKTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBmbiBvZiB0aGlzLmxpc3RlbmVycykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdGVtcERhdGEgPSBmbihkYXRhKTtcbiAgICAgICAgaWYgKGNoZWNrUmV0dXJuRGF0YShkYXRhLCB0ZW1wRGF0YSkpIHtcbiAgICAgICAgICBkYXRhID0gdGVtcERhdGE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5vbmVycm9yKGBUaGUgcmV0dXJuIHZhbHVlIG9mIGhvb2sgXCIke3RoaXMudHlwZX1cIiBpcyBpbmNvcnJlY3QuYCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID8gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiIDogZmFsc2UpICYmIHdhcm4yKGUpO1xuICAgICAgICB0aGlzLm9uZXJyb3IoZSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBkYXRhO1xuICB9XG59O1xuXG4vLyBzcmMvYXN5bmNXYXRlcmZhbGxIb29rcy50c1xuaW1wb3J0IHsgd2FybiBhcyB3YXJuMywgZXJyb3IgYXMgZXJyb3IyLCBpc09iamVjdCBhcyBpc09iamVjdDIgfSBmcm9tIFwiQGdhcmZpc2gvdXRpbHNcIjtcbnZhciBBc3luY1dhdGVyZmFsbEhvb2sgPSBjbGFzcyBleHRlbmRzIFN5bmNIb29rIHtcbiAgY29uc3RydWN0b3IodHlwZSkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5vbmVycm9yID0gZXJyb3IyO1xuICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gIH1cbiAgZW1pdChkYXRhKSB7XG4gICAgaWYgKCFpc09iamVjdDIoZGF0YSkpIHtcbiAgICAgIGVycm9yMihgXCIke3RoaXMudHlwZX1cIiBob29rIHJlc3BvbnNlIGRhdGEgbXVzdCBiZSBhbiBvYmplY3QuYCk7XG4gICAgfVxuICAgIGNvbnN0IGxzID0gQXJyYXkuZnJvbSh0aGlzLmxpc3RlbmVycyk7XG4gICAgaWYgKGxzLmxlbmd0aCA+IDApIHtcbiAgICAgIGxldCBpID0gMDtcbiAgICAgIGNvbnN0IHByb2Nlc3NFcnJvciA9IChlKSA9PiB7XG4gICAgICAgICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudiAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViA/IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA6IGZhbHNlKSAmJiB3YXJuMyhlKTtcbiAgICAgICAgdGhpcy5vbmVycm9yKGUpO1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgIH07XG4gICAgICBjb25zdCBjYWxsID0gKHByZXZEYXRhKSA9PiB7XG4gICAgICAgIGlmIChwcmV2RGF0YSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0gZWxzZSBpZiAoY2hlY2tSZXR1cm5EYXRhKGRhdGEsIHByZXZEYXRhKSkge1xuICAgICAgICAgIGRhdGEgPSBwcmV2RGF0YTtcbiAgICAgICAgICBpZiAoaSA8IGxzLmxlbmd0aCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShsc1tpKytdKGRhdGEpKS50aGVuKGNhbGwsIHByb2Nlc3NFcnJvcik7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgIHJldHVybiBwcm9jZXNzRXJyb3IoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMub25lcnJvcihgVGhlIHJldHVybiB2YWx1ZSBvZiBob29rIFwiJHt0aGlzLnR5cGV9XCIgaXMgaW5jb3JyZWN0LmApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoY2FsbChkYXRhKSk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZGF0YSk7XG4gIH1cbn07XG5cbi8vIHNyYy9wbHVnaW5TeXN0ZW0udHNcbmltcG9ydCB7IHdhcm4gYXMgd2FybjQsIGFzc2VydCwgaXNQbGFpbk9iamVjdCB9IGZyb20gXCJAZ2FyZmlzaC91dGlsc1wiO1xudmFyIFBsdWdpblN5c3RlbSA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IobGlmZWN5Y2xlKSB7XG4gICAgdGhpcy5yZWdpc3RlclBsdWdpbnMgPSB7fTtcbiAgICB0aGlzLmxpZmVjeWNsZSA9IGxpZmVjeWNsZTtcbiAgICB0aGlzLmxpZmVjeWNsZUtleXMgPSBPYmplY3Qua2V5cyhsaWZlY3ljbGUpO1xuICB9XG4gIHVzZVBsdWdpbihwbHVnaW4pIHtcbiAgICBhc3NlcnQoaXNQbGFpbk9iamVjdChwbHVnaW4pLCBcIkludmFsaWQgcGx1Z2luIGNvbmZpZ3VyYXRpb24uXCIpO1xuICAgIGNvbnN0IHBsdWdpbk5hbWUgPSBwbHVnaW4ubmFtZTtcbiAgICBhc3NlcnQocGx1Z2luTmFtZSwgXCJQbHVnaW4gbXVzdCBwcm92aWRlIGEgbmFtZS5cIik7XG4gICAgaWYgKCF0aGlzLnJlZ2lzdGVyUGx1Z2luc1twbHVnaW5OYW1lXSkge1xuICAgICAgdGhpcy5yZWdpc3RlclBsdWdpbnNbcGx1Z2luTmFtZV0gPSBwbHVnaW47XG4gICAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLmxpZmVjeWNsZSkge1xuICAgICAgICBjb25zdCBwbHVnaW5MaWZlID0gcGx1Z2luW2tleV07XG4gICAgICAgIGlmIChwbHVnaW5MaWZlKSB7XG4gICAgICAgICAgdGhpcy5saWZlY3ljbGVba2V5XS5vbihwbHVnaW5MaWZlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB3YXJuNChgUmVwZWF0IHRvIHJlZ2lzdGVyIHBsdWdpbiBob29rcyBcIiR7cGx1Z2luTmFtZX1cIi5gKTtcbiAgICB9XG4gIH1cbiAgcmVtb3ZlUGx1Z2luKHBsdWdpbk5hbWUpIHtcbiAgICBhc3NlcnQocGx1Z2luTmFtZSwgXCJNdXN0IHByb3ZpZGUgYSBuYW1lLlwiKTtcbiAgICBjb25zdCBwbHVnaW4gPSB0aGlzLnJlZ2lzdGVyUGx1Z2luc1twbHVnaW5OYW1lXTtcbiAgICBhc3NlcnQocGx1Z2luLCBgcGx1Z2luIFwiJHtwbHVnaW5OYW1lfVwiIGlzIG5vdCByZWdpc3RlcmVkLmApO1xuICAgIGZvciAoY29uc3Qga2V5IGluIHBsdWdpbikge1xuICAgICAgaWYgKGtleSA9PT0gXCJuYW1lXCIpXG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgdGhpcy5saWZlY3ljbGVba2V5XS5yZW1vdmUocGx1Z2luW2tleV0pO1xuICAgIH1cbiAgfVxuICBpbmhlcml0KHsgbGlmZWN5Y2xlLCByZWdpc3RlclBsdWdpbnMgfSkge1xuICAgIGZvciAoY29uc3QgaG9va05hbWUgaW4gbGlmZWN5Y2xlKSB7XG4gICAgICBhc3NlcnQoIXRoaXMubGlmZWN5Y2xlW2hvb2tOYW1lXSwgYFwiJHtob29rTmFtZX1cIiBob29rIGhhcyBjb25mbGljdCBhbmQgY2Fubm90IGJlIGluaGVyaXRlZC5gKTtcbiAgICAgIHRoaXMubGlmZWN5Y2xlW2hvb2tOYW1lXSA9IGxpZmVjeWNsZVtob29rTmFtZV07XG4gICAgfVxuICAgIGZvciAoY29uc3QgcGx1Z2luTmFtZSBpbiByZWdpc3RlclBsdWdpbnMpIHtcbiAgICAgIGFzc2VydCghdGhpcy5yZWdpc3RlclBsdWdpbnNbcGx1Z2luTmFtZV0sIGBcIiR7cGx1Z2luTmFtZX1cIiBwbHVnaW4gaGFzIGNvbmZsaWN0IGFuZCBjYW5ub3QgYmUgaW5oZXJpdGVkLmApO1xuICAgICAgdGhpcy51c2VQbHVnaW4ocmVnaXN0ZXJQbHVnaW5zW3BsdWdpbk5hbWVdKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbn07XG5leHBvcnQge1xuICBBc3luY0hvb2ssXG4gIEFzeW5jV2F0ZXJmYWxsSG9vayxcbiAgUGx1Z2luU3lzdGVtLFxuICBTeW5jSG9vayxcbiAgU3luY1dhdGVyZmFsbEhvb2tcbn07XG4iLCJ2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xudmFyIF9fZ2V0T3duUHJvcFN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzO1xudmFyIF9faGFzT3duUHJvcCA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG52YXIgX19wcm9wSXNFbnVtID0gT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZTtcbnZhciBfX2RlZk5vcm1hbFByb3AgPSAob2JqLCBrZXksIHZhbHVlKSA9PiBrZXkgaW4gb2JqID8gX19kZWZQcm9wKG9iaiwga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUsIHZhbHVlIH0pIDogb2JqW2tleV0gPSB2YWx1ZTtcbnZhciBfX3NwcmVhZFZhbHVlcyA9IChhLCBiKSA9PiB7XG4gIGZvciAodmFyIHByb3AgaW4gYiB8fCAoYiA9IHt9KSlcbiAgICBpZiAoX19oYXNPd25Qcm9wLmNhbGwoYiwgcHJvcCkpXG4gICAgICBfX2RlZk5vcm1hbFByb3AoYSwgcHJvcCwgYltwcm9wXSk7XG4gIGlmIChfX2dldE93blByb3BTeW1ib2xzKVxuICAgIGZvciAodmFyIHByb3Agb2YgX19nZXRPd25Qcm9wU3ltYm9scyhiKSkge1xuICAgICAgaWYgKF9fcHJvcElzRW51bS5jYWxsKGIsIHByb3ApKVxuICAgICAgICBfX2RlZk5vcm1hbFByb3AoYSwgcHJvcCwgYltwcm9wXSk7XG4gICAgfVxuICByZXR1cm4gYTtcbn07XG5cbi8vIHNyYy9pbmRleC50c1xuaW1wb3J0IHtcbiAgU3luY0hvb2ssXG4gIFN5bmNXYXRlcmZhbGxIb29rLFxuICBQbHVnaW5TeXN0ZW0sXG4gIEFzeW5jSG9va1xufSBmcm9tIFwiQGdhcmZpc2gvaG9va3NcIjtcbmltcG9ydCB7XG4gIGVycm9yIGFzIGVycm9yMixcbiAgbWFjcm9UYXNrLFxuICBfX0xPQURFUl9GTEFHX18sXG4gIGlzSnNUeXBlLFxuICBpc0Nzc1R5cGUsXG4gIGlzSHRtbFR5cGVcbn0gZnJvbSBcIkBnYXJmaXNoL3V0aWxzXCI7XG5cbi8vIHNyYy9tYW5hZ2Vycy9zdHlsZS50c1xuaW1wb3J0IHsgaXNBYnNvbHV0ZSwgdHJhbnNmb3JtVXJsIH0gZnJvbSBcIkBnYXJmaXNoL3V0aWxzXCI7XG52YXIgTUFUQ0hfQ1NTX1VSTCA9IC91cmxcXChcXHMqKFsnXCJdKT8oLio/KVxcMVxccypcXCkvZztcbnZhciBNQVRDSF9DSEFSU0VUX1VSTCA9IC9AY2hhcnNldFxccysoWydcIl0pKC4qPylcXDFcXHMqOz8vZztcbnZhciBNQVRDSF9JTVBPUlRfVVJMID0gL0BpbXBvcnRcXHMrKFsnXCJdKSguKj8pXFwxL2c7XG52YXIgU3R5bGVNYW5hZ2VyID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihzdHlsZUNvZGUsIHVybCkge1xuICAgIHRoaXMuZGVwc1N0YWNrID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbiAgICB0aGlzLnNjb3BlRGF0YSA9IG51bGw7XG4gICAgdGhpcy51cmwgPSB1cmwgfHwgbnVsbDtcbiAgICB0aGlzLnN0eWxlQ29kZSA9IHN0eWxlQ29kZTtcbiAgfVxuICBjb3JyZWN0UGF0aChiYXNlVXJsKSB7XG4gICAgY29uc3QgeyB1cmwsIHN0eWxlQ29kZSB9ID0gdGhpcztcbiAgICBpZiAoIWJhc2VVcmwpXG4gICAgICBiYXNlVXJsID0gdXJsO1xuICAgIGlmIChiYXNlVXJsICYmIHR5cGVvZiBzdHlsZUNvZGUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIHRoaXMuc3R5bGVDb2RlID0gc3R5bGVDb2RlLnJlcGxhY2UoTUFUQ0hfQ0hBUlNFVF9VUkwsIFwiXCIpLnJlcGxhY2UoTUFUQ0hfSU1QT1JUX1VSTCwgZnVuY3Rpb24oazAsIGsxLCBrMikge1xuICAgICAgICByZXR1cm4gazIgPyBgQGltcG9ydCB1cmwoJHtrMX0ke2syfSR7azF9KWAgOiBrMDtcbiAgICAgIH0pLnJlcGxhY2UoTUFUQ0hfQ1NTX1VSTCwgKGswLCBrMSwgazIpID0+IHtcbiAgICAgICAgaWYgKGlzQWJzb2x1dGUoazIpKVxuICAgICAgICAgIHJldHVybiBrMDtcbiAgICAgICAgcmV0dXJuIGB1cmwoXCIke2Jhc2VVcmwgPyB0cmFuc2Zvcm1VcmwoYmFzZVVybCwgazIpIDogazJ9XCIpYDtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICB0cmFuc2Zvcm1Db2RlKGNvZGUpIHtcbiAgICByZXR1cm4gY29kZTtcbiAgfVxuICBzZXREZXAobm9kZSkge1xuICAgIHRoaXMuZGVwc1N0YWNrLmFkZChub2RlKTtcbiAgfVxuICBzZXRTY29wZShkYXRhKSB7XG4gICAgdGhpcy5zY29wZURhdGEgPSBkYXRhO1xuICB9XG4gIGlzU2FtZU9yaWdpbihub2RlKSB7XG4gICAgcmV0dXJuIHRoaXMuZGVwc1N0YWNrLmhhcyhub2RlKTtcbiAgfVxuICByZW5kZXJBc1N0eWxlRWxlbWVudChleHRyYUNvZGUgPSBcIlwiKSB7XG4gICAgY29uc3Qgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcbiAgICBjb25zdCBjb2RlID0gZXh0cmFDb2RlICsgKHRoaXMuc3R5bGVDb2RlID8gdGhpcy5zdHlsZUNvZGUgOiBcIi8qKmVtcHR5IHN0eWxlKiovXCIpO1xuICAgIG5vZGUuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcInRleHQvY3NzXCIpO1xuICAgIG5vZGUudGV4dENvbnRlbnQgPSB0aGlzLnRyYW5zZm9ybUNvZGUoY29kZSk7XG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cbiAgY2xvbmUoKSB7XG4gICAgY29uc3QgY2xvbmVkID0gbmV3IHRoaXMuY29uc3RydWN0b3IoKTtcbiAgICBjbG9uZWQudXJsID0gdGhpcy51cmw7XG4gICAgY2xvbmVkLnN0eWxlQ29kZSA9IHRoaXMuc3R5bGVDb2RlO1xuICAgIGNsb25lZC5zY29wZURhdGEgPSB0aGlzLnNjb3BlRGF0YTtcbiAgICBjbG9uZWQuZGVwc1N0YWNrID0gbmV3IFNldCh0aGlzLmRlcHNTdGFjayk7XG4gICAgcmV0dXJuIGNsb25lZDtcbiAgfVxufTtcblxuLy8gc3JjL21hbmFnZXJzL21vZHVsZS50c1xudmFyIE1vZHVsZU1hbmFnZXIgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKG1vZHVsZUNvZGUsIHVybCkge1xuICAgIHRoaXMuYWxpYXMgPSBudWxsO1xuICAgIHRoaXMudXJsID0gdXJsIHx8IG51bGw7XG4gICAgdGhpcy5tb2R1bGVDb2RlID0gbW9kdWxlQ29kZTtcbiAgfVxuICBzZXRBbGlhcyhuYW1lKSB7XG4gICAgaWYgKG5hbWUgJiYgdHlwZW9mIG5hbWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIHRoaXMuYWxpYXMgPSBuYW1lO1xuICAgIH1cbiAgfVxuICBjbG9uZSgpIHtcbiAgICBjb25zdCBjbG9uZWQgPSBuZXcgdGhpcy5jb25zdHJ1Y3RvcigpO1xuICAgIGNsb25lZC51cmwgPSB0aGlzLnVybDtcbiAgICBjbG9uZWQuYWxpYXMgPSB0aGlzLmFsaWFzO1xuICAgIGNsb25lZC5tb2R1bGVDb2RlID0gdGhpcy5tb2R1bGVDb2RlO1xuICAgIHJldHVybiBjbG9uZWQ7XG4gIH1cbn07XG5cbi8vIHNyYy9tYW5hZ2Vycy90ZW1wbGF0ZS50c1xuaW1wb3J0IHtcbiAgRE9NQXBpcyxcbiAgZGVlcE1lcmdlLFxuICB0cmFuc2Zvcm1VcmwgYXMgdHJhbnNmb3JtVXJsMixcbiAgdGVtcGxhdGVQYXJzZVxufSBmcm9tIFwiQGdhcmZpc2gvdXRpbHNcIjtcbnZhciBUZW1wbGF0ZU1hbmFnZXIgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHRlbXBsYXRlLCB1cmwpIHtcbiAgICB0aGlzLkRPTUFwaXMgPSBuZXcgRE9NQXBpcygpO1xuICAgIHRoaXMuYXN0VHJlZSA9IFtdO1xuICAgIHRoaXMucHJldHJlYXRtZW50U3RvcmUgPSB7fTtcbiAgICB0aGlzLnVybCA9IHVybDtcbiAgICBpZiAodGVtcGxhdGUpIHtcbiAgICAgIGNvbnN0IFthc3RUcmVlLCBjb2xsZWN0aW9uRWxzXSA9IHRlbXBsYXRlUGFyc2UodGVtcGxhdGUsIFtcbiAgICAgICAgXCJtZXRhXCIsXG4gICAgICAgIFwibGlua1wiLFxuICAgICAgICBcInN0eWxlXCIsXG4gICAgICAgIFwic2NyaXB0XCJcbiAgICAgIF0pO1xuICAgICAgdGhpcy5hc3RUcmVlID0gYXN0VHJlZTtcbiAgICAgIHRoaXMucHJldHJlYXRtZW50U3RvcmUgPSBjb2xsZWN0aW9uRWxzO1xuICAgIH1cbiAgfVxuICBnZXROb2Rlc0J5VGFnTmFtZSguLi50YWdzKSB7XG4gICAgbGV0IGNvdW50ZXIgPSAwO1xuICAgIGNvbnN0IGNvbGxlY3Rpb24gPSB7fTtcbiAgICBmb3IgKGNvbnN0IHRhZyBvZiB0YWdzKSB7XG4gICAgICBpZiAodGhpcy5wcmV0cmVhdG1lbnRTdG9yZVt0YWddKSB7XG4gICAgICAgIGNvdW50ZXIrKztcbiAgICAgICAgY29sbGVjdGlvblt0YWddID0gdGhpcy5wcmV0cmVhdG1lbnRTdG9yZVt0YWddO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29sbGVjdGlvblt0YWddID0gW107XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChjb3VudGVyICE9PSB0YWdzLmxlbmd0aCkge1xuICAgICAgY29uc3QgdHJhdmVyc2UgPSAobm9kZSkgPT4ge1xuICAgICAgICBpZiAobm9kZS50eXBlICE9PSBcImVsZW1lbnRcIilcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIGlmICh0YWdzLmluZGV4T2Yobm9kZS50YWdOYW1lKSA+IC0xICYmICF0aGlzLnByZXRyZWF0bWVudFN0b3JlW25vZGUudGFnTmFtZV0pIHtcbiAgICAgICAgICBjb2xsZWN0aW9uW25vZGUudGFnTmFtZV0ucHVzaChub2RlKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIG5vZGUuY2hpbGRyZW4pXG4gICAgICAgICAgdHJhdmVyc2UoY2hpbGQpO1xuICAgICAgfTtcbiAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiB0aGlzLmFzdFRyZWUpXG4gICAgICAgIHRyYXZlcnNlKG5vZGUpO1xuICAgIH1cbiAgICByZXR1cm4gY29sbGVjdGlvbjtcbiAgfVxuICBjcmVhdGVFbGVtZW50cyhyZW5kZXJlciwgcGFyZW50LCBjb21tb25SZW5kZXIpIHtcbiAgICBjb25zdCBlbGVtZW50cyA9IFtdO1xuICAgIGNvbnN0IHRyYXZlcnNlID0gKG5vZGUsIHBhcmVudEVsKSA9PiB7XG4gICAgICB2YXIgX2E7XG4gICAgICBsZXQgZWw7XG4gICAgICBpZiAodGhpcy5ET01BcGlzLmlzQ29tbWVudE5vZGUobm9kZSkpIHtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5ET01BcGlzLmlzVGV4dChub2RlKSkge1xuICAgICAgICBlbCA9IHRoaXMuRE9NQXBpcy5jcmVhdGVUZXh0Tm9kZShub2RlKTtcbiAgICAgICAgcGFyZW50RWwgJiYgcGFyZW50RWwuYXBwZW5kQ2hpbGQoZWwpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLkRPTUFwaXMuaXNOb2RlKG5vZGUpKSB7XG4gICAgICAgIGNvbnN0IHsgdGFnTmFtZSwgY2hpbGRyZW4gfSA9IG5vZGU7XG4gICAgICAgIGlmICh0eXBlb2YgY29tbW9uUmVuZGVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBlbCA9IChfYSA9IGNvbW1vblJlbmRlcihub2RlLCBwYXJlbnQpKSA9PSBudWxsID8gdm9pZCAwIDogX2EuY3VzdG9tRWxlbWVudDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWVsKSB7XG4gICAgICAgICAgaWYgKHJlbmRlcmVyW3RhZ05hbWVdKSB7XG4gICAgICAgICAgICBlbCA9IHJlbmRlcmVyW3RhZ05hbWVdKG5vZGUpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbCA9IHRoaXMuRE9NQXBpcy5jcmVhdGVFbGVtZW50KG5vZGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyZW50RWwgJiYgZWwpIHtcbiAgICAgICAgICBwYXJlbnRFbC5hcHBlbmRDaGlsZChlbCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGVsKSB7XG4gICAgICAgICAgY29uc3QgeyBub2RlVHlwZSwgX2lnbm9yZUNoaWxkTm9kZXMgfSA9IGVsO1xuICAgICAgICAgIGlmICghX2lnbm9yZUNoaWxkTm9kZXMgJiYgbm9kZVR5cGUgIT09IDggJiYgbm9kZVR5cGUgIT09IDEwKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIGNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgIHRyYXZlcnNlKGNoaWxkLCBlbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZWw7XG4gICAgfTtcbiAgICBmb3IgKGNvbnN0IG5vZGUgb2YgdGhpcy5hc3RUcmVlKSB7XG4gICAgICBpZiAodGhpcy5ET01BcGlzLmlzTm9kZShub2RlKSAmJiBub2RlLnRhZ05hbWUgIT09IFwiIWRvY3R5cGVcIikge1xuICAgICAgICBjb25zdCBlbCA9IHRyYXZlcnNlKG5vZGUsIHBhcmVudCk7XG4gICAgICAgIGVsICYmIGVsZW1lbnRzLnB1c2goZWwpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZWxlbWVudHM7XG4gIH1cbiAgdG9SZXNvbHZlVXJsKG5vZGUsIHR5cGUsIGJhc2VVcmwpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3Qgc3JjID0gKF9hID0gbm9kZS5hdHRyaWJ1dGVzKSA9PSBudWxsID8gdm9pZCAwIDogX2EuZmluZCgoeyBrZXkgfSkgPT4ga2V5ID09PSB0eXBlKTtcbiAgICBpZiAoc3JjICYmIHNyYy52YWx1ZSAmJiBiYXNlVXJsKSB7XG4gICAgICBzcmMudmFsdWUgPSB0cmFuc2Zvcm1VcmwyKGJhc2VVcmwsIHNyYy52YWx1ZSk7XG4gICAgfVxuICB9XG4gIGlnbm9yZUNoaWxkTm9kZXNDcmVhdGlvbihub2RlKSB7XG4gICAgaWYgKG5vZGUpIHtcbiAgICAgIG5vZGUuX2lnbm9yZUNoaWxkTm9kZXMgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gbm9kZTtcbiAgfVxuICBmaW5kQWxsTWV0YU5vZGVzKCkge1xuICAgIHJldHVybiB0aGlzLmdldE5vZGVzQnlUYWdOYW1lKFwibWV0YVwiKS5tZXRhO1xuICB9XG4gIGZpbmRBbGxMaW5rTm9kZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0Tm9kZXNCeVRhZ05hbWUoXCJsaW5rXCIpLmxpbms7XG4gIH1cbiAgZmluZEFsbEpzTm9kZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0Tm9kZXNCeVRhZ05hbWUoXCJzY3JpcHRcIikuc2NyaXB0O1xuICB9XG4gIGZpbmRBdHRyaWJ1dGVWYWx1ZShub2RlLCB0eXBlKSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICByZXR1cm4gKChfYiA9IChfYSA9IG5vZGUuYXR0cmlidXRlcykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmZpbmQoKHsga2V5IH0pID0+IGtleSA9PT0gdHlwZSkpID09IG51bGwgPyB2b2lkIDAgOiBfYi52YWx1ZSkgfHwgdm9pZCAwO1xuICB9XG4gIGNsb25lTm9kZShub2RlKSB7XG4gICAgcmV0dXJuIGRlZXBNZXJnZShub2RlLCB7fSk7XG4gIH1cbiAgY2xvbmUoKSB7XG4gICAgY29uc3QgY2xvbmVkID0gbmV3IHRoaXMuY29uc3RydWN0b3IoKTtcbiAgICBjbG9uZWQudXJsID0gdGhpcy51cmw7XG4gICAgY2xvbmVkLmFzdFRyZWUgPSB0aGlzLmFzdFRyZWU7XG4gICAgY2xvbmVkLnByZXRyZWF0bWVudFN0b3JlID0gdGhpcy5wcmV0cmVhdG1lbnRTdG9yZTtcbiAgICBjbG9uZWQuRE9NQXBpcyA9IG5ldyBET01BcGlzKHRoaXMuRE9NQXBpcy5kb2N1bWVudCk7XG4gICAgcmV0dXJuIGNsb25lZDtcbiAgfVxufTtcblxuLy8gc3JjL21hbmFnZXJzL2phdmFzY3JpcHQudHNcbnZhciBKYXZhU2NyaXB0TWFuYWdlciA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3Ioc2NyaXB0Q29kZSwgdXJsKSB7XG4gICAgdGhpcy5kZXBzU3RhY2sgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICAgIHRoaXMubWltZVR5cGUgPSBcIlwiO1xuICAgIHRoaXMuYXN5bmMgPSBmYWxzZTtcbiAgICB0aGlzLmRlZmVyID0gZmFsc2U7XG4gICAgdGhpcy51cmwgPSB1cmw7XG4gICAgdGhpcy5zY3JpcHRDb2RlID0gc2NyaXB0Q29kZTtcbiAgfVxuICBpc01vZHVsZSgpIHtcbiAgICByZXR1cm4gdGhpcy5taW1lVHlwZSA9PT0gXCJtb2R1bGVcIjtcbiAgfVxuICBpc0lubGluZVNjcmlwdCgpIHtcbiAgICByZXR1cm4gQm9vbGVhbighdGhpcy51cmwpO1xuICB9XG4gIHNldE1pbWVUeXBlKG1pbWVUeXBlKSB7XG4gICAgdGhpcy5taW1lVHlwZSA9IG1pbWVUeXBlIHx8IFwiXCI7XG4gIH1cbiAgc2V0QXN5bmNBdHRyaWJ1dGUodmFsKSB7XG4gICAgdGhpcy5hc3luYyA9IEJvb2xlYW4odmFsKTtcbiAgfVxuICBzZXREZWZmZXJBdHRyaWJ1dGUodmFsKSB7XG4gICAgdGhpcy5kZWZlciA9IEJvb2xlYW4odmFsKTtcbiAgfVxuICBzZXREZXAobm9kZSkge1xuICAgIHRoaXMuZGVwc1N0YWNrLmFkZChub2RlKTtcbiAgfVxuICBpc1NhbWVPcmlnaW4obm9kZSkge1xuICAgIHJldHVybiB0aGlzLmRlcHNTdGFjay5oYXMobm9kZSk7XG4gIH1cbiAgY2xvbmUoKSB7XG4gICAgY29uc3QgY2xvbmVkID0gbmV3IHRoaXMuY29uc3RydWN0b3IoKTtcbiAgICBjbG9uZWQudXJsID0gdGhpcy51cmw7XG4gICAgY2xvbmVkLmFzeW5jID0gdGhpcy5hc3luYztcbiAgICBjbG9uZWQubWltZVR5cGUgPSB0aGlzLm1pbWVUeXBlO1xuICAgIGNsb25lZC5zY3JpcHRDb2RlID0gdGhpcy5zY3JpcHRDb2RlO1xuICAgIGNsb25lZC5kZXBzU3RhY2sgPSBuZXcgU2V0KHRoaXMuZGVwc1N0YWNrKTtcbiAgICByZXR1cm4gY2xvbmVkO1xuICB9XG59O1xuXG4vLyBzcmMvdXRpbHMudHNcbmltcG9ydCB7IGVycm9yLCBwYXJzZUNvbnRlbnRUeXBlIH0gZnJvbSBcIkBnYXJmaXNoL3V0aWxzXCI7XG5mdW5jdGlvbiBnZXRSZXF1ZXN0KGN1c3RvbUZldGNoKSB7XG4gIHJldHVybiBhc3luYyBmdW5jdGlvbiByZXF1ZXN0KHVybCwgY29uZmlnKSB7XG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0IGN1c3RvbUZldGNoLmVtaXQodXJsLCBjb25maWcgfHwge30pO1xuICAgIGlmICghcmVzdWx0IHx8ICEocmVzdWx0IGluc3RhbmNlb2YgUmVzcG9uc2UpKSB7XG4gICAgICByZXN1bHQgPSBhd2FpdCBmZXRjaCh1cmwsIGNvbmZpZyB8fCB7fSk7XG4gICAgfVxuICAgIGlmIChyZXN1bHQuc3RhdHVzID49IDQwMCkge1xuICAgICAgZXJyb3IoYFwiJHt1cmx9XCIgbG9hZCBmYWlsZWQgd2l0aCBzdGF0dXMgXCIke3Jlc3VsdC5zdGF0dXN9XCJgKTtcbiAgICB9XG4gICAgY29uc3QgY29kZSA9IGF3YWl0IHJlc3VsdC50ZXh0KCk7XG4gICAgY29uc3QgdHlwZSA9IHJlc3VsdC5oZWFkZXJzLmdldChcImNvbnRlbnQtdHlwZVwiKSB8fCBcIlwiO1xuICAgIGNvbnN0IHNpemUgPSBOdW1iZXIocmVzdWx0LmhlYWRlcnMuZ2V0KFwiY29udGVudC1zaXplXCIpKTtcbiAgICBjb25zdCBtaW1lVHlwZSA9IHBhcnNlQ29udGVudFR5cGUodHlwZSB8fCBcIlwiKTtcbiAgICByZXR1cm4ge1xuICAgICAgY29kZSxcbiAgICAgIHJlc3VsdCxcbiAgICAgIG1pbWVUeXBlLFxuICAgICAgdHlwZSxcbiAgICAgIHNpemU6IE51bWJlci5pc05hTihzaXplKSA/IG51bGwgOiBzaXplXG4gICAgfTtcbiAgfTtcbn1cbmZ1bmN0aW9uIGNvcHlSZXN1bHQocmVzdWx0KSB7XG4gIGlmIChyZXN1bHQucmVzb3VyY2VNYW5hZ2VyKSB7XG4gICAgcmVzdWx0LnJlc291cmNlTWFuYWdlciA9IHJlc3VsdC5yZXNvdXJjZU1hbmFnZXIuY2xvbmUoKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gbWVyZ2VDb25maWcobG9hZGVyLCB1cmwpIHtcbiAgY29uc3QgZXh0cmEgPSBsb2FkZXIucmVxdWVzdENvbmZpZztcbiAgY29uc3QgY29uZmlnID0gdHlwZW9mIGV4dHJhID09PSBcImZ1bmN0aW9uXCIgPyBleHRyYSh1cmwpIDogZXh0cmE7XG4gIHJldHVybiBfX3NwcmVhZFZhbHVlcyh7IG1vZGU6IFwiY29yc1wiIH0sIGNvbmZpZyk7XG59XG5cbi8vIHNyYy9hcHBDYWNoZS50c1xudmFyIGNhY2hlZERhdGFTZXQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtTZXQoKTtcbnZhciBNQVhfU0laRSA9IDEwMjQgKiAxMDI0ICogNTA7XG52YXIgREVGQVVMVF9QT0xMID0gU3ltYm9sKFwiX19kZWZhdWx0QnVmZmVyUG9sbF9fXCIpO1xudmFyIEZJTEVfVFlQRVMgPSBbXG4gIFwianNcIiAvKiBqcyAqLyxcbiAgXCJjc3NcIiAvKiBjc3MgKi8sXG4gIFwibW9kdWxlXCIgLyogbW9kdWxlICovLFxuICBcInRlbXBsYXRlXCIgLyogdGVtcGxhdGUgKi8sXG4gIERFRkFVTFRfUE9MTFxuXTtcbnZhciBBcHBDYWNoZUNvbnRhaW5lciA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IobWF4U2l6ZSA9IE1BWF9TSVpFKSB7XG4gICAgdGhpcy50b3RhbFNpemUgPSAwO1xuICAgIHRoaXMucmVjb3JkZXIgPSB7fTtcbiAgICB0aGlzLm1heFNpemUgPSBtYXhTaXplO1xuICAgIEZJTEVfVFlQRVMuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICB0aGlzLnJlY29yZGVyW2tleV0gPSAwO1xuICAgICAgdGhpc1trZXldID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgICB9KTtcbiAgfVxuICBidWZmZXJQb29sKHR5cGUpIHtcbiAgICByZXR1cm4gdGhpc1t0eXBlXTtcbiAgfVxuICBoYXModXJsKSB7XG4gICAgcmV0dXJuIEZJTEVfVFlQRVMuc29tZSgoa2V5KSA9PiB0aGlzW2tleV0uaGFzKHVybCkpO1xuICB9XG4gIGdldCh1cmwpIHtcbiAgICBmb3IgKGNvbnN0IGtleSBvZiBGSUxFX1RZUEVTKSB7XG4gICAgICBpZiAodGhpc1trZXldLmhhcyh1cmwpKSB7XG4gICAgICAgIHJldHVybiB0aGlzW2tleV0uZ2V0KHVybCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHNldCh1cmwsIGRhdGEsIHR5cGUpIHtcbiAgICBjb25zdCBjdXJTaXplID0gY2FjaGVkRGF0YVNldC5oYXMoZGF0YSkgPyAwIDogZGF0YS5zaXplO1xuICAgIGNvbnN0IHRvdGFsU2l6ZSA9IHRoaXMudG90YWxTaXplICsgY3VyU2l6ZTtcbiAgICBpZiAodG90YWxTaXplIDwgdGhpcy5tYXhTaXplKSB7XG4gICAgICBsZXQgYmFyID0gdHlwZTtcbiAgICAgIGxldCBidWZmZXJQb29sID0gdGhpcy5idWZmZXJQb29sKHR5cGUpO1xuICAgICAgaWYgKCFidWZmZXJQb29sKSB7XG4gICAgICAgIGJhciA9IERFRkFVTFRfUE9MTDtcbiAgICAgICAgYnVmZmVyUG9vbCA9IHRoaXMuYnVmZmVyUG9vbChERUZBVUxUX1BPTEwpO1xuICAgICAgfVxuICAgICAgYnVmZmVyUG9vbC5zZXQodXJsLCBkYXRhKTtcbiAgICAgIHRoaXMudG90YWxTaXplID0gdG90YWxTaXplO1xuICAgICAgdGhpcy5yZWNvcmRlcltiYXJdICs9IGN1clNpemU7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGNsZWFyKHR5cGUpIHtcbiAgICBpZiAodHlwZW9mIHR5cGUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIGNvbnN0IGNhY2hlQm94ID0gdGhpcy5idWZmZXJQb29sKHR5cGUpO1xuICAgICAgaWYgKGNhY2hlQm94ICYmIGNhY2hlQm94IGluc3RhbmNlb2YgTWFwKSB7XG4gICAgICAgIGNvbnN0IHNpemUgPSB0aGlzLnJlY29yZGVyW3R5cGVdO1xuICAgICAgICB0aGlzLnRvdGFsU2l6ZSAtPSBzaXplO1xuICAgICAgICB0aGlzLnJlY29yZGVyW3R5cGVdID0gMDtcbiAgICAgICAgY2FjaGVCb3guY2xlYXIoKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgRklMRV9UWVBFUy5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgdGhpc1trZXldLmNsZWFyKCk7XG4gICAgICAgIHRoaXMucmVjb3JkZXJba2V5XSA9IDA7XG4gICAgICB9KTtcbiAgICAgIHRoaXMudG90YWxTaXplID0gMDtcbiAgICB9XG4gIH1cbn07XG5cbi8vIHNyYy9pbmRleC50c1xudmFyIENyb3NzT3JpZ2luQ3JlZGVudGlhbHMgPSAvKiBAX19QVVJFX18gKi8gKChDcm9zc09yaWdpbkNyZWRlbnRpYWxzMikgPT4ge1xuICBDcm9zc09yaWdpbkNyZWRlbnRpYWxzMltcImFub255bW91c1wiXSA9IFwic2FtZS1vcmlnaW5cIjtcbiAgQ3Jvc3NPcmlnaW5DcmVkZW50aWFsczJbXCJ1c2UtY3JlZGVudGlhbHNcIl0gPSBcImluY2x1ZGVcIjtcbiAgcmV0dXJuIENyb3NzT3JpZ2luQ3JlZGVudGlhbHMyO1xufSkoQ3Jvc3NPcmlnaW5DcmVkZW50aWFscyB8fCB7fSk7XG52YXIgTG9hZGVyID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgdGhpcy5wZXJzb25hbElkID0gX19MT0FERVJfRkxBR19fO1xuICAgIHRoaXMuU3R5bGVNYW5hZ2VyID0gU3R5bGVNYW5hZ2VyO1xuICAgIHRoaXMuTW9kdWxlTWFuYWdlciA9IE1vZHVsZU1hbmFnZXI7XG4gICAgdGhpcy5UZW1wbGF0ZU1hbmFnZXIgPSBUZW1wbGF0ZU1hbmFnZXI7XG4gICAgdGhpcy5KYXZhU2NyaXB0TWFuYWdlciA9IEphdmFTY3JpcHRNYW5hZ2VyO1xuICAgIHRoaXMuaG9va3MgPSBuZXcgUGx1Z2luU3lzdGVtKHtcbiAgICAgIGVycm9yOiBuZXcgU3luY0hvb2soKSxcbiAgICAgIGxvYWRlZDogbmV3IFN5bmNXYXRlcmZhbGxIb29rKFwibG9hZGVkXCIpLFxuICAgICAgY2xlYXI6IG5ldyBTeW5jV2F0ZXJmYWxsSG9vayhcImNsZWFyXCIpLFxuICAgICAgYmVmb3JlTG9hZDogbmV3IFN5bmNXYXRlcmZhbGxIb29rKFwiYmVmb3JlTG9hZFwiKSxcbiAgICAgIGZldGNoOiBuZXcgQXN5bmNIb29rKFwiZmV0Y2hcIilcbiAgICB9KTtcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgIHRoaXMubG9hZGluZ0xpc3QgPSAvKiBAX19QVVJFX18gKi8gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICB0aGlzLmNhY2hlU3RvcmUgPSAvKiBAX19QVVJFX18gKi8gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgfVxuICBzZXRPcHRpb25zKG9wdGlvbnMpIHtcbiAgICB0aGlzLm9wdGlvbnMgPSBfX3NwcmVhZFZhbHVlcyhfX3NwcmVhZFZhbHVlcyh7fSwgdGhpcy5vcHRpb25zKSwgb3B0aW9ucyk7XG4gIH1cbiAgY2xlYXIoc2NvcGUsIGZpbGVUeXBlKSB7XG4gICAgY29uc3QgYXBwQ2FjaGVDb250YWluZXIgPSB0aGlzLmNhY2hlU3RvcmVbc2NvcGVdO1xuICAgIGlmIChhcHBDYWNoZUNvbnRhaW5lcikge1xuICAgICAgYXBwQ2FjaGVDb250YWluZXIuY2xlYXIoZmlsZVR5cGUpO1xuICAgICAgdGhpcy5ob29rcy5saWZlY3ljbGUuY2xlYXIuZW1pdCh7IHNjb3BlLCBmaWxlVHlwZSB9KTtcbiAgICB9XG4gIH1cbiAgY2xlYXJBbGwoZmlsZVR5cGUpIHtcbiAgICBmb3IgKGNvbnN0IHNjb3BlIGluIHRoaXMuY2FjaGVTdG9yZSkge1xuICAgICAgdGhpcy5jbGVhcihzY29wZSwgZmlsZVR5cGUpO1xuICAgIH1cbiAgfVxuICB1c2VQbHVnaW4ob3B0aW9ucykge1xuICAgIHRoaXMuaG9va3MudXNlUGx1Z2luKG9wdGlvbnMpO1xuICB9XG4gIHNldExpZmVDeWNsZShsaWZlQ3ljbGUpIHtcbiAgICB0aGlzLmhvb2tzLnVzZVBsdWdpbihfX3NwcmVhZFZhbHVlcyh7XG4gICAgICBuYW1lOiBcImxvYWRlci1saWZlY3ljbGVcIlxuICAgIH0sIGxpZmVDeWNsZSkpO1xuICB9XG4gIGxvYWRNb2R1bGUodXJsKSB7XG4gICAgcmV0dXJuIHRoaXMubG9hZCh7XG4gICAgICBzY29wZTogXCJtb2R1bGVzXCIsXG4gICAgICB1cmwsXG4gICAgICBpc1JlbW90ZU1vZHVsZTogdHJ1ZVxuICAgIH0pO1xuICB9XG4gIGFzeW5jIGxvYWQoe1xuICAgIHNjb3BlLFxuICAgIHVybCxcbiAgICBpc1JlbW90ZU1vZHVsZSA9IGZhbHNlLFxuICAgIGNyb3NzT3JpZ2luID0gXCJhbm9ueW1vdXNcIixcbiAgICBkZWZhdWx0Q29udGVudFR5cGUgPSBcIlwiXG4gIH0pIHtcbiAgICBjb25zdCB7IG9wdGlvbnMsIGxvYWRpbmdMaXN0LCBjYWNoZVN0b3JlIH0gPSB0aGlzO1xuICAgIGNvbnN0IHJlcyA9IGxvYWRpbmdMaXN0W3VybF07XG4gICAgaWYgKHJlcyAmJiBPYmplY3Qua2V5cyhyZXMpLmluY2x1ZGVzKHNjb3BlKSkge1xuICAgICAgcmV0dXJuIG1hY3JvVGFzayhyZXNbc2NvcGVdLCA0KTtcbiAgICB9XG4gICAgbGV0IGFwcENhY2hlQ29udGFpbmVyID0gY2FjaGVTdG9yZVtzY29wZV07XG4gICAgaWYgKCFhcHBDYWNoZUNvbnRhaW5lcikge1xuICAgICAgYXBwQ2FjaGVDb250YWluZXIgPSBjYWNoZVN0b3JlW3Njb3BlXSA9IG5ldyBBcHBDYWNoZUNvbnRhaW5lcihvcHRpb25zLm1heFNpemUpO1xuICAgIH1cbiAgICBpZiAoYXBwQ2FjaGVDb250YWluZXIuaGFzKHVybCkpIHtcbiAgICAgIHJldHVybiBtYWNyb1Rhc2soY29weVJlc3VsdChhcHBDYWNoZUNvbnRhaW5lci5nZXQodXJsKSksIDQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGNvbnN0IGtleSBpbiBjYWNoZVN0b3JlKSB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGNhY2hlU3RvcmVba2V5XTtcbiAgICAgICAgaWYgKGNvbnRhaW5lciAhPT0gYXBwQ2FjaGVDb250YWluZXIpIHtcbiAgICAgICAgICBpZiAoY29udGFpbmVyLmhhcyh1cmwpKSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBjb250YWluZXIuZ2V0KHVybCk7XG4gICAgICAgICAgICBjYWNoZWREYXRhU2V0LmFkZChyZXN1bHQpO1xuICAgICAgICAgICAgYXBwQ2FjaGVDb250YWluZXIuc2V0KHVybCwgcmVzdWx0LCByZXN1bHQuZmlsZVR5cGUpO1xuICAgICAgICAgICAgcmV0dXJuIG1hY3JvVGFzayhjb3B5UmVzdWx0KHJlc3VsdCksIDQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCByZXF1ZXN0Q29uZmlnID0gbWVyZ2VDb25maWcodGhpcywgdXJsKTtcbiAgICByZXF1ZXN0Q29uZmlnLmNyZWRlbnRpYWxzID0gQ3Jvc3NPcmlnaW5DcmVkZW50aWFsc1tjcm9zc09yaWdpbl07XG4gICAgY29uc3QgcmVzT3B0cyA9IHRoaXMuaG9va3MubGlmZWN5Y2xlLmJlZm9yZUxvYWQuZW1pdCh7XG4gICAgICB1cmwsXG4gICAgICBzY29wZSxcbiAgICAgIHJlcXVlc3RDb25maWdcbiAgICB9KTtcbiAgICBjb25zdCByZXF1ZXN0ID0gZ2V0UmVxdWVzdCh0aGlzLmhvb2tzLmxpZmVjeWNsZS5mZXRjaCk7XG4gICAgY29uc3QgbG9hZFJlcyA9IHJlcXVlc3QocmVzT3B0cy51cmwsIHJlc09wdHMucmVxdWVzdENvbmZpZykudGhlbigoeyBjb2RlLCBzaXplLCByZXN1bHQsIHR5cGUgfSkgPT4ge1xuICAgICAgbGV0IG1hbmFnZXJDdG9yLCBmaWxlVHlwZSA9IFwiXCI7XG4gICAgICBpZiAoaXNSZW1vdGVNb2R1bGUpIHtcbiAgICAgICAgZmlsZVR5cGUgPSBcIm1vZHVsZVwiIC8qIG1vZHVsZSAqLztcbiAgICAgICAgbWFuYWdlckN0b3IgPSB0aGlzLk1vZHVsZU1hbmFnZXI7XG4gICAgICB9IGVsc2UgaWYgKGlzSHRtbFR5cGUoeyB0eXBlLCBzcmM6IHJlc3VsdC51cmwgfSkgfHwgaXNIdG1sVHlwZSh7XG4gICAgICAgIHR5cGU6IGRlZmF1bHRDb250ZW50VHlwZVxuICAgICAgfSkpIHtcbiAgICAgICAgZmlsZVR5cGUgPSBcInRlbXBsYXRlXCIgLyogdGVtcGxhdGUgKi87XG4gICAgICAgIG1hbmFnZXJDdG9yID0gdGhpcy5UZW1wbGF0ZU1hbmFnZXI7XG4gICAgICB9IGVsc2UgaWYgKGlzSnNUeXBlKHsgdHlwZTogZGVmYXVsdENvbnRlbnRUeXBlIH0pIHx8IGlzSnNUeXBlKHsgdHlwZSwgc3JjOiByZXN1bHQudXJsIH0pKSB7XG4gICAgICAgIGZpbGVUeXBlID0gXCJqc1wiIC8qIGpzICovO1xuICAgICAgICBtYW5hZ2VyQ3RvciA9IHRoaXMuSmF2YVNjcmlwdE1hbmFnZXI7XG4gICAgICB9IGVsc2UgaWYgKGlzQ3NzVHlwZSh7IHNyYzogcmVzdWx0LnVybCwgdHlwZSB9KSB8fCBpc0Nzc1R5cGUoe1xuICAgICAgICB0eXBlOiBkZWZhdWx0Q29udGVudFR5cGVcbiAgICAgIH0pKSB7XG4gICAgICAgIGZpbGVUeXBlID0gXCJjc3NcIiAvKiBjc3MgKi87XG4gICAgICAgIG1hbmFnZXJDdG9yID0gdGhpcy5TdHlsZU1hbmFnZXI7XG4gICAgICB9XG4gICAgICBjb25zdCByZXNvdXJjZU1hbmFnZXIgPSBtYW5hZ2VyQ3RvciA/IG5ldyBtYW5hZ2VyQ3Rvcihjb2RlLCByZXN1bHQudXJsKSA6IG51bGw7XG4gICAgICBjb25zdCBkYXRhID0gdGhpcy5ob29rcy5saWZlY3ljbGUubG9hZGVkLmVtaXQoe1xuICAgICAgICByZXN1bHQsXG4gICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgdXJsLFxuICAgICAgICAgIHNjb3BlLFxuICAgICAgICAgIHJlc291cmNlTWFuYWdlcixcbiAgICAgICAgICBmaWxlVHlwZTogZmlsZVR5cGUgfHwgXCJcIixcbiAgICAgICAgICBzaXplOiBzaXplIHx8IGNvZGUubGVuZ3RoLFxuICAgICAgICAgIGNvZGU6IHJlc291cmNlTWFuYWdlciA/IFwiXCIgOiBjb2RlXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgZmlsZVR5cGUgJiYgYXBwQ2FjaGVDb250YWluZXIuc2V0KHVybCwgZGF0YS52YWx1ZSwgZmlsZVR5cGUpO1xuICAgICAgcmV0dXJuIGNvcHlSZXN1bHQoZGF0YS52YWx1ZSk7XG4gICAgfSkuY2F0Y2goKGUpID0+IHtcbiAgICAgICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudiAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViA/IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA6IGZhbHNlKSAmJiBlcnJvcjIoZSk7XG4gICAgICB0aGlzLmhvb2tzLmxpZmVjeWNsZS5lcnJvci5lbWl0KGUsIHsgc2NvcGUgfSk7XG4gICAgICB0aHJvdyBlO1xuICAgIH0pLmZpbmFsbHkoKCkgPT4ge1xuICAgIH0pO1xuICAgIGxvYWRpbmdMaXN0W3VybF0gPyBsb2FkaW5nTGlzdFt1cmxdW3Njb3BlXSA9IGxvYWRSZXMgOiBsb2FkaW5nTGlzdFt1cmxdID0geyBbc2NvcGVdOiBsb2FkUmVzIH07XG4gICAgcmV0dXJuIGxvYWRSZXM7XG4gIH1cbn07XG5leHBvcnQge1xuICBDcm9zc09yaWdpbkNyZWRlbnRpYWxzLFxuICBKYXZhU2NyaXB0TWFuYWdlcixcbiAgTG9hZGVyLFxuICBNb2R1bGVNYW5hZ2VyLFxuICBTdHlsZU1hbmFnZXIsXG4gIFRlbXBsYXRlTWFuYWdlclxufTtcbiIsInZhciBfX2RlZlByb3AgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG52YXIgX19kZWZQcm9wcyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzO1xudmFyIF9fZ2V0T3duUHJvcERlc2NzID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM7XG52YXIgX19nZXRPd25Qcm9wU3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7XG52YXIgX19oYXNPd25Qcm9wID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcbnZhciBfX3Byb3BJc0VudW0gPSBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlO1xudmFyIF9fZGVmTm9ybWFsUHJvcCA9IChvYmosIGtleSwgdmFsdWUpID0+IGtleSBpbiBvYmogPyBfX2RlZlByb3Aob2JqLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSwgdmFsdWUgfSkgOiBvYmpba2V5XSA9IHZhbHVlO1xudmFyIF9fc3ByZWFkVmFsdWVzID0gKGEsIGIpID0+IHtcbiAgZm9yICh2YXIgcHJvcCBpbiBiIHx8IChiID0ge30pKVxuICAgIGlmIChfX2hhc093blByb3AuY2FsbChiLCBwcm9wKSlcbiAgICAgIF9fZGVmTm9ybWFsUHJvcChhLCBwcm9wLCBiW3Byb3BdKTtcbiAgaWYgKF9fZ2V0T3duUHJvcFN5bWJvbHMpXG4gICAgZm9yICh2YXIgcHJvcCBvZiBfX2dldE93blByb3BTeW1ib2xzKGIpKSB7XG4gICAgICBpZiAoX19wcm9wSXNFbnVtLmNhbGwoYiwgcHJvcCkpXG4gICAgICAgIF9fZGVmTm9ybWFsUHJvcChhLCBwcm9wLCBiW3Byb3BdKTtcbiAgICB9XG4gIHJldHVybiBhO1xufTtcbnZhciBfX3NwcmVhZFByb3BzID0gKGEsIGIpID0+IF9fZGVmUHJvcHMoYSwgX19nZXRPd25Qcm9wRGVzY3MoYikpO1xuXG4vLyBzcmMvaW5kZXgudHNcbmltcG9ydCB7IGNyZWF0ZUtleSwgcm91dGVyTG9nIH0gZnJvbSBcIkBnYXJmaXNoL3V0aWxzXCI7XG5cbi8vIHNyYy9jb25maWcudHNcbnZhciBfX0dBUkZJU0hfUk9VVEVSX1VQREFURV9GTEFHX18gPSBcIl9fR0FSRklTSF9ST1VURVJfVVBEQVRFX0ZMQUdfX1wiO1xudmFyIF9fR0FSRklTSF9ST1VURVJfRkxBR19fID0gXCJfX0dBUkZJU0hfUk9VVEVSX0ZMQUdfX1wiO1xudmFyIF9fR0FSRklTSF9CRUZPUkVfUk9VVEVSX0VWRU5UX18gPSBcImdhcmZpc2g6YmVmb3JlLXJvdXRpbmctZXZlbnRcIjtcbnZhciBSb3V0ZXJDb25maWcgPSB7XG4gIGJhc2VuYW1lOiBcIi9cIixcbiAgY3VycmVudDoge1xuICAgIGZ1bGxQYXRoOiBcIi9cIixcbiAgICBwYXRoOiBcIi9cIixcbiAgICBtYXRjaGVkOiBbXSxcbiAgICBxdWVyeToge30sXG4gICAgc3RhdGU6IHt9LFxuICAgIGhyZWY6IFwiXCJcbiAgfSxcbiAgYXBwczogW10sXG4gIGJlZm9yZUVhY2g6ICh0bywgZnJvbSwgbmV4dCkgPT4gbmV4dCgpLFxuICBhZnRlckVhY2g6ICh0bywgZnJvbSwgbmV4dCkgPT4gbmV4dCgpLFxuICBhY3RpdmU6ICgpID0+IFByb21pc2UucmVzb2x2ZSgpLFxuICBkZWFjdGl2ZTogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCksXG4gIHJvdXRlckNoYW5nZTogKCkgPT4ge1xuICB9LFxuICBhdXRvUmVmcmVzaEFwcDogdHJ1ZSxcbiAgbGlzdGVuaW5nOiB0cnVlXG59O1xuZnVuY3Rpb24gc2V0KGZpZWxkLCB2YWx1ZSkge1xuICBSb3V0ZXJDb25maWdbZmllbGRdID0gdmFsdWU7XG59XG5mdW5jdGlvbiBzZXRSb3V0ZXJDb25maWcob3B0aW9ucykge1xuICBPYmplY3QuYXNzaWduKFJvdXRlckNvbmZpZywgb3B0aW9ucyk7XG59XG5cbi8vIHNyYy91dGlscy91cmxVdC50c1xuZnVuY3Rpb24gcGFyc2VRdWVyeShxdWVyeSA9IFwiXCIpIHtcbiAgY29uc3QgcmVzID0ge307XG4gIGlmIChxdWVyeSkge1xuICAgIHF1ZXJ5LnNsaWNlKDEpLnNwbGl0KFwiJlwiKS5tYXAoKGl0ZW0pID0+IHtcbiAgICAgIGNvbnN0IHBhaXJzID0gaXRlbS5zcGxpdChcIj1cIik7XG4gICAgICByZXNbcGFpcnNbMF1dID0gcGFpcnM7XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHJlcztcbn1cbmZ1bmN0aW9uIGdldFBhdGgoYmFzZW5hbWUgPSBcIi9cIiwgcGF0aG5hbWUpIHtcbiAgaWYgKGJhc2VuYW1lID09PSBcIi9cIiB8fCBiYXNlbmFtZSA9PT0gXCJcIikge1xuICAgIHJldHVybiBwYXRobmFtZSB8fCBsb2NhdGlvbi5wYXRobmFtZTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gKHBhdGhuYW1lIHx8IGxvY2F0aW9uLnBhdGhuYW1lKS5yZXBsYWNlKG5ldyBSZWdFeHAoYF4vPyR7YmFzZW5hbWV9YCksIFwiXCIpO1xuICB9XG59XG5mdW5jdGlvbiBnZXRBcHBSb290UGF0aChhcHBJbmZvKSB7XG4gIGNvbnN0IHBhdGggPSBnZXRQYXRoKGFwcEluZm8uYmFzZW5hbWUsIGxvY2F0aW9uLnBhdGhuYW1lKTtcbiAgbGV0IGFwcFJvb3RQYXRoID0gYXBwSW5mby5iYXNlbmFtZSA9PT0gXCIvXCIgPyBcIlwiIDogYXBwSW5mby5iYXNlbmFtZSB8fCBcIlwiO1xuICBpZiAodHlwZW9mIGFwcEluZm8uYWN0aXZlV2hlbiA9PT0gXCJzdHJpbmdcIikge1xuICAgIGFwcFJvb3RQYXRoICs9IGFwcEluZm8uYWN0aXZlV2hlbjtcbiAgfSBlbHNlIHtcbiAgICBhcHBSb290UGF0aCArPSBwYXRoLnNwbGl0KFwiXCIpLnJlZHVjZSgocHJlLCBuZXh0KSA9PiB7XG4gICAgICBpZiAodHlwZW9mIGFwcEluZm8uYWN0aXZlV2hlbiA9PT0gXCJmdW5jdGlvblwiICYmICFhcHBJbmZvLmFjdGl2ZVdoZW4ocHJlKSlcbiAgICAgICAgcmV0dXJuIHByZSArIG5leHQ7XG4gICAgICByZXR1cm4gcHJlO1xuICAgIH0sIFwiXCIpO1xuICB9XG4gIHJldHVybiBhcHBSb290UGF0aDtcbn1cblxuLy8gc3JjL3V0aWxzL2luZGV4LnRzXG5hc3luYyBmdW5jdGlvbiBhc3luY0ZvckVhY2goYXJyLCBjYWxsYmFjaykge1xuICBjb25zdCBsZW5ndGggPSBhcnIubGVuZ3RoO1xuICBsZXQgayA9IDA7XG4gIHdoaWxlIChrIDwgbGVuZ3RoKSB7XG4gICAgY29uc3Qga1ZhbHVlID0gYXJyW2tdO1xuICAgIGF3YWl0IGNhbGxiYWNrKGtWYWx1ZSwgaywgYXJyKTtcbiAgICBrKys7XG4gIH1cbn1cbmZ1bmN0aW9uIHRvTWlkZGxlV2FyZSh0bywgZnJvbSwgY2IpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICB0cnkge1xuICAgICAgY2IodG8sIGZyb20sIHJlc29sdmUpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmVqZWN0KGVycik7XG4gICAgfVxuICB9KTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUV2ZW50KHR5cGUpIHtcbiAgbGV0IGU7XG4gIGlmIChuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoXCJNU0lFXCIpICE9PSAtMSB8fCBuYXZpZ2F0b3IuYXBwVmVyc2lvbi5pbmRleE9mKFwiVHJpZGVudC9cIikgPiAwKSB7XG4gICAgZSA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KFwiVUlFdmVudHNcIik7XG4gICAgZS5pbml0VUlFdmVudCh0eXBlLnRvTG93ZXJDYXNlKCksIHRydWUsIGZhbHNlLCB3aW5kb3csIDApO1xuICB9IGVsc2Uge1xuICAgIGUgPSBuZXcgRXZlbnQodHlwZS50b0xvd2VyQ2FzZSgpKTtcbiAgfVxuICByZXR1cm4gZTtcbn1cblxuLy8gc3JjL3V0aWxzL2N1c3RvbUV2ZW50LnRzXG52YXIgTmF0aXZlQ3VzdG9tRXZlbnQgPSB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsID09IG51bGwgPyB2b2lkIDAgOiBnbG9iYWwuQ3VzdG9tRXZlbnQgOiBudWxsO1xuZnVuY3Rpb24gdXNlTmF0aXZlKCkge1xuICB0cnkge1xuICAgIGNvbnN0IHAgPSBuZXcgTmF0aXZlQ3VzdG9tRXZlbnQoXCJjYXRcIiwgeyBkZXRhaWw6IHsgZm9vOiBcImJhclwiIH0gfSk7XG4gICAgcmV0dXJuIHAudHlwZSA9PT0gXCJjYXRcIiAmJiBwLmRldGFpbC5mb28gPT09IFwiYmFyXCI7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG52YXIgQ3VzdG9tRXZlbnQ7XG5pZiAoTmF0aXZlQ3VzdG9tRXZlbnQgJiYgdXNlTmF0aXZlKCkpIHtcbiAgQ3VzdG9tRXZlbnQgPSBOYXRpdmVDdXN0b21FdmVudDtcbn0gZWxzZSBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBkb2N1bWVudC5jcmVhdGVFdmVudCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gIEN1c3RvbUV2ZW50ID0gZnVuY3Rpb24odHlwZSwgcGFyYW1zKSB7XG4gICAgcGFyYW1zID0gcGFyYW1zIHx8IHsgYnViYmxlczogZmFsc2UsIGNhbmNlbGFibGU6IGZhbHNlLCBkZXRhaWw6IG51bGwgfTtcbiAgICBjb25zdCBldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudChcIkN1c3RvbUV2ZW50XCIpO1xuICAgIGV2dC5pbml0Q3VzdG9tRXZlbnQodHlwZSwgcGFyYW1zLmJ1YmJsZXMgfHwgZmFsc2UsIHBhcmFtcy5jYW5jZWxhYmxlIHx8IGZhbHNlLCBwYXJhbXMuZGV0YWlsIHx8IG51bGwpO1xuICAgIHJldHVybiBldnQ7XG4gIH07XG59IGVsc2Uge1xuICBDdXN0b21FdmVudCA9IGZ1bmN0aW9uKHR5cGUsIHBhcmFtcykge1xuICAgIGNvbnN0IGUgPSBkb2N1bWVudC5jcmVhdGVFdmVudE9iamVjdCgpO1xuICAgIGUudHlwZSA9IHR5cGU7XG4gICAgaWYgKHBhcmFtcykge1xuICAgICAgZS5idWJibGVzID0gQm9vbGVhbihwYXJhbXMuYnViYmxlcyk7XG4gICAgICBlLmNhbmNlbGFibGUgPSBCb29sZWFuKHBhcmFtcy5jYW5jZWxhYmxlKTtcbiAgICAgIGUuZGV0YWlsID0gcGFyYW1zLmRldGFpbDtcbiAgICB9IGVsc2Uge1xuICAgICAgZS5idWJibGVzID0gZmFsc2U7XG4gICAgICBlLmNhbmNlbGFibGUgPSBmYWxzZTtcbiAgICAgIGUuZGV0YWlsID0gdm9pZCAwO1xuICAgIH1cbiAgICByZXR1cm4gZTtcbiAgfTtcbn1cbnZhciBjdXN0b21FdmVudF9kZWZhdWx0ID0gQ3VzdG9tRXZlbnQ7XG5cbi8vIHNyYy91dGlscy9uYXZFdmVudC50c1xuaW1wb3J0IHsgdmFsaWRVUkwgfSBmcm9tIFwiQGdhcmZpc2gvdXRpbHNcIjtcbmZ1bmN0aW9uIGNyZWF0ZVBvcFN0YXRlRXZlbnQoc3RhdGUsIG9yaWdpbmFsTWV0aG9kTmFtZSkge1xuICBsZXQgZXZ0O1xuICB0cnkge1xuICAgIGV2dCA9IG5ldyBQb3BTdGF0ZUV2ZW50KFwicG9wc3RhdGVcIiwgeyBzdGF0ZSB9KTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJQb3BTdGF0ZUV2ZW50XCIpO1xuICAgIGV2dC5pbml0UG9wU3RhdGVFdmVudChcInBvcHN0YXRlXCIsIGZhbHNlLCBmYWxzZSwgc3RhdGUpO1xuICB9XG4gIGV2dC5nYXJmaXNoID0gdHJ1ZTtcbiAgZXZ0LmdhcmZpc2hUcmlnZ2VyID0gb3JpZ2luYWxNZXRob2ROYW1lO1xuICByZXR1cm4gZXZ0O1xufVxudmFyIGNhbGxDYXB0dXJlZEV2ZW50TGlzdGVuZXJzID0gKHR5cGUpID0+IHtcbiAgY29uc3QgZXZlbnRBcmd1bWVudHMgPSBjcmVhdGVQb3BTdGF0ZUV2ZW50KHdpbmRvdy5oaXN0b3J5LnN0YXRlLCB0eXBlKTtcbiAgd2luZG93LmRpc3BhdGNoRXZlbnQoZXZlbnRBcmd1bWVudHMpO1xufTtcbnZhciBoYW5kbGVyUGFyYW1zID0gZnVuY3Rpb24ocGF0aCwgcXVlcnksIGJhc2VuYW1lKSB7XG4gIGlmICghcGF0aCB8fCB0eXBlb2YgcGF0aCAhPT0gXCJzdHJpbmdcIilcbiAgICByZXR1cm4gXCJcIjtcbiAgbGV0IHVybCA9IHBhdGg7XG4gIGlmICh1cmxbMF0gIT09IFwiL1wiKVxuICAgIHVybCA9IFwiL1wiICsgdXJsO1xuICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHF1ZXJ5KSA9PT0gXCJbb2JqZWN0IE9iamVjdF1cIikge1xuICAgIGNvbnN0IHFzID0gT2JqZWN0LmtleXMocXVlcnkpLm1hcCgoa2V5KSA9PiBgJHtrZXl9PSR7cXVlcnlba2V5XX1gKS5qb2luKFwiJlwiKTtcbiAgICB1cmwgKz0gcXMgPyBcIj9cIiArIHFzIDogXCJcIjtcbiAgfVxuICBpZiAoYmFzZW5hbWUgIT09IFwiL1wiKVxuICAgIHVybCA9IGJhc2VuYW1lICsgdXJsO1xuICBpZiAodXJsWzBdICE9PSBcIi9cIilcbiAgICB1cmwgPSBcIi9cIiArIHVybDtcbiAgcmV0dXJuIHVybDtcbn07XG52YXIgcHVzaCA9ICh7XG4gIHBhdGgsXG4gIHF1ZXJ5LFxuICBiYXNlbmFtZVxufSkgPT4ge1xuICBpZiAoIWJhc2VuYW1lKVxuICAgIGJhc2VuYW1lID0gUm91dGVyQ29uZmlnLmJhc2VuYW1lIHx8IFwiL1wiO1xuICBsZXQgdXJsID0gbnVsbDtcbiAgaWYgKHZhbGlkVVJMKHBhdGgpKSB7XG4gICAgdXJsID0gLyheaHR0cHM/Oil8KF5cXC9cXC8pLy50ZXN0KHBhdGgpID8gcGF0aCA6IGAvLyR7cGF0aH1gO1xuICB9IGVsc2Uge1xuICAgIHVybCA9IGhhbmRsZXJQYXJhbXMocGF0aCwgcXVlcnksIGJhc2VuYW1lKTtcbiAgfVxuICBoaXN0b3J5LnB1c2hTdGF0ZShfX3NwcmVhZFZhbHVlcyh7IFtfX0dBUkZJU0hfUk9VVEVSX1VQREFURV9GTEFHX19dOiB0cnVlIH0sIGhpc3Rvcnkuc3RhdGUpLCBcIlwiLCB1cmwpO1xufTtcbnZhciByZXBsYWNlID0gKHtcbiAgcGF0aCxcbiAgcXVlcnksXG4gIGJhc2VuYW1lXG59KSA9PiB7XG4gIGlmICghYmFzZW5hbWUpXG4gICAgYmFzZW5hbWUgPSBSb3V0ZXJDb25maWcuYmFzZW5hbWUgfHwgXCIvXCI7XG4gIGxldCB1cmwgPSBudWxsO1xuICBpZiAodmFsaWRVUkwocGF0aCkpIHtcbiAgICB1cmwgPSAvXihodHRwcz86KShcXC9cXC8pLy50ZXN0KHBhdGgpID8gcGF0aCA6IGAvLyR7cGF0aH1gO1xuICB9IGVsc2Uge1xuICAgIHVybCA9IGhhbmRsZXJQYXJhbXMocGF0aCwgcXVlcnksIGJhc2VuYW1lKTtcbiAgfVxuICBoaXN0b3J5LnJlcGxhY2VTdGF0ZShfX3NwcmVhZFZhbHVlcyh7IFtfX0dBUkZJU0hfUk9VVEVSX1VQREFURV9GTEFHX19dOiB0cnVlIH0sIGhpc3Rvcnkuc3RhdGUpLCBcIlwiLCB1cmwpO1xufTtcblxuLy8gc3JjL2xpbmtUby50c1xudmFyIGhhc0FjdGl2ZSA9IChhY3RpdmVXaGVuLCBwYXRoKSA9PiB7XG4gIGlmICh0eXBlb2YgYWN0aXZlV2hlbiA9PT0gXCJzdHJpbmdcIikge1xuICAgIGlmIChhY3RpdmVXaGVuWzBdICE9PSBcIi9cIilcbiAgICAgIGFjdGl2ZVdoZW4gPSBgLyR7YWN0aXZlV2hlbn1gO1xuICAgIGlmIChhY3RpdmVXaGVuID09PSBcIi9cIiAmJiBwYXRoID09PSBhY3RpdmVXaGVuKVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgY29uc3QgYWN0aXZlV2hlbkFyciA9IGFjdGl2ZVdoZW4uc3BsaXQoXCIvXCIpO1xuICAgIGNvbnN0IHBhdGhBcnIgPSBwYXRoLnNwbGl0KFwiL1wiKTtcbiAgICBsZXQgZmxhZyA9IHRydWU7XG4gICAgYWN0aXZlV2hlbkFyci5mb3JFYWNoKChwYXRoSXRlbSwgaW5kZXgpID0+IHtcbiAgICAgIGlmIChwYXRoSXRlbSAmJiBwYXRoSXRlbSAhPT0gcGF0aEFycltpbmRleF0pIHtcbiAgICAgICAgZmxhZyA9IGZhbHNlO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBmbGFnO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBhY3RpdmVXaGVuKHBhdGgpO1xuICB9XG59O1xudmFyIGxpbmtUbyA9IGFzeW5jICh7XG4gIHRvUm91dGVySW5mbyxcbiAgZnJvbVJvdXRlckluZm8sXG4gIGV2ZW50VHlwZVxufSkgPT4ge1xuICBjb25zdCB7XG4gICAgY3VycmVudCxcbiAgICBhcHBzLFxuICAgIGRlYWN0aXZlLFxuICAgIGFjdGl2ZSxcbiAgICBub3RNYXRjaCxcbiAgICBiZWZvcmVFYWNoOiBiZWZvcmVFYWNoMixcbiAgICBhZnRlckVhY2g6IGFmdGVyRWFjaDIsXG4gICAgYXV0b1JlZnJlc2hBcHBcbiAgfSA9IFJvdXRlckNvbmZpZztcbiAgY29uc3QgZGVhY3RpdmVBcHBzID0gY3VycmVudC5tYXRjaGVkLmZpbHRlcigoYXBwSW5mbykgPT4gIWhhc0FjdGl2ZShhcHBJbmZvLmFjdGl2ZVdoZW4sIGdldFBhdGgoYXBwSW5mby5iYXNlbmFtZSwgbG9jYXRpb24ucGF0aG5hbWUpKSk7XG4gIGNvbnN0IGFjdGl2ZUFwcHMgPSBhcHBzLmZpbHRlcigoYXBwSW5mbykgPT4ge1xuICAgIHJldHVybiBoYXNBY3RpdmUoYXBwSW5mby5hY3RpdmVXaGVuLCBnZXRQYXRoKGFwcEluZm8uYmFzZW5hbWUsIGxvY2F0aW9uLnBhdGhuYW1lKSk7XG4gIH0pO1xuICBjb25zdCBuZWVkVG9BY3RpdmUgPSBhY3RpdmVBcHBzLmZpbHRlcigoeyBuYW1lIH0pID0+IHtcbiAgICByZXR1cm4gIWN1cnJlbnQubWF0Y2hlZC5zb21lKCh7IG5hbWU6IGNOYW1lIH0pID0+IG5hbWUgPT09IGNOYW1lKTtcbiAgfSk7XG4gIGNvbnN0IHRvID0gX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyh7fSwgdG9Sb3V0ZXJJbmZvKSwge1xuICAgIG1hdGNoZWQ6IG5lZWRUb0FjdGl2ZVxuICB9KTtcbiAgY29uc3QgZnJvbSA9IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIGZyb21Sb3V0ZXJJbmZvKSwge1xuICAgIG1hdGNoZWQ6IGRlYWN0aXZlQXBwc1xuICB9KTtcbiAgYXdhaXQgdG9NaWRkbGVXYXJlKHRvLCBmcm9tLCBiZWZvcmVFYWNoMik7XG4gIGlmIChjdXJyZW50Lm1hdGNoZWQubGVuZ3RoID4gMCkge1xuICAgIGF3YWl0IGFzeW5jRm9yRWFjaChkZWFjdGl2ZUFwcHMsIGFzeW5jIChhcHBJbmZvKSA9PiBhd2FpdCBkZWFjdGl2ZShhcHBJbmZvLCBnZXRQYXRoKGFwcEluZm8uYmFzZW5hbWUsIGxvY2F0aW9uLnBhdGhuYW1lKSkpO1xuICB9XG4gIHNldFJvdXRlckNvbmZpZyh7XG4gICAgY3VycmVudDoge1xuICAgICAgcGF0aDogZ2V0UGF0aChSb3V0ZXJDb25maWcuYmFzZW5hbWUpLFxuICAgICAgZnVsbFBhdGg6IGxvY2F0aW9uLnBhdGhuYW1lLFxuICAgICAgaHJlZjogbG9jYXRpb24uaHJlZixcbiAgICAgIG1hdGNoZWQ6IGFjdGl2ZUFwcHMsXG4gICAgICBzdGF0ZTogaGlzdG9yeS5zdGF0ZSxcbiAgICAgIHF1ZXJ5OiBwYXJzZVF1ZXJ5KGxvY2F0aW9uLnNlYXJjaClcbiAgICB9XG4gIH0pO1xuICBjb25zdCBjdXJTdGF0ZSA9IHdpbmRvdy5oaXN0b3J5LnN0YXRlIHx8IHt9O1xuICBpZiAoZXZlbnRUeXBlICE9PSBcInBvcHN0YXRlXCIgJiYgKGN1clN0YXRlW19fR0FSRklTSF9ST1VURVJfVVBEQVRFX0ZMQUdfX10gfHwgYXV0b1JlZnJlc2hBcHApKSB7XG4gICAgY2FsbENhcHR1cmVkRXZlbnRMaXN0ZW5lcnMoZXZlbnRUeXBlKTtcbiAgfVxuICBhd2FpdCBhc3luY0ZvckVhY2gobmVlZFRvQWN0aXZlLCBhc3luYyAoYXBwSW5mbykgPT4ge1xuICAgIGNvbnN0IGFwcFJvb3RQYXRoID0gZ2V0QXBwUm9vdFBhdGgoYXBwSW5mbyk7XG4gICAgYXdhaXQgYWN0aXZlKGFwcEluZm8sIGFwcFJvb3RQYXRoKTtcbiAgfSk7XG4gIGlmIChhY3RpdmVBcHBzLmxlbmd0aCA9PT0gMCAmJiBub3RNYXRjaClcbiAgICBub3RNYXRjaChsb2NhdGlvbi5wYXRobmFtZSk7XG4gIGF3YWl0IHRvTWlkZGxlV2FyZSh0bywgZnJvbSwgYWZ0ZXJFYWNoMik7XG59O1xuXG4vLyBzcmMvYWdlbnRSb3V0ZXIudHNcbnZhciBub3JtYWxBZ2VudCA9ICgpID0+IHtcbiAgY29uc3QgYWRkUm91dGVyTGlzdGVuZXIgPSBmdW5jdGlvbigpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihfX0dBUkZJU0hfQkVGT1JFX1JPVVRFUl9FVkVOVF9fLCBmdW5jdGlvbihlbnYpIHtcbiAgICAgIFJvdXRlckNvbmZpZy5yb3V0ZXJDaGFuZ2UgJiYgUm91dGVyQ29uZmlnLnJvdXRlckNoYW5nZShsb2NhdGlvbi5wYXRobmFtZSk7XG4gICAgICBsaW5rVG8oZW52LmRldGFpbCk7XG4gICAgfSk7XG4gIH07XG4gIGlmICghd2luZG93W19fR0FSRklTSF9ST1VURVJfRkxBR19fXSkge1xuICAgIGNvbnN0IHJld3JpdGUgPSBmdW5jdGlvbih0eXBlKSB7XG4gICAgICBjb25zdCBoYXBpID0gaGlzdG9yeVt0eXBlXTtcbiAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc3QgdXJsQmVmb3JlID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lICsgd2luZG93LmxvY2F0aW9uLmhhc2g7XG4gICAgICAgIGNvbnN0IHN0YXRlQmVmb3JlID0gaGlzdG9yeSA9PSBudWxsID8gdm9pZCAwIDogaGlzdG9yeS5zdGF0ZTtcbiAgICAgICAgY29uc3QgcmVzID0gaGFwaS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICBjb25zdCB1cmxBZnRlciA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSArIHdpbmRvdy5sb2NhdGlvbi5oYXNoO1xuICAgICAgICBjb25zdCBzdGF0ZUFmdGVyID0gaGlzdG9yeSA9PSBudWxsID8gdm9pZCAwIDogaGlzdG9yeS5zdGF0ZTtcbiAgICAgICAgY29uc3QgZSA9IGNyZWF0ZUV2ZW50KHR5cGUpO1xuICAgICAgICBlLmFyZ3VtZW50cyA9IGFyZ3VtZW50cztcbiAgICAgICAgaWYgKHVybEJlZm9yZSAhPT0gdXJsQWZ0ZXIgfHwgSlNPTi5zdHJpbmdpZnkoc3RhdGVCZWZvcmUpICE9PSBKU09OLnN0cmluZ2lmeShzdGF0ZUFmdGVyKSkge1xuICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBjdXN0b21FdmVudF9kZWZhdWx0KF9fR0FSRklTSF9CRUZPUkVfUk9VVEVSX0VWRU5UX18sIHtcbiAgICAgICAgICAgIGRldGFpbDoge1xuICAgICAgICAgICAgICB0b1JvdXRlckluZm86IHtcbiAgICAgICAgICAgICAgICBmdWxsUGF0aDogdXJsQWZ0ZXIsXG4gICAgICAgICAgICAgICAgaHJlZjogbG9jYXRpb24uaHJlZixcbiAgICAgICAgICAgICAgICBxdWVyeTogcGFyc2VRdWVyeShsb2NhdGlvbi5zZWFyY2gpLFxuICAgICAgICAgICAgICAgIHBhdGg6IGdldFBhdGgoUm91dGVyQ29uZmlnLmJhc2VuYW1lLCB1cmxBZnRlciksXG4gICAgICAgICAgICAgICAgc3RhdGU6IHN0YXRlQWZ0ZXJcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZnJvbVJvdXRlckluZm86IHtcbiAgICAgICAgICAgICAgICBmdWxsUGF0aDogdXJsQmVmb3JlLFxuICAgICAgICAgICAgICAgIHF1ZXJ5OiBSb3V0ZXJDb25maWcuY3VycmVudC5xdWVyeSxcbiAgICAgICAgICAgICAgICBocmVmOiBSb3V0ZXJDb25maWcuY3VycmVudC5ocmVmLFxuICAgICAgICAgICAgICAgIHBhdGg6IGdldFBhdGgoUm91dGVyQ29uZmlnLmJhc2VuYW1lLCB1cmxCZWZvcmUpLFxuICAgICAgICAgICAgICAgIHN0YXRlOiBzdGF0ZUJlZm9yZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBldmVudFR5cGU6IHR5cGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgIH07XG4gICAgfTtcbiAgICBoaXN0b3J5LnB1c2hTdGF0ZSA9IHJld3JpdGUoXCJwdXNoU3RhdGVcIik7XG4gICAgaGlzdG9yeS5yZXBsYWNlU3RhdGUgPSByZXdyaXRlKFwicmVwbGFjZVN0YXRlXCIpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicG9wc3RhdGVcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGlmIChldmVudCAmJiB0eXBlb2YgZXZlbnQgPT09IFwib2JqZWN0XCIgJiYgZXZlbnQuZ2FyZmlzaClcbiAgICAgICAgcmV0dXJuO1xuICAgICAgaWYgKGhpc3Rvcnkuc3RhdGUgJiYgdHlwZW9mIGhpc3Rvcnkuc3RhdGUgPT09IFwib2JqZWN0XCIpXG4gICAgICAgIGRlbGV0ZSBoaXN0b3J5LnN0YXRlW19fR0FSRklTSF9ST1VURVJfVVBEQVRFX0ZMQUdfX107XG4gICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgY3VzdG9tRXZlbnRfZGVmYXVsdChfX0dBUkZJU0hfQkVGT1JFX1JPVVRFUl9FVkVOVF9fLCB7XG4gICAgICAgIGRldGFpbDoge1xuICAgICAgICAgIHRvUm91dGVySW5mbzoge1xuICAgICAgICAgICAgZnVsbFBhdGg6IGxvY2F0aW9uLnBhdGhuYW1lLFxuICAgICAgICAgICAgaHJlZjogbG9jYXRpb24uaHJlZixcbiAgICAgICAgICAgIHF1ZXJ5OiBwYXJzZVF1ZXJ5KGxvY2F0aW9uLnNlYXJjaCksXG4gICAgICAgICAgICBwYXRoOiBnZXRQYXRoKFJvdXRlckNvbmZpZy5iYXNlbmFtZSlcbiAgICAgICAgICB9LFxuICAgICAgICAgIGZyb21Sb3V0ZXJJbmZvOiB7XG4gICAgICAgICAgICBmdWxsUGF0aDogUm91dGVyQ29uZmlnLmN1cnJlbnQuZnVsbFBhdGgsXG4gICAgICAgICAgICBwYXRoOiBnZXRQYXRoKFJvdXRlckNvbmZpZy5iYXNlbmFtZSwgUm91dGVyQ29uZmlnLmN1cnJlbnQucGF0aCksXG4gICAgICAgICAgICBocmVmOiBSb3V0ZXJDb25maWcuY3VycmVudC5ocmVmLFxuICAgICAgICAgICAgcXVlcnk6IFJvdXRlckNvbmZpZy5jdXJyZW50LnF1ZXJ5XG4gICAgICAgICAgfSxcbiAgICAgICAgICBldmVudFR5cGU6IFwicG9wc3RhdGVcIlxuICAgICAgICB9XG4gICAgICB9KSk7XG4gICAgfSwgZmFsc2UpO1xuICAgIHdpbmRvd1tfX0dBUkZJU0hfUk9VVEVSX0ZMQUdfX10gPSB0cnVlO1xuICB9XG4gIGFkZFJvdXRlckxpc3RlbmVyKCk7XG59O1xudmFyIGluaXRSZWRpcmVjdCA9ICgpID0+IHtcbiAgbGlua1RvKHtcbiAgICB0b1JvdXRlckluZm86IHtcbiAgICAgIGZ1bGxQYXRoOiBsb2NhdGlvbi5wYXRobmFtZSxcbiAgICAgIGhyZWY6IGxvY2F0aW9uLmhyZWYsXG4gICAgICBwYXRoOiBnZXRQYXRoKFJvdXRlckNvbmZpZy5iYXNlbmFtZSksXG4gICAgICBxdWVyeTogcGFyc2VRdWVyeShsb2NhdGlvbi5zZWFyY2gpLFxuICAgICAgc3RhdGU6IGhpc3Rvcnkuc3RhdGVcbiAgICB9LFxuICAgIGZyb21Sb3V0ZXJJbmZvOiB7XG4gICAgICBmdWxsUGF0aDogXCIvXCIsXG4gICAgICBocmVmOiBcIlwiLFxuICAgICAgcGF0aDogXCIvXCIsXG4gICAgICBxdWVyeToge30sXG4gICAgICBzdGF0ZToge31cbiAgICB9LFxuICAgIGV2ZW50VHlwZTogXCJwdXNoU3RhdGVcIlxuICB9KTtcbn07XG52YXIgbGlzdGVuID0gKCkgPT4ge1xuICBub3JtYWxBZ2VudCgpO1xuICBpbml0UmVkaXJlY3QoKTtcbn07XG5cbi8vIHNyYy9jb250ZXh0LnRzXG52YXIgYmVmb3JlRWFjaCA9IChob29rKSA9PiB7XG4gIHNldChcImJlZm9yZUVhY2hcIiwgaG9vayk7XG59O1xudmFyIGFmdGVyRWFjaCA9IChob29rKSA9PiB7XG4gIHNldChcImFmdGVyRWFjaFwiLCBob29rKTtcbn07XG52YXIgcm91dGVyQ2hhbmdlID0gKGhvb2spID0+IHtcbiAgc2V0KFwicm91dGVyQ2hhbmdlXCIsIGhvb2spO1xufTtcbnZhciByZWdpc3RlclJvdXRlciA9IChBcHBzKSA9PiB7XG4gIGNvbnN0IHVucmVnaXN0ZXJBcHBzID0gQXBwcy5maWx0ZXIoKGFwcCkgPT4gIVJvdXRlckNvbmZpZy5hcHBzLnNvbWUoKGl0ZW0pID0+IGFwcC5uYW1lID09PSBpdGVtLm5hbWUpKTtcbiAgc2V0KFwiYXBwc1wiLCBSb3V0ZXJDb25maWcuYXBwcy5jb25jYXQodW5yZWdpc3RlckFwcHMpKTtcbn07XG52YXIgbGlzdGVuUm91dGVyQW5kUmVEaXJlY3QgPSAoe1xuICBhcHBzLFxuICBiYXNlbmFtZSA9IFwiL1wiLFxuICBhdXRvUmVmcmVzaEFwcCxcbiAgYWN0aXZlLFxuICBkZWFjdGl2ZSxcbiAgbm90TWF0Y2gsXG4gIGxpc3RlbmluZyA9IHRydWVcbn0pID0+IHtcbiAgcmVnaXN0ZXJSb3V0ZXIoYXBwcyk7XG4gIHNldFJvdXRlckNvbmZpZyh7XG4gICAgYmFzZW5hbWUsXG4gICAgYXV0b1JlZnJlc2hBcHAsXG4gICAgYWN0aXZlLFxuICAgIGRlYWN0aXZlLFxuICAgIG5vdE1hdGNoLFxuICAgIGxpc3RlbmluZ1xuICB9KTtcbiAgbGlzdGVuKCk7XG59O1xudmFyIFJvdXRlciA9IHtcbiAgcHVzaCxcbiAgcmVwbGFjZSxcbiAgYmVmb3JlRWFjaCxcbiAgYWZ0ZXJFYWNoLFxuICByZWdpc3RlclJvdXRlcixcbiAgcm91dGVyQ2hhbmdlLFxuICBsaXN0ZW5Sb3V0ZXJBbmRSZURpcmVjdCxcbiAgc2V0Um91dGVyQ29uZmlnLFxuICByb3V0ZXJDb25maWc6IFJvdXRlckNvbmZpZ1xufTtcbnZhciBjb250ZXh0X2RlZmF1bHQgPSBSb3V0ZXI7XG5cbi8vIHNyYy9pbmRleC50c1xuZnVuY3Rpb24gR2FyZmlzaFJvdXRlcihfYXJncykge1xuICByZXR1cm4gZnVuY3Rpb24oR2FyZmlzaCkge1xuICAgIEdhcmZpc2guYXBwcyA9IHt9O1xuICAgIEdhcmZpc2gucm91dGVyID0gY29udGV4dF9kZWZhdWx0O1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBcInJvdXRlclwiLFxuICAgICAgdmVyc2lvbjogXCIxLjE2LjJcIixcbiAgICAgIGJvb3RzdHJhcChvcHRpb25zKSB7XG4gICAgICAgIGxldCBhY3RpdmVBcHAgPSBudWxsO1xuICAgICAgICBjb25zdCB1bm1vdW50cyA9IHt9O1xuICAgICAgICBjb25zdCB7IGJhc2VuYW1lIH0gPSBvcHRpb25zO1xuICAgICAgICBjb25zdCB7IGF1dG9SZWZyZXNoQXBwID0gdHJ1ZSwgb25Ob3RNYXRjaFJvdXRlciA9ICgpID0+IG51bGwgfSA9IEdhcmZpc2gub3B0aW9ucztcbiAgICAgICAgYXN5bmMgZnVuY3Rpb24gYWN0aXZlKGFwcEluZm8sIHJvb3RQYXRoID0gXCIvXCIpIHtcbiAgICAgICAgICByb3V0ZXJMb2coYCR7YXBwSW5mby5uYW1lfSBhY3RpdmVgLCB7XG4gICAgICAgICAgICBhcHBJbmZvLFxuICAgICAgICAgICAgcm9vdFBhdGgsXG4gICAgICAgICAgICBsaXN0ZW5pbmc6IFJvdXRlckNvbmZpZy5saXN0ZW5pbmdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoIVJvdXRlckNvbmZpZy5saXN0ZW5pbmcpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgY29uc3QgeyBuYW1lLCBhY3RpdmU6IGFjdGl2ZTIsIGNhY2hlID0gdHJ1ZSB9ID0gYXBwSW5mbztcbiAgICAgICAgICBpZiAoYWN0aXZlMilcbiAgICAgICAgICAgIHJldHVybiBhY3RpdmUyKGFwcEluZm8sIHJvb3RQYXRoKTtcbiAgICAgICAgICBhcHBJbmZvLnJvb3RQYXRoID0gcm9vdFBhdGg7XG4gICAgICAgICAgY29uc3QgY3VycmVudEFwcCA9IGFjdGl2ZUFwcCA9IGNyZWF0ZUtleSgpO1xuICAgICAgICAgIGNvbnN0IGFwcCA9IGF3YWl0IEdhcmZpc2gubG9hZEFwcChhcHBJbmZvLm5hbWUsIHtcbiAgICAgICAgICAgIGNhY2hlLFxuICAgICAgICAgICAgYmFzZW5hbWU6IHJvb3RQYXRoLFxuICAgICAgICAgICAgZW50cnk6IGFwcEluZm8uZW50cnksXG4gICAgICAgICAgICBkb21HZXR0ZXI6IGFwcEluZm8uZG9tR2V0dGVyXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKGFwcCkge1xuICAgICAgICAgICAgYXBwLmFwcEluZm8uYmFzZW5hbWUgPSByb290UGF0aDtcbiAgICAgICAgICAgIGNvbnN0IGNhbGwgPSBhc3luYyAoYXBwMiwgaXNSZW5kZXIpID0+IHtcbiAgICAgICAgICAgICAgaWYgKCFhcHAyKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgY29uc3QgaXNEZXMgPSBjYWNoZSAmJiBhcHAyLm1vdW50ZWQ7XG4gICAgICAgICAgICAgIGlmIChpc1JlbmRlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCBhcHAyW2lzRGVzID8gXCJzaG93XCIgOiBcIm1vdW50XCJdKCk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFwcDJbaXNEZXMgPyBcImhpZGVcIiA6IFwidW5tb3VudFwiXSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgR2FyZmlzaC5hcHBzW25hbWVdID0gYXBwO1xuICAgICAgICAgICAgdW5tb3VudHNbbmFtZV0gPSAoKSA9PiB7XG4gICAgICAgICAgICAgIGlmIChhcHAubW91bnRpbmcpIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgR2FyZmlzaC5jYWNoZUFwcHNbbmFtZV07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY2FsbChhcHAsIGZhbHNlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoY3VycmVudEFwcCA9PT0gYWN0aXZlQXBwKSB7XG4gICAgICAgICAgICAgIGF3YWl0IGNhbGwoYXBwLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXN5bmMgZnVuY3Rpb24gZGVhY3RpdmUoYXBwSW5mbywgcm9vdFBhdGgpIHtcbiAgICAgICAgICByb3V0ZXJMb2coYCR7YXBwSW5mby5uYW1lfSBkZWFjdGl2ZWAsIHtcbiAgICAgICAgICAgIGFwcEluZm8sXG4gICAgICAgICAgICByb290UGF0aFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGFjdGl2ZUFwcCA9IG51bGw7XG4gICAgICAgICAgY29uc3QgeyBuYW1lLCBkZWFjdGl2ZTogZGVhY3RpdmUyIH0gPSBhcHBJbmZvO1xuICAgICAgICAgIGlmIChkZWFjdGl2ZTIpXG4gICAgICAgICAgICByZXR1cm4gZGVhY3RpdmUyKGFwcEluZm8sIHJvb3RQYXRoKTtcbiAgICAgICAgICBjb25zdCB1bm1vdW50ID0gdW5tb3VudHNbbmFtZV07XG4gICAgICAgICAgdW5tb3VudCAmJiB1bm1vdW50KCk7XG4gICAgICAgICAgZGVsZXRlIEdhcmZpc2guYXBwc1tuYW1lXTtcbiAgICAgICAgICBjb25zdCBuZWVkVG9EZWxldGVBcHBzID0gY29udGV4dF9kZWZhdWx0LnJvdXRlckNvbmZpZy5hcHBzLmZpbHRlcigoYXBwKSA9PiB7XG4gICAgICAgICAgICBpZiAoYXBwSW5mby5yb290UGF0aCA9PT0gYXBwLmJhc2VuYW1lKVxuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAobmVlZFRvRGVsZXRlQXBwcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBuZWVkVG9EZWxldGVBcHBzLmZvckVhY2goKGFwcCkgPT4ge1xuICAgICAgICAgICAgICBkZWxldGUgR2FyZmlzaC5hcHBJbmZvc1thcHAubmFtZV07XG4gICAgICAgICAgICAgIGRlbGV0ZSBHYXJmaXNoLmNhY2hlQXBwc1thcHAubmFtZV07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnRleHRfZGVmYXVsdC5zZXRSb3V0ZXJDb25maWcoe1xuICAgICAgICAgICAgICBhcHBzOiBjb250ZXh0X2RlZmF1bHQucm91dGVyQ29uZmlnLmFwcHMuZmlsdGVyKChhcHApID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gIW5lZWRUb0RlbGV0ZUFwcHMuc29tZSgobmVlZERlbGV0ZSkgPT4gYXBwLm5hbWUgPT09IG5lZWREZWxldGUubmFtZSk7XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYXBwcyA9IE9iamVjdC52YWx1ZXMoR2FyZmlzaC5hcHBJbmZvcyk7XG4gICAgICAgIGNvbnN0IGFwcExpc3QgPSBhcHBzLmZpbHRlcigoYXBwKSA9PiB7XG4gICAgICAgICAgaWYgKCFhcHAuYmFzZW5hbWUpXG4gICAgICAgICAgICBhcHAuYmFzZW5hbWUgPSBiYXNlbmFtZTtcbiAgICAgICAgICByZXR1cm4gISFhcHAuYWN0aXZlV2hlbjtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGxpc3Rlbk9wdGlvbnMgPSB7XG4gICAgICAgICAgYmFzZW5hbWUsXG4gICAgICAgICAgYWN0aXZlLFxuICAgICAgICAgIGRlYWN0aXZlLFxuICAgICAgICAgIGF1dG9SZWZyZXNoQXBwLFxuICAgICAgICAgIG5vdE1hdGNoOiBvbk5vdE1hdGNoUm91dGVyLFxuICAgICAgICAgIGFwcHM6IGFwcExpc3QsXG4gICAgICAgICAgbGlzdGVuaW5nOiB0cnVlXG4gICAgICAgIH07XG4gICAgICAgIHJvdXRlckxvZyhcImxpc3RlblJvdXRlckFuZFJlRGlyZWN0XCIsIGxpc3Rlbk9wdGlvbnMpO1xuICAgICAgICBsaXN0ZW5Sb3V0ZXJBbmRSZURpcmVjdChsaXN0ZW5PcHRpb25zKTtcbiAgICAgIH0sXG4gICAgICByZWdpc3RlckFwcChhcHBJbmZvcykge1xuICAgICAgICBjb25zdCBhcHBMaXN0ID0gT2JqZWN0LnZhbHVlcyhhcHBJbmZvcyk7XG4gICAgICAgIGNvbnRleHRfZGVmYXVsdC5yZWdpc3RlclJvdXRlcihhcHBMaXN0LmZpbHRlcigoYXBwKSA9PiAhIWFwcC5hY3RpdmVXaGVuKSk7XG4gICAgICAgIGlmICghR2FyZmlzaC5ydW5uaW5nKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgcm91dGVyTG9nKFwicmVnaXN0ZXJBcHAgaW5pdFJlZGlyZWN0XCIsIGFwcEluZm9zKTtcbiAgICAgICAgaW5pdFJlZGlyZWN0KCk7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcbn1cbmV4cG9ydCB7XG4gIEdhcmZpc2hSb3V0ZXJcbn07XG4iLCIvLyBzcmMvdXRpbHMudHNcbnZhciBub29wID0gKCkgPT4ge1xufTtcbnZhciBvYmplY3RUb1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG52YXIgc3VwcG9ydFdhc20gPSB0eXBlb2YgV2ViQXNzZW1ibHkgPT09IFwib2JqZWN0XCI7XG52YXIgaWRsZUNhbGxiYWNrID0gd2luZG93LnJlcXVlc3RJZGxlQ2FsbGJhY2sgfHwgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZTtcbmZ1bmN0aW9uIGNyZWF0ZUtleSgpIHtcbiAgcmV0dXJuIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA4KTtcbn1cbmZ1bmN0aW9uIGlzT2JqZWN0KHZhbCkge1xuICByZXR1cm4gdmFsICYmIHR5cGVvZiB2YWwgPT09IFwib2JqZWN0XCI7XG59XG5mdW5jdGlvbiBpc1BsYWluT2JqZWN0KHZhbCkge1xuICByZXR1cm4gb2JqZWN0VG9TdHJpbmcuY2FsbCh2YWwpID09PSBcIltvYmplY3QgT2JqZWN0XVwiO1xufVxuZnVuY3Rpb24gZ2V0VHlwZSh2YWwpIHtcbiAgcmV0dXJuIG9iamVjdFRvU3RyaW5nLmNhbGwodmFsKS5zbGljZSg4LCAtMSkudG9Mb3dlckNhc2UoKTtcbn1cbmZ1bmN0aW9uIGlzUHJvbWlzZShvYmopIHtcbiAgcmV0dXJuIGlzT2JqZWN0KG9iaikgJiYgdHlwZW9mIG9iai50aGVuID09PSBcImZ1bmN0aW9uXCI7XG59XG52YXIgaGFzT3duUHJvcGVydHkgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xuZnVuY3Rpb24gaGFzT3duKG9iaiwga2V5KSB7XG4gIHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KTtcbn1cbmZ1bmN0aW9uIGRlZihvYmosIGtleSwgdmFsdWUpIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7XG4gICAgZ2V0OiAoKSA9PiB2YWx1ZSxcbiAgICBzZXQ6ICh2YWwpID0+IHtcbiAgICAgIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudiAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViA/IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA6IGZhbHNlKSB7XG4gICAgICAgIGlmICh2YWwgIT09IHZhbHVlKSB7XG4gICAgICAgICAgZXJyb3IoYFRyeSB0byBtb2RpZnkgYSByZWFkLW9ubHkgcHJvcGVydHkgJHtrZXl9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGNvbmZpZ3VyYWJsZTogKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID8gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiIDogZmFsc2UpID8gdHJ1ZSA6IGZhbHNlXG4gIH0pO1xufVxuZnVuY3Rpb24gbWFrZU1hcChsaXN0KSB7XG4gIGNvbnN0IG1hcCA9IC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICBtYXBbbGlzdFtpXV0gPSB0cnVlO1xuICB9XG4gIHJldHVybiAodmFsKSA9PiAhIW1hcFt2YWxdO1xufVxuZnVuY3Rpb24gbWFrZU1hcE9iamVjdChsaXN0KSB7XG4gIGNvbnN0IG1hcCA9IC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICBtYXBbbGlzdFtpXV0gPSB0cnVlO1xuICB9XG4gIHJldHVybiBtYXA7XG59XG5mdW5jdGlvbiBpbkJyb3dzZXIoKSB7XG4gIHJldHVybiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiO1xufVxudmFyIHdhcm5QcmVmaXggPSBcIltHYXJmaXNoIHdhcm5pbmddXCI7XG52YXIgcHJvY2Vzc0Vycm9yID0gKGVycm9yMiwgZm4pID0+IHtcbiAgdHJ5IHtcbiAgICBpZiAodHlwZW9mIGVycm9yMiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgZXJyb3IyID0gYCR7d2FyblByZWZpeH06ICR7ZXJyb3IyfVxuXG5gO1xuICAgICAgZm4oZXJyb3IyLCB0cnVlKTtcbiAgICB9IGVsc2UgaWYgKGVycm9yMiBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICBpZiAoIWVycm9yMi5tZXNzYWdlLnN0YXJ0c1dpdGgod2FyblByZWZpeCkpIHtcbiAgICAgICAgZXJyb3IyLm1lc3NhZ2UgPSBgJHt3YXJuUHJlZml4fTogJHtlcnJvcjIubWVzc2FnZX1gO1xuICAgICAgfVxuICAgICAgZm4oZXJyb3IyLCBmYWxzZSk7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgZm4oZXJyb3IyLCB0eXBlb2YgZXJyb3IyID09PSBcInN0cmluZ1wiKTtcbiAgfVxufTtcbmZ1bmN0aW9uIHdhcm4obXNnKSB7XG4gIHByb2Nlc3NFcnJvcihtc2csIChlLCBpc1N0cmluZykgPT4ge1xuICAgIGNvbnN0IHdhcm5Nc2cgPSBpc1N0cmluZyA/IGUgOiBlLm1lc3NhZ2U7XG4gICAgaWYgKGZhbHNlKSB7XG4gICAgICBjYWxsVGVzdENhbGxiYWNrKHdhcm4sIHdhcm5Nc2cpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zb2xlLndhcm4od2Fybk1zZyk7XG4gIH0pO1xufVxuZnVuY3Rpb24gZXJyb3IoZXJyb3IyKSB7XG4gIHByb2Nlc3NFcnJvcihlcnJvcjIsIChlLCBpc1N0cmluZykgPT4ge1xuICAgIGlmIChpc1N0cmluZykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBlO1xuICAgIH1cbiAgfSk7XG59XG5mdW5jdGlvbiB2YWxpZFVSTChzdHIpIHtcbiAgY29uc3QgcGF0dGVybiA9IG5ldyBSZWdFeHAoXCJeKGh0dHBzPzpcXFxcL1xcXFwvKT8oKChbYS16XFxcXGRdKFthLXpcXFxcZC1dKlthLXpcXFxcZF0pKilcXFxcLikrW2Etel17Mix9fCgoXFxcXGR7MSwzfVxcXFwuKXszfVxcXFxkezEsM30pKShcXFxcOlxcXFxkKyk/KFxcXFwvWy1hLXpcXFxcZCVfLn4rXSopKihcXFxcP1s7JmEtelxcXFxkJV8ufis9LV0qKT8oXFxcXCNbLWEtelxcXFxkX10qKT8kXCIsIFwiaVwiKTtcbiAgcmV0dXJuICEhcGF0dGVybi50ZXN0KHN0cik7XG59XG5mdW5jdGlvbiBpbnRlcm5GdW5jKGludGVybmFsaXplU3RyaW5nKSB7XG4gIGNvbnN0IHRlbXBvcmFyeU9iID0ge307XG4gIHRlbXBvcmFyeU9iW2ludGVybmFsaXplU3RyaW5nXSA9IHRydWU7XG4gIHJldHVybiBPYmplY3Qua2V5cyh0ZW1wb3JhcnlPYilbMF07XG59XG5mdW5jdGlvbiBldmFsV2l0aEVudihjb2RlLCBwYXJhbXMsIGNvbnRleHQsIHVzZVN0cmljdCA9IGZhbHNlKSB7XG4gIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhwYXJhbXMpO1xuICBjb25zdCBuYXRpdmVXaW5kb3cgPSAoMCwgZXZhbCkoXCJ3aW5kb3c7XCIpO1xuICBjb25zdCByYW5kb21WYWxLZXkgPSBcIl9fZ2FyZmlzaF9fZXhlY190ZW1wb3JhcnlfX1wiO1xuICBjb25zdCB2YWx1ZXMgPSBrZXlzLm1hcCgoaykgPT4gYHdpbmRvdy4ke3JhbmRvbVZhbEtleX0uJHtrfWApO1xuICBjb25zdCBjb250ZXh0S2V5ID0gXCJfX2dhcmZpc2hfZXhlY190ZW1wb3JhcnlfY29udGV4dF9fXCI7XG4gIHRyeSB7XG4gICAgbmF0aXZlV2luZG93W3JhbmRvbVZhbEtleV0gPSBwYXJhbXM7XG4gICAgbmF0aXZlV2luZG93W2NvbnRleHRLZXldID0gY29udGV4dDtcbiAgICBjb25zdCBldmFsSW5mbyA9IFtcbiAgICAgIGA7KGZ1bmN0aW9uKCR7a2V5cy5qb2luKFwiLFwiKX0peyR7dXNlU3RyaWN0ID8gJ1widXNlIHN0cmljdFwiOycgOiBcIlwifWAsXG4gICAgICBgXG59KS5jYWxsKHdpbmRvdy4ke2NvbnRleHRLZXl9LCR7dmFsdWVzLmpvaW4oXCIsXCIpfSk7YFxuICAgIF07XG4gICAgY29uc3QgaW50ZXJuYWxpemVTdHJpbmcgPSBpbnRlcm5GdW5jKGV2YWxJbmZvWzBdICsgY29kZSArIGV2YWxJbmZvWzFdKTtcbiAgICAoMCwgZXZhbCkoaW50ZXJuYWxpemVTdHJpbmcpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgZTtcbiAgfSBmaW5hbGx5IHtcbiAgICBkZWxldGUgbmF0aXZlV2luZG93W3JhbmRvbVZhbEtleV07XG4gICAgZGVsZXRlIG5hdGl2ZVdpbmRvd1tjb250ZXh0S2V5XTtcbiAgfVxufVxuZnVuY3Rpb24gc2FmZVdyYXBwZXIoY2FsbGJhY2ssIGRpc2FibGVXYXJuKSB7XG4gIHRyeSB7XG4gICAgY2FsbGJhY2soKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgICFkaXNhYmxlV2FybiAmJiAodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPyBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgOiBmYWxzZSkgJiYgd2FybihlKTtcbiAgfVxufVxuZnVuY3Rpb24gbmV4dFRpY2soY2IpIHtcbiAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihjYik7XG59XG5mdW5jdGlvbiBhc3NlcnQoY29uZGl0aW9uLCBtc2cpIHtcbiAgaWYgKCFjb25kaXRpb24pIHtcbiAgICBlcnJvcihtc2cgfHwgXCJ1bmtub3cgcmVhc29uXCIpO1xuICB9XG59XG5mdW5jdGlvbiB0b0Jvb2xlYW4odmFsKSB7XG4gIGlmICh2YWwgPT09IFwiXCIpXG4gICAgcmV0dXJuIHRydWU7XG4gIGlmICh2YWwgPT09IFwiZmFsc2VcIilcbiAgICByZXR1cm4gZmFsc2U7XG4gIHJldHVybiBCb29sZWFuKHZhbCk7XG59XG5mdW5jdGlvbiByZW1vdmUobGlzdCwgZWwpIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkobGlzdCkpIHtcbiAgICBjb25zdCBpID0gbGlzdC5pbmRleE9mKGVsKTtcbiAgICBpZiAoaSA+IC0xKSB7XG4gICAgICBsaXN0LnNwbGljZShpLCAxKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0gZWxzZSB7XG4gICAgaWYgKGxpc3QuaGFzKGVsKSkge1xuICAgICAgbGlzdC5kZWxldGUoZWwpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuZnVuY3Rpb24gY2FsbFRlc3RDYWxsYmFjayhvYmosIC4uLmFyZ3MpIHtcbiAgaWYgKGZhbHNlKSB7XG4gICAgY29uc3Qgb25jYWxsZWQgPSBvYmouX29uY2FsbGVkO1xuICAgIGlmICh0eXBlb2Ygb25jYWxsZWQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgb25jYWxsZWQuYXBwbHkobnVsbCwgYXJncyk7XG4gICAgfVxuICB9XG59XG5mdW5jdGlvbiB1bmlxdWUobGlzdCkge1xuICBjb25zdCByZXMgPSBbXTtcbiAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IGxpc3QubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICBmb3IgKGxldCBqID0gaSArIDE7IGogPCBsZW47IGorKykge1xuICAgICAgaWYgKGxpc3RbaV0gPT09IGxpc3Rbal0pIHtcbiAgICAgICAgaiA9ICsraTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmVzLnB1c2gobGlzdFtpXSk7XG4gIH1cbiAgcmV0dXJuIGZhbHNlID8gcmVzLnNvcnQoKSA6IHJlcztcbn1cbmZ1bmN0aW9uIGlzUHJpbWl0aXZlKHZhbCkge1xuICByZXR1cm4gdmFsID09PSBudWxsIHx8IHR5cGVvZiB2YWwgPT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIHZhbCA9PT0gXCJudW1iZXJcIiB8fCB0eXBlb2YgdmFsID09PSBcImJpZ2ludFwiIHx8IHR5cGVvZiB2YWwgPT09IFwic3ltYm9sXCIgfHwgdHlwZW9mIHZhbCA9PT0gXCJib29sZWFuXCIgfHwgdHlwZW9mIHZhbCA9PT0gXCJ1bmRlZmluZWRcIiB8fCBvYmplY3RUb1N0cmluZy5jYWxsKHZhbCkgPT09IFwiW29iamVjdCBSZWdFeHBdXCI7XG59XG5mdW5jdGlvbiBmaWx0ZXJVbmRlZmluZWRWYWwob2IpIHtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKG9iKS5yZWR1Y2UoKHJlcywga2V5KSA9PiB7XG4gICAgaWYgKHJlc1trZXldID09PSB2b2lkIDApIHtcbiAgICAgIGRlbGV0ZSByZXNba2V5XTtcbiAgICB9XG4gICAgcmV0dXJuIHJlcztcbiAgfSwgb2IpO1xufVxuZnVuY3Rpb24gZGVlcE1lcmdlKG8sIG4sIGRwLCBpZ25vcmVzKSB7XG4gIGNvbnN0IGxlZnRSZWNvcmQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTtcbiAgY29uc3QgcmlnaHRSZWNvcmQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTtcbiAgY29uc3QgdmFsdWVSZWNvcmQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTtcbiAgY29uc3QgaWdub3Jlc01hcCA9IG1ha2VNYXAoaWdub3JlcyB8fCBbXSk7XG4gIGNvbnN0IGlzQXJyYXkgPSBBcnJheS5pc0FycmF5O1xuICBjb25zdCBpc0FsbFJlZnMgPSAoYSwgYikgPT4ge1xuICAgIGlmIChsZWZ0UmVjb3JkLmhhcyhhKSB8fCByaWdodFJlY29yZC5oYXMoYSkpIHtcbiAgICAgIHJldHVybiBsZWZ0UmVjb3JkLmhhcyhiKSB8fCByaWdodFJlY29yZC5oYXMoYik7XG4gICAgfVxuICB9O1xuICBjb25zdCBjbG9uZSA9ICh2KSA9PiB7XG4gICAgaWYgKGlzUHJpbWl0aXZlKHYpIHx8IHR5cGVvZiB2ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHJldHVybiB2O1xuICAgIH0gZWxzZSBpZiAodmFsdWVSZWNvcmQuaGFzKHYpKSB7XG4gICAgICByZXR1cm4gdmFsdWVSZWNvcmQuZ2V0KHYpO1xuICAgIH0gZWxzZSBpZiAobGVmdFJlY29yZC5oYXModikpIHtcbiAgICAgIHJldHVybiBsZWZ0UmVjb3JkLmdldCh2KTtcbiAgICB9IGVsc2UgaWYgKHJpZ2h0UmVjb3JkLmhhcyh2KSkge1xuICAgICAgcmV0dXJuIHJpZ2h0UmVjb3JkLmdldCh2KTtcbiAgICB9IGVsc2UgaWYgKGlzQXJyYXkodikpIHtcbiAgICAgIGlmIChkcClcbiAgICAgICAgdiA9IHVuaXF1ZSh2KTtcbiAgICAgIGNvbnN0IGFyciA9IFtdO1xuICAgICAgdmFsdWVSZWNvcmQuc2V0KHYsIGFycik7XG4gICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gdi5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBhcnJbaV0gPSBjbG9uZSh2W2ldKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhcnI7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdiA9PT0gXCJvYmplY3RcIikge1xuICAgICAgY29uc3Qgb2JqID0ge307XG4gICAgICB2YWx1ZVJlY29yZC5zZXQodiwgb2JqKTtcbiAgICAgIGNvbnN0IGtleXMgPSBSZWZsZWN0Lm93bktleXModik7XG4gICAgICBrZXlzLmZvckVhY2goKGtleSkgPT4gb2JqW2tleV0gPSBjbG9uZSh2W2tleV0pKTtcbiAgICAgIHJldHVybiBvYmo7XG4gICAgfVxuICB9O1xuICBjb25zdCBzZXRWYWx1ZSA9IChyLCBrLCBrZXkpID0+IHtcbiAgICBpZiAoci5oYXMoaykpIHtcbiAgICAgIHJldHVybiByLmdldChrKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGlnbm9yZXNNYXBba2V5XSkge1xuICAgICAgICByZXR1cm4gaztcbiAgICAgIH1cbiAgICAgIGNvbnN0IHZhbCA9IGNsb25lKGspO1xuICAgICAgaWYgKCFpc1ByaW1pdGl2ZSh2YWwpICYmIHR5cGVvZiB2YWwgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByLnNldChrLCB2YWwpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbDtcbiAgICB9XG4gIH07XG4gIGNvbnN0IG1lcmdlT2JqZWN0ID0gKGwsIHIpID0+IHtcbiAgICBjb25zdCByZXMgPSB7fTtcbiAgICBjb25zdCBsZWZ0S2V5cyA9IFJlZmxlY3Qub3duS2V5cyhsKTtcbiAgICBjb25zdCByaWdodEtleXMgPSBSZWZsZWN0Lm93bktleXMocik7XG4gICAgbGVmdFJlY29yZC5zZXQobCwgcmVzKTtcbiAgICByaWdodFJlY29yZC5zZXQociwgcmVzKTtcbiAgICBsZWZ0S2V5cy5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgIGNvbnN0IGx2ID0gbFtrZXldO1xuICAgICAgY29uc3QgcnYgPSByW2tleV07XG4gICAgICBpZiAoaGFzT3duKHIsIGtleSkpIHtcbiAgICAgICAgaWYgKGlzQXJyYXkobHYpICYmIGlzQXJyYXkocnYpKSB7XG4gICAgICAgICAgY29uc3QgaXRlbSA9IGNsb25lKFsuLi5sdiwgLi4ucnZdKTtcbiAgICAgICAgICByZXNba2V5XSA9IGRwID8gdW5pcXVlKGl0ZW0pIDogaXRlbTtcbiAgICAgICAgfSBlbHNlIGlmIChpc1BsYWluT2JqZWN0KGx2KSAmJiBpc1BsYWluT2JqZWN0KHJ2KSkge1xuICAgICAgICAgIHJlc1trZXldID0gaXNBbGxSZWZzKGx2LCBydikgPyBsZWZ0UmVjb3JkLmdldChsdikgOiBtZXJnZU9iamVjdChsdiwgcnYpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc1trZXldID0gc2V0VmFsdWUocmlnaHRSZWNvcmQsIHJ2LCBrZXkpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNba2V5XSA9IHNldFZhbHVlKGxlZnRSZWNvcmQsIGx2LCBrZXkpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJpZ2h0S2V5cy5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgIGlmIChoYXNPd24ocmVzLCBrZXkpKVxuICAgICAgICByZXR1cm47XG4gICAgICByZXNba2V5XSA9IHNldFZhbHVlKHJpZ2h0UmVjb3JkLCByW2tleV0sIGtleSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlcztcbiAgfTtcbiAgcmV0dXJuIG1lcmdlT2JqZWN0KG8sIG4pO1xufVxuZnVuY3Rpb24gaXNBYnNvbHV0ZSh1cmwpIHtcbiAgaWYgKCEvXlthLXpBLVpdOlxcXFwvLnRlc3QodXJsKSkge1xuICAgIGlmICgvXlthLXpBLVpdW2EtekEtWlxcZCtcXC0uXSo6Ly50ZXN0KHVybCkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiB0cmFuc2Zvcm1VcmwocmVzb2x2ZVBhdGgsIGN1clBhdGgpIHtcbiAgY29uc3QgYmFzZVVybCA9IG5ldyBVUkwocmVzb2x2ZVBhdGgsIGxvY2F0aW9uLmhyZWYpO1xuICBjb25zdCByZWFsUGF0aCA9IG5ldyBVUkwoY3VyUGF0aCwgYmFzZVVybC5ocmVmKTtcbiAgcmV0dXJuIHJlYWxQYXRoLmhyZWY7XG59XG5mdW5jdGlvbiB0b1dzUHJvdG9jb2wodXJsKSB7XG4gIGNvbnN0IGRhdGEgPSBuZXcgVVJMKHVybCk7XG4gIGlmIChkYXRhLnByb3RvY29sLnN0YXJ0c1dpdGgoXCJodHRwXCIpKSB7XG4gICAgZGF0YS5wcm90b2NvbCA9IGRhdGEucHJvdG9jb2wgPT09IFwiaHR0cHM6XCIgPyBcIndzczpcIiA6IFwid3M6XCI7XG4gICAgcmV0dXJuIGRhdGEudG9TdHJpbmcoKTtcbiAgfVxuICByZXR1cm4gdXJsO1xufVxuZnVuY3Rpb24gZmluZFRhcmdldChlbCwgc2VsZWN0b3JzKSB7XG4gIGZvciAoY29uc3QgcyBvZiBzZWxlY3RvcnMpIHtcbiAgICBjb25zdCB0YXJnZXQgPSBlbC5xdWVyeVNlbGVjdG9yKHMpO1xuICAgIGlmICh0YXJnZXQpXG4gICAgICByZXR1cm4gdGFyZ2V0O1xuICB9XG4gIHJldHVybiBlbDtcbn1cbmZ1bmN0aW9uIHNldERvY0N1cnJlbnRTY3JpcHQodGFyZ2V0LCBjb2RlLCBkZWZpbmUsIHVybCwgYXN5bmMsIGRlZmVyLCBvcmlnaW5TY3JpcHQpIHtcbiAgaWYgKCF0YXJnZXQpXG4gICAgcmV0dXJuIG5vb3A7XG4gIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcbiAgaWYgKCF1cmwgJiYgY29kZSkge1xuICAgIGVsLnRleHRDb250ZW50ID0gY29kZTtcbiAgfVxuICBpZiAodXJsKSB7XG4gICAgZWwuc3JjID0gdXJsO1xuICB9XG4gIG9yaWdpblNjcmlwdCAmJiBvcmlnaW5TY3JpcHQuZ2V0QXR0cmlidXRlTmFtZXMoKS5mb3JFYWNoKChhdHRyaWJ1dGUpID0+IHtcbiAgICBlbC5zZXRBdHRyaWJ1dGUoYXR0cmlidXRlLCBvcmlnaW5TY3JpcHQuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZSkgfHwgXCJcIik7XG4gIH0pO1xuICBpZiAoYXN5bmMpIHtcbiAgICBlbC5zZXRBdHRyaWJ1dGUoXCJhc3luY1wiLCBcInRydWVcIik7XG4gIH1cbiAgaWYgKGRlZmVyKSB7XG4gICAgZWwuc2V0QXR0cmlidXRlKFwiZGVmZXJcIiwgXCJ0cnVlXCIpO1xuICB9XG4gIGNvbnN0IHNldCA9ICh2YWwpID0+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKGRlZmluZSkge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBcImN1cnJlbnRTY3JpcHRcIiwge1xuICAgICAgICAgIHZhbHVlOiB2YWwsXG4gICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGFyZ2V0LmN1cnJlbnRTY3JpcHQgPSB2YWw7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WID8gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiIDogZmFsc2UpIHtcbiAgICAgICAgd2FybihlKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIHNldChlbCk7XG4gIHJldHVybiAoKSA9PiBzYWZlV3JhcHBlcigoKSA9PiBkZWxldGUgdGFyZ2V0LmN1cnJlbnRTY3JpcHQsIHRydWUpO1xufVxuZnVuY3Rpb24gX2V4dGVuZHMoZCwgYikge1xuICBPYmplY3Quc2V0UHJvdG90eXBlT2YoZCwgYik7XG4gIGZ1bmN0aW9uIGZOT1AoKSB7XG4gICAgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7XG4gIH1cbiAgaWYgKGIgPT09IG51bGwpIHtcbiAgICBkLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoYik7XG4gIH0gZWxzZSB7XG4gICAgaWYgKGIucHJvdG90eXBlKVxuICAgICAgZk5PUC5wcm90b3R5cGUgPSBiLnByb3RvdHlwZTtcbiAgICBkLnByb3RvdHlwZSA9IG5ldyBmTk9QKCk7XG4gIH1cbn1cbmZ1bmN0aW9uIG1hcE9iamVjdChvYmosIGZuKSB7XG4gIGNvbnN0IGRlc3RPYmplY3QgPSB7fTtcbiAgZm9yIChjb25zdCBrZXkgaW4gb2JqKSB7XG4gICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICBkZXN0T2JqZWN0W2tleV0gPSBmbihrZXksIG9ialtrZXldKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGRlc3RPYmplY3Q7XG59XG5mdW5jdGlvbiB0b0Jhc2U2NChpbnB1dCwgbWltZVR5cGUpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICByZWFkZXIucmVhZEFzRGF0YVVSTChuZXcgQmxvYihbaW5wdXRdLCB7IHR5cGU6IG1pbWVUeXBlIH0pKTtcbiAgICByZWFkZXIub25sb2FkID0gKCkgPT4gcmVzb2x2ZShyZWFkZXIucmVzdWx0KTtcbiAgfSk7XG59XG52YXIgaG9va09iamVjdFByb3BlcnR5ID0gKG9iaiwga2V5LCBob29rRnVuYykgPT4ge1xuICByZXR1cm4gKC4uLnBhcmFtcykgPT4ge1xuICAgIGlmICghb2JqKSB7XG4gICAgICByZXR1cm4gbm9vcDtcbiAgICB9XG4gICAgY29uc3Qgb3JpZ2luID0gb2JqW2tleV07XG4gICAgY29uc3QgaG9va2VkVW5zYWZlID0gaG9va0Z1bmMob3JpZ2luLCAuLi5wYXJhbXMpO1xuICAgIGxldCBob29rZWQgPSBob29rZWRVbnNhZmU7XG4gICAgaWYgKHR5cGVvZiBob29rZWQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgaG9va2VkID0gZnVuY3Rpb24oLi4uYXJncykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHJldHVybiBob29rZWRVbnNhZmUuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICByZXR1cm4gdHlwZW9mIG9yaWdpbiA9PT0gXCJmdW5jdGlvblwiICYmIG9yaWdpbi5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gICAgb2JqW2tleV0gPSBob29rZWQ7XG4gICAgcmV0dXJuIChzdHJpY3QpID0+IHtcbiAgICAgIGlmICghc3RyaWN0IHx8IGhvb2tlZCA9PT0gb2JqW2tleV0pIHtcbiAgICAgICAgb2JqW2tleV0gPSBvcmlnaW47XG4gICAgICB9XG4gICAgfTtcbiAgfTtcbn07XG5mdW5jdGlvbiBnZXRQYXJhbWV0ZXJCeU5hbWUobmFtZSwgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWYpIHtcbiAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW1xcXV0vZywgXCJcXFxcJCZcIik7XG4gIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChcIls/Jl1cIiArIG5hbWUgKyBcIig9KFteJiNdKil8JnwjfCQpXCIpLCByZXN1bHRzID0gcmVnZXguZXhlYyh1cmwpO1xuICBpZiAoIXJlc3VsdHMpXG4gICAgcmV0dXJuIG51bGw7XG4gIGlmICghcmVzdWx0c1syXSlcbiAgICByZXR1cm4gXCJcIjtcbiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCBcIiBcIikpO1xufVxuZnVuY3Rpb24gZ2V0R2FyZmlzaERlYnVnSW5zdGFuY2VOYW1lKCkge1xuICBjb25zdCBERUJVR19HQVJGSVNIX1RBRyA9IFwiX19HQVJGSVNIX0lOU1RBTkNFX0RFQlVHX19cIjtcbiAgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKERFQlVHX0dBUkZJU0hfVEFHKSB8fCBnZXRQYXJhbWV0ZXJCeU5hbWUoREVCVUdfR0FSRklTSF9UQUcpO1xufVxuZnVuY3Rpb24gc2FmYXJpMTNEZWFsKCkge1xuICBsZXQgZnJvbVNldEZsYWcgPSBmYWxzZTtcbiAgcmV0dXJuIHtcbiAgICB0cmlnZ2VyU2V0KCkge1xuICAgICAgZnJvbVNldEZsYWcgPSB0cnVlO1xuICAgIH0sXG4gICAgaGFuZGxlRGVzY3JpcHRvcihkZXNjcmlwdG9yKSB7XG4gICAgICBpZiAoZnJvbVNldEZsYWcgPT09IHRydWUpIHtcbiAgICAgICAgZnJvbVNldEZsYWcgPSBmYWxzZTtcbiAgICAgICAgaWYgKChkZXNjcmlwdG9yID09IG51bGwgPyB2b2lkIDAgOiBkZXNjcmlwdG9yLndyaXRhYmxlKSA9PT0gZmFsc2UpXG4gICAgICAgICAgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7XG4gICAgICAgIGlmICgoZGVzY3JpcHRvciA9PSBudWxsID8gdm9pZCAwIDogZGVzY3JpcHRvci5lbnVtZXJhYmxlKSA9PT0gZmFsc2UpXG4gICAgICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gdHJ1ZTtcbiAgICAgICAgaWYgKChkZXNjcmlwdG9yID09IG51bGwgPyB2b2lkIDAgOiBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSkgPT09IGZhbHNlKVxuICAgICAgICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG52YXIgU09VUkNFTUFQX1JFRyA9IC9bQCNdIHNvdXJjZU1hcHBpbmdVUkw9L2c7XG5mdW5jdGlvbiBoYXZlU291cmNlbWFwKGNvZGUpIHtcbiAgcmV0dXJuIFNPVVJDRU1BUF9SRUcudGVzdChjb2RlKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVNvdXJjZW1hcChjb2RlLCBmaWxlbmFtZSkge1xuICBjb25zdCBjb250ZW50ID0gYXdhaXQgdG9CYXNlNjQoSlNPTi5zdHJpbmdpZnkoe1xuICAgIHZlcnNpb246IDMsXG4gICAgc291cmNlczogW2ZpbGVuYW1lXSxcbiAgICBzb3VyY2VzQ29udGVudDogW2NvZGVdLFxuICAgIG1hcHBpbmdzOiBcIjtcIiArIGNvZGUuc3BsaXQoXCJcXG5cIikubWFwKCgpID0+IFwiQUFDQVwiKS5qb2luKFwiO1wiKVxuICB9KSk7XG4gIHJldHVybiBgLy9AIHNvdXJjZU1hcHBpbmdVUkw9JHtjb250ZW50fWA7XG59XG5mdW5jdGlvbiBnZXRTb3VyY2VVUkwodXJsKSB7XG4gIGlmICh1cmwgaW5zdGFuY2VvZiBVUkwpXG4gICAgcmV0dXJuIHVybC5ocmVmO1xuICBpZiAodXJsIGluc3RhbmNlb2YgUmVxdWVzdClcbiAgICByZXR1cm4gdXJsLnVybDtcbiAgcmV0dXJuIHVybC5zdGFydHNXaXRoKFwiL1wiKSA/IGAke2xvY2F0aW9uLm9yaWdpbn0ke3VybH1gIDogdXJsO1xufVxuZnVuY3Rpb24gbWFjcm9UYXNrKHZhbHVlLCB0aW1lID0gMCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHJlc29sdmUodmFsdWUpLCB0aW1lKTtcbiAgfSk7XG59XG5cbi8vIHNyYy9xdWV1ZS50c1xudmFyIFF1ZXVlID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmZ4ID0gW107XG4gICAgdGhpcy5pbml0ID0gdHJ1ZTtcbiAgICB0aGlzLmxvY2sgPSBmYWxzZTtcbiAgICB0aGlzLmZpbmlzaERlZmVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7XG4gIH1cbiAgbmV4dCgpIHtcbiAgICBpZiAoIXRoaXMubG9jaykge1xuICAgICAgdGhpcy5sb2NrID0gdHJ1ZTtcbiAgICAgIGlmICh0aGlzLmZ4Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0aGlzLmluaXQgPSB0cnVlO1xuICAgICAgICB0aGlzLmZpbmlzaERlZmVycy5mb3JFYWNoKChkKSA9PiBkLnJlc29sdmUoKSk7XG4gICAgICAgIHRoaXMuZmluaXNoRGVmZXJzLmNsZWFyKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBmbiA9IHRoaXMuZnguc2hpZnQoKTtcbiAgICAgICAgaWYgKGZuKSB7XG4gICAgICAgICAgZm4oKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5sb2NrID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLm5leHQoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBhZGQoZm4pIHtcbiAgICB0aGlzLmZ4LnB1c2goZm4pO1xuICAgIGlmICh0aGlzLmluaXQpIHtcbiAgICAgIHRoaXMubG9jayA9IGZhbHNlO1xuICAgICAgdGhpcy5pbml0ID0gZmFsc2U7XG4gICAgICB0aGlzLm5leHQoKTtcbiAgICB9XG4gIH1cbiAgYXdhaXRDb21wbGV0aW9uKCkge1xuICAgIGlmICh0aGlzLmluaXQpXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgY29uc3QgZGVmZXIgPSB7fTtcbiAgICB0aGlzLmZpbmlzaERlZmVycy5hZGQoZGVmZXIpO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBkZWZlci5yZXNvbHZlID0gcmVzb2x2ZTtcbiAgICAgIGRlZmVyLnJlamVjdCA9IHJlamVjdDtcbiAgICB9KTtcbiAgfVxufTtcblxuLy8gc3JjL3NlbnRyeS50c1xudmFyIGNocm9tZSA9IC9eXFxzKmF0ICg/OiguKj8pID9cXCgpPygoPzpmaWxlfGh0dHBzP3xibG9ifGNocm9tZS1leHRlbnNpb258YWRkcmVzc3xuYXRpdmV8ZXZhbHx3ZWJwYWNrfDxhbm9ueW1vdXM+fFstYS16XSs6fC4qYnVuZGxlfFxcLykuKj8pKD86OihcXGQrKSk/KD86OihcXGQrKSk/XFwpP1xccyokL2k7XG52YXIgZ2Vja28gPSAvXlxccyooLio/KSg/OlxcKCguKj8pXFwpKT8oPzpefEApPygoPzpmaWxlfGh0dHBzP3xibG9ifGNocm9tZXx3ZWJwYWNrfHJlc291cmNlfG1vei1leHRlbnNpb258Y2FwYWNpdG9yKS4qPzpcXC8uKj98XFxbbmF0aXZlIGNvZGVcXF18W15AXSooPzpidW5kbGV8XFxkK1xcLmpzKXxcXC9bXFx3XFwtLiAvPV0rKSg/OjooXFxkKykpPyg/OjooXFxkKykpP1xccyokL2k7XG52YXIgd2luanMgPSAvXlxccyphdCAoPzooKD86XFxbb2JqZWN0IG9iamVjdFxcXSk/LispICk/XFwoPygoPzpmaWxlfG1zLWFwcHh8aHR0cHM/fHdlYnBhY2t8YmxvYik6Lio/KTooXFxkKykoPzo6KFxcZCspKT9cXCk/XFxzKiQvaTtcbnZhciBnZWNrb0V2YWwgPSAvKFxcUyspIGxpbmUgKFxcZCspKD86ID4gZXZhbCBsaW5lIFxcZCspKiA+IGV2YWwvaTtcbnZhciBjaHJvbWVFdmFsID0gL1xcKChcXFMqKSg/OjooXFxkKykpKD86OihcXGQrKSlcXCkvO1xudmFyIFVOS05PV05fRlVOQ1RJT04gPSBcIj9cIjtcbmZ1bmN0aW9uIGV4dHJhY3RNZXNzYWdlKGV4KSB7XG4gIGNvbnN0IG1lc3NhZ2UgPSBleCAmJiBleC5tZXNzYWdlO1xuICBpZiAoIW1lc3NhZ2UpIHtcbiAgICByZXR1cm4gXCJObyBlcnJvciBtZXNzYWdlXCI7XG4gIH1cbiAgaWYgKG1lc3NhZ2UuZXJyb3IgJiYgdHlwZW9mIG1lc3NhZ2UuZXJyb3IubWVzc2FnZSA9PT0gXCJzdHJpbmdcIikge1xuICAgIHJldHVybiBtZXNzYWdlLmVycm9yLm1lc3NhZ2U7XG4gIH1cbiAgcmV0dXJuIG1lc3NhZ2U7XG59XG5mdW5jdGlvbiBjb21wdXRlU3RhY2tUcmFjZUZyb21TdGFja1Byb3AoZXgpIHtcbiAgaWYgKCFleCB8fCAhZXguc3RhY2spIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCBzdGFjayA9IFtdO1xuICBjb25zdCBsaW5lcyA9IGV4LnN0YWNrLnNwbGl0KFwiXFxuXCIpO1xuICBsZXQgaXNFdmFsO1xuICBsZXQgc3VibWF0Y2g7XG4gIGxldCBwYXJ0cztcbiAgbGV0IGVsZW1lbnQ7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyArK2kpIHtcbiAgICBpZiAocGFydHMgPSBjaHJvbWUuZXhlYyhsaW5lc1tpXSkpIHtcbiAgICAgIGNvbnN0IGlzTmF0aXZlID0gcGFydHNbMl0gJiYgcGFydHNbMl0uaW5kZXhPZihcIm5hdGl2ZVwiKSA9PT0gMDtcbiAgICAgIGlzRXZhbCA9IHBhcnRzWzJdICYmIHBhcnRzWzJdLmluZGV4T2YoXCJldmFsXCIpID09PSAwO1xuICAgICAgaWYgKGlzRXZhbCAmJiAoc3VibWF0Y2ggPSBjaHJvbWVFdmFsLmV4ZWMocGFydHNbMl0pKSkge1xuICAgICAgICBwYXJ0c1syXSA9IHN1Ym1hdGNoWzFdO1xuICAgICAgfVxuICAgICAgbGV0IHVybCA9IHBhcnRzWzJdICYmIHBhcnRzWzJdLmluZGV4T2YoXCJhZGRyZXNzIGF0IFwiKSA9PT0gMCA/IHBhcnRzWzJdLnN1YnN0cihcImFkZHJlc3MgYXQgXCIubGVuZ3RoKSA6IHBhcnRzWzJdO1xuICAgICAgbGV0IGZ1bmMgPSBwYXJ0c1sxXSB8fCBVTktOT1dOX0ZVTkNUSU9OO1xuICAgICAgY29uc3QgaXNTYWZhcmlFeHRlbnNpb24gPSBmdW5jLmluZGV4T2YoXCJzYWZhcmktZXh0ZW5zaW9uXCIpICE9PSAtMTtcbiAgICAgIGNvbnN0IGlzU2FmYXJpV2ViRXh0ZW5zaW9uID0gZnVuYy5pbmRleE9mKFwic2FmYXJpLXdlYi1leHRlbnNpb25cIikgIT09IC0xO1xuICAgICAgaWYgKGlzU2FmYXJpRXh0ZW5zaW9uIHx8IGlzU2FmYXJpV2ViRXh0ZW5zaW9uKSB7XG4gICAgICAgIGZ1bmMgPSBmdW5jLmluZGV4T2YoXCJAXCIpICE9PSAtMSA/IGZ1bmMuc3BsaXQoXCJAXCIpWzBdIDogVU5LTk9XTl9GVU5DVElPTjtcbiAgICAgICAgdXJsID0gaXNTYWZhcmlFeHRlbnNpb24gPyBgc2FmYXJpLWV4dGVuc2lvbjoke3VybH1gIDogYHNhZmFyaS13ZWItZXh0ZW5zaW9uOiR7dXJsfWA7XG4gICAgICB9XG4gICAgICBlbGVtZW50ID0ge1xuICAgICAgICB1cmwsXG4gICAgICAgIGZ1bmMsXG4gICAgICAgIGFyZ3M6IGlzTmF0aXZlID8gW3BhcnRzWzJdXSA6IFtdLFxuICAgICAgICBsaW5lOiBwYXJ0c1szXSA/ICtwYXJ0c1szXSA6IG51bGwsXG4gICAgICAgIGNvbHVtbjogcGFydHNbNF0gPyArcGFydHNbNF0gOiBudWxsXG4gICAgICB9O1xuICAgIH0gZWxzZSBpZiAocGFydHMgPSB3aW5qcy5leGVjKGxpbmVzW2ldKSkge1xuICAgICAgZWxlbWVudCA9IHtcbiAgICAgICAgdXJsOiBwYXJ0c1syXSxcbiAgICAgICAgZnVuYzogcGFydHNbMV0gfHwgVU5LTk9XTl9GVU5DVElPTixcbiAgICAgICAgYXJnczogW10sXG4gICAgICAgIGxpbmU6ICtwYXJ0c1szXSxcbiAgICAgICAgY29sdW1uOiBwYXJ0c1s0XSA/ICtwYXJ0c1s0XSA6IG51bGxcbiAgICAgIH07XG4gICAgfSBlbHNlIGlmIChwYXJ0cyA9IGdlY2tvLmV4ZWMobGluZXNbaV0pKSB7XG4gICAgICBpc0V2YWwgPSBwYXJ0c1szXSAmJiBwYXJ0c1szXS5pbmRleE9mKFwiID4gZXZhbFwiKSA+IC0xO1xuICAgICAgaWYgKGlzRXZhbCAmJiAoc3VibWF0Y2ggPSBnZWNrb0V2YWwuZXhlYyhwYXJ0c1szXSkpKSB7XG4gICAgICAgIHBhcnRzWzFdID0gcGFydHNbMV0gfHwgXCJldmFsXCI7XG4gICAgICAgIHBhcnRzWzNdID0gc3VibWF0Y2hbMV07XG4gICAgICAgIHBhcnRzWzRdID0gc3VibWF0Y2hbMl07XG4gICAgICAgIHBhcnRzWzVdID0gXCJcIjtcbiAgICAgIH0gZWxzZSBpZiAoaSA9PT0gMCAmJiAhcGFydHNbNV0gJiYgZXguY29sdW1uTnVtYmVyICE9PSB2b2lkIDApIHtcbiAgICAgICAgc3RhY2tbMF0uY29sdW1uID0gZXguY29sdW1uTnVtYmVyICsgMTtcbiAgICAgIH1cbiAgICAgIGVsZW1lbnQgPSB7XG4gICAgICAgIHVybDogcGFydHNbM10sXG4gICAgICAgIGZ1bmM6IHBhcnRzWzFdIHx8IFVOS05PV05fRlVOQ1RJT04sXG4gICAgICAgIGFyZ3M6IHBhcnRzWzJdID8gcGFydHNbMl0uc3BsaXQoXCIsXCIpIDogW10sXG4gICAgICAgIGxpbmU6IHBhcnRzWzRdID8gK3BhcnRzWzRdIDogbnVsbCxcbiAgICAgICAgY29sdW1uOiBwYXJ0c1s1XSA/ICtwYXJ0c1s1XSA6IG51bGxcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoIWVsZW1lbnQuZnVuYyAmJiBlbGVtZW50LmxpbmUpIHtcbiAgICAgIGVsZW1lbnQuZnVuYyA9IFVOS05PV05fRlVOQ1RJT047XG4gICAgfVxuICAgIHN0YWNrLnB1c2goZWxlbWVudCk7XG4gIH1cbiAgaWYgKCFzdGFjay5sZW5ndGgpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICByZXR1cm4ge1xuICAgIG1lc3NhZ2U6IGV4dHJhY3RNZXNzYWdlKGV4KSxcbiAgICBuYW1lOiBleC5uYW1lLFxuICAgIHN0YWNrXG4gIH07XG59XG52YXIgc291cmNlTGlzdFRhZ3MgPSBbXG4gIFwibGlua1wiLFxuICBcInN0eWxlXCIsXG4gIFwic2NyaXB0XCIsXG4gIFwiaW1nXCIsXG4gIFwidmlkZW9cIixcbiAgXCJhdWRpb1wiLFxuICBcImlmcmFtZVwiXG5dO1xudmFyIHNvdXJjZU5vZGUgPSBtYWtlTWFwKHNvdXJjZUxpc3RUYWdzKTtcbmZ1bmN0aW9uIGNvbXB1dGVFcnJvclVybChleCkge1xuICBpZiAoZXggJiYgZXguZmlsZW5hbWUpXG4gICAgcmV0dXJuIGV4LmZpbGVuYW1lO1xuICBjb25zdCByZXMgPSBjb21wdXRlU3RhY2tUcmFjZUZyb21TdGFja1Byb3AoZXgpO1xuICBpZiAocmVzKSB7XG4gICAgY29uc3QgdXJscyA9IHJlcy5zdGFjay5tYXAoKGl0ZW0pID0+IHtcbiAgICAgIHJldHVybiBpdGVtLnVybDtcbiAgICB9KTtcbiAgICByZXR1cm4gdXJsc1swXSB8fCBudWxsO1xuICB9IGVsc2UgaWYgKGV4ICYmIGV4LnRhcmdldCAmJiBleC50YXJnZXQudGFnTmFtZSkge1xuICAgIGNvbnN0IHRhZ05hbWUgPSBleC50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmIChzb3VyY2VOb2RlKHRhZ05hbWUpKSB7XG4gICAgICByZXR1cm4gZXgudGFyZ2V0LnNyYyB8fCBleC50YXJnZXQuaHJlZjtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5mdW5jdGlvbiBmaWx0ZXJBbmRXcmFwRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgc291cmNlTGlzdCkge1xuICBjb25zdCBlcnJvckhhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgaWYgKHR5cGVvZiBsaXN0ZW5lciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBpZiAoc291cmNlTGlzdCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIioqKioqKioqKipcIiwgY29tcHV0ZUVycm9yVXJsKGUpKTtcbiAgICAgICAgY29uc3QgcmVzID0gc291cmNlTGlzdC5maW5kKChpdGVtKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGl0ZW0uaW5kZXhPZihjb21wdXRlRXJyb3JVcmwoZSkpICE9PSAtMTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChyZXMpIHtcbiAgICAgICAgICBsaXN0ZW5lcihlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGlzdGVuZXIoZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuICBjb25zdCB1bmhhbmRsZWRyZWplY3Rpb24gPSBmdW5jdGlvbihldmVudCkge1xuICAgIGV2ZW50LnByb21pc2UuY2F0Y2goKGUpID0+IHtcbiAgICAgIGlmIChlIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgZXJyb3JIYW5kbGVyKGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHR5cGVvZiBsaXN0ZW5lciA9PT0gXCJmdW5jdGlvblwiKVxuICAgICAgICAgIGxpc3RlbmVyKGV2ZW50KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgZmlsdGVyRXJyb3IgPSBmdW5jdGlvbihldmVudCkge1xuICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgaWYgKHR5cGUgPT09IFwidW5oYW5kbGVkcmVqZWN0aW9uXCIpIHtcbiAgICAgICAgdW5oYW5kbGVkcmVqZWN0aW9uKGV2ZW50KTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJlcnJvclwiKSB7XG4gICAgICAgIGVycm9ySGFuZGxlcihldmVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsaXN0ZW5lcihldmVudCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuICByZXR1cm4gZmlsdGVyRXJyb3I7XG59XG5cbi8vIHNyYy9kb21BcGlzLnRzXG52YXIgeENoYXIgPSAxMjA7XG52YXIgY29sb25DaGFyID0gNTg7XG52YXIgbnMgPSBcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI7XG52YXIgeGxpbmtOUyA9IFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiO1xudmFyIHhtbE5TID0gXCJodHRwOi8vd3d3LnczLm9yZy9YTUwvMTk5OC9uYW1lc3BhY2VcIjtcbnZhciB4bGlua1ByZWZpeCA9IFwieGxpbmtcIjtcbnZhciBTVkdfVEFHUyA9IFwic3ZnLGFuaW1hdGUsYW5pbWF0ZU1vdGlvbixhbmltYXRlVHJhbnNmb3JtLGNpcmNsZSxjbGlwUGF0aCxjb2xvci1wcm9maWxlLGRlZnMsZGVzYyxkaXNjYXJkLGVsbGlwc2UsZmVCbGVuZCxmZUNvbG9yTWF0cml4LGZlQ29tcG9uZW50VHJhbnNmZXIsZmVDb21wb3NpdGUsZmVDb252b2x2ZU1hdHJpeCxmZURpZmZ1c2VMaWdodGluZyxmZURpc3BsYWNlbWVudE1hcCxmZURpc3RhbmNlTGlnaHQsZmVEcm9wU2hhZG93LGZlRmxvb2QsZmVGdW5jQSxmZUZ1bmNCLGZlRnVuY0csZmVGdW5jUixmZUdhdXNzaWFuQmx1cixmZUltYWdlLGZlTWVyZ2UsZmVNZXJnZU5vZGUsZmVNb3JwaG9sb2d5LGZlT2Zmc2V0LGZlUG9pbnRMaWdodCxmZVNwZWN1bGFyTGlnaHRpbmcsZmVTcG90TGlnaHQsZmVUaWxlLGZlVHVyYnVsZW5jZSxmaWx0ZXIsZm9yZWlnbk9iamVjdCxnLGhhdGNoLGhhdGNocGF0aCxpbWFnZSxsaW5lLGxpbmVhckdyYWRpZW50LG1hcmtlcixtYXNrLG1lc2gsbWVzaGdyYWRpZW50LG1lc2hwYXRjaCxtZXNocm93LG1ldGFkYXRhLG1wYXRoLHBhdGgscGF0dGVybixwb2x5Z29uLHBvbHlsaW5lLHJhZGlhbEdyYWRpZW50LHJlY3Qsc2V0LHNvbGlkY29sb3Isc3RvcCxzd2l0Y2gsc3ltYm9sLHRleHQsdGV4dFBhdGgsdGl0bGUsdHNwYW4sdW5rbm93bix1c2Usdmlld1wiO1xudmFyIGlzU1ZHID0gbWFrZU1hcChTVkdfVEFHUy5zcGxpdChcIixcIikpO1xuZnVuY3Rpb24gY2hhbmdlVGFnTmFtZVRvTG93ZXJDYXNlKHRhZ05hbWUpIHtcbiAgcmV0dXJuIGlzU1ZHKHRhZ05hbWUpID8gdGFnTmFtZSA6IHRhZ05hbWUudG9Mb3dlckNhc2UoKTtcbn1cbmZ1bmN0aW9uIGF0dHJpYnV0ZXNTdHJpbmcoYXR0cmlidXRlcykge1xuICBpZiAoIWF0dHJpYnV0ZXMgfHwgYXR0cmlidXRlcy5sZW5ndGggPT09IDApXG4gICAgcmV0dXJuIFwiXCI7XG4gIHJldHVybiBhdHRyaWJ1dGVzLnJlZHVjZSgodG90YWwsIHsga2V5LCB2YWx1ZSB9KSA9PiB7XG4gICAgcmV0dXJuIHRvdGFsICsgKHZhbHVlID8gYCR7a2V5fT1cIiR7dmFsdWV9XCIgYCA6IGtleSk7XG4gIH0sIFwiXCIpO1xufVxudmFyIERPTUFwaXMgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGN1c0RvY3VtZW50KSB7XG4gICAgdGhpcy5kb2N1bWVudCA9IGN1c0RvY3VtZW50IHx8IGRvY3VtZW50O1xuICB9XG4gIGlzVGV4dChub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUgJiYgbm9kZS50eXBlID09PSBcInRleHRcIjtcbiAgfVxuICBpc05vZGUobm9kZSkge1xuICAgIHJldHVybiBub2RlICYmIG5vZGUudHlwZSA9PT0gXCJlbGVtZW50XCI7XG4gIH1cbiAgaXNDb21tZW50Tm9kZShub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUgJiYgbm9kZS50eXBlID09PSBcImNvbW1lbnRcIjtcbiAgfVxuICBpc0Nzc0xpbmtOb2RlKG5vZGUpIHtcbiAgICBpZiAodGhpcy5pc05vZGUobm9kZSkgJiYgbm9kZS50YWdOYW1lID09PSBcImxpbmtcIikge1xuICAgICAgcmV0dXJuICEhbm9kZS5hdHRyaWJ1dGVzLmZpbmQoKHsga2V5LCB2YWx1ZSB9KSA9PiBrZXkgPT09IFwicmVsXCIgJiYgdmFsdWUgPT09IFwic3R5bGVzaGVldFwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlzSWNvbkxpbmtOb2RlKG5vZGUpIHtcbiAgICBpZiAodGhpcy5pc05vZGUobm9kZSkgJiYgbm9kZS50YWdOYW1lID09PSBcImxpbmtcIikge1xuICAgICAgcmV0dXJuICEhbm9kZS5hdHRyaWJ1dGVzLmZpbmQoKHsga2V5LCB2YWx1ZSB9KSA9PiBrZXkgPT09IFwicmVsXCIgJiYgdmFsdWUgPT09IFwiaWNvblwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlzUHJlZmV0Y2hKc0xpbmtOb2RlKG5vZGUpIHtcbiAgICBpZiAoIXRoaXMuaXNOb2RlKG5vZGUpIHx8IG5vZGUudGFnTmFtZSAhPT0gXCJsaW5rXCIpXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgbGV0IGhhc1JlbEF0dHIsIGhhc0FzQXR0cjtcbiAgICBmb3IgKGNvbnN0IHsga2V5LCB2YWx1ZSB9IG9mIG5vZGUuYXR0cmlidXRlcykge1xuICAgICAgaWYgKGtleSA9PT0gXCJyZWxcIikge1xuICAgICAgICBoYXNSZWxBdHRyID0gdHJ1ZTtcbiAgICAgICAgaWYgKHZhbHVlICE9PSBcInByZWxvYWRcIiAmJiB2YWx1ZSAhPT0gXCJwcmVmZXRjaFwiKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGtleSA9PT0gXCJhc1wiKSB7XG4gICAgICAgIGhhc0FzQXR0ciA9IHRydWU7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gXCJzY3JpcHRcIilcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBCb29sZWFuKGhhc1JlbEF0dHIgJiYgaGFzQXNBdHRyKTtcbiAgfVxuICBpc1JlbW90ZU1vZHVsZShub2RlKSB7XG4gICAgaWYgKCF0aGlzLmlzTm9kZShub2RlKSB8fCBub2RlLnRhZ05hbWUgIT09IFwibWV0YVwiKVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIGxldCBoYXNOYW1lQXR0ciwgaGFzU3JjQXR0cjtcbiAgICBmb3IgKGNvbnN0IHsga2V5LCB2YWx1ZSB9IG9mIG5vZGUuYXR0cmlidXRlcykge1xuICAgICAgaWYgKGtleSA9PT0gXCJuYW1lXCIpIHtcbiAgICAgICAgaGFzTmFtZUF0dHIgPSB0cnVlO1xuICAgICAgICBpZiAodmFsdWUgIT09IFwiZ2FyZmlzaC1yZW1vdGUtbW9kdWxlXCIpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoa2V5ID09PSBcInNyY1wiKSB7XG4gICAgICAgIGhhc1NyY0F0dHIgPSB0cnVlO1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiIHx8IHZhbHVlID09PSBcIlwiKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBCb29sZWFuKGhhc05hbWVBdHRyICYmIGhhc1NyY0F0dHIpO1xuICB9XG4gIHJlbW92ZUVsZW1lbnQoZWwpIHtcbiAgICBjb25zdCBwYXJlbnROb2RlID0gZWwgJiYgZWwucGFyZW50Tm9kZTtcbiAgICBpZiAocGFyZW50Tm9kZSkge1xuICAgICAgcGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbCk7XG4gICAgfVxuICB9XG4gIGNyZWF0ZUVsZW1lbnQobm9kZSkge1xuICAgIGNvbnN0IHsgdGFnTmFtZSwgYXR0cmlidXRlcyB9ID0gbm9kZTtcbiAgICBjb25zdCBlbCA9IGlzU1ZHKHRhZ05hbWUpID8gdGhpcy5kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMobnMsIHRhZ05hbWUpIDogdGhpcy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZ05hbWUpO1xuICAgIHRoaXMuYXBwbHlBdHRyaWJ1dGVzKGVsLCBhdHRyaWJ1dGVzKTtcbiAgICByZXR1cm4gZWw7XG4gIH1cbiAgY3JlYXRlVGV4dE5vZGUobm9kZSkge1xuICAgIHJldHVybiB0aGlzLmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKG5vZGUuY29udGVudCk7XG4gIH1cbiAgY3JlYXRlU3R5bGVOb2RlKGNvbnRlbnQpIHtcbiAgICBjb25zdCBlbCA9IHRoaXMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuICAgIGNvbnRlbnQgJiYgKGVsLnRleHRDb250ZW50ID0gY29udGVudCk7XG4gICAgdGhpcy5hcHBseUF0dHJpYnV0ZXMoZWwsIFt7IGtleTogXCJ0eXBlXCIsIHZhbHVlOiBcInRleHQvY3NzXCIgfV0pO1xuICAgIHJldHVybiBlbDtcbiAgfVxuICBjcmVhdGVMaW5rQ29tbWVudE5vZGUobm9kZSkge1xuICAgIGlmICh0aGlzLmlzTm9kZShub2RlKSkge1xuICAgICAgY29uc3QgcHMgPSBhdHRyaWJ1dGVzU3RyaW5nKG5vZGUuYXR0cmlidXRlcyk7XG4gICAgICByZXR1cm4gYDxsaW5rICR7cHMuc2xpY2UoMCwgLTEpfT48L2xpbms+YDtcbiAgICB9IGVsc2Uge1xuICAgICAgbm9kZSA9IG5vZGUgPyBgc3JjPVwiJHtub2RlfVwiIGAgOiBcIlwiO1xuICAgICAgcmV0dXJuIHRoaXMuZG9jdW1lbnQuY3JlYXRlQ29tbWVudChgPGxpbmsgJHtub2RlfWV4ZWN1dGUgYnkgZ2FyZmlzaChkeW5hbWljKT48L2xpbms+YCk7XG4gICAgfVxuICB9XG4gIGNyZWF0ZVNjcmlwdENvbW1lbnROb2RlKG5vZGUpIHtcbiAgICBpZiAodGhpcy5pc05vZGUobm9kZSkpIHtcbiAgICAgIGNvbnN0IHsgYXR0cmlidXRlcywgY2hpbGRyZW4gfSA9IG5vZGU7XG4gICAgICBjb25zdCBwcyA9IGF0dHJpYnV0ZXNTdHJpbmcoYXR0cmlidXRlcyk7XG4gICAgICBjb25zdCBjb2RlID0gKGNoaWxkcmVuID09IG51bGwgPyB2b2lkIDAgOiBjaGlsZHJlblswXSkgPyBjaGlsZHJlblswXS5jb250ZW50IDogXCJcIjtcbiAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50LmNyZWF0ZUNvbW1lbnQoYDxzY3JpcHQgJHtwc30gZXhlY3V0ZSBieSBnYXJmaXNoPiR7Y29kZX08XFwvc2NyaXB0PmApO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB7IHNyYywgY29kZSB9ID0gbm9kZTtcbiAgICAgIGNvbnN0IHVybCA9IHNyYyA/IGBzcmM9XCIke3NyY31cIiBgIDogXCJcIjtcbiAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50LmNyZWF0ZUNvbW1lbnQoYDxzY3JpcHQgJHt1cmx9ZXhlY3V0ZSBieSBnYXJmaXNoKGR5bmFtaWMpPiR7Y29kZX08XFwvc2NyaXB0PmApO1xuICAgIH1cbiAgfVxuICBhcHBseUF0dHJpYnV0ZXMoZWwsIGF0dHJpYnV0ZXMpIHtcbiAgICBpZiAoIWF0dHJpYnV0ZXMgfHwgYXR0cmlidXRlcy5sZW5ndGggPT09IDApXG4gICAgICByZXR1cm47XG4gICAgZm9yIChjb25zdCB7IGtleSwgdmFsdWUgfSBvZiBhdHRyaWJ1dGVzKSB7XG4gICAgICBpZiAoa2V5KSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZShrZXksIFwiXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgIGlmIChrZXkuY2hhckNvZGVBdCgwKSAhPT0geENoYXIpIHtcbiAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZShrZXksIHZhbHVlKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGtleS5jaGFyQ29kZUF0KDMpID09PSBjb2xvbkNoYXIpIHtcbiAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZU5TKHhtbE5TLCBrZXksIHZhbHVlKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGtleS5jaGFyQ29kZUF0KDUpID09PSBjb2xvbkNoYXIgJiYga2V5LnNsaWNlKDAsIDUpID09PSB4bGlua1ByZWZpeCkge1xuICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlTlMoeGxpbmtOUywga2V5LCB2YWx1ZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZShrZXksIHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG5cbi8vIHNyYy9nYXJmaXNoLnRzXG52YXIgX19MT0FERVJfRkxBR19fID0gU3ltYm9sLmZvcihcIl9fTE9BREVSX0ZMQUdfX1wiKTtcbnZhciBfX0dBUkZJU0hfRkxBR19fID0gU3ltYm9sLmZvcihcIl9fR0FSRklTSF9GTEFHX19cIik7XG52YXIgX19Nb2NrSHRtbF9fID0gXCJfX2dhcmZpc2htb2NraHRtbF9fXCI7XG52YXIgX19Nb2NrQm9keV9fID0gXCJfX2dhcmZpc2htb2NrYm9keV9fXCI7XG52YXIgX19Nb2NrSGVhZF9fID0gXCJfX2dhcmZpc2htb2NraGVhZF9fXCI7XG52YXIgX19SRU1PVkVfTk9ERV9fID0gXCJfX2dhcmZpc2hyZW1vdmVub2RlX19cIjtcblxuLy8gc3JjL21pbWVUeXBlLnRzXG5mdW5jdGlvbiBwYXJzZUNvbnRlbnRUeXBlKGlucHV0KSB7XG4gIGlucHV0ID0gaW5wdXQgPT0gbnVsbCA/IHZvaWQgMCA6IGlucHV0LnRyaW0oKTtcbiAgaWYgKCFpbnB1dClcbiAgICByZXR1cm4gbnVsbDtcbiAgbGV0IGlkeCA9IDA7XG4gIGxldCB0eXBlID0gXCJcIjtcbiAgbGV0IHN1YlR5cGUgPSBcIlwiO1xuICB3aGlsZSAoaWR4IDwgaW5wdXQubGVuZ3RoICYmIGlucHV0W2lkeF0gIT09IFwiL1wiKSB7XG4gICAgdHlwZSArPSBpbnB1dFtpZHhdO1xuICAgIGlkeCsrO1xuICB9XG4gIGlmICh0eXBlLmxlbmd0aCA9PT0gMCB8fCBpZHggPj0gaW5wdXQubGVuZ3RoKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgaWR4Kys7XG4gIHdoaWxlIChpZHggPCBpbnB1dC5sZW5ndGggJiYgaW5wdXRbaWR4XSAhPT0gXCI7XCIpIHtcbiAgICBzdWJUeXBlICs9IGlucHV0W2lkeF07XG4gICAgaWR4Kys7XG4gIH1cbiAgc3ViVHlwZSA9IHN1YlR5cGUucmVwbGFjZSgvWyBcXHRcXG5cXHJdKyQvLCBcIlwiKTtcbiAgaWYgKHN1YlR5cGUubGVuZ3RoID09PSAwKVxuICAgIHJldHVybiBudWxsO1xuICByZXR1cm4ge1xuICAgIHR5cGU6IHR5cGUudG9Mb2NhbGVMb3dlckNhc2UoKSxcbiAgICBzdWJ0eXBlOiBzdWJUeXBlLnRvTG9jYWxlTG93ZXJDYXNlKClcbiAgfTtcbn1cbmZ1bmN0aW9uIGlzQ3NzKG10KSB7XG4gIHJldHVybiBtdCA/IG10LnR5cGUgPT09IFwidGV4dFwiICYmIG10LnN1YnR5cGUgPT09IFwiY3NzXCIgOiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGlzSHRtbChtdCkge1xuICByZXR1cm4gbXQgPyBtdC50eXBlID09PSBcInRleHRcIiAmJiBtdC5zdWJ0eXBlID09PSBcImh0bWxcIiA6IGZhbHNlO1xufVxuZnVuY3Rpb24gaXNKcyhtdCkge1xuICBjb25zdCB7IHR5cGUsIHN1YnR5cGUgfSA9IG10IHx8IHt9O1xuICBzd2l0Y2ggKHR5cGUpIHtcbiAgICBjYXNlIFwidGV4dFwiOiB7XG4gICAgICBzd2l0Y2ggKHN1YnR5cGUpIHtcbiAgICAgICAgY2FzZSBcImVjbWFzY3JpcHRcIjpcbiAgICAgICAgY2FzZSBcImphdmFzY3JpcHRcIjpcbiAgICAgICAgY2FzZSBcImphdmFzY3JpcHQxLjBcIjpcbiAgICAgICAgY2FzZSBcImphdmFzY3JpcHQxLjFcIjpcbiAgICAgICAgY2FzZSBcImphdmFzY3JpcHQxLjJcIjpcbiAgICAgICAgY2FzZSBcImphdmFzY3JpcHQxLjNcIjpcbiAgICAgICAgY2FzZSBcImphdmFzY3JpcHQxLjRcIjpcbiAgICAgICAgY2FzZSBcImphdmFzY3JpcHQxLjVcIjpcbiAgICAgICAgY2FzZSBcImpzY3JpcHRcIjpcbiAgICAgICAgY2FzZSBcImxpdmVzY3JpcHRcIjpcbiAgICAgICAgY2FzZSBcIngtZWNtYXNjcmlwdFwiOlxuICAgICAgICBjYXNlIFwieC1qYXZhc2NyaXB0XCI6IHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGNhc2UgXCJhcHBsaWNhdGlvblwiOiB7XG4gICAgICBzd2l0Y2ggKHN1YnR5cGUpIHtcbiAgICAgICAgY2FzZSBcImVjbWFzY3JpcHRcIjpcbiAgICAgICAgY2FzZSBcImphdmFzY3JpcHRcIjpcbiAgICAgICAgY2FzZSBcIngtZWNtYXNjcmlwdFwiOlxuICAgICAgICBjYXNlIFwieC1qYXZhc2NyaXB0XCI6IHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGRlZmF1bHQ6IHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbn1cbmZ1bmN0aW9uIGlzSnNvbnAobXQsIHNyYykge1xuICBjb25zdCBjYWxsYmFja1JlZ0V4cCA9IC9jYWxsYmFjay87XG4gIHRyeSB7XG4gICAgY29uc3Qgc2VhcmNoID0gbmV3IFVSTChzcmMpLnNlYXJjaDtcbiAgICBjb25zdCB7IHR5cGUsIHN1YnR5cGUgfSA9IG10IHx8IHt9O1xuICAgIGlmICh0eXBlID09PSBcImFwcGxpY2F0aW9uXCIgJiYgc3VidHlwZSA9PT0gXCJqc29uXCIgJiYgY2FsbGJhY2tSZWdFeHAudGVzdChzZWFyY2gpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuZnVuY3Rpb24gaXNKc1R5cGUoeyBzcmMgPSBcIlwiLCB0eXBlIH0pIHtcbiAgaWYgKC9cXC5qcyQvLnRlc3Qoc3JjKSlcbiAgICByZXR1cm4gdHJ1ZTtcbiAgaWYgKHR5cGUpIHtcbiAgICBpZiAodHlwZSA9PT0gXCJtb2R1bGVcIilcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIGNvbnN0IG1pbWVUeXBlSW5mbyA9IHBhcnNlQ29udGVudFR5cGUodHlwZSk7XG4gICAgaWYgKGlzSnNvbnAobWltZVR5cGVJbmZvLCBzcmMpKVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgaWYgKGlzSnMobWltZVR5cGVJbmZvKSlcbiAgICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGlzQ3NzVHlwZSh7IHNyYyA9IFwiXCIsIHR5cGUgfSkge1xuICBpZiAoL1xcLmNzcyQvLnRlc3Qoc3JjKSlcbiAgICByZXR1cm4gdHJ1ZTtcbiAgaWYgKHR5cGUpIHtcbiAgICBjb25zdCBtaW1lVHlwZUluZm8gPSBwYXJzZUNvbnRlbnRUeXBlKHR5cGUpO1xuICAgIGlmIChpc0NzcyhtaW1lVHlwZUluZm8pKVxuICAgICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuZnVuY3Rpb24gaXNIdG1sVHlwZSh7XG4gIHNyYyA9IFwiXCIsXG4gIHR5cGVcbn0pIHtcbiAgaWYgKC9cXC5odG1sJC8udGVzdChzcmMpKVxuICAgIHJldHVybiB0cnVlO1xuICBpZiAodHlwZSkge1xuICAgIGNvbnN0IG1pbWVUeXBlSW5mbyA9IHBhcnNlQ29udGVudFR5cGUodHlwZSk7XG4gICAgaWYgKGlzSHRtbChtaW1lVHlwZUluZm8pKVxuICAgICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuZnVuY3Rpb24gaXNHYXJmaXNoQ29uZmlnVHlwZSh7XG4gIHR5cGUgPSBcIlwiXG59KSB7XG4gIHJldHVybiAvZ2FyZmlzaC1jb25maWcvaS50ZXN0KHR5cGUpO1xufVxuXG4vLyBzcmMvZGlzcGF0Y2hFdmVudHMudHNcbnZhciByZWFjdEV2ZW50cyA9IFtcbiAgXCJvbkFib3J0XCIsXG4gIFwib25BbmltYXRpb25DYW5jZWxcIixcbiAgXCJvbkFuaW1hdGlvbkVuZFwiLFxuICBcIm9uQW5pbWF0aW9uSXRlcmF0aW9uXCIsXG4gIFwib25BdXhDbGlja1wiLFxuICBcIm9uQmx1clwiLFxuICBcIm9uQ2hhbmdlXCIsXG4gIFwib25DbGlja1wiLFxuICBcIm9uQ2xvc2VcIixcbiAgXCJvbkNvbnRleHRNZW51XCIsXG4gIFwib25Eb3VibGVDbGlja1wiLFxuICBcIm9uRXJyb3JcIixcbiAgXCJvbkZvY3VzXCIsXG4gIFwib25Hb3RQb2ludGVyQ2FwdHVyZVwiLFxuICBcIm9uSW5wdXRcIixcbiAgXCJvbktleURvd25cIixcbiAgXCJvbktleVByZXNzXCIsXG4gIFwib25LZXlVcFwiLFxuICBcIm9uTG9hZFwiLFxuICBcIm9uTG9hZEVuZFwiLFxuICBcIm9uTG9hZFN0YXJ0XCIsXG4gIFwib25Mb3N0UG9pbnRlckNhcHR1cmVcIixcbiAgXCJvbk1vdXNlRG93blwiLFxuICBcIm9uTW91c2VNb3ZlXCIsXG4gIFwib25Nb3VzZU91dFwiLFxuICBcIm9uTW91c2VPdmVyXCIsXG4gIFwib25Nb3VzZVVwXCIsXG4gIFwib25Qb2ludGVyQ2FuY2VsXCIsXG4gIFwib25Qb2ludGVyRG93blwiLFxuICBcIm9uUG9pbnRlckVudGVyXCIsXG4gIFwib25Qb2ludGVyTGVhdmVcIixcbiAgXCJvblBvaW50ZXJNb3ZlXCIsXG4gIFwib25Qb2ludGVyT3V0XCIsXG4gIFwib25Qb2ludGVyT3ZlclwiLFxuICBcIm9uUG9pbnRlclVwXCIsXG4gIFwib25SZXNldFwiLFxuICBcIm9uUmVzaXplXCIsXG4gIFwib25TY3JvbGxcIixcbiAgXCJvblNlbGVjdFwiLFxuICBcIm9uU2VsZWN0aW9uQ2hhbmdlXCIsXG4gIFwib25TZWxlY3RTdGFydFwiLFxuICBcIm9uU3VibWl0XCIsXG4gIFwib25Ub3VjaENhbmNlbFwiLFxuICBcIm9uVG91Y2hNb3ZlXCIsXG4gIFwib25Ub3VjaFN0YXJ0XCIsXG4gIFwib25Ub3VjaEVuZFwiLFxuICBcIm9uVHJhbnNpdGlvbkNhbmNlbFwiLFxuICBcIm9uVHJhbnNpdGlvbkVuZFwiLFxuICBcIm9uRHJhZ1wiLFxuICBcIm9uRHJhZ0VuZFwiLFxuICBcIm9uRHJhZ0VudGVyXCIsXG4gIFwib25EcmFnRXhpdFwiLFxuICBcIm9uRHJhZ0xlYXZlXCIsXG4gIFwib25EcmFnT3ZlclwiLFxuICBcIm9uRHJhZ1N0YXJ0XCIsXG4gIFwib25Ecm9wXCIsXG4gIFwib25Gb2N1c091dFwiXG5dO1xudmFyIGRpdmVyZ2VudE5hdGl2ZUV2ZW50cyA9IHtcbiAgb25Eb3VibGVDbGljazogXCJkYmxjbGlja1wiXG59O1xudmFyIG1pbWlja2VkUmVhY3RFdmVudHMgPSB7XG4gIG9uSW5wdXQ6IFwib25DaGFuZ2VcIixcbiAgb25Gb2N1c091dDogXCJvbkJsdXJcIixcbiAgb25TZWxlY3Rpb25DaGFuZ2U6IFwib25TZWxlY3RcIlxufTtcbmZ1bmN0aW9uIGRpc3BhdGNoRXZlbnRzKHNoYWRvd1Jvb3QpIHtcbiAgY29uc3QgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMgPSBbXTtcbiAgcmVhY3RFdmVudHMuZm9yRWFjaChmdW5jdGlvbihyZWFjdEV2ZW50TmFtZSkge1xuICAgIGNvbnN0IG5hdGl2ZUV2ZW50TmFtZSA9IGdldE5hdGl2ZUV2ZW50TmFtZShyZWFjdEV2ZW50TmFtZSk7XG4gICAgZnVuY3Rpb24gcmV0YXJnZXRFdmVudChldmVudCkge1xuICAgICAgY29uc3QgcGF0aCA9IGV2ZW50LnBhdGggfHwgZXZlbnQuY29tcG9zZWRQYXRoICYmIGV2ZW50LmNvbXBvc2VkUGF0aCgpIHx8IGNvbXBvc2VkUGF0aChldmVudC50YXJnZXQpO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXRoLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGVsID0gcGF0aFtpXTtcbiAgICAgICAgbGV0IHByb3BzID0gbnVsbDtcbiAgICAgICAgY29uc3QgcmVhY3RDb21wb25lbnQgPSBmaW5kUmVhY3RDb21wb25lbnQoZWwpO1xuICAgICAgICBjb25zdCBldmVudEhhbmRsZXJzID0gZmluZFJlYWN0RXZlbnRIYW5kbGVycyhlbCk7XG4gICAgICAgIGlmICghZXZlbnRIYW5kbGVycykge1xuICAgICAgICAgIHByb3BzID0gZmluZFJlYWN0UHJvcHMocmVhY3RDb21wb25lbnQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHByb3BzID0gZXZlbnRIYW5kbGVycztcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVhY3RDb21wb25lbnQgJiYgcHJvcHMpIHtcbiAgICAgICAgICBkaXNwYXRjaEV2ZW50KGV2ZW50LCByZWFjdEV2ZW50TmFtZSwgcHJvcHMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZWFjdENvbXBvbmVudCAmJiBwcm9wcyAmJiBtaW1pY2tlZFJlYWN0RXZlbnRzW3JlYWN0RXZlbnROYW1lXSkge1xuICAgICAgICAgIGRpc3BhdGNoRXZlbnQoZXZlbnQsIG1pbWlja2VkUmVhY3RFdmVudHNbcmVhY3RFdmVudE5hbWVdLCBwcm9wcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2ZW50LmNhbmNlbEJ1YmJsZSkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlbCA9PT0gc2hhZG93Um9vdCkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHNoYWRvd1Jvb3QuYWRkRXZlbnRMaXN0ZW5lcihuYXRpdmVFdmVudE5hbWUsIHJldGFyZ2V0RXZlbnQsIGZhbHNlKTtcbiAgICByZW1vdmVFdmVudExpc3RlbmVycy5wdXNoKGZ1bmN0aW9uKCkge1xuICAgICAgc2hhZG93Um9vdC5yZW1vdmVFdmVudExpc3RlbmVyKG5hdGl2ZUV2ZW50TmFtZSwgcmV0YXJnZXRFdmVudCwgZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHJlbW92ZUV2ZW50TGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24ocmVtb3ZlRXZlbnRMaXN0ZW5lcikge1xuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcigpO1xuICAgIH0pO1xuICB9O1xufVxuZnVuY3Rpb24gZmluZFJlYWN0RXZlbnRIYW5kbGVycyhpdGVtKSB7XG4gIHJldHVybiBmaW5kUmVhY3RQcm9wZXJ0eShpdGVtLCBcIl9fcmVhY3RFdmVudEhhbmRsZXJzXCIpO1xufVxuZnVuY3Rpb24gZmluZFJlYWN0Q29tcG9uZW50KGl0ZW0pIHtcbiAgcmV0dXJuIGZpbmRSZWFjdFByb3BlcnR5KGl0ZW0sIFwiX3JlYWN0SW50ZXJuYWxcIik7XG59XG5mdW5jdGlvbiBmaW5kUmVhY3RQcm9wZXJ0eShpdGVtLCBwcm9wZXJ0eVByZWZpeCkge1xuICBmb3IgKGNvbnN0IGtleSBpbiBpdGVtKSB7XG4gICAgaWYgKGhhc093bihpdGVtLCBrZXkpICYmIGtleS5pbmRleE9mKHByb3BlcnR5UHJlZml4KSAhPT0gLTEpIHtcbiAgICAgIHJldHVybiBpdGVtW2tleV07XG4gICAgfVxuICB9XG59XG5mdW5jdGlvbiBmaW5kUmVhY3RQcm9wcyhjb21wb25lbnQpIHtcbiAgaWYgKCFjb21wb25lbnQpXG4gICAgcmV0dXJuIHZvaWQgMDtcbiAgaWYgKGNvbXBvbmVudC5tZW1vaXplZFByb3BzKVxuICAgIHJldHVybiBjb21wb25lbnQubWVtb2l6ZWRQcm9wcztcbiAgaWYgKGNvbXBvbmVudC5fY3VycmVudEVsZW1lbnQgJiYgY29tcG9uZW50Ll9jdXJyZW50RWxlbWVudC5wcm9wcylcbiAgICByZXR1cm4gY29tcG9uZW50Ll9jdXJyZW50RWxlbWVudC5wcm9wcztcbn1cbmZ1bmN0aW9uIGRpc3BhdGNoRXZlbnQoZXZlbnQsIGV2ZW50VHlwZSwgY29tcG9uZW50UHJvcHMpIHtcbiAgZXZlbnQucGVyc2lzdCA9IGZ1bmN0aW9uKCkge1xuICAgIGV2ZW50LmlzUGVyc2lzdGVudCA9ICgpID0+IHRydWU7XG4gIH07XG4gIGlmIChjb21wb25lbnRQcm9wc1tldmVudFR5cGVdKSB7XG4gICAgY29tcG9uZW50UHJvcHNbZXZlbnRUeXBlXShldmVudCk7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldE5hdGl2ZUV2ZW50TmFtZShyZWFjdEV2ZW50TmFtZSkge1xuICBpZiAoZGl2ZXJnZW50TmF0aXZlRXZlbnRzW3JlYWN0RXZlbnROYW1lXSkge1xuICAgIHJldHVybiBkaXZlcmdlbnROYXRpdmVFdmVudHNbcmVhY3RFdmVudE5hbWVdO1xuICB9XG4gIHJldHVybiByZWFjdEV2ZW50TmFtZS5yZXBsYWNlKC9eb24vLCBcIlwiKS50b0xvd2VyQ2FzZSgpO1xufVxuZnVuY3Rpb24gY29tcG9zZWRQYXRoKGVsKSB7XG4gIGNvbnN0IHBhdGggPSBbXTtcbiAgd2hpbGUgKGVsKSB7XG4gICAgcGF0aC5wdXNoKGVsKTtcbiAgICBpZiAoZWwudGFnTmFtZSA9PT0gXCJIVE1MXCIpIHtcbiAgICAgIHBhdGgucHVzaChkb2N1bWVudCk7XG4gICAgICBwYXRoLnB1c2god2luZG93KTtcbiAgICAgIHJldHVybiBwYXRoO1xuICAgIH1cbiAgICBlbCA9IGVsLnBhcmVudEVsZW1lbnQ7XG4gIH1cbn1cblxuLy8gc3JjL2NvbnRhaW5lci50c1xudmFyIGFwcENvbnRhaW5lcklkID0gXCJnYXJmaXNoX2FwcF9mb3JcIjtcbmZ1bmN0aW9uIGNyZWF0ZUFwcENvbnRhaW5lcihhcHBJbmZvKSB7XG4gIGxldCBodG1sTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IGFwcENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGlmIChhcHBJbmZvLnNhbmRib3ggJiYgYXBwSW5mby5zYW5kYm94LnN0cmljdElzb2xhdGlvbikge1xuICAgIGh0bWxOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImh0bWxcIik7XG4gICAgY29uc3Qgcm9vdCA9IGFwcENvbnRhaW5lci5hdHRhY2hTaGFkb3coeyBtb2RlOiBcIm9wZW5cIiB9KTtcbiAgICByb290LmFwcGVuZENoaWxkKGh0bWxOb2RlKTtcbiAgICBkaXNwYXRjaEV2ZW50cyhyb290KTtcbiAgfSBlbHNlIHtcbiAgICBodG1sTm9kZS5zZXRBdHRyaWJ1dGUoX19Nb2NrSHRtbF9fLCBcIlwiKTtcbiAgICBhcHBDb250YWluZXIuYXBwZW5kQ2hpbGQoaHRtbE5vZGUpO1xuICB9XG4gIGFwcENvbnRhaW5lci5pZCA9IGAke2FwcENvbnRhaW5lcklkfV8ke2FwcEluZm8ubmFtZX1fJHtjcmVhdGVLZXkoKX1gO1xuICByZXR1cm4ge1xuICAgIGh0bWxOb2RlLFxuICAgIGFwcENvbnRhaW5lclxuICB9O1xufVxuZnVuY3Rpb24gd2FpdEVsZW1lbnRSZWFkeShzZWxlY3RvciwgY2FsbGJhY2ssIGxlZnRUaW1lKSB7XG4gIGNvbnN0IHRpbWVJbnRlcnZhbCA9IDUwO1xuICBjb25zdCBlbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gIGlmIChlbGVtICE9PSBudWxsIHx8IGxlZnRUaW1lIDw9IDApIHtcbiAgICBjYWxsYmFjayhlbGVtKTtcbiAgICByZXR1cm47XG4gIH1cbiAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICB3YWl0RWxlbWVudFJlYWR5KHNlbGVjdG9yLCBjYWxsYmFjaywgbGVmdFRpbWUgLSB0aW1lSW50ZXJ2YWwpO1xuICB9LCB0aW1lSW50ZXJ2YWwpO1xufVxuZnVuY3Rpb24gZGVsYXkoZHVyYXRpb24pIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpIHtcbiAgICBzZXRUaW1lb3V0KHJlc29sdmUsIGR1cmF0aW9uKTtcbiAgfSk7XG59XG5mdW5jdGlvbiB3YWl0RWxlbWVudChzZWxlY3RvciwgdGltZW91dCA9IDNlMykge1xuICBjb25zdCB3YWl0UHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpIHtcbiAgICB3YWl0RWxlbWVudFJlYWR5KHNlbGVjdG9yLCBmdW5jdGlvbihlbGVtKSB7XG4gICAgICByZXR1cm4gcmVzb2x2ZShlbGVtKTtcbiAgICB9LCB0aW1lb3V0KTtcbiAgfSk7XG4gIHJldHVybiBQcm9taXNlLnJhY2UoW2RlbGF5KHRpbWVvdXQpLCB3YWl0UHJvbWlzZV0pO1xufVxuYXN5bmMgZnVuY3Rpb24gZ2V0UmVuZGVyTm9kZShkb21HZXR0ZXIpIHtcbiAgYXNzZXJ0KGRvbUdldHRlciwgYEludmFsaWQgZG9tR2V0dGVyOlxuICR7ZG9tR2V0dGVyfS5gKTtcbiAgbGV0IGFwcFdyYXBwZXJOb2RlO1xuICBpZiAodHlwZW9mIGRvbUdldHRlciA9PT0gXCJzdHJpbmdcIikge1xuICAgIGFwcFdyYXBwZXJOb2RlID0gYXdhaXQgd2FpdEVsZW1lbnQoZG9tR2V0dGVyKTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZG9tR2V0dGVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICBhcHBXcmFwcGVyTm9kZSA9IGF3YWl0IFByb21pc2UucmVzb2x2ZShkb21HZXR0ZXIoKSk7XG4gIH1cbiAgYXNzZXJ0KGFwcFdyYXBwZXJOb2RlIGluc3RhbmNlb2YgRWxlbWVudCwgYEludmFsaWQgZG9tR2V0dGVyOiAke2RvbUdldHRlcn1gKTtcbiAgcmV0dXJuIGFwcFdyYXBwZXJOb2RlO1xufVxuXG4vLyBzcmMvdGVtcGxhdGVQYXJzZS50c1xuZnVuY3Rpb24gQXR0cmlidXRlcyh7IG5hbWUsIHZhbHVlIH0pIHtcbiAgdGhpcy5rZXkgPSBuYW1lO1xuICB0aGlzLnZhbHVlID0gdmFsdWU7XG59XG52YXIgZ2VuZXJhdGVBdHRyaWJ1dGVzID0gKGVsKSA9PiB7XG4gIGNvbnN0IGxpc3QgPSBbXTtcbiAgY29uc3QgYXR0cnMgPSBlbC5hdHRyaWJ1dGVzO1xuICBjb25zdCBsZW4gPSBhdHRycy5sZW5ndGg7XG4gIGlmIChsZW4gPiAwKSB7XG4gICAgaWYgKGxlbiA9PT0gMSkge1xuICAgICAgbGlzdFswXSA9IG5ldyBBdHRyaWJ1dGVzKGF0dHJzWzBdKTtcbiAgICB9IGVsc2UgaWYgKGxlbiA9PT0gMikge1xuICAgICAgbGlzdFswXSA9IG5ldyBBdHRyaWJ1dGVzKGF0dHJzWzBdKTtcbiAgICAgIGxpc3RbMV0gPSBuZXcgQXR0cmlidXRlcyhhdHRyc1sxXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgbGlzdFtpXSA9IG5ldyBBdHRyaWJ1dGVzKGF0dHJzW2ldKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIGxpc3Q7XG59O1xudmFyIGNyZWF0ZUVsZW1lbnQgPSAoZWwsIGZpbHRlcikgPT4ge1xuICBzd2l0Y2ggKGVsLm5vZGVUeXBlKSB7XG4gICAgY2FzZSAzIC8qIFRFWFQgKi86XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBcInRleHRcIixcbiAgICAgICAgY29udGVudDogZWwudGV4dENvbnRlbnRcbiAgICAgIH07XG4gICAgY2FzZSA4IC8qIENPTU1FTlQgKi86XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBcImNvbW1lbnRcIixcbiAgICAgICAgY29udGVudDogZWwudGV4dENvbnRlbnRcbiAgICAgIH07XG4gICAgY2FzZSAxIC8qIEVMRU1FTlQgKi86XG4gICAgICByZXR1cm4gZmlsdGVyKHtcbiAgICAgICAgdHlwZTogXCJlbGVtZW50XCIsXG4gICAgICAgIHRhZ05hbWU6IGNoYW5nZVRhZ05hbWVUb0xvd2VyQ2FzZShlbC50YWdOYW1lKSxcbiAgICAgICAgYXR0cmlidXRlczogZ2VuZXJhdGVBdHRyaWJ1dGVzKGVsKSxcbiAgICAgICAgY2hpbGRyZW46IEFycmF5LmZyb20oZWwuY2hpbGROb2RlcykubWFwKChub2RlKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGNyZWF0ZUVsZW1lbnQobm9kZSwgZmlsdGVyKTtcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuICAgIGRlZmF1bHQ6XG4gICAgICBlcnJvcihgSW52YWxpZCBub2RlIHR5cGUgXCIke2VsLm5vZGVUeXBlfVwiYCk7XG4gIH1cbn07XG5mdW5jdGlvbiB0ZW1wbGF0ZVBhcnNlKGNvZGUsIHRhZ3MpIHtcbiAgbGV0IGFzdFRyZWUgPSBbXTtcbiAgY29uc3QgaHRtbE5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaHRtbFwiKTtcbiAgY29uc3QgY29sbGVjdGlvbkVscyA9IHt9O1xuICBjb25zdCBmaWx0ZXIgPSAoZWwpID0+IHtcbiAgICBpZiAodGFncy5pbmNsdWRlcyhlbC50YWdOYW1lKSkge1xuICAgICAgY29sbGVjdGlvbkVsc1tlbC50YWdOYW1lXS5wdXNoKGVsKTtcbiAgICB9XG4gICAgcmV0dXJuIGVsO1xuICB9O1xuICBodG1sTm9kZS5pbm5lckhUTUwgPSBjb2RlO1xuICBmb3IgKGNvbnN0IHRhZyBvZiB0YWdzKSB7XG4gICAgY29sbGVjdGlvbkVsc1t0YWddID0gW107XG4gIH1cbiAgYXN0VHJlZSA9IEFycmF5LmZyb20oaHRtbE5vZGUuY2hpbGROb2RlcykubWFwKChub2RlKSA9PiB7XG4gICAgcmV0dXJuIGNyZWF0ZUVsZW1lbnQobm9kZSwgZmlsdGVyKTtcbiAgfSk7XG4gIHJldHVybiBbYXN0VHJlZSwgY29sbGVjdGlvbkVsc107XG59XG5cbi8vIHNyYy9sb2dnZXIudHNcbmltcG9ydCBjcmVhdGVEZWJ1ZyBmcm9tIFwiZGVidWdcIjtcbnZhciBsb2cgPSBjcmVhdGVEZWJ1ZyhcImdhcmZpc2hcIik7XG52YXIgY29yZUxvZyA9IGxvZy5leHRlbmQoXCJjb3JlXCIpO1xudmFyIHJvdXRlckxvZyA9IGxvZy5leHRlbmQoXCJyb3V0ZXJcIik7XG5cbi8vIHNyYy9sb2NrLnRzXG52YXIgTG9jayA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5pZCA9IDA7XG4gICAgdGhpcy5sb2NrUXVldWUgPSBbXTtcbiAgfVxuICBnZW5JZCgpIHtcbiAgICByZXR1cm4gKyt0aGlzLmlkO1xuICB9XG4gIGdldElkKCkge1xuICAgIHJldHVybiB0aGlzLmlkO1xuICB9XG4gIGFzeW5jIHdhaXQoaWQpIHtcbiAgICBjb25zdCB7IGxvY2tRdWV1ZSB9ID0gdGhpcztcbiAgICBjb25zdCBmaXJzdExvY2sgPSBsb2NrUXVldWVbMF07XG4gICAgY29uc3QgbGFzdExvY2sgPSBmaXJzdExvY2sgPyBsb2NrUXVldWVbbG9ja1F1ZXVlLmxlbmd0aCAtIDFdIDogdm9pZCAwO1xuICAgIGlmICgoZmlyc3RMb2NrID09IG51bGwgPyB2b2lkIDAgOiBmaXJzdExvY2suaWQpID09PSBpZClcbiAgICAgIHJldHVybjtcbiAgICBsZXQgbG9ja0l0ZW0gPSBsb2NrUXVldWUuZmluZCgoaXRlbSkgPT4gaXRlbS5pZCA9PT0gaWQpO1xuICAgIGlmICghbG9ja0l0ZW0pIHtcbiAgICAgIGxldCBwcm9taXNlUmVzb2x2ZSA9ICgpID0+IHtcbiAgICAgIH07XG4gICAgICBjb25zdCB3YWl0aW5nID0gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgcHJvbWlzZVJlc29sdmUgPSByZXNvbHZlO1xuICAgICAgfSk7XG4gICAgICBsb2NrSXRlbSA9IHsgaWQsIHdhaXRpbmcsIHJlc29sdmU6IHByb21pc2VSZXNvbHZlIH07XG4gICAgICBsb2NrUXVldWUucHVzaChsb2NrSXRlbSk7XG4gICAgfVxuICAgIGlmIChsYXN0TG9jaykge1xuICAgICAgYXdhaXQgbGFzdExvY2sud2FpdGluZztcbiAgICB9XG4gIH1cbiAgcmVsZWFzZSgpIHtcbiAgICBjb25zdCB7IGxvY2tRdWV1ZSB9ID0gdGhpcztcbiAgICBjb25zdCBmaXJzdExvY2sgPSBsb2NrUXVldWVbMF07XG4gICAgaWYgKCFmaXJzdExvY2spXG4gICAgICByZXR1cm47XG4gICAgbG9ja1F1ZXVlLnNoaWZ0KCk7XG4gICAgZmlyc3RMb2NrLnJlc29sdmUoKTtcbiAgfVxuICBjbGVhcigpIHtcbiAgICB0aGlzLmxvY2tRdWV1ZSA9IFtdO1xuICB9XG59O1xuZXhwb3J0IHtcbiAgRE9NQXBpcyxcbiAgTG9jayxcbiAgUXVldWUsXG4gIF9fR0FSRklTSF9GTEFHX18sXG4gIF9fTE9BREVSX0ZMQUdfXyxcbiAgX19Nb2NrQm9keV9fLFxuICBfX01vY2tIZWFkX18sXG4gIF9fTW9ja0h0bWxfXyxcbiAgX19SRU1PVkVfTk9ERV9fLFxuICBfZXh0ZW5kcyxcbiAgYXBwQ29udGFpbmVySWQsXG4gIGFzc2VydCxcbiAgY2FsbFRlc3RDYWxsYmFjayxcbiAgY2hhbmdlVGFnTmFtZVRvTG93ZXJDYXNlLFxuICBjb21wdXRlRXJyb3JVcmwsXG4gIGNvbXB1dGVTdGFja1RyYWNlRnJvbVN0YWNrUHJvcCxcbiAgY29yZUxvZyxcbiAgY3JlYXRlQXBwQ29udGFpbmVyLFxuICBjcmVhdGVLZXksXG4gIGNyZWF0ZVNvdXJjZW1hcCxcbiAgZGVlcE1lcmdlLFxuICBkZWYsXG4gIGVycm9yLFxuICBldmFsV2l0aEVudixcbiAgZmlsdGVyQW5kV3JhcEV2ZW50TGlzdGVuZXIsXG4gIGZpbHRlclVuZGVmaW5lZFZhbCxcbiAgZmluZFRhcmdldCxcbiAgZ2V0R2FyZmlzaERlYnVnSW5zdGFuY2VOYW1lLFxuICBnZXRQYXJhbWV0ZXJCeU5hbWUsXG4gIGdldFJlbmRlck5vZGUsXG4gIGdldFNvdXJjZVVSTCxcbiAgZ2V0VHlwZSxcbiAgaGFzT3duLFxuICBoYXZlU291cmNlbWFwLFxuICBob29rT2JqZWN0UHJvcGVydHksXG4gIGlkbGVDYWxsYmFjayxcbiAgaW5Ccm93c2VyLFxuICBpbnRlcm5GdW5jLFxuICBpc0Fic29sdXRlLFxuICBpc0NzcyxcbiAgaXNDc3NUeXBlLFxuICBpc0dhcmZpc2hDb25maWdUeXBlLFxuICBpc0h0bWwsXG4gIGlzSHRtbFR5cGUsXG4gIGlzSnMsXG4gIGlzSnNUeXBlLFxuICBpc0pzb25wLFxuICBpc09iamVjdCxcbiAgaXNQbGFpbk9iamVjdCxcbiAgaXNQcmltaXRpdmUsXG4gIGlzUHJvbWlzZSxcbiAgbWFjcm9UYXNrLFxuICBtYWtlTWFwLFxuICBtYWtlTWFwT2JqZWN0LFxuICBtYXBPYmplY3QsXG4gIG5leHRUaWNrLFxuICBub29wLFxuICBvYmplY3RUb1N0cmluZyxcbiAgcGFyc2VDb250ZW50VHlwZSxcbiAgcmVtb3ZlLFxuICByb3V0ZXJMb2csXG4gIHNhZmFyaTEzRGVhbCxcbiAgc2FmZVdyYXBwZXIsXG4gIHNldERvY0N1cnJlbnRTY3JpcHQsXG4gIHNvdXJjZUxpc3RUYWdzLFxuICBzb3VyY2VOb2RlLFxuICBzdXBwb3J0V2FzbSxcbiAgdGVtcGxhdGVQYXJzZSxcbiAgdG9CYXNlNjQsXG4gIHRvQm9vbGVhbixcbiAgdG9Xc1Byb3RvY29sLFxuICB0cmFuc2Zvcm1VcmwsXG4gIHVuaXF1ZSxcbiAgdmFsaWRVUkwsXG4gIHdhcm5cbn07XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5leHBvcnQgY29uc3Qge1xuICBpc1ZhbGlkRWxlbWVudFxufSA9IFJlYWN0O1xuZXhwb3J0IGZ1bmN0aW9uIGlzRnJhZ21lbnQoY2hpbGQpIHtcbiAgcmV0dXJuIGNoaWxkICYmIGlzVmFsaWRFbGVtZW50KGNoaWxkKSAmJiBjaGlsZC50eXBlID09PSBSZWFjdC5GcmFnbWVudDtcbn1cbmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlRWxlbWVudChlbGVtZW50LCByZXBsYWNlbWVudCwgcHJvcHMpIHtcbiAgaWYgKCFpc1ZhbGlkRWxlbWVudChlbGVtZW50KSkge1xuICAgIHJldHVybiByZXBsYWNlbWVudDtcbiAgfVxuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNsb25lRWxlbWVudChlbGVtZW50LCB0eXBlb2YgcHJvcHMgPT09ICdmdW5jdGlvbicgPyBwcm9wcyhlbGVtZW50LnByb3BzIHx8IHt9KSA6IHByb3BzKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjbG9uZUVsZW1lbnQoZWxlbWVudCwgcHJvcHMpIHtcbiAgcmV0dXJuIHJlcGxhY2VFbGVtZW50KGVsZW1lbnQsIGVsZW1lbnQsIHByb3BzKTtcbn0iLCIvKiBlc2xpbnQtZW52IGJyb3dzZXIgKi9cblxuLyoqXG4gKiBUaGlzIGlzIHRoZSB3ZWIgYnJvd3NlciBpbXBsZW1lbnRhdGlvbiBvZiBgZGVidWcoKWAuXG4gKi9cblxuZXhwb3J0cy5mb3JtYXRBcmdzID0gZm9ybWF0QXJncztcbmV4cG9ydHMuc2F2ZSA9IHNhdmU7XG5leHBvcnRzLmxvYWQgPSBsb2FkO1xuZXhwb3J0cy51c2VDb2xvcnMgPSB1c2VDb2xvcnM7XG5leHBvcnRzLnN0b3JhZ2UgPSBsb2NhbHN0b3JhZ2UoKTtcbmV4cG9ydHMuZGVzdHJveSA9ICgoKSA9PiB7XG5cdGxldCB3YXJuZWQgPSBmYWxzZTtcblxuXHRyZXR1cm4gKCkgPT4ge1xuXHRcdGlmICghd2FybmVkKSB7XG5cdFx0XHR3YXJuZWQgPSB0cnVlO1xuXHRcdFx0Y29uc29sZS53YXJuKCdJbnN0YW5jZSBtZXRob2QgYGRlYnVnLmRlc3Ryb3koKWAgaXMgZGVwcmVjYXRlZCBhbmQgbm8gbG9uZ2VyIGRvZXMgYW55dGhpbmcuIEl0IHdpbGwgYmUgcmVtb3ZlZCBpbiB0aGUgbmV4dCBtYWpvciB2ZXJzaW9uIG9mIGBkZWJ1Z2AuJyk7XG5cdFx0fVxuXHR9O1xufSkoKTtcblxuLyoqXG4gKiBDb2xvcnMuXG4gKi9cblxuZXhwb3J0cy5jb2xvcnMgPSBbXG5cdCcjMDAwMENDJyxcblx0JyMwMDAwRkYnLFxuXHQnIzAwMzNDQycsXG5cdCcjMDAzM0ZGJyxcblx0JyMwMDY2Q0MnLFxuXHQnIzAwNjZGRicsXG5cdCcjMDA5OUNDJyxcblx0JyMwMDk5RkYnLFxuXHQnIzAwQ0MwMCcsXG5cdCcjMDBDQzMzJyxcblx0JyMwMENDNjYnLFxuXHQnIzAwQ0M5OScsXG5cdCcjMDBDQ0NDJyxcblx0JyMwMENDRkYnLFxuXHQnIzMzMDBDQycsXG5cdCcjMzMwMEZGJyxcblx0JyMzMzMzQ0MnLFxuXHQnIzMzMzNGRicsXG5cdCcjMzM2NkNDJyxcblx0JyMzMzY2RkYnLFxuXHQnIzMzOTlDQycsXG5cdCcjMzM5OUZGJyxcblx0JyMzM0NDMDAnLFxuXHQnIzMzQ0MzMycsXG5cdCcjMzNDQzY2Jyxcblx0JyMzM0NDOTknLFxuXHQnIzMzQ0NDQycsXG5cdCcjMzNDQ0ZGJyxcblx0JyM2NjAwQ0MnLFxuXHQnIzY2MDBGRicsXG5cdCcjNjYzM0NDJyxcblx0JyM2NjMzRkYnLFxuXHQnIzY2Q0MwMCcsXG5cdCcjNjZDQzMzJyxcblx0JyM5OTAwQ0MnLFxuXHQnIzk5MDBGRicsXG5cdCcjOTkzM0NDJyxcblx0JyM5OTMzRkYnLFxuXHQnIzk5Q0MwMCcsXG5cdCcjOTlDQzMzJyxcblx0JyNDQzAwMDAnLFxuXHQnI0NDMDAzMycsXG5cdCcjQ0MwMDY2Jyxcblx0JyNDQzAwOTknLFxuXHQnI0NDMDBDQycsXG5cdCcjQ0MwMEZGJyxcblx0JyNDQzMzMDAnLFxuXHQnI0NDMzMzMycsXG5cdCcjQ0MzMzY2Jyxcblx0JyNDQzMzOTknLFxuXHQnI0NDMzNDQycsXG5cdCcjQ0MzM0ZGJyxcblx0JyNDQzY2MDAnLFxuXHQnI0NDNjYzMycsXG5cdCcjQ0M5OTAwJyxcblx0JyNDQzk5MzMnLFxuXHQnI0NDQ0MwMCcsXG5cdCcjQ0NDQzMzJyxcblx0JyNGRjAwMDAnLFxuXHQnI0ZGMDAzMycsXG5cdCcjRkYwMDY2Jyxcblx0JyNGRjAwOTknLFxuXHQnI0ZGMDBDQycsXG5cdCcjRkYwMEZGJyxcblx0JyNGRjMzMDAnLFxuXHQnI0ZGMzMzMycsXG5cdCcjRkYzMzY2Jyxcblx0JyNGRjMzOTknLFxuXHQnI0ZGMzNDQycsXG5cdCcjRkYzM0ZGJyxcblx0JyNGRjY2MDAnLFxuXHQnI0ZGNjYzMycsXG5cdCcjRkY5OTAwJyxcblx0JyNGRjk5MzMnLFxuXHQnI0ZGQ0MwMCcsXG5cdCcjRkZDQzMzJ1xuXTtcblxuLyoqXG4gKiBDdXJyZW50bHkgb25seSBXZWJLaXQtYmFzZWQgV2ViIEluc3BlY3RvcnMsIEZpcmVmb3ggPj0gdjMxLFxuICogYW5kIHRoZSBGaXJlYnVnIGV4dGVuc2lvbiAoYW55IEZpcmVmb3ggdmVyc2lvbikgYXJlIGtub3duXG4gKiB0byBzdXBwb3J0IFwiJWNcIiBDU1MgY3VzdG9taXphdGlvbnMuXG4gKlxuICogVE9ETzogYWRkIGEgYGxvY2FsU3RvcmFnZWAgdmFyaWFibGUgdG8gZXhwbGljaXRseSBlbmFibGUvZGlzYWJsZSBjb2xvcnNcbiAqL1xuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY29tcGxleGl0eVxuZnVuY3Rpb24gdXNlQ29sb3JzKCkge1xuXHQvLyBOQjogSW4gYW4gRWxlY3Ryb24gcHJlbG9hZCBzY3JpcHQsIGRvY3VtZW50IHdpbGwgYmUgZGVmaW5lZCBidXQgbm90IGZ1bGx5XG5cdC8vIGluaXRpYWxpemVkLiBTaW5jZSB3ZSBrbm93IHdlJ3JlIGluIENocm9tZSwgd2UnbGwganVzdCBkZXRlY3QgdGhpcyBjYXNlXG5cdC8vIGV4cGxpY2l0bHlcblx0aWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5wcm9jZXNzICYmICh3aW5kb3cucHJvY2Vzcy50eXBlID09PSAncmVuZGVyZXInIHx8IHdpbmRvdy5wcm9jZXNzLl9fbndqcykpIHtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdC8vIEludGVybmV0IEV4cGxvcmVyIGFuZCBFZGdlIGRvIG5vdCBzdXBwb3J0IGNvbG9ycy5cblx0aWYgKHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnICYmIG5hdmlnYXRvci51c2VyQWdlbnQgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLm1hdGNoKC8oZWRnZXx0cmlkZW50KVxcLyhcXGQrKS8pKSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0Ly8gSXMgd2Via2l0PyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNjQ1OTYwNi8zNzY3NzNcblx0Ly8gZG9jdW1lbnQgaXMgdW5kZWZpbmVkIGluIHJlYWN0LW5hdGl2ZTogaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0LW5hdGl2ZS9wdWxsLzE2MzJcblx0cmV0dXJuICh0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLldlYmtpdEFwcGVhcmFuY2UpIHx8XG5cdFx0Ly8gSXMgZmlyZWJ1Zz8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMzk4MTIwLzM3Njc3M1xuXHRcdCh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuY29uc29sZSAmJiAod2luZG93LmNvbnNvbGUuZmlyZWJ1ZyB8fCAod2luZG93LmNvbnNvbGUuZXhjZXB0aW9uICYmIHdpbmRvdy5jb25zb2xlLnRhYmxlKSkpIHx8XG5cdFx0Ly8gSXMgZmlyZWZveCA+PSB2MzE/XG5cdFx0Ly8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9Ub29scy9XZWJfQ29uc29sZSNTdHlsaW5nX21lc3NhZ2VzXG5cdFx0KHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnICYmIG5hdmlnYXRvci51c2VyQWdlbnQgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9maXJlZm94XFwvKFxcZCspLykgJiYgcGFyc2VJbnQoUmVnRXhwLiQxLCAxMCkgPj0gMzEpIHx8XG5cdFx0Ly8gRG91YmxlIGNoZWNrIHdlYmtpdCBpbiB1c2VyQWdlbnQganVzdCBpbiBjYXNlIHdlIGFyZSBpbiBhIHdvcmtlclxuXHRcdCh0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJiBuYXZpZ2F0b3IudXNlckFnZW50ICYmIG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKS5tYXRjaCgvYXBwbGV3ZWJraXRcXC8oXFxkKykvKSk7XG59XG5cbi8qKlxuICogQ29sb3JpemUgbG9nIGFyZ3VtZW50cyBpZiBlbmFibGVkLlxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuZnVuY3Rpb24gZm9ybWF0QXJncyhhcmdzKSB7XG5cdGFyZ3NbMF0gPSAodGhpcy51c2VDb2xvcnMgPyAnJWMnIDogJycpICtcblx0XHR0aGlzLm5hbWVzcGFjZSArXG5cdFx0KHRoaXMudXNlQ29sb3JzID8gJyAlYycgOiAnICcpICtcblx0XHRhcmdzWzBdICtcblx0XHQodGhpcy51c2VDb2xvcnMgPyAnJWMgJyA6ICcgJykgK1xuXHRcdCcrJyArIG1vZHVsZS5leHBvcnRzLmh1bWFuaXplKHRoaXMuZGlmZik7XG5cblx0aWYgKCF0aGlzLnVzZUNvbG9ycykge1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGNvbnN0IGMgPSAnY29sb3I6ICcgKyB0aGlzLmNvbG9yO1xuXHRhcmdzLnNwbGljZSgxLCAwLCBjLCAnY29sb3I6IGluaGVyaXQnKTtcblxuXHQvLyBUaGUgZmluYWwgXCIlY1wiIGlzIHNvbWV3aGF0IHRyaWNreSwgYmVjYXVzZSB0aGVyZSBjb3VsZCBiZSBvdGhlclxuXHQvLyBhcmd1bWVudHMgcGFzc2VkIGVpdGhlciBiZWZvcmUgb3IgYWZ0ZXIgdGhlICVjLCBzbyB3ZSBuZWVkIHRvXG5cdC8vIGZpZ3VyZSBvdXQgdGhlIGNvcnJlY3QgaW5kZXggdG8gaW5zZXJ0IHRoZSBDU1MgaW50b1xuXHRsZXQgaW5kZXggPSAwO1xuXHRsZXQgbGFzdEMgPSAwO1xuXHRhcmdzWzBdLnJlcGxhY2UoLyVbYS16QS1aJV0vZywgbWF0Y2ggPT4ge1xuXHRcdGlmIChtYXRjaCA9PT0gJyUlJykge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpbmRleCsrO1xuXHRcdGlmIChtYXRjaCA9PT0gJyVjJykge1xuXHRcdFx0Ly8gV2Ugb25seSBhcmUgaW50ZXJlc3RlZCBpbiB0aGUgKmxhc3QqICVjXG5cdFx0XHQvLyAodGhlIHVzZXIgbWF5IGhhdmUgcHJvdmlkZWQgdGhlaXIgb3duKVxuXHRcdFx0bGFzdEMgPSBpbmRleDtcblx0XHR9XG5cdH0pO1xuXG5cdGFyZ3Muc3BsaWNlKGxhc3RDLCAwLCBjKTtcbn1cblxuLyoqXG4gKiBJbnZva2VzIGBjb25zb2xlLmRlYnVnKClgIHdoZW4gYXZhaWxhYmxlLlxuICogTm8tb3Agd2hlbiBgY29uc29sZS5kZWJ1Z2AgaXMgbm90IGEgXCJmdW5jdGlvblwiLlxuICogSWYgYGNvbnNvbGUuZGVidWdgIGlzIG5vdCBhdmFpbGFibGUsIGZhbGxzIGJhY2tcbiAqIHRvIGBjb25zb2xlLmxvZ2AuXG4gKlxuICogQGFwaSBwdWJsaWNcbiAqL1xuZXhwb3J0cy5sb2cgPSBjb25zb2xlLmRlYnVnIHx8IGNvbnNvbGUubG9nIHx8ICgoKSA9PiB7fSk7XG5cbi8qKlxuICogU2F2ZSBgbmFtZXNwYWNlc2AuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWVzcGFjZXNcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBzYXZlKG5hbWVzcGFjZXMpIHtcblx0dHJ5IHtcblx0XHRpZiAobmFtZXNwYWNlcykge1xuXHRcdFx0ZXhwb3J0cy5zdG9yYWdlLnNldEl0ZW0oJ2RlYnVnJywgbmFtZXNwYWNlcyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGV4cG9ydHMuc3RvcmFnZS5yZW1vdmVJdGVtKCdkZWJ1ZycpO1xuXHRcdH1cblx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHQvLyBTd2FsbG93XG5cdFx0Ly8gWFhYIChAUWl4LSkgc2hvdWxkIHdlIGJlIGxvZ2dpbmcgdGhlc2U/XG5cdH1cbn1cblxuLyoqXG4gKiBMb2FkIGBuYW1lc3BhY2VzYC5cbiAqXG4gKiBAcmV0dXJuIHtTdHJpbmd9IHJldHVybnMgdGhlIHByZXZpb3VzbHkgcGVyc2lzdGVkIGRlYnVnIG1vZGVzXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gbG9hZCgpIHtcblx0bGV0IHI7XG5cdHRyeSB7XG5cdFx0ciA9IGV4cG9ydHMuc3RvcmFnZS5nZXRJdGVtKCdkZWJ1ZycpO1xuXHR9IGNhdGNoIChlcnJvcikge1xuXHRcdC8vIFN3YWxsb3dcblx0XHQvLyBYWFggKEBRaXgtKSBzaG91bGQgd2UgYmUgbG9nZ2luZyB0aGVzZT9cblx0fVxuXG5cdC8vIElmIGRlYnVnIGlzbid0IHNldCBpbiBMUywgYW5kIHdlJ3JlIGluIEVsZWN0cm9uLCB0cnkgdG8gbG9hZCAkREVCVUdcblx0aWYgKCFyICYmIHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiAnZW52JyBpbiBwcm9jZXNzKSB7XG5cdFx0ciA9IHByb2Nlc3MuZW52LkRFQlVHO1xuXHR9XG5cblx0cmV0dXJuIHI7XG59XG5cbi8qKlxuICogTG9jYWxzdG9yYWdlIGF0dGVtcHRzIHRvIHJldHVybiB0aGUgbG9jYWxzdG9yYWdlLlxuICpcbiAqIFRoaXMgaXMgbmVjZXNzYXJ5IGJlY2F1c2Ugc2FmYXJpIHRocm93c1xuICogd2hlbiBhIHVzZXIgZGlzYWJsZXMgY29va2llcy9sb2NhbHN0b3JhZ2VcbiAqIGFuZCB5b3UgYXR0ZW1wdCB0byBhY2Nlc3MgaXQuXG4gKlxuICogQHJldHVybiB7TG9jYWxTdG9yYWdlfVxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZnVuY3Rpb24gbG9jYWxzdG9yYWdlKCkge1xuXHR0cnkge1xuXHRcdC8vIFRWTUxLaXQgKEFwcGxlIFRWIEpTIFJ1bnRpbWUpIGRvZXMgbm90IGhhdmUgYSB3aW5kb3cgb2JqZWN0LCBqdXN0IGxvY2FsU3RvcmFnZSBpbiB0aGUgZ2xvYmFsIGNvbnRleHRcblx0XHQvLyBUaGUgQnJvd3NlciBhbHNvIGhhcyBsb2NhbFN0b3JhZ2UgaW4gdGhlIGdsb2JhbCBjb250ZXh0LlxuXHRcdHJldHVybiBsb2NhbFN0b3JhZ2U7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Ly8gU3dhbGxvd1xuXHRcdC8vIFhYWCAoQFFpeC0pIHNob3VsZCB3ZSBiZSBsb2dnaW5nIHRoZXNlP1xuXHR9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9jb21tb24nKShleHBvcnRzKTtcblxuY29uc3Qge2Zvcm1hdHRlcnN9ID0gbW9kdWxlLmV4cG9ydHM7XG5cbi8qKlxuICogTWFwICVqIHRvIGBKU09OLnN0cmluZ2lmeSgpYCwgc2luY2Ugbm8gV2ViIEluc3BlY3RvcnMgZG8gdGhhdCBieSBkZWZhdWx0LlxuICovXG5cbmZvcm1hdHRlcnMuaiA9IGZ1bmN0aW9uICh2KSB7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIEpTT04uc3RyaW5naWZ5KHYpO1xuXHR9IGNhdGNoIChlcnJvcikge1xuXHRcdHJldHVybiAnW1VuZXhwZWN0ZWRKU09OUGFyc2VFcnJvcl06ICcgKyBlcnJvci5tZXNzYWdlO1xuXHR9XG59O1xuIiwiXG4vKipcbiAqIFRoaXMgaXMgdGhlIGNvbW1vbiBsb2dpYyBmb3IgYm90aCB0aGUgTm9kZS5qcyBhbmQgd2ViIGJyb3dzZXJcbiAqIGltcGxlbWVudGF0aW9ucyBvZiBgZGVidWcoKWAuXG4gKi9cblxuZnVuY3Rpb24gc2V0dXAoZW52KSB7XG5cdGNyZWF0ZURlYnVnLmRlYnVnID0gY3JlYXRlRGVidWc7XG5cdGNyZWF0ZURlYnVnLmRlZmF1bHQgPSBjcmVhdGVEZWJ1Zztcblx0Y3JlYXRlRGVidWcuY29lcmNlID0gY29lcmNlO1xuXHRjcmVhdGVEZWJ1Zy5kaXNhYmxlID0gZGlzYWJsZTtcblx0Y3JlYXRlRGVidWcuZW5hYmxlID0gZW5hYmxlO1xuXHRjcmVhdGVEZWJ1Zy5lbmFibGVkID0gZW5hYmxlZDtcblx0Y3JlYXRlRGVidWcuaHVtYW5pemUgPSByZXF1aXJlKCdtcycpO1xuXHRjcmVhdGVEZWJ1Zy5kZXN0cm95ID0gZGVzdHJveTtcblxuXHRPYmplY3Qua2V5cyhlbnYpLmZvckVhY2goa2V5ID0+IHtcblx0XHRjcmVhdGVEZWJ1Z1trZXldID0gZW52W2tleV07XG5cdH0pO1xuXG5cdC8qKlxuXHQqIFRoZSBjdXJyZW50bHkgYWN0aXZlIGRlYnVnIG1vZGUgbmFtZXMsIGFuZCBuYW1lcyB0byBza2lwLlxuXHQqL1xuXG5cdGNyZWF0ZURlYnVnLm5hbWVzID0gW107XG5cdGNyZWF0ZURlYnVnLnNraXBzID0gW107XG5cblx0LyoqXG5cdCogTWFwIG9mIHNwZWNpYWwgXCIlblwiIGhhbmRsaW5nIGZ1bmN0aW9ucywgZm9yIHRoZSBkZWJ1ZyBcImZvcm1hdFwiIGFyZ3VtZW50LlxuXHQqXG5cdCogVmFsaWQga2V5IG5hbWVzIGFyZSBhIHNpbmdsZSwgbG93ZXIgb3IgdXBwZXItY2FzZSBsZXR0ZXIsIGkuZS4gXCJuXCIgYW5kIFwiTlwiLlxuXHQqL1xuXHRjcmVhdGVEZWJ1Zy5mb3JtYXR0ZXJzID0ge307XG5cblx0LyoqXG5cdCogU2VsZWN0cyBhIGNvbG9yIGZvciBhIGRlYnVnIG5hbWVzcGFjZVxuXHQqIEBwYXJhbSB7U3RyaW5nfSBuYW1lc3BhY2UgVGhlIG5hbWVzcGFjZSBzdHJpbmcgZm9yIHRoZSBkZWJ1ZyBpbnN0YW5jZSB0byBiZSBjb2xvcmVkXG5cdCogQHJldHVybiB7TnVtYmVyfFN0cmluZ30gQW4gQU5TSSBjb2xvciBjb2RlIGZvciB0aGUgZ2l2ZW4gbmFtZXNwYWNlXG5cdCogQGFwaSBwcml2YXRlXG5cdCovXG5cdGZ1bmN0aW9uIHNlbGVjdENvbG9yKG5hbWVzcGFjZSkge1xuXHRcdGxldCBoYXNoID0gMDtcblxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbmFtZXNwYWNlLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRoYXNoID0gKChoYXNoIDw8IDUpIC0gaGFzaCkgKyBuYW1lc3BhY2UuY2hhckNvZGVBdChpKTtcblx0XHRcdGhhc2ggfD0gMDsgLy8gQ29udmVydCB0byAzMmJpdCBpbnRlZ2VyXG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNyZWF0ZURlYnVnLmNvbG9yc1tNYXRoLmFicyhoYXNoKSAlIGNyZWF0ZURlYnVnLmNvbG9ycy5sZW5ndGhdO1xuXHR9XG5cdGNyZWF0ZURlYnVnLnNlbGVjdENvbG9yID0gc2VsZWN0Q29sb3I7XG5cblx0LyoqXG5cdCogQ3JlYXRlIGEgZGVidWdnZXIgd2l0aCB0aGUgZ2l2ZW4gYG5hbWVzcGFjZWAuXG5cdCpcblx0KiBAcGFyYW0ge1N0cmluZ30gbmFtZXNwYWNlXG5cdCogQHJldHVybiB7RnVuY3Rpb259XG5cdCogQGFwaSBwdWJsaWNcblx0Ki9cblx0ZnVuY3Rpb24gY3JlYXRlRGVidWcobmFtZXNwYWNlKSB7XG5cdFx0bGV0IHByZXZUaW1lO1xuXHRcdGxldCBlbmFibGVPdmVycmlkZSA9IG51bGw7XG5cdFx0bGV0IG5hbWVzcGFjZXNDYWNoZTtcblx0XHRsZXQgZW5hYmxlZENhY2hlO1xuXG5cdFx0ZnVuY3Rpb24gZGVidWcoLi4uYXJncykge1xuXHRcdFx0Ly8gRGlzYWJsZWQ/XG5cdFx0XHRpZiAoIWRlYnVnLmVuYWJsZWQpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBzZWxmID0gZGVidWc7XG5cblx0XHRcdC8vIFNldCBgZGlmZmAgdGltZXN0YW1wXG5cdFx0XHRjb25zdCBjdXJyID0gTnVtYmVyKG5ldyBEYXRlKCkpO1xuXHRcdFx0Y29uc3QgbXMgPSBjdXJyIC0gKHByZXZUaW1lIHx8IGN1cnIpO1xuXHRcdFx0c2VsZi5kaWZmID0gbXM7XG5cdFx0XHRzZWxmLnByZXYgPSBwcmV2VGltZTtcblx0XHRcdHNlbGYuY3VyciA9IGN1cnI7XG5cdFx0XHRwcmV2VGltZSA9IGN1cnI7XG5cblx0XHRcdGFyZ3NbMF0gPSBjcmVhdGVEZWJ1Zy5jb2VyY2UoYXJnc1swXSk7XG5cblx0XHRcdGlmICh0eXBlb2YgYXJnc1swXSAhPT0gJ3N0cmluZycpIHtcblx0XHRcdFx0Ly8gQW55dGhpbmcgZWxzZSBsZXQncyBpbnNwZWN0IHdpdGggJU9cblx0XHRcdFx0YXJncy51bnNoaWZ0KCclTycpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBBcHBseSBhbnkgYGZvcm1hdHRlcnNgIHRyYW5zZm9ybWF0aW9uc1xuXHRcdFx0bGV0IGluZGV4ID0gMDtcblx0XHRcdGFyZ3NbMF0gPSBhcmdzWzBdLnJlcGxhY2UoLyUoW2EtekEtWiVdKS9nLCAobWF0Y2gsIGZvcm1hdCkgPT4ge1xuXHRcdFx0XHQvLyBJZiB3ZSBlbmNvdW50ZXIgYW4gZXNjYXBlZCAlIHRoZW4gZG9uJ3QgaW5jcmVhc2UgdGhlIGFycmF5IGluZGV4XG5cdFx0XHRcdGlmIChtYXRjaCA9PT0gJyUlJykge1xuXHRcdFx0XHRcdHJldHVybiAnJSc7XG5cdFx0XHRcdH1cblx0XHRcdFx0aW5kZXgrKztcblx0XHRcdFx0Y29uc3QgZm9ybWF0dGVyID0gY3JlYXRlRGVidWcuZm9ybWF0dGVyc1tmb3JtYXRdO1xuXHRcdFx0XHRpZiAodHlwZW9mIGZvcm1hdHRlciA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0XHRcdGNvbnN0IHZhbCA9IGFyZ3NbaW5kZXhdO1xuXHRcdFx0XHRcdG1hdGNoID0gZm9ybWF0dGVyLmNhbGwoc2VsZiwgdmFsKTtcblxuXHRcdFx0XHRcdC8vIE5vdyB3ZSBuZWVkIHRvIHJlbW92ZSBgYXJnc1tpbmRleF1gIHNpbmNlIGl0J3MgaW5saW5lZCBpbiB0aGUgYGZvcm1hdGBcblx0XHRcdFx0XHRhcmdzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdFx0aW5kZXgtLTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gbWF0Y2g7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gQXBwbHkgZW52LXNwZWNpZmljIGZvcm1hdHRpbmcgKGNvbG9ycywgZXRjLilcblx0XHRcdGNyZWF0ZURlYnVnLmZvcm1hdEFyZ3MuY2FsbChzZWxmLCBhcmdzKTtcblxuXHRcdFx0Y29uc3QgbG9nRm4gPSBzZWxmLmxvZyB8fCBjcmVhdGVEZWJ1Zy5sb2c7XG5cdFx0XHRsb2dGbi5hcHBseShzZWxmLCBhcmdzKTtcblx0XHR9XG5cblx0XHRkZWJ1Zy5uYW1lc3BhY2UgPSBuYW1lc3BhY2U7XG5cdFx0ZGVidWcudXNlQ29sb3JzID0gY3JlYXRlRGVidWcudXNlQ29sb3JzKCk7XG5cdFx0ZGVidWcuY29sb3IgPSBjcmVhdGVEZWJ1Zy5zZWxlY3RDb2xvcihuYW1lc3BhY2UpO1xuXHRcdGRlYnVnLmV4dGVuZCA9IGV4dGVuZDtcblx0XHRkZWJ1Zy5kZXN0cm95ID0gY3JlYXRlRGVidWcuZGVzdHJveTsgLy8gWFhYIFRlbXBvcmFyeS4gV2lsbCBiZSByZW1vdmVkIGluIHRoZSBuZXh0IG1ham9yIHJlbGVhc2UuXG5cblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZGVidWcsICdlbmFibGVkJywge1xuXHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcblx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG5cdFx0XHRnZXQ6ICgpID0+IHtcblx0XHRcdFx0aWYgKGVuYWJsZU92ZXJyaWRlICE9PSBudWxsKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGVuYWJsZU92ZXJyaWRlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChuYW1lc3BhY2VzQ2FjaGUgIT09IGNyZWF0ZURlYnVnLm5hbWVzcGFjZXMpIHtcblx0XHRcdFx0XHRuYW1lc3BhY2VzQ2FjaGUgPSBjcmVhdGVEZWJ1Zy5uYW1lc3BhY2VzO1xuXHRcdFx0XHRcdGVuYWJsZWRDYWNoZSA9IGNyZWF0ZURlYnVnLmVuYWJsZWQobmFtZXNwYWNlKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiBlbmFibGVkQ2FjaGU7XG5cdFx0XHR9LFxuXHRcdFx0c2V0OiB2ID0+IHtcblx0XHRcdFx0ZW5hYmxlT3ZlcnJpZGUgPSB2O1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gRW52LXNwZWNpZmljIGluaXRpYWxpemF0aW9uIGxvZ2ljIGZvciBkZWJ1ZyBpbnN0YW5jZXNcblx0XHRpZiAodHlwZW9mIGNyZWF0ZURlYnVnLmluaXQgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdGNyZWF0ZURlYnVnLmluaXQoZGVidWcpO1xuXHRcdH1cblxuXHRcdHJldHVybiBkZWJ1Zztcblx0fVxuXG5cdGZ1bmN0aW9uIGV4dGVuZChuYW1lc3BhY2UsIGRlbGltaXRlcikge1xuXHRcdGNvbnN0IG5ld0RlYnVnID0gY3JlYXRlRGVidWcodGhpcy5uYW1lc3BhY2UgKyAodHlwZW9mIGRlbGltaXRlciA9PT0gJ3VuZGVmaW5lZCcgPyAnOicgOiBkZWxpbWl0ZXIpICsgbmFtZXNwYWNlKTtcblx0XHRuZXdEZWJ1Zy5sb2cgPSB0aGlzLmxvZztcblx0XHRyZXR1cm4gbmV3RGVidWc7XG5cdH1cblxuXHQvKipcblx0KiBFbmFibGVzIGEgZGVidWcgbW9kZSBieSBuYW1lc3BhY2VzLiBUaGlzIGNhbiBpbmNsdWRlIG1vZGVzXG5cdCogc2VwYXJhdGVkIGJ5IGEgY29sb24gYW5kIHdpbGRjYXJkcy5cblx0KlxuXHQqIEBwYXJhbSB7U3RyaW5nfSBuYW1lc3BhY2VzXG5cdCogQGFwaSBwdWJsaWNcblx0Ki9cblx0ZnVuY3Rpb24gZW5hYmxlKG5hbWVzcGFjZXMpIHtcblx0XHRjcmVhdGVEZWJ1Zy5zYXZlKG5hbWVzcGFjZXMpO1xuXHRcdGNyZWF0ZURlYnVnLm5hbWVzcGFjZXMgPSBuYW1lc3BhY2VzO1xuXG5cdFx0Y3JlYXRlRGVidWcubmFtZXMgPSBbXTtcblx0XHRjcmVhdGVEZWJ1Zy5za2lwcyA9IFtdO1xuXG5cdFx0bGV0IGk7XG5cdFx0Y29uc3Qgc3BsaXQgPSAodHlwZW9mIG5hbWVzcGFjZXMgPT09ICdzdHJpbmcnID8gbmFtZXNwYWNlcyA6ICcnKS5zcGxpdCgvW1xccyxdKy8pO1xuXHRcdGNvbnN0IGxlbiA9IHNwbGl0Lmxlbmd0aDtcblxuXHRcdGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuXHRcdFx0aWYgKCFzcGxpdFtpXSkge1xuXHRcdFx0XHQvLyBpZ25vcmUgZW1wdHkgc3RyaW5nc1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0bmFtZXNwYWNlcyA9IHNwbGl0W2ldLnJlcGxhY2UoL1xcKi9nLCAnLio/Jyk7XG5cblx0XHRcdGlmIChuYW1lc3BhY2VzWzBdID09PSAnLScpIHtcblx0XHRcdFx0Y3JlYXRlRGVidWcuc2tpcHMucHVzaChuZXcgUmVnRXhwKCdeJyArIG5hbWVzcGFjZXMuc2xpY2UoMSkgKyAnJCcpKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNyZWF0ZURlYnVnLm5hbWVzLnB1c2gobmV3IFJlZ0V4cCgnXicgKyBuYW1lc3BhY2VzICsgJyQnKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCogRGlzYWJsZSBkZWJ1ZyBvdXRwdXQuXG5cdCpcblx0KiBAcmV0dXJuIHtTdHJpbmd9IG5hbWVzcGFjZXNcblx0KiBAYXBpIHB1YmxpY1xuXHQqL1xuXHRmdW5jdGlvbiBkaXNhYmxlKCkge1xuXHRcdGNvbnN0IG5hbWVzcGFjZXMgPSBbXG5cdFx0XHQuLi5jcmVhdGVEZWJ1Zy5uYW1lcy5tYXAodG9OYW1lc3BhY2UpLFxuXHRcdFx0Li4uY3JlYXRlRGVidWcuc2tpcHMubWFwKHRvTmFtZXNwYWNlKS5tYXAobmFtZXNwYWNlID0+ICctJyArIG5hbWVzcGFjZSlcblx0XHRdLmpvaW4oJywnKTtcblx0XHRjcmVhdGVEZWJ1Zy5lbmFibGUoJycpO1xuXHRcdHJldHVybiBuYW1lc3BhY2VzO1xuXHR9XG5cblx0LyoqXG5cdCogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBtb2RlIG5hbWUgaXMgZW5hYmxlZCwgZmFsc2Ugb3RoZXJ3aXNlLlxuXHQqXG5cdCogQHBhcmFtIHtTdHJpbmd9IG5hbWVcblx0KiBAcmV0dXJuIHtCb29sZWFufVxuXHQqIEBhcGkgcHVibGljXG5cdCovXG5cdGZ1bmN0aW9uIGVuYWJsZWQobmFtZSkge1xuXHRcdGlmIChuYW1lW25hbWUubGVuZ3RoIC0gMV0gPT09ICcqJykge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0bGV0IGk7XG5cdFx0bGV0IGxlbjtcblxuXHRcdGZvciAoaSA9IDAsIGxlbiA9IGNyZWF0ZURlYnVnLnNraXBzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdFx0XHRpZiAoY3JlYXRlRGVidWcuc2tpcHNbaV0udGVzdChuYW1lKSkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Zm9yIChpID0gMCwgbGVuID0gY3JlYXRlRGVidWcubmFtZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0XHRcdGlmIChjcmVhdGVEZWJ1Zy5uYW1lc1tpXS50ZXN0KG5hbWUpKSB7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdC8qKlxuXHQqIENvbnZlcnQgcmVnZXhwIHRvIG5hbWVzcGFjZVxuXHQqXG5cdCogQHBhcmFtIHtSZWdFeHB9IHJlZ3hlcFxuXHQqIEByZXR1cm4ge1N0cmluZ30gbmFtZXNwYWNlXG5cdCogQGFwaSBwcml2YXRlXG5cdCovXG5cdGZ1bmN0aW9uIHRvTmFtZXNwYWNlKHJlZ2V4cCkge1xuXHRcdHJldHVybiByZWdleHAudG9TdHJpbmcoKVxuXHRcdFx0LnN1YnN0cmluZygyLCByZWdleHAudG9TdHJpbmcoKS5sZW5ndGggLSAyKVxuXHRcdFx0LnJlcGxhY2UoL1xcLlxcKlxcPyQvLCAnKicpO1xuXHR9XG5cblx0LyoqXG5cdCogQ29lcmNlIGB2YWxgLlxuXHQqXG5cdCogQHBhcmFtIHtNaXhlZH0gdmFsXG5cdCogQHJldHVybiB7TWl4ZWR9XG5cdCogQGFwaSBwcml2YXRlXG5cdCovXG5cdGZ1bmN0aW9uIGNvZXJjZSh2YWwpIHtcblx0XHRpZiAodmFsIGluc3RhbmNlb2YgRXJyb3IpIHtcblx0XHRcdHJldHVybiB2YWwuc3RhY2sgfHwgdmFsLm1lc3NhZ2U7XG5cdFx0fVxuXHRcdHJldHVybiB2YWw7XG5cdH1cblxuXHQvKipcblx0KiBYWFggRE8gTk9UIFVTRS4gVGhpcyBpcyBhIHRlbXBvcmFyeSBzdHViIGZ1bmN0aW9uLlxuXHQqIFhYWCBJdCBXSUxMIGJlIHJlbW92ZWQgaW4gdGhlIG5leHQgbWFqb3IgcmVsZWFzZS5cblx0Ki9cblx0ZnVuY3Rpb24gZGVzdHJveSgpIHtcblx0XHRjb25zb2xlLndhcm4oJ0luc3RhbmNlIG1ldGhvZCBgZGVidWcuZGVzdHJveSgpYCBpcyBkZXByZWNhdGVkIGFuZCBubyBsb25nZXIgZG9lcyBhbnl0aGluZy4gSXQgd2lsbCBiZSByZW1vdmVkIGluIHRoZSBuZXh0IG1ham9yIHZlcnNpb24gb2YgYGRlYnVnYC4nKTtcblx0fVxuXG5cdGNyZWF0ZURlYnVnLmVuYWJsZShjcmVhdGVEZWJ1Zy5sb2FkKCkpO1xuXG5cdHJldHVybiBjcmVhdGVEZWJ1Zztcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBzZXR1cDtcbiIsIi8qIVxuICogRXZlbnRFbWl0dGVyMlxuICogaHR0cHM6Ly9naXRodWIuY29tL2hpajFueC9FdmVudEVtaXR0ZXIyXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDEzIGhpajFueFxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICovXG47IWZ1bmN0aW9uKHVuZGVmaW5lZCkge1xuICB2YXIgaGFzT3duUHJvcGVydHk9IE9iamVjdC5oYXNPd25Qcm9wZXJ0eTtcbiAgdmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5ID8gQXJyYXkuaXNBcnJheSA6IGZ1bmN0aW9uIF9pc0FycmF5KG9iaikge1xuICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSA9PT0gXCJbb2JqZWN0IEFycmF5XVwiO1xuICB9O1xuICB2YXIgZGVmYXVsdE1heExpc3RlbmVycyA9IDEwO1xuICB2YXIgbmV4dFRpY2tTdXBwb3J0ZWQ9IHR5cGVvZiBwcm9jZXNzPT0nb2JqZWN0JyAmJiB0eXBlb2YgcHJvY2Vzcy5uZXh0VGljaz09J2Z1bmN0aW9uJztcbiAgdmFyIHN5bWJvbHNTdXBwb3J0ZWQ9IHR5cGVvZiBTeW1ib2w9PT0nZnVuY3Rpb24nO1xuICB2YXIgcmVmbGVjdFN1cHBvcnRlZD0gdHlwZW9mIFJlZmxlY3QgPT09ICdvYmplY3QnO1xuICB2YXIgc2V0SW1tZWRpYXRlU3VwcG9ydGVkPSB0eXBlb2Ygc2V0SW1tZWRpYXRlID09PSAnZnVuY3Rpb24nO1xuICB2YXIgX3NldEltbWVkaWF0ZT0gc2V0SW1tZWRpYXRlU3VwcG9ydGVkID8gc2V0SW1tZWRpYXRlIDogc2V0VGltZW91dDtcbiAgdmFyIG93bktleXM9IHN5bWJvbHNTdXBwb3J0ZWQ/IChyZWZsZWN0U3VwcG9ydGVkICYmIHR5cGVvZiBSZWZsZWN0Lm93bktleXM9PT0nZnVuY3Rpb24nPyBSZWZsZWN0Lm93bktleXMgOiBmdW5jdGlvbihvYmope1xuICAgIHZhciBhcnI9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG9iaik7XG4gICAgYXJyLnB1c2guYXBwbHkoYXJyLCBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iaikpO1xuICAgIHJldHVybiBhcnI7XG4gIH0pIDogT2JqZWN0LmtleXM7XG5cbiAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICB0aGlzLl9ldmVudHMgPSB7fTtcbiAgICBpZiAodGhpcy5fY29uZikge1xuICAgICAgY29uZmlndXJlLmNhbGwodGhpcywgdGhpcy5fY29uZik7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gY29uZmlndXJlKGNvbmYpIHtcbiAgICBpZiAoY29uZikge1xuICAgICAgdGhpcy5fY29uZiA9IGNvbmY7XG5cbiAgICAgIGNvbmYuZGVsaW1pdGVyICYmICh0aGlzLmRlbGltaXRlciA9IGNvbmYuZGVsaW1pdGVyKTtcblxuICAgICAgaWYoY29uZi5tYXhMaXN0ZW5lcnMhPT11bmRlZmluZWQpe1xuICAgICAgICAgIHRoaXMuX21heExpc3RlbmVycz0gY29uZi5tYXhMaXN0ZW5lcnM7XG4gICAgICB9XG5cbiAgICAgIGNvbmYud2lsZGNhcmQgJiYgKHRoaXMud2lsZGNhcmQgPSBjb25mLndpbGRjYXJkKTtcbiAgICAgIGNvbmYubmV3TGlzdGVuZXIgJiYgKHRoaXMuX25ld0xpc3RlbmVyID0gY29uZi5uZXdMaXN0ZW5lcik7XG4gICAgICBjb25mLnJlbW92ZUxpc3RlbmVyICYmICh0aGlzLl9yZW1vdmVMaXN0ZW5lciA9IGNvbmYucmVtb3ZlTGlzdGVuZXIpO1xuICAgICAgY29uZi52ZXJib3NlTWVtb3J5TGVhayAmJiAodGhpcy52ZXJib3NlTWVtb3J5TGVhayA9IGNvbmYudmVyYm9zZU1lbW9yeUxlYWspO1xuICAgICAgY29uZi5pZ25vcmVFcnJvcnMgJiYgKHRoaXMuaWdub3JlRXJyb3JzID0gY29uZi5pZ25vcmVFcnJvcnMpO1xuXG4gICAgICBpZiAodGhpcy53aWxkY2FyZCkge1xuICAgICAgICB0aGlzLmxpc3RlbmVyVHJlZSA9IHt9O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGxvZ1Bvc3NpYmxlTWVtb3J5TGVhayhjb3VudCwgZXZlbnROYW1lKSB7XG4gICAgdmFyIGVycm9yTXNnID0gJyhub2RlKSB3YXJuaW5nOiBwb3NzaWJsZSBFdmVudEVtaXR0ZXIgbWVtb3J5ICcgK1xuICAgICAgICAnbGVhayBkZXRlY3RlZC4gJyArIGNvdW50ICsgJyBsaXN0ZW5lcnMgYWRkZWQuICcgK1xuICAgICAgICAnVXNlIGVtaXR0ZXIuc2V0TWF4TGlzdGVuZXJzKCkgdG8gaW5jcmVhc2UgbGltaXQuJztcblxuICAgIGlmKHRoaXMudmVyYm9zZU1lbW9yeUxlYWspe1xuICAgICAgZXJyb3JNc2cgKz0gJyBFdmVudCBuYW1lOiAnICsgZXZlbnROYW1lICsgJy4nO1xuICAgIH1cblxuICAgIGlmKHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiBwcm9jZXNzLmVtaXRXYXJuaW5nKXtcbiAgICAgIHZhciBlID0gbmV3IEVycm9yKGVycm9yTXNnKTtcbiAgICAgIGUubmFtZSA9ICdNYXhMaXN0ZW5lcnNFeGNlZWRlZFdhcm5pbmcnO1xuICAgICAgZS5lbWl0dGVyID0gdGhpcztcbiAgICAgIGUuY291bnQgPSBjb3VudDtcbiAgICAgIHByb2Nlc3MuZW1pdFdhcm5pbmcoZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3JNc2cpO1xuXG4gICAgICBpZiAoY29uc29sZS50cmFjZSl7XG4gICAgICAgIGNvbnNvbGUudHJhY2UoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2YXIgdG9BcnJheSA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7XG4gICAgdmFyIG4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgIHN3aXRjaCAobikge1xuICAgICAgY2FzZSAwOlxuICAgICAgICByZXR1cm4gW107XG4gICAgICBjYXNlIDE6XG4gICAgICAgIHJldHVybiBbYV07XG4gICAgICBjYXNlIDI6XG4gICAgICAgIHJldHVybiBbYSwgYl07XG4gICAgICBjYXNlIDM6XG4gICAgICAgIHJldHVybiBbYSwgYiwgY107XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB2YXIgYXJyID0gbmV3IEFycmF5KG4pO1xuICAgICAgICB3aGlsZSAobi0tKSB7XG4gICAgICAgICAgYXJyW25dID0gYXJndW1lbnRzW25dO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcnI7XG4gICAgfVxuICB9O1xuXG4gIGZ1bmN0aW9uIHRvT2JqZWN0KGtleXMsIHZhbHVlcykge1xuICAgIHZhciBvYmogPSB7fTtcbiAgICB2YXIga2V5O1xuICAgIHZhciBsZW4gPSBrZXlzLmxlbmd0aDtcbiAgICB2YXIgdmFsdWVzQ291bnQgPSB2YWx1ZXMgPyB2YWx1ZXMubGVuZ3RoIDogMDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBrZXkgPSBrZXlzW2ldO1xuICAgICAgb2JqW2tleV0gPSBpIDwgdmFsdWVzQ291bnQgPyB2YWx1ZXNbaV0gOiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJldHVybiBvYmo7XG4gIH1cblxuICBmdW5jdGlvbiBUYXJnZXRPYnNlcnZlcihlbWl0dGVyLCB0YXJnZXQsIG9wdGlvbnMpIHtcbiAgICB0aGlzLl9lbWl0dGVyID0gZW1pdHRlcjtcbiAgICB0aGlzLl90YXJnZXQgPSB0YXJnZXQ7XG4gICAgdGhpcy5fbGlzdGVuZXJzID0ge307XG4gICAgdGhpcy5fbGlzdGVuZXJzQ291bnQgPSAwO1xuXG4gICAgdmFyIG9uLCBvZmY7XG5cbiAgICBpZiAob3B0aW9ucy5vbiB8fCBvcHRpb25zLm9mZikge1xuICAgICAgb24gPSBvcHRpb25zLm9uO1xuICAgICAgb2ZmID0gb3B0aW9ucy5vZmY7XG4gICAgfVxuXG4gICAgaWYgKHRhcmdldC5hZGRFdmVudExpc3RlbmVyKSB7XG4gICAgICBvbiA9IHRhcmdldC5hZGRFdmVudExpc3RlbmVyO1xuICAgICAgb2ZmID0gdGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXI7XG4gICAgfSBlbHNlIGlmICh0YXJnZXQuYWRkTGlzdGVuZXIpIHtcbiAgICAgIG9uID0gdGFyZ2V0LmFkZExpc3RlbmVyO1xuICAgICAgb2ZmID0gdGFyZ2V0LnJlbW92ZUxpc3RlbmVyO1xuICAgIH0gZWxzZSBpZiAodGFyZ2V0Lm9uKSB7XG4gICAgICBvbiA9IHRhcmdldC5vbjtcbiAgICAgIG9mZiA9IHRhcmdldC5vZmY7XG4gICAgfVxuXG4gICAgaWYgKCFvbiAmJiAhb2ZmKSB7XG4gICAgICB0aHJvdyBFcnJvcigndGFyZ2V0IGRvZXMgbm90IGltcGxlbWVudCBhbnkga25vd24gZXZlbnQgQVBJJyk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBvbiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdGhyb3cgVHlwZUVycm9yKCdvbiBtZXRob2QgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBvZmYgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IFR5cGVFcnJvcignb2ZmIG1ldGhvZCBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICB9XG5cbiAgICB0aGlzLl9vbiA9IG9uO1xuICAgIHRoaXMuX29mZiA9IG9mZjtcblxuICAgIHZhciBfb2JzZXJ2ZXJzPSBlbWl0dGVyLl9vYnNlcnZlcnM7XG4gICAgaWYoX29ic2VydmVycyl7XG4gICAgICBfb2JzZXJ2ZXJzLnB1c2godGhpcyk7XG4gICAgfWVsc2V7XG4gICAgICBlbWl0dGVyLl9vYnNlcnZlcnM9IFt0aGlzXTtcbiAgICB9XG4gIH1cblxuICBPYmplY3QuYXNzaWduKFRhcmdldE9ic2VydmVyLnByb3RvdHlwZSwge1xuICAgIHN1YnNjcmliZTogZnVuY3Rpb24oZXZlbnQsIGxvY2FsRXZlbnQsIHJlZHVjZXIpe1xuICAgICAgdmFyIG9ic2VydmVyPSB0aGlzO1xuICAgICAgdmFyIHRhcmdldD0gdGhpcy5fdGFyZ2V0O1xuICAgICAgdmFyIGVtaXR0ZXI9IHRoaXMuX2VtaXR0ZXI7XG4gICAgICB2YXIgbGlzdGVuZXJzPSB0aGlzLl9saXN0ZW5lcnM7XG4gICAgICB2YXIgaGFuZGxlcj0gZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIGFyZ3M9IHRvQXJyYXkuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbiAgICAgICAgdmFyIGV2ZW50T2JqPSB7XG4gICAgICAgICAgZGF0YTogYXJncyxcbiAgICAgICAgICBuYW1lOiBsb2NhbEV2ZW50LFxuICAgICAgICAgIG9yaWdpbmFsOiBldmVudFxuICAgICAgICB9O1xuICAgICAgICBpZihyZWR1Y2VyKXtcbiAgICAgICAgICB2YXIgcmVzdWx0PSByZWR1Y2VyLmNhbGwodGFyZ2V0LCBldmVudE9iaik7XG4gICAgICAgICAgaWYocmVzdWx0IT09ZmFsc2Upe1xuICAgICAgICAgICAgZW1pdHRlci5lbWl0LmFwcGx5KGVtaXR0ZXIsIFtldmVudE9iai5uYW1lXS5jb25jYXQoYXJncykpXG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBlbWl0dGVyLmVtaXQuYXBwbHkoZW1pdHRlciwgW2xvY2FsRXZlbnRdLmNvbmNhdChhcmdzKSk7XG4gICAgICB9O1xuXG5cbiAgICAgIGlmKGxpc3RlbmVyc1tldmVudF0pe1xuICAgICAgICB0aHJvdyBFcnJvcignRXZlbnQgXFwnJyArIGV2ZW50ICsgJ1xcJyBpcyBhbHJlYWR5IGxpc3RlbmluZycpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9saXN0ZW5lcnNDb3VudCsrO1xuXG4gICAgICBpZihlbWl0dGVyLl9uZXdMaXN0ZW5lciAmJiBlbWl0dGVyLl9yZW1vdmVMaXN0ZW5lciAmJiAhb2JzZXJ2ZXIuX29uTmV3TGlzdGVuZXIpe1xuXG4gICAgICAgIHRoaXMuX29uTmV3TGlzdGVuZXIgPSBmdW5jdGlvbiAoX2V2ZW50KSB7XG4gICAgICAgICAgaWYgKF9ldmVudCA9PT0gbG9jYWxFdmVudCAmJiBsaXN0ZW5lcnNbZXZlbnRdID09PSBudWxsKSB7XG4gICAgICAgICAgICBsaXN0ZW5lcnNbZXZlbnRdID0gaGFuZGxlcjtcbiAgICAgICAgICAgIG9ic2VydmVyLl9vbi5jYWxsKHRhcmdldCwgZXZlbnQsIGhhbmRsZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBlbWl0dGVyLm9uKCduZXdMaXN0ZW5lcicsIHRoaXMuX29uTmV3TGlzdGVuZXIpO1xuXG4gICAgICAgIHRoaXMuX29uUmVtb3ZlTGlzdGVuZXI9IGZ1bmN0aW9uKF9ldmVudCl7XG4gICAgICAgICAgaWYoX2V2ZW50ID09PSBsb2NhbEV2ZW50ICYmICFlbWl0dGVyLmhhc0xpc3RlbmVycyhfZXZlbnQpICYmIGxpc3RlbmVyc1tldmVudF0pe1xuICAgICAgICAgICAgbGlzdGVuZXJzW2V2ZW50XT0gbnVsbDtcbiAgICAgICAgICAgIG9ic2VydmVyLl9vZmYuY2FsbCh0YXJnZXQsIGV2ZW50LCBoYW5kbGVyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgbGlzdGVuZXJzW2V2ZW50XT0gbnVsbDtcblxuICAgICAgICBlbWl0dGVyLm9uKCdyZW1vdmVMaXN0ZW5lcicsIHRoaXMuX29uUmVtb3ZlTGlzdGVuZXIpO1xuICAgICAgfWVsc2V7XG4gICAgICAgIGxpc3RlbmVyc1tldmVudF09IGhhbmRsZXI7XG4gICAgICAgIG9ic2VydmVyLl9vbi5jYWxsKHRhcmdldCwgZXZlbnQsIGhhbmRsZXIpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICB1bnN1YnNjcmliZTogZnVuY3Rpb24oZXZlbnQpe1xuICAgICAgdmFyIG9ic2VydmVyPSB0aGlzO1xuICAgICAgdmFyIGxpc3RlbmVycz0gdGhpcy5fbGlzdGVuZXJzO1xuICAgICAgdmFyIGVtaXR0ZXI9IHRoaXMuX2VtaXR0ZXI7XG4gICAgICB2YXIgaGFuZGxlcjtcbiAgICAgIHZhciBldmVudHM7XG4gICAgICB2YXIgb2ZmPSB0aGlzLl9vZmY7XG4gICAgICB2YXIgdGFyZ2V0PSB0aGlzLl90YXJnZXQ7XG4gICAgICB2YXIgaTtcblxuICAgICAgaWYoZXZlbnQgJiYgdHlwZW9mIGV2ZW50IT09J3N0cmluZycpe1xuICAgICAgICB0aHJvdyBUeXBlRXJyb3IoJ2V2ZW50IG11c3QgYmUgYSBzdHJpbmcnKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gY2xlYXJSZWZzKCl7XG4gICAgICAgIGlmKG9ic2VydmVyLl9vbk5ld0xpc3RlbmVyKXtcbiAgICAgICAgICBlbWl0dGVyLm9mZignbmV3TGlzdGVuZXInLCBvYnNlcnZlci5fb25OZXdMaXN0ZW5lcik7XG4gICAgICAgICAgZW1pdHRlci5vZmYoJ3JlbW92ZUxpc3RlbmVyJywgb2JzZXJ2ZXIuX29uUmVtb3ZlTGlzdGVuZXIpO1xuICAgICAgICAgIG9ic2VydmVyLl9vbk5ld0xpc3RlbmVyPSBudWxsO1xuICAgICAgICAgIG9ic2VydmVyLl9vblJlbW92ZUxpc3RlbmVyPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbmRleD0gZmluZFRhcmdldEluZGV4LmNhbGwoZW1pdHRlciwgb2JzZXJ2ZXIpO1xuICAgICAgICBlbWl0dGVyLl9vYnNlcnZlcnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIH1cblxuICAgICAgaWYoZXZlbnQpe1xuICAgICAgICBoYW5kbGVyPSBsaXN0ZW5lcnNbZXZlbnRdO1xuICAgICAgICBpZighaGFuZGxlcikgcmV0dXJuO1xuICAgICAgICBvZmYuY2FsbCh0YXJnZXQsIGV2ZW50LCBoYW5kbGVyKTtcbiAgICAgICAgZGVsZXRlIGxpc3RlbmVyc1tldmVudF07XG4gICAgICAgIGlmKCEtLXRoaXMuX2xpc3RlbmVyc0NvdW50KXtcbiAgICAgICAgICBjbGVhclJlZnMoKTtcbiAgICAgICAgfVxuICAgICAgfWVsc2V7XG4gICAgICAgIGV2ZW50cz0gb3duS2V5cyhsaXN0ZW5lcnMpO1xuICAgICAgICBpPSBldmVudHMubGVuZ3RoO1xuICAgICAgICB3aGlsZShpLS0+MCl7XG4gICAgICAgICAgZXZlbnQ9IGV2ZW50c1tpXTtcbiAgICAgICAgICBvZmYuY2FsbCh0YXJnZXQsIGV2ZW50LCBsaXN0ZW5lcnNbZXZlbnRdKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9saXN0ZW5lcnM9IHt9O1xuICAgICAgICB0aGlzLl9saXN0ZW5lcnNDb3VudD0gMDtcbiAgICAgICAgY2xlYXJSZWZzKCk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICBmdW5jdGlvbiByZXNvbHZlT3B0aW9ucyhvcHRpb25zLCBzY2hlbWEsIHJlZHVjZXJzLCBhbGxvd1Vua25vd24pIHtcbiAgICB2YXIgY29tcHV0ZWRPcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgc2NoZW1hKTtcblxuICAgIGlmICghb3B0aW9ucykgcmV0dXJuIGNvbXB1dGVkT3B0aW9ucztcblxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucyAhPT0gJ29iamVjdCcpIHtcbiAgICAgIHRocm93IFR5cGVFcnJvcignb3B0aW9ucyBtdXN0IGJlIGFuIG9iamVjdCcpXG4gICAgfVxuXG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvcHRpb25zKTtcbiAgICB2YXIgbGVuZ3RoID0ga2V5cy5sZW5ndGg7XG4gICAgdmFyIG9wdGlvbiwgdmFsdWU7XG4gICAgdmFyIHJlZHVjZXI7XG5cbiAgICBmdW5jdGlvbiByZWplY3QocmVhc29uKSB7XG4gICAgICB0aHJvdyBFcnJvcignSW52YWxpZCBcIicgKyBvcHRpb24gKyAnXCIgb3B0aW9uIHZhbHVlJyArIChyZWFzb24gPyAnLiBSZWFzb246ICcgKyByZWFzb24gOiAnJykpXG4gICAgfVxuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgb3B0aW9uID0ga2V5c1tpXTtcbiAgICAgIGlmICghYWxsb3dVbmtub3duICYmICFoYXNPd25Qcm9wZXJ0eS5jYWxsKHNjaGVtYSwgb3B0aW9uKSkge1xuICAgICAgICB0aHJvdyBFcnJvcignVW5rbm93biBcIicgKyBvcHRpb24gKyAnXCIgb3B0aW9uJyk7XG4gICAgICB9XG4gICAgICB2YWx1ZSA9IG9wdGlvbnNbb3B0aW9uXTtcbiAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJlZHVjZXIgPSByZWR1Y2Vyc1tvcHRpb25dO1xuICAgICAgICBjb21wdXRlZE9wdGlvbnNbb3B0aW9uXSA9IHJlZHVjZXIgPyByZWR1Y2VyKHZhbHVlLCByZWplY3QpIDogdmFsdWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjb21wdXRlZE9wdGlvbnM7XG4gIH1cblxuICBmdW5jdGlvbiBjb25zdHJ1Y3RvclJlZHVjZXIodmFsdWUsIHJlamVjdCkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdmdW5jdGlvbicgfHwgIXZhbHVlLmhhc093blByb3BlcnR5KCdwcm90b3R5cGUnKSkge1xuICAgICAgcmVqZWN0KCd2YWx1ZSBtdXN0IGJlIGEgY29uc3RydWN0b3InKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG5cbiAgZnVuY3Rpb24gbWFrZVR5cGVSZWR1Y2VyKHR5cGVzKSB7XG4gICAgdmFyIG1lc3NhZ2U9ICd2YWx1ZSBtdXN0IGJlIHR5cGUgb2YgJyArIHR5cGVzLmpvaW4oJ3wnKTtcbiAgICB2YXIgbGVuPSB0eXBlcy5sZW5ndGg7XG4gICAgdmFyIGZpcnN0VHlwZT0gdHlwZXNbMF07XG4gICAgdmFyIHNlY29uZFR5cGU9IHR5cGVzWzFdO1xuXG4gICAgaWYgKGxlbiA9PT0gMSkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uICh2LCByZWplY3QpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2ID09PSBmaXJzdFR5cGUpIHtcbiAgICAgICAgICByZXR1cm4gdjtcbiAgICAgICAgfVxuICAgICAgICByZWplY3QobWVzc2FnZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGxlbiA9PT0gMikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uICh2LCByZWplY3QpIHtcbiAgICAgICAgdmFyIGtpbmQ9IHR5cGVvZiB2O1xuICAgICAgICBpZiAoa2luZCA9PT0gZmlyc3RUeXBlIHx8IGtpbmQgPT09IHNlY29uZFR5cGUpIHJldHVybiB2O1xuICAgICAgICByZWplY3QobWVzc2FnZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh2LCByZWplY3QpIHtcbiAgICAgIHZhciBraW5kID0gdHlwZW9mIHY7XG4gICAgICB2YXIgaSA9IGxlbjtcbiAgICAgIHdoaWxlIChpLS0gPiAwKSB7XG4gICAgICAgIGlmIChraW5kID09PSB0eXBlc1tpXSkgcmV0dXJuIHY7XG4gICAgICB9XG4gICAgICByZWplY3QobWVzc2FnZSk7XG4gICAgfVxuICB9XG5cbiAgdmFyIGZ1bmN0aW9uUmVkdWNlcj0gbWFrZVR5cGVSZWR1Y2VyKFsnZnVuY3Rpb24nXSk7XG5cbiAgdmFyIG9iamVjdEZ1bmN0aW9uUmVkdWNlcj0gbWFrZVR5cGVSZWR1Y2VyKFsnb2JqZWN0JywgJ2Z1bmN0aW9uJ10pO1xuXG4gIGZ1bmN0aW9uIG1ha2VDYW5jZWxhYmxlUHJvbWlzZShQcm9taXNlLCBleGVjdXRvciwgb3B0aW9ucykge1xuICAgIHZhciBpc0NhbmNlbGFibGU7XG4gICAgdmFyIGNhbGxiYWNrcztcbiAgICB2YXIgdGltZXI9IDA7XG4gICAgdmFyIHN1YnNjcmlwdGlvbkNsb3NlZDtcblxuICAgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCwgb25DYW5jZWwpIHtcbiAgICAgIG9wdGlvbnM9IHJlc29sdmVPcHRpb25zKG9wdGlvbnMsIHtcbiAgICAgICAgdGltZW91dDogMCxcbiAgICAgICAgb3ZlcmxvYWQ6IGZhbHNlXG4gICAgICB9LCB7XG4gICAgICAgIHRpbWVvdXQ6IGZ1bmN0aW9uKHZhbHVlLCByZWplY3Qpe1xuICAgICAgICAgIHZhbHVlKj0gMTtcbiAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnbnVtYmVyJyB8fCB2YWx1ZSA8IDAgfHwgIU51bWJlci5pc0Zpbml0ZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHJlamVjdCgndGltZW91dCBtdXN0IGJlIGEgcG9zaXRpdmUgbnVtYmVyJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGlzQ2FuY2VsYWJsZSA9ICFvcHRpb25zLm92ZXJsb2FkICYmIHR5cGVvZiBQcm9taXNlLnByb3RvdHlwZS5jYW5jZWwgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIG9uQ2FuY2VsID09PSAnZnVuY3Rpb24nO1xuXG4gICAgICBmdW5jdGlvbiBjbGVhbnVwKCkge1xuICAgICAgICBpZiAoY2FsbGJhY2tzKSB7XG4gICAgICAgICAgY2FsbGJhY2tzID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGltZXIpIHtcbiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgICAgICAgIHRpbWVyID0gMDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB2YXIgX3Jlc29sdmU9IGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICByZXNvbHZlKHZhbHVlKTtcbiAgICAgIH07XG5cbiAgICAgIHZhciBfcmVqZWN0PSBmdW5jdGlvbihlcnIpe1xuICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgfTtcblxuICAgICAgaWYgKGlzQ2FuY2VsYWJsZSkge1xuICAgICAgICBleGVjdXRvcihfcmVzb2x2ZSwgX3JlamVjdCwgb25DYW5jZWwpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2FsbGJhY2tzID0gW2Z1bmN0aW9uKHJlYXNvbil7XG4gICAgICAgICAgX3JlamVjdChyZWFzb24gfHwgRXJyb3IoJ2NhbmNlbGVkJykpO1xuICAgICAgICB9XTtcbiAgICAgICAgZXhlY3V0b3IoX3Jlc29sdmUsIF9yZWplY3QsIGZ1bmN0aW9uIChjYikge1xuICAgICAgICAgIGlmIChzdWJzY3JpcHRpb25DbG9zZWQpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdVbmFibGUgdG8gc3Vic2NyaWJlIG9uIGNhbmNlbCBldmVudCBhc3luY2hyb25vdXNseScpXG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0eXBlb2YgY2IgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRocm93IFR5cGVFcnJvcignb25DYW5jZWwgY2FsbGJhY2sgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNhbGxiYWNrcy5wdXNoKGNiKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHN1YnNjcmlwdGlvbkNsb3NlZD0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKG9wdGlvbnMudGltZW91dCA+IDApIHtcbiAgICAgICAgdGltZXI9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICB2YXIgcmVhc29uPSBFcnJvcigndGltZW91dCcpO1xuICAgICAgICAgIHJlYXNvbi5jb2RlID0gJ0VUSU1FRE9VVCdcbiAgICAgICAgICB0aW1lcj0gMDtcbiAgICAgICAgICBwcm9taXNlLmNhbmNlbChyZWFzb24pO1xuICAgICAgICAgIHJlamVjdChyZWFzb24pO1xuICAgICAgICB9LCBvcHRpb25zLnRpbWVvdXQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKCFpc0NhbmNlbGFibGUpIHtcbiAgICAgIHByb21pc2UuY2FuY2VsID0gZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgICBpZiAoIWNhbGxiYWNrcykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGVuZ3RoID0gY2FsbGJhY2tzLmxlbmd0aDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNhbGxiYWNrc1tpXShyZWFzb24pO1xuICAgICAgICB9XG4gICAgICAgIC8vIGludGVybmFsIGNhbGxiYWNrIHRvIHJlamVjdCB0aGUgcHJvbWlzZVxuICAgICAgICBjYWxsYmFja3NbMF0ocmVhc29uKTtcbiAgICAgICAgY2FsbGJhY2tzID0gbnVsbDtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHByb21pc2U7XG4gIH1cblxuICBmdW5jdGlvbiBmaW5kVGFyZ2V0SW5kZXgob2JzZXJ2ZXIpIHtcbiAgICB2YXIgb2JzZXJ2ZXJzID0gdGhpcy5fb2JzZXJ2ZXJzO1xuICAgIGlmKCFvYnNlcnZlcnMpe1xuICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICB2YXIgbGVuID0gb2JzZXJ2ZXJzLmxlbmd0aDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBpZiAob2JzZXJ2ZXJzW2ldLl90YXJnZXQgPT09IG9ic2VydmVyKSByZXR1cm4gaTtcbiAgICB9XG4gICAgcmV0dXJuIC0xO1xuICB9XG5cbiAgLy8gQXR0ZW50aW9uLCBmdW5jdGlvbiByZXR1cm4gdHlwZSBub3cgaXMgYXJyYXksIGFsd2F5cyAhXG4gIC8vIEl0IGhhcyB6ZXJvIGVsZW1lbnRzIGlmIG5vIGFueSBtYXRjaGVzIGZvdW5kIGFuZCBvbmUgb3IgbW9yZVxuICAvLyBlbGVtZW50cyAobGVhZnMpIGlmIHRoZXJlIGFyZSBtYXRjaGVzXG4gIC8vXG4gIGZ1bmN0aW9uIHNlYXJjaExpc3RlbmVyVHJlZShoYW5kbGVycywgdHlwZSwgdHJlZSwgaSwgdHlwZUxlbmd0aCkge1xuICAgIGlmICghdHJlZSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKGkgPT09IDApIHtcbiAgICAgIHZhciBraW5kID0gdHlwZW9mIHR5cGU7XG4gICAgICBpZiAoa2luZCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgdmFyIG5zLCBuLCBsID0gMCwgaiA9IDAsIGRlbGltaXRlciA9IHRoaXMuZGVsaW1pdGVyLCBkbCA9IGRlbGltaXRlci5sZW5ndGg7XG4gICAgICAgIGlmICgobiA9IHR5cGUuaW5kZXhPZihkZWxpbWl0ZXIpKSAhPT0gLTEpIHtcbiAgICAgICAgICBucyA9IG5ldyBBcnJheSg1KTtcbiAgICAgICAgICBkbyB7XG4gICAgICAgICAgICBuc1tsKytdID0gdHlwZS5zbGljZShqLCBuKTtcbiAgICAgICAgICAgIGogPSBuICsgZGw7XG4gICAgICAgICAgfSB3aGlsZSAoKG4gPSB0eXBlLmluZGV4T2YoZGVsaW1pdGVyLCBqKSkgIT09IC0xKTtcblxuICAgICAgICAgIG5zW2wrK10gPSB0eXBlLnNsaWNlKGopO1xuICAgICAgICAgIHR5cGUgPSBucztcbiAgICAgICAgICB0eXBlTGVuZ3RoID0gbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0eXBlID0gW3R5cGVdO1xuICAgICAgICAgIHR5cGVMZW5ndGggPSAxO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGtpbmQgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIHR5cGVMZW5ndGggPSB0eXBlLmxlbmd0aDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHR5cGUgPSBbdHlwZV07XG4gICAgICAgIHR5cGVMZW5ndGggPSAxO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBsaXN0ZW5lcnM9IG51bGwsIGJyYW5jaCwgeFRyZWUsIHh4VHJlZSwgaXNvbGF0ZWRCcmFuY2gsIGVuZFJlYWNoZWQsIGN1cnJlbnRUeXBlID0gdHlwZVtpXSxcbiAgICAgICAgbmV4dFR5cGUgPSB0eXBlW2kgKyAxXSwgYnJhbmNoZXMsIF9saXN0ZW5lcnM7XG5cbiAgICBpZiAoaSA9PT0gdHlwZUxlbmd0aCkge1xuICAgICAgLy9cbiAgICAgIC8vIElmIGF0IHRoZSBlbmQgb2YgdGhlIGV2ZW50KHMpIGxpc3QgYW5kIHRoZSB0cmVlIGhhcyBsaXN0ZW5lcnNcbiAgICAgIC8vIGludm9rZSB0aG9zZSBsaXN0ZW5lcnMuXG4gICAgICAvL1xuXG4gICAgICBpZih0cmVlLl9saXN0ZW5lcnMpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0cmVlLl9saXN0ZW5lcnMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICBoYW5kbGVycyAmJiBoYW5kbGVycy5wdXNoKHRyZWUuX2xpc3RlbmVycyk7XG4gICAgICAgICAgbGlzdGVuZXJzID0gW3RyZWVdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGhhbmRsZXJzICYmIGhhbmRsZXJzLnB1c2guYXBwbHkoaGFuZGxlcnMsIHRyZWUuX2xpc3RlbmVycyk7XG4gICAgICAgICAgbGlzdGVuZXJzID0gW3RyZWVdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcblxuICAgICAgaWYgKGN1cnJlbnRUeXBlID09PSAnKicpIHtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gSWYgdGhlIGV2ZW50IGVtaXR0ZWQgaXMgJyonIGF0IHRoaXMgcGFydFxuICAgICAgICAvLyBvciB0aGVyZSBpcyBhIGNvbmNyZXRlIG1hdGNoIGF0IHRoaXMgcGF0Y2hcbiAgICAgICAgLy9cbiAgICAgICAgYnJhbmNoZXMgPSBvd25LZXlzKHRyZWUpO1xuICAgICAgICBuID0gYnJhbmNoZXMubGVuZ3RoO1xuICAgICAgICB3aGlsZSAobi0tID4gMCkge1xuICAgICAgICAgIGJyYW5jaCA9IGJyYW5jaGVzW25dO1xuICAgICAgICAgIGlmIChicmFuY2ggIT09ICdfbGlzdGVuZXJzJykge1xuICAgICAgICAgICAgX2xpc3RlbmVycyA9IHNlYXJjaExpc3RlbmVyVHJlZShoYW5kbGVycywgdHlwZSwgdHJlZVticmFuY2hdLCBpICsgMSwgdHlwZUxlbmd0aCk7XG4gICAgICAgICAgICBpZiAoX2xpc3RlbmVycykge1xuICAgICAgICAgICAgICBpZiAobGlzdGVuZXJzKSB7XG4gICAgICAgICAgICAgICAgbGlzdGVuZXJzLnB1c2guYXBwbHkobGlzdGVuZXJzLCBfbGlzdGVuZXJzKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsaXN0ZW5lcnMgPSBfbGlzdGVuZXJzO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaXN0ZW5lcnM7XG4gICAgICB9IGVsc2UgaWYgKGN1cnJlbnRUeXBlID09PSAnKionKSB7XG4gICAgICAgIGVuZFJlYWNoZWQgPSAoaSArIDEgPT09IHR5cGVMZW5ndGggfHwgKGkgKyAyID09PSB0eXBlTGVuZ3RoICYmIG5leHRUeXBlID09PSAnKicpKTtcbiAgICAgICAgaWYgKGVuZFJlYWNoZWQgJiYgdHJlZS5fbGlzdGVuZXJzKSB7XG4gICAgICAgICAgLy8gVGhlIG5leHQgZWxlbWVudCBoYXMgYSBfbGlzdGVuZXJzLCBhZGQgaXQgdG8gdGhlIGhhbmRsZXJzLlxuICAgICAgICAgIGxpc3RlbmVycyA9IHNlYXJjaExpc3RlbmVyVHJlZShoYW5kbGVycywgdHlwZSwgdHJlZSwgdHlwZUxlbmd0aCwgdHlwZUxlbmd0aCk7XG4gICAgICAgIH1cblxuICAgICAgICBicmFuY2hlcyA9IG93bktleXModHJlZSk7XG4gICAgICAgIG4gPSBicmFuY2hlcy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChuLS0gPiAwKSB7XG4gICAgICAgICAgYnJhbmNoID0gYnJhbmNoZXNbbl07XG4gICAgICAgICAgaWYgKGJyYW5jaCAhPT0gJ19saXN0ZW5lcnMnKSB7XG4gICAgICAgICAgICBpZiAoYnJhbmNoID09PSAnKicgfHwgYnJhbmNoID09PSAnKionKSB7XG4gICAgICAgICAgICAgIGlmICh0cmVlW2JyYW5jaF0uX2xpc3RlbmVycyAmJiAhZW5kUmVhY2hlZCkge1xuICAgICAgICAgICAgICAgIF9saXN0ZW5lcnMgPSBzZWFyY2hMaXN0ZW5lclRyZWUoaGFuZGxlcnMsIHR5cGUsIHRyZWVbYnJhbmNoXSwgdHlwZUxlbmd0aCwgdHlwZUxlbmd0aCk7XG4gICAgICAgICAgICAgICAgaWYgKF9saXN0ZW5lcnMpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChsaXN0ZW5lcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXJzLnB1c2guYXBwbHkobGlzdGVuZXJzLCBfbGlzdGVuZXJzKTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxpc3RlbmVycyA9IF9saXN0ZW5lcnM7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIF9saXN0ZW5lcnMgPSBzZWFyY2hMaXN0ZW5lclRyZWUoaGFuZGxlcnMsIHR5cGUsIHRyZWVbYnJhbmNoXSwgaSwgdHlwZUxlbmd0aCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGJyYW5jaCA9PT0gbmV4dFR5cGUpIHtcbiAgICAgICAgICAgICAgX2xpc3RlbmVycyA9IHNlYXJjaExpc3RlbmVyVHJlZShoYW5kbGVycywgdHlwZSwgdHJlZVticmFuY2hdLCBpICsgMiwgdHlwZUxlbmd0aCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAvLyBObyBtYXRjaCBvbiB0aGlzIG9uZSwgc2hpZnQgaW50byB0aGUgdHJlZSBidXQgbm90IGluIHRoZSB0eXBlIGFycmF5LlxuICAgICAgICAgICAgICBfbGlzdGVuZXJzID0gc2VhcmNoTGlzdGVuZXJUcmVlKGhhbmRsZXJzLCB0eXBlLCB0cmVlW2JyYW5jaF0sIGksIHR5cGVMZW5ndGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF9saXN0ZW5lcnMpIHtcbiAgICAgICAgICAgICAgaWYgKGxpc3RlbmVycykge1xuICAgICAgICAgICAgICAgIGxpc3RlbmVycy5wdXNoLmFwcGx5KGxpc3RlbmVycywgX2xpc3RlbmVycyk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGlzdGVuZXJzID0gX2xpc3RlbmVycztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGlzdGVuZXJzO1xuICAgICAgfSBlbHNlIGlmICh0cmVlW2N1cnJlbnRUeXBlXSkge1xuICAgICAgICBsaXN0ZW5lcnMgPSBzZWFyY2hMaXN0ZW5lclRyZWUoaGFuZGxlcnMsIHR5cGUsIHRyZWVbY3VycmVudFR5cGVdLCBpICsgMSwgdHlwZUxlbmd0aCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgICB4VHJlZSA9IHRyZWVbJyonXTtcbiAgICBpZiAoeFRyZWUpIHtcbiAgICAgIC8vXG4gICAgICAvLyBJZiB0aGUgbGlzdGVuZXIgdHJlZSB3aWxsIGFsbG93IGFueSBtYXRjaCBmb3IgdGhpcyBwYXJ0LFxuICAgICAgLy8gdGhlbiByZWN1cnNpdmVseSBleHBsb3JlIGFsbCBicmFuY2hlcyBvZiB0aGUgdHJlZVxuICAgICAgLy9cbiAgICAgIHNlYXJjaExpc3RlbmVyVHJlZShoYW5kbGVycywgdHlwZSwgeFRyZWUsIGkgKyAxLCB0eXBlTGVuZ3RoKTtcbiAgICB9XG5cbiAgICB4eFRyZWUgPSB0cmVlWycqKiddO1xuICAgIGlmICh4eFRyZWUpIHtcbiAgICAgIGlmIChpIDwgdHlwZUxlbmd0aCkge1xuICAgICAgICBpZiAoeHhUcmVlLl9saXN0ZW5lcnMpIHtcbiAgICAgICAgICAvLyBJZiB3ZSBoYXZlIGEgbGlzdGVuZXIgb24gYSAnKionLCBpdCB3aWxsIGNhdGNoIGFsbCwgc28gYWRkIGl0cyBoYW5kbGVyLlxuICAgICAgICAgIHNlYXJjaExpc3RlbmVyVHJlZShoYW5kbGVycywgdHlwZSwgeHhUcmVlLCB0eXBlTGVuZ3RoLCB0eXBlTGVuZ3RoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJ1aWxkIGFycmF5cyBvZiBtYXRjaGluZyBuZXh0IGJyYW5jaGVzIGFuZCBvdGhlcnMuXG4gICAgICAgIGJyYW5jaGVzPSBvd25LZXlzKHh4VHJlZSk7XG4gICAgICAgIG49IGJyYW5jaGVzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUobi0tPjApe1xuICAgICAgICAgIGJyYW5jaD0gYnJhbmNoZXNbbl07XG4gICAgICAgICAgaWYgKGJyYW5jaCAhPT0gJ19saXN0ZW5lcnMnKSB7XG4gICAgICAgICAgICBpZiAoYnJhbmNoID09PSBuZXh0VHlwZSkge1xuICAgICAgICAgICAgICAvLyBXZSBrbm93IHRoZSBuZXh0IGVsZW1lbnQgd2lsbCBtYXRjaCwgc28ganVtcCB0d2ljZS5cbiAgICAgICAgICAgICAgc2VhcmNoTGlzdGVuZXJUcmVlKGhhbmRsZXJzLCB0eXBlLCB4eFRyZWVbYnJhbmNoXSwgaSArIDIsIHR5cGVMZW5ndGgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChicmFuY2ggPT09IGN1cnJlbnRUeXBlKSB7XG4gICAgICAgICAgICAgIC8vIEN1cnJlbnQgbm9kZSBtYXRjaGVzLCBtb3ZlIGludG8gdGhlIHRyZWUuXG4gICAgICAgICAgICAgIHNlYXJjaExpc3RlbmVyVHJlZShoYW5kbGVycywgdHlwZSwgeHhUcmVlW2JyYW5jaF0sIGkgKyAxLCB0eXBlTGVuZ3RoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGlzb2xhdGVkQnJhbmNoID0ge307XG4gICAgICAgICAgICAgIGlzb2xhdGVkQnJhbmNoW2JyYW5jaF0gPSB4eFRyZWVbYnJhbmNoXTtcbiAgICAgICAgICAgICAgc2VhcmNoTGlzdGVuZXJUcmVlKGhhbmRsZXJzLCB0eXBlLCB7JyoqJzogaXNvbGF0ZWRCcmFuY2h9LCBpICsgMSwgdHlwZUxlbmd0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHh4VHJlZS5fbGlzdGVuZXJzKSB7XG4gICAgICAgIC8vIFdlIGhhdmUgcmVhY2hlZCB0aGUgZW5kIGFuZCBzdGlsbCBvbiBhICcqKidcbiAgICAgICAgc2VhcmNoTGlzdGVuZXJUcmVlKGhhbmRsZXJzLCB0eXBlLCB4eFRyZWUsIHR5cGVMZW5ndGgsIHR5cGVMZW5ndGgpO1xuICAgICAgfSBlbHNlIGlmICh4eFRyZWVbJyonXSAmJiB4eFRyZWVbJyonXS5fbGlzdGVuZXJzKSB7XG4gICAgICAgIHNlYXJjaExpc3RlbmVyVHJlZShoYW5kbGVycywgdHlwZSwgeHhUcmVlWycqJ10sIHR5cGVMZW5ndGgsIHR5cGVMZW5ndGgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBsaXN0ZW5lcnM7XG4gIH1cblxuICBmdW5jdGlvbiBncm93TGlzdGVuZXJUcmVlKHR5cGUsIGxpc3RlbmVyLCBwcmVwZW5kKSB7XG4gICAgdmFyIGxlbiA9IDAsIGogPSAwLCBpLCBkZWxpbWl0ZXIgPSB0aGlzLmRlbGltaXRlciwgZGw9IGRlbGltaXRlci5sZW5ndGgsIG5zO1xuXG4gICAgaWYodHlwZW9mIHR5cGU9PT0nc3RyaW5nJykge1xuICAgICAgaWYgKChpID0gdHlwZS5pbmRleE9mKGRlbGltaXRlcikpICE9PSAtMSkge1xuICAgICAgICBucyA9IG5ldyBBcnJheSg1KTtcbiAgICAgICAgZG8ge1xuICAgICAgICAgIG5zW2xlbisrXSA9IHR5cGUuc2xpY2UoaiwgaSk7XG4gICAgICAgICAgaiA9IGkgKyBkbDtcbiAgICAgICAgfSB3aGlsZSAoKGkgPSB0eXBlLmluZGV4T2YoZGVsaW1pdGVyLCBqKSkgIT09IC0xKTtcblxuICAgICAgICBuc1tsZW4rK10gPSB0eXBlLnNsaWNlKGopO1xuICAgICAgfWVsc2V7XG4gICAgICAgIG5zPSBbdHlwZV07XG4gICAgICAgIGxlbj0gMTtcbiAgICAgIH1cbiAgICB9ZWxzZXtcbiAgICAgIG5zPSB0eXBlO1xuICAgICAgbGVuPSB0eXBlLmxlbmd0aDtcbiAgICB9XG5cbiAgICAvL1xuICAgIC8vIExvb2tzIGZvciB0d28gY29uc2VjdXRpdmUgJyoqJywgaWYgc28sIGRvbid0IGFkZCB0aGUgZXZlbnQgYXQgYWxsLlxuICAgIC8vXG4gICAgaWYgKGxlbiA+IDEpIHtcbiAgICAgIGZvciAoaSA9IDA7IGkgKyAxIDwgbGVuOyBpKyspIHtcbiAgICAgICAgaWYgKG5zW2ldID09PSAnKionICYmIG5zW2kgKyAxXSA9PT0gJyoqJykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuXG5cbiAgICB2YXIgdHJlZSA9IHRoaXMubGlzdGVuZXJUcmVlLCBuYW1lO1xuXG4gICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBuYW1lID0gbnNbaV07XG5cbiAgICAgIHRyZWUgPSB0cmVlW25hbWVdIHx8ICh0cmVlW25hbWVdID0ge30pO1xuXG4gICAgICBpZiAoaSA9PT0gbGVuIC0gMSkge1xuICAgICAgICBpZiAoIXRyZWUuX2xpc3RlbmVycykge1xuICAgICAgICAgIHRyZWUuX2xpc3RlbmVycyA9IGxpc3RlbmVyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICh0eXBlb2YgdHJlZS5fbGlzdGVuZXJzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0cmVlLl9saXN0ZW5lcnMgPSBbdHJlZS5fbGlzdGVuZXJzXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAocHJlcGVuZCkge1xuICAgICAgICAgICAgdHJlZS5fbGlzdGVuZXJzLnVuc2hpZnQobGlzdGVuZXIpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0cmVlLl9saXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAhdHJlZS5fbGlzdGVuZXJzLndhcm5lZCAmJlxuICAgICAgICAgICAgICB0aGlzLl9tYXhMaXN0ZW5lcnMgPiAwICYmXG4gICAgICAgICAgICAgIHRyZWUuX2xpc3RlbmVycy5sZW5ndGggPiB0aGlzLl9tYXhMaXN0ZW5lcnNcbiAgICAgICAgICApIHtcbiAgICAgICAgICAgIHRyZWUuX2xpc3RlbmVycy53YXJuZWQgPSB0cnVlO1xuICAgICAgICAgICAgbG9nUG9zc2libGVNZW1vcnlMZWFrLmNhbGwodGhpcywgdHJlZS5fbGlzdGVuZXJzLmxlbmd0aCwgbmFtZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgZnVuY3Rpb24gY29sbGVjdFRyZWVFdmVudHModHJlZSwgZXZlbnRzLCByb290LCBhc0FycmF5KXtcbiAgICAgdmFyIGJyYW5jaGVzPSBvd25LZXlzKHRyZWUpO1xuICAgICB2YXIgaT0gYnJhbmNoZXMubGVuZ3RoO1xuICAgICB2YXIgYnJhbmNoLCBicmFuY2hOYW1lLCBwYXRoO1xuICAgICB2YXIgaGFzTGlzdGVuZXJzPSB0cmVlWydfbGlzdGVuZXJzJ107XG4gICAgIHZhciBpc0FycmF5UGF0aDtcblxuICAgICB3aGlsZShpLS0+MCl7XG4gICAgICAgICBicmFuY2hOYW1lPSBicmFuY2hlc1tpXTtcblxuICAgICAgICAgYnJhbmNoPSB0cmVlW2JyYW5jaE5hbWVdO1xuXG4gICAgICAgICBpZihicmFuY2hOYW1lPT09J19saXN0ZW5lcnMnKXtcbiAgICAgICAgICAgICBwYXRoPSByb290O1xuICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgIHBhdGggPSByb290ID8gcm9vdC5jb25jYXQoYnJhbmNoTmFtZSkgOiBbYnJhbmNoTmFtZV07XG4gICAgICAgICB9XG5cbiAgICAgICAgIGlzQXJyYXlQYXRoPSBhc0FycmF5IHx8IHR5cGVvZiBicmFuY2hOYW1lPT09J3N5bWJvbCc7XG5cbiAgICAgICAgIGhhc0xpc3RlbmVycyAmJiBldmVudHMucHVzaChpc0FycmF5UGF0aD8gcGF0aCA6IHBhdGguam9pbih0aGlzLmRlbGltaXRlcikpO1xuXG4gICAgICAgICBpZih0eXBlb2YgYnJhbmNoPT09J29iamVjdCcpe1xuICAgICAgICAgICAgIGNvbGxlY3RUcmVlRXZlbnRzLmNhbGwodGhpcywgYnJhbmNoLCBldmVudHMsIHBhdGgsIGlzQXJyYXlQYXRoKTtcbiAgICAgICAgIH1cbiAgICAgfVxuXG4gICAgIHJldHVybiBldmVudHM7XG4gIH1cblxuICBmdW5jdGlvbiByZWN1cnNpdmVseUdhcmJhZ2VDb2xsZWN0KHJvb3QpIHtcbiAgICB2YXIga2V5cyA9IG93bktleXMocm9vdCk7XG4gICAgdmFyIGk9IGtleXMubGVuZ3RoO1xuICAgIHZhciBvYmosIGtleSwgZmxhZztcbiAgICB3aGlsZShpLS0+MCl7XG4gICAgICBrZXkgPSBrZXlzW2ldO1xuICAgICAgb2JqID0gcm9vdFtrZXldO1xuXG4gICAgICBpZihvYmope1xuICAgICAgICAgIGZsYWc9IHRydWU7XG4gICAgICAgICAgaWYoa2V5ICE9PSAnX2xpc3RlbmVycycgJiYgIXJlY3Vyc2l2ZWx5R2FyYmFnZUNvbGxlY3Qob2JqKSl7XG4gICAgICAgICAgICAgZGVsZXRlIHJvb3Rba2V5XTtcbiAgICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZsYWc7XG4gIH1cblxuICBmdW5jdGlvbiBMaXN0ZW5lcihlbWl0dGVyLCBldmVudCwgbGlzdGVuZXIpe1xuICAgIHRoaXMuZW1pdHRlcj0gZW1pdHRlcjtcbiAgICB0aGlzLmV2ZW50PSBldmVudDtcbiAgICB0aGlzLmxpc3RlbmVyPSBsaXN0ZW5lcjtcbiAgfVxuXG4gIExpc3RlbmVyLnByb3RvdHlwZS5vZmY9IGZ1bmN0aW9uKCl7XG4gICAgdGhpcy5lbWl0dGVyLm9mZih0aGlzLmV2ZW50LCB0aGlzLmxpc3RlbmVyKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBmdW5jdGlvbiBzZXR1cExpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lciwgb3B0aW9ucyl7XG4gICAgICBpZiAob3B0aW9ucyA9PT0gdHJ1ZSkge1xuICAgICAgICBwcm9taXNpZnkgPSB0cnVlO1xuICAgICAgfSBlbHNlIGlmIChvcHRpb25zID09PSBmYWxzZSkge1xuICAgICAgICBhc3luYyA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIW9wdGlvbnMgfHwgdHlwZW9mIG9wdGlvbnMgIT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgdGhyb3cgVHlwZUVycm9yKCdvcHRpb25zIHNob3VsZCBiZSBhbiBvYmplY3Qgb3IgdHJ1ZScpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhc3luYyA9IG9wdGlvbnMuYXN5bmM7XG4gICAgICAgIHZhciBwcm9taXNpZnkgPSBvcHRpb25zLnByb21pc2lmeTtcbiAgICAgICAgdmFyIG5leHRUaWNrID0gb3B0aW9ucy5uZXh0VGljaztcbiAgICAgICAgdmFyIG9iamVjdGlmeSA9IG9wdGlvbnMub2JqZWN0aWZ5O1xuICAgICAgfVxuXG4gICAgICBpZiAoYXN5bmMgfHwgbmV4dFRpY2sgfHwgcHJvbWlzaWZ5KSB7XG4gICAgICAgIHZhciBfbGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgICAgICAgdmFyIF9vcmlnaW4gPSBsaXN0ZW5lci5fb3JpZ2luIHx8IGxpc3RlbmVyO1xuXG4gICAgICAgIGlmIChuZXh0VGljayAmJiAhbmV4dFRpY2tTdXBwb3J0ZWQpIHtcbiAgICAgICAgICB0aHJvdyBFcnJvcigncHJvY2Vzcy5uZXh0VGljayBpcyBub3Qgc3VwcG9ydGVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocHJvbWlzaWZ5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBwcm9taXNpZnkgPSBsaXN0ZW5lci5jb25zdHJ1Y3Rvci5uYW1lID09PSAnQXN5bmNGdW5jdGlvbic7XG4gICAgICAgIH1cblxuICAgICAgICBsaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXM7XG4gICAgICAgICAgdmFyIGV2ZW50ID0gdGhpcy5ldmVudDtcblxuICAgICAgICAgIHJldHVybiBwcm9taXNpZnkgPyAobmV4dFRpY2sgPyBQcm9taXNlLnJlc29sdmUoKSA6IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgICBfc2V0SW1tZWRpYXRlKHJlc29sdmUpO1xuICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29udGV4dC5ldmVudCA9IGV2ZW50O1xuICAgICAgICAgICAgcmV0dXJuIF9saXN0ZW5lci5hcHBseShjb250ZXh0LCBhcmdzKVxuICAgICAgICAgIH0pKSA6IChuZXh0VGljayA/IHByb2Nlc3MubmV4dFRpY2sgOiBfc2V0SW1tZWRpYXRlKShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb250ZXh0LmV2ZW50ID0gZXZlbnQ7XG4gICAgICAgICAgICBfbGlzdGVuZXIuYXBwbHkoY29udGV4dCwgYXJncylcbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBsaXN0ZW5lci5fYXN5bmMgPSB0cnVlO1xuICAgICAgICBsaXN0ZW5lci5fb3JpZ2luID0gX29yaWdpbjtcbiAgICAgIH1cblxuICAgIHJldHVybiBbbGlzdGVuZXIsIG9iamVjdGlmeT8gbmV3IExpc3RlbmVyKHRoaXMsIGV2ZW50LCBsaXN0ZW5lcik6IHRoaXNdO1xuICB9XG5cbiAgZnVuY3Rpb24gRXZlbnRFbWl0dGVyKGNvbmYpIHtcbiAgICB0aGlzLl9ldmVudHMgPSB7fTtcbiAgICB0aGlzLl9uZXdMaXN0ZW5lciA9IGZhbHNlO1xuICAgIHRoaXMuX3JlbW92ZUxpc3RlbmVyID0gZmFsc2U7XG4gICAgdGhpcy52ZXJib3NlTWVtb3J5TGVhayA9IGZhbHNlO1xuICAgIGNvbmZpZ3VyZS5jYWxsKHRoaXMsIGNvbmYpO1xuICB9XG5cbiAgRXZlbnRFbWl0dGVyLkV2ZW50RW1pdHRlcjIgPSBFdmVudEVtaXR0ZXI7IC8vIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IGZvciBleHBvcnRpbmcgRXZlbnRFbWl0dGVyIHByb3BlcnR5XG5cbiAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5Ubz0gZnVuY3Rpb24odGFyZ2V0LCBldmVudHMsIG9wdGlvbnMpe1xuICAgIGlmKHR5cGVvZiB0YXJnZXQhPT0nb2JqZWN0Jyl7XG4gICAgICB0aHJvdyBUeXBlRXJyb3IoJ3RhcmdldCBtdXN0cyBiZSBhbiBvYmplY3QnKTtcbiAgICB9XG5cbiAgICB2YXIgZW1pdHRlcj0gdGhpcztcblxuICAgIG9wdGlvbnMgPSByZXNvbHZlT3B0aW9ucyhvcHRpb25zLCB7XG4gICAgICBvbjogdW5kZWZpbmVkLFxuICAgICAgb2ZmOiB1bmRlZmluZWQsXG4gICAgICByZWR1Y2VyczogdW5kZWZpbmVkXG4gICAgfSwge1xuICAgICAgb246IGZ1bmN0aW9uUmVkdWNlcixcbiAgICAgIG9mZjogZnVuY3Rpb25SZWR1Y2VyLFxuICAgICAgcmVkdWNlcnM6IG9iamVjdEZ1bmN0aW9uUmVkdWNlclxuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gbGlzdGVuKGV2ZW50cyl7XG4gICAgICBpZih0eXBlb2YgZXZlbnRzIT09J29iamVjdCcpe1xuICAgICAgICB0aHJvdyBUeXBlRXJyb3IoJ2V2ZW50cyBtdXN0IGJlIGFuIG9iamVjdCcpO1xuICAgICAgfVxuXG4gICAgICB2YXIgcmVkdWNlcnM9IG9wdGlvbnMucmVkdWNlcnM7XG4gICAgICB2YXIgaW5kZXg9IGZpbmRUYXJnZXRJbmRleC5jYWxsKGVtaXR0ZXIsIHRhcmdldCk7XG4gICAgICB2YXIgb2JzZXJ2ZXI7XG5cbiAgICAgIGlmKGluZGV4PT09LTEpe1xuICAgICAgICBvYnNlcnZlcj0gbmV3IFRhcmdldE9ic2VydmVyKGVtaXR0ZXIsIHRhcmdldCwgb3B0aW9ucyk7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgb2JzZXJ2ZXI9IGVtaXR0ZXIuX29ic2VydmVyc1tpbmRleF07XG4gICAgICB9XG5cbiAgICAgIHZhciBrZXlzPSBvd25LZXlzKGV2ZW50cyk7XG4gICAgICB2YXIgbGVuPSBrZXlzLmxlbmd0aDtcbiAgICAgIHZhciBldmVudDtcbiAgICAgIHZhciBpc1NpbmdsZVJlZHVjZXI9IHR5cGVvZiByZWR1Y2Vycz09PSdmdW5jdGlvbic7XG5cbiAgICAgIGZvcih2YXIgaT0wOyBpPGxlbjsgaSsrKXtcbiAgICAgICAgZXZlbnQ9IGtleXNbaV07XG4gICAgICAgIG9ic2VydmVyLnN1YnNjcmliZShcbiAgICAgICAgICAgIGV2ZW50LFxuICAgICAgICAgICAgZXZlbnRzW2V2ZW50XSB8fCBldmVudCxcbiAgICAgICAgICAgIGlzU2luZ2xlUmVkdWNlciA/IHJlZHVjZXJzIDogcmVkdWNlcnMgJiYgcmVkdWNlcnNbZXZlbnRdXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaXNBcnJheShldmVudHMpP1xuICAgICAgICBsaXN0ZW4odG9PYmplY3QoZXZlbnRzKSkgOlxuICAgICAgICAodHlwZW9mIGV2ZW50cz09PSdzdHJpbmcnPyBsaXN0ZW4odG9PYmplY3QoZXZlbnRzLnNwbGl0KC9cXHMrLykpKTogbGlzdGVuKGV2ZW50cykpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5zdG9wTGlzdGVuaW5nVG8gPSBmdW5jdGlvbiAodGFyZ2V0LCBldmVudCkge1xuICAgIHZhciBvYnNlcnZlcnMgPSB0aGlzLl9vYnNlcnZlcnM7XG5cbiAgICBpZighb2JzZXJ2ZXJzKXtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgaSA9IG9ic2VydmVycy5sZW5ndGg7XG4gICAgdmFyIG9ic2VydmVyO1xuICAgIHZhciBtYXRjaGVkPSBmYWxzZTtcblxuICAgIGlmKHRhcmdldCAmJiB0eXBlb2YgdGFyZ2V0IT09J29iamVjdCcpe1xuICAgICAgdGhyb3cgVHlwZUVycm9yKCd0YXJnZXQgc2hvdWxkIGJlIGFuIG9iamVjdCcpO1xuICAgIH1cblxuICAgIHdoaWxlIChpLS0gPiAwKSB7XG4gICAgICBvYnNlcnZlciA9IG9ic2VydmVyc1tpXTtcbiAgICAgIGlmICghdGFyZ2V0IHx8IG9ic2VydmVyLl90YXJnZXQgPT09IHRhcmdldCkge1xuICAgICAgICBvYnNlcnZlci51bnN1YnNjcmliZShldmVudCk7XG4gICAgICAgIG1hdGNoZWQ9IHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG1hdGNoZWQ7XG4gIH07XG5cbiAgLy8gQnkgZGVmYXVsdCBFdmVudEVtaXR0ZXJzIHdpbGwgcHJpbnQgYSB3YXJuaW5nIGlmIG1vcmUgdGhhblxuICAvLyAxMCBsaXN0ZW5lcnMgYXJlIGFkZGVkIHRvIGl0LiBUaGlzIGlzIGEgdXNlZnVsIGRlZmF1bHQgd2hpY2hcbiAgLy8gaGVscHMgZmluZGluZyBtZW1vcnkgbGVha3MuXG4gIC8vXG4gIC8vIE9idmlvdXNseSBub3QgYWxsIEVtaXR0ZXJzIHNob3VsZCBiZSBsaW1pdGVkIHRvIDEwLiBUaGlzIGZ1bmN0aW9uIGFsbG93c1xuICAvLyB0aGF0IHRvIGJlIGluY3JlYXNlZC4gU2V0IHRvIHplcm8gZm9yIHVubGltaXRlZC5cblxuICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmRlbGltaXRlciA9ICcuJztcblxuICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLnNldE1heExpc3RlbmVycyA9IGZ1bmN0aW9uKG4pIHtcbiAgICBpZiAobiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSBuO1xuICAgICAgaWYgKCF0aGlzLl9jb25mKSB0aGlzLl9jb25mID0ge307XG4gICAgICB0aGlzLl9jb25mLm1heExpc3RlbmVycyA9IG47XG4gICAgfVxuICB9O1xuXG4gIEV2ZW50RW1pdHRlci5wcm90b3R5cGUuZ2V0TWF4TGlzdGVuZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuX21heExpc3RlbmVycztcbiAgfTtcblxuICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmV2ZW50ID0gJyc7XG5cbiAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbmNlID0gZnVuY3Rpb24oZXZlbnQsIGZuLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIHRoaXMuX29uY2UoZXZlbnQsIGZuLCBmYWxzZSwgb3B0aW9ucyk7XG4gIH07XG5cbiAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5wcmVwZW5kT25jZUxpc3RlbmVyID0gZnVuY3Rpb24oZXZlbnQsIGZuLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIHRoaXMuX29uY2UoZXZlbnQsIGZuLCB0cnVlLCBvcHRpb25zKTtcbiAgfTtcblxuICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLl9vbmNlID0gZnVuY3Rpb24oZXZlbnQsIGZuLCBwcmVwZW5kLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIHRoaXMuX21hbnkoZXZlbnQsIDEsIGZuLCBwcmVwZW5kLCBvcHRpb25zKTtcbiAgfTtcblxuICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLm1hbnkgPSBmdW5jdGlvbihldmVudCwgdHRsLCBmbiwgb3B0aW9ucykge1xuICAgIHJldHVybiB0aGlzLl9tYW55KGV2ZW50LCB0dGwsIGZuLCBmYWxzZSwgb3B0aW9ucyk7XG4gIH07XG5cbiAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5wcmVwZW5kTWFueSA9IGZ1bmN0aW9uKGV2ZW50LCB0dGwsIGZuLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIHRoaXMuX21hbnkoZXZlbnQsIHR0bCwgZm4sIHRydWUsIG9wdGlvbnMpO1xuICB9O1xuXG4gIEV2ZW50RW1pdHRlci5wcm90b3R5cGUuX21hbnkgPSBmdW5jdGlvbihldmVudCwgdHRsLCBmbiwgcHJlcGVuZCwgb3B0aW9ucykge1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIGlmICh0eXBlb2YgZm4gIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignbWFueSBvbmx5IGFjY2VwdHMgaW5zdGFuY2VzIG9mIEZ1bmN0aW9uJyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGlzdGVuZXIoKSB7XG4gICAgICBpZiAoLS10dGwgPT09IDApIHtcbiAgICAgICAgc2VsZi5vZmYoZXZlbnQsIGxpc3RlbmVyKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIGxpc3RlbmVyLl9vcmlnaW4gPSBmbjtcblxuICAgIHJldHVybiB0aGlzLl9vbihldmVudCwgbGlzdGVuZXIsIHByZXBlbmQsIG9wdGlvbnMpO1xuICB9O1xuXG4gIEV2ZW50RW1pdHRlci5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICghdGhpcy5fZXZlbnRzICYmICF0aGlzLl9hbGwpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB0aGlzLl9ldmVudHMgfHwgaW5pdC5jYWxsKHRoaXMpO1xuXG4gICAgdmFyIHR5cGUgPSBhcmd1bWVudHNbMF0sIG5zLCB3aWxkY2FyZD0gdGhpcy53aWxkY2FyZDtcbiAgICB2YXIgYXJncyxsLGksaiwgY29udGFpbnNTeW1ib2w7XG5cbiAgICBpZiAodHlwZSA9PT0gJ25ld0xpc3RlbmVyJyAmJiAhdGhpcy5fbmV3TGlzdGVuZXIpIHtcbiAgICAgIGlmICghdGhpcy5fZXZlbnRzLm5ld0xpc3RlbmVyKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAod2lsZGNhcmQpIHtcbiAgICAgIG5zPSB0eXBlO1xuICAgICAgaWYodHlwZSE9PSduZXdMaXN0ZW5lcicgJiYgdHlwZSE9PSdyZW1vdmVMaXN0ZW5lcicpe1xuICAgICAgICBpZiAodHlwZW9mIHR5cGUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgbCA9IHR5cGUubGVuZ3RoO1xuICAgICAgICAgIGlmIChzeW1ib2xzU3VwcG9ydGVkKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAgIGlmICh0eXBlb2YgdHlwZVtpXSA9PT0gJ3N5bWJvbCcpIHtcbiAgICAgICAgICAgICAgICBjb250YWluc1N5bWJvbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFjb250YWluc1N5bWJvbCkge1xuICAgICAgICAgICAgdHlwZSA9IHR5cGUuam9pbih0aGlzLmRlbGltaXRlcik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIGFsID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICB2YXIgaGFuZGxlcjtcblxuICAgIGlmICh0aGlzLl9hbGwgJiYgdGhpcy5fYWxsLmxlbmd0aCkge1xuICAgICAgaGFuZGxlciA9IHRoaXMuX2FsbC5zbGljZSgpO1xuXG4gICAgICBmb3IgKGkgPSAwLCBsID0gaGFuZGxlci5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgdGhpcy5ldmVudCA9IHR5cGU7XG4gICAgICAgIHN3aXRjaCAoYWwpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIGhhbmRsZXJbaV0uY2FsbCh0aGlzLCB0eXBlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIGhhbmRsZXJbaV0uY2FsbCh0aGlzLCB0eXBlLCBhcmd1bWVudHNbMV0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgaGFuZGxlcltpXS5jYWxsKHRoaXMsIHR5cGUsIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBoYW5kbGVyW2ldLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAod2lsZGNhcmQpIHtcbiAgICAgIGhhbmRsZXIgPSBbXTtcbiAgICAgIHNlYXJjaExpc3RlbmVyVHJlZS5jYWxsKHRoaXMsIGhhbmRsZXIsIG5zLCB0aGlzLmxpc3RlbmVyVHJlZSwgMCwgbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGhhbmRsZXIgPSB0aGlzLl9ldmVudHNbdHlwZV07XG4gICAgICBpZiAodHlwZW9mIGhhbmRsZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5ldmVudCA9IHR5cGU7XG4gICAgICAgIHN3aXRjaCAoYWwpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzLCBhcmd1bWVudHNbMV0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBhcmdzID0gbmV3IEFycmF5KGFsIC0gMSk7XG4gICAgICAgICAgZm9yIChqID0gMTsgaiA8IGFsOyBqKyspIGFyZ3NbaiAtIDFdID0gYXJndW1lbnRzW2pdO1xuICAgICAgICAgIGhhbmRsZXIuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGVsc2UgaWYgKGhhbmRsZXIpIHtcbiAgICAgICAgLy8gbmVlZCB0byBtYWtlIGNvcHkgb2YgaGFuZGxlcnMgYmVjYXVzZSBsaXN0IGNhbiBjaGFuZ2UgaW4gdGhlIG1pZGRsZVxuICAgICAgICAvLyBvZiBlbWl0IGNhbGxcbiAgICAgICAgaGFuZGxlciA9IGhhbmRsZXIuc2xpY2UoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoaGFuZGxlciAmJiBoYW5kbGVyLmxlbmd0aCkge1xuICAgICAgaWYgKGFsID4gMykge1xuICAgICAgICBhcmdzID0gbmV3IEFycmF5KGFsIC0gMSk7XG4gICAgICAgIGZvciAoaiA9IDE7IGogPCBhbDsgaisrKSBhcmdzW2ogLSAxXSA9IGFyZ3VtZW50c1tqXTtcbiAgICAgIH1cbiAgICAgIGZvciAoaSA9IDAsIGwgPSBoYW5kbGVyLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICB0aGlzLmV2ZW50ID0gdHlwZTtcbiAgICAgICAgc3dpdGNoIChhbCkge1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgaGFuZGxlcltpXS5jYWxsKHRoaXMpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgaGFuZGxlcltpXS5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICBoYW5kbGVyW2ldLmNhbGwodGhpcywgYXJndW1lbnRzWzFdLCBhcmd1bWVudHNbMl0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGhhbmRsZXJbaV0uYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSBpZiAoIXRoaXMuaWdub3JlRXJyb3JzICYmICF0aGlzLl9hbGwgJiYgdHlwZSA9PT0gJ2Vycm9yJykge1xuICAgICAgaWYgKGFyZ3VtZW50c1sxXSBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgIHRocm93IGFyZ3VtZW50c1sxXTsgLy8gVW5oYW5kbGVkICdlcnJvcicgZXZlbnRcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuY2F1Z2h0LCB1bnNwZWNpZmllZCAnZXJyb3InIGV2ZW50LlwiKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gISF0aGlzLl9hbGw7XG4gIH07XG5cbiAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5lbWl0QXN5bmMgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoIXRoaXMuX2V2ZW50cyAmJiAhdGhpcy5fYWxsKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdGhpcy5fZXZlbnRzIHx8IGluaXQuY2FsbCh0aGlzKTtcblxuICAgIHZhciB0eXBlID0gYXJndW1lbnRzWzBdLCB3aWxkY2FyZD0gdGhpcy53aWxkY2FyZCwgbnMsIGNvbnRhaW5zU3ltYm9sO1xuICAgIHZhciBhcmdzLGwsaSxqO1xuXG4gICAgaWYgKHR5cGUgPT09ICduZXdMaXN0ZW5lcicgJiYgIXRoaXMuX25ld0xpc3RlbmVyKSB7XG4gICAgICAgIGlmICghdGhpcy5fZXZlbnRzLm5ld0xpc3RlbmVyKSB7IHJldHVybiBQcm9taXNlLnJlc29sdmUoW2ZhbHNlXSk7IH1cbiAgICB9XG5cbiAgICBpZiAod2lsZGNhcmQpIHtcbiAgICAgIG5zPSB0eXBlO1xuICAgICAgaWYodHlwZSE9PSduZXdMaXN0ZW5lcicgJiYgdHlwZSE9PSdyZW1vdmVMaXN0ZW5lcicpe1xuICAgICAgICBpZiAodHlwZW9mIHR5cGUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgbCA9IHR5cGUubGVuZ3RoO1xuICAgICAgICAgIGlmIChzeW1ib2xzU3VwcG9ydGVkKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAgIGlmICh0eXBlb2YgdHlwZVtpXSA9PT0gJ3N5bWJvbCcpIHtcbiAgICAgICAgICAgICAgICBjb250YWluc1N5bWJvbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFjb250YWluc1N5bWJvbCkge1xuICAgICAgICAgICAgdHlwZSA9IHR5cGUuam9pbih0aGlzLmRlbGltaXRlcik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHByb21pc2VzPSBbXTtcblxuICAgIHZhciBhbCA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgdmFyIGhhbmRsZXI7XG5cbiAgICBpZiAodGhpcy5fYWxsKSB7XG4gICAgICBmb3IgKGkgPSAwLCBsID0gdGhpcy5fYWxsLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICB0aGlzLmV2ZW50ID0gdHlwZTtcbiAgICAgICAgc3dpdGNoIChhbCkge1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgcHJvbWlzZXMucHVzaCh0aGlzLl9hbGxbaV0uY2FsbCh0aGlzLCB0eXBlKSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICBwcm9taXNlcy5wdXNoKHRoaXMuX2FsbFtpXS5jYWxsKHRoaXMsIHR5cGUsIGFyZ3VtZW50c1sxXSkpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgcHJvbWlzZXMucHVzaCh0aGlzLl9hbGxbaV0uY2FsbCh0aGlzLCB0eXBlLCBhcmd1bWVudHNbMV0sIGFyZ3VtZW50c1syXSkpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHByb21pc2VzLnB1c2godGhpcy5fYWxsW2ldLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHdpbGRjYXJkKSB7XG4gICAgICBoYW5kbGVyID0gW107XG4gICAgICBzZWFyY2hMaXN0ZW5lclRyZWUuY2FsbCh0aGlzLCBoYW5kbGVyLCBucywgdGhpcy5saXN0ZW5lclRyZWUsIDApO1xuICAgIH0gZWxzZSB7XG4gICAgICBoYW5kbGVyID0gdGhpcy5fZXZlbnRzW3R5cGVdO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgaGFuZGxlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdGhpcy5ldmVudCA9IHR5cGU7XG4gICAgICBzd2l0Y2ggKGFsKSB7XG4gICAgICBjYXNlIDE6XG4gICAgICAgIHByb21pc2VzLnB1c2goaGFuZGxlci5jYWxsKHRoaXMpKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDI6XG4gICAgICAgIHByb21pc2VzLnB1c2goaGFuZGxlci5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSkpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMzpcbiAgICAgICAgcHJvbWlzZXMucHVzaChoYW5kbGVyLmNhbGwodGhpcywgYXJndW1lbnRzWzFdLCBhcmd1bWVudHNbMl0pKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBhcmdzID0gbmV3IEFycmF5KGFsIC0gMSk7XG4gICAgICAgIGZvciAoaiA9IDE7IGogPCBhbDsgaisrKSBhcmdzW2ogLSAxXSA9IGFyZ3VtZW50c1tqXTtcbiAgICAgICAgcHJvbWlzZXMucHVzaChoYW5kbGVyLmFwcGx5KHRoaXMsIGFyZ3MpKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGhhbmRsZXIgJiYgaGFuZGxlci5sZW5ndGgpIHtcbiAgICAgIGhhbmRsZXIgPSBoYW5kbGVyLnNsaWNlKCk7XG4gICAgICBpZiAoYWwgPiAzKSB7XG4gICAgICAgIGFyZ3MgPSBuZXcgQXJyYXkoYWwgLSAxKTtcbiAgICAgICAgZm9yIChqID0gMTsgaiA8IGFsOyBqKyspIGFyZ3NbaiAtIDFdID0gYXJndW1lbnRzW2pdO1xuICAgICAgfVxuICAgICAgZm9yIChpID0gMCwgbCA9IGhhbmRsZXIubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIHRoaXMuZXZlbnQgPSB0eXBlO1xuICAgICAgICBzd2l0Y2ggKGFsKSB7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICBwcm9taXNlcy5wdXNoKGhhbmRsZXJbaV0uY2FsbCh0aGlzKSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICBwcm9taXNlcy5wdXNoKGhhbmRsZXJbaV0uY2FsbCh0aGlzLCBhcmd1bWVudHNbMV0pKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgIHByb21pc2VzLnB1c2goaGFuZGxlcltpXS5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgcHJvbWlzZXMucHVzaChoYW5kbGVyW2ldLmFwcGx5KHRoaXMsIGFyZ3MpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoIXRoaXMuaWdub3JlRXJyb3JzICYmICF0aGlzLl9hbGwgJiYgdHlwZSA9PT0gJ2Vycm9yJykge1xuICAgICAgaWYgKGFyZ3VtZW50c1sxXSBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChhcmd1bWVudHNbMV0pOyAvLyBVbmhhbmRsZWQgJ2Vycm9yJyBldmVudFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KFwiVW5jYXVnaHQsIHVuc3BlY2lmaWVkICdlcnJvcicgZXZlbnQuXCIpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlcyk7XG4gIH07XG5cbiAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIHRoaXMuX29uKHR5cGUsIGxpc3RlbmVyLCBmYWxzZSwgb3B0aW9ucyk7XG4gIH07XG5cbiAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5wcmVwZW5kTGlzdGVuZXIgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucykge1xuICAgIHJldHVybiB0aGlzLl9vbih0eXBlLCBsaXN0ZW5lciwgdHJ1ZSwgb3B0aW9ucyk7XG4gIH07XG5cbiAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbkFueSA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgcmV0dXJuIHRoaXMuX29uQW55KGZuLCBmYWxzZSk7XG4gIH07XG5cbiAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5wcmVwZW5kQW55ID0gZnVuY3Rpb24oZm4pIHtcbiAgICByZXR1cm4gdGhpcy5fb25BbnkoZm4sIHRydWUpO1xuICB9O1xuXG4gIEV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXIgPSBFdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uO1xuXG4gIEV2ZW50RW1pdHRlci5wcm90b3R5cGUuX29uQW55ID0gZnVuY3Rpb24oZm4sIHByZXBlbmQpe1xuICAgIGlmICh0eXBlb2YgZm4gIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignb25Bbnkgb25seSBhY2NlcHRzIGluc3RhbmNlcyBvZiBGdW5jdGlvbicpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5fYWxsKSB7XG4gICAgICB0aGlzLl9hbGwgPSBbXTtcbiAgICB9XG5cbiAgICAvLyBBZGQgdGhlIGZ1bmN0aW9uIHRvIHRoZSBldmVudCBsaXN0ZW5lciBjb2xsZWN0aW9uLlxuICAgIGlmKHByZXBlbmQpe1xuICAgICAgdGhpcy5fYWxsLnVuc2hpZnQoZm4pO1xuICAgIH1lbHNle1xuICAgICAgdGhpcy5fYWxsLnB1c2goZm4pO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIEV2ZW50RW1pdHRlci5wcm90b3R5cGUuX29uID0gZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIsIHByZXBlbmQsIG9wdGlvbnMpIHtcbiAgICBpZiAodHlwZW9mIHR5cGUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRoaXMuX29uQW55KHR5cGUsIGxpc3RlbmVyKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignb24gb25seSBhY2NlcHRzIGluc3RhbmNlcyBvZiBGdW5jdGlvbicpO1xuICAgIH1cbiAgICB0aGlzLl9ldmVudHMgfHwgaW5pdC5jYWxsKHRoaXMpO1xuXG4gICAgdmFyIHJldHVyblZhbHVlPSB0aGlzLCB0ZW1wO1xuXG4gICAgaWYgKG9wdGlvbnMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGVtcCA9IHNldHVwTGlzdGVuZXIuY2FsbCh0aGlzLCB0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG4gICAgICBsaXN0ZW5lciA9IHRlbXBbMF07XG4gICAgICByZXR1cm5WYWx1ZSA9IHRlbXBbMV07XG4gICAgfVxuXG4gICAgLy8gVG8gYXZvaWQgcmVjdXJzaW9uIGluIHRoZSBjYXNlIHRoYXQgdHlwZSA9PSBcIm5ld0xpc3RlbmVyc1wiISBCZWZvcmVcbiAgICAvLyBhZGRpbmcgaXQgdG8gdGhlIGxpc3RlbmVycywgZmlyc3QgZW1pdCBcIm5ld0xpc3RlbmVyc1wiLlxuICAgIGlmICh0aGlzLl9uZXdMaXN0ZW5lcikge1xuICAgICAgdGhpcy5lbWl0KCduZXdMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy53aWxkY2FyZCkge1xuICAgICAgZ3Jvd0xpc3RlbmVyVHJlZS5jYWxsKHRoaXMsIHR5cGUsIGxpc3RlbmVyLCBwcmVwZW5kKTtcbiAgICAgIHJldHVybiByZXR1cm5WYWx1ZTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuX2V2ZW50c1t0eXBlXSkge1xuICAgICAgLy8gT3B0aW1pemUgdGhlIGNhc2Ugb2Ygb25lIGxpc3RlbmVyLiBEb24ndCBuZWVkIHRoZSBleHRyYSBhcnJheSBvYmplY3QuXG4gICAgICB0aGlzLl9ldmVudHNbdHlwZV0gPSBsaXN0ZW5lcjtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHR5cGVvZiB0aGlzLl9ldmVudHNbdHlwZV0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgLy8gQ2hhbmdlIHRvIGFycmF5LlxuICAgICAgICB0aGlzLl9ldmVudHNbdHlwZV0gPSBbdGhpcy5fZXZlbnRzW3R5cGVdXTtcbiAgICAgIH1cblxuICAgICAgLy8gSWYgd2UndmUgYWxyZWFkeSBnb3QgYW4gYXJyYXksIGp1c3QgYWRkXG4gICAgICBpZihwcmVwZW5kKXtcbiAgICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdLnVuc2hpZnQobGlzdGVuZXIpO1xuICAgICAgfWVsc2V7XG4gICAgICAgIHRoaXMuX2V2ZW50c1t0eXBlXS5wdXNoKGxpc3RlbmVyKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgZm9yIGxpc3RlbmVyIGxlYWtcbiAgICAgIGlmIChcbiAgICAgICAgIXRoaXMuX2V2ZW50c1t0eXBlXS53YXJuZWQgJiZcbiAgICAgICAgdGhpcy5fbWF4TGlzdGVuZXJzID4gMCAmJlxuICAgICAgICB0aGlzLl9ldmVudHNbdHlwZV0ubGVuZ3RoID4gdGhpcy5fbWF4TGlzdGVuZXJzXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdLndhcm5lZCA9IHRydWU7XG4gICAgICAgIGxvZ1Bvc3NpYmxlTWVtb3J5TGVhay5jYWxsKHRoaXMsIHRoaXMuX2V2ZW50c1t0eXBlXS5sZW5ndGgsIHR5cGUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZXR1cm5WYWx1ZTtcbiAgfTtcblxuICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgaWYgKHR5cGVvZiBsaXN0ZW5lciAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdyZW1vdmVMaXN0ZW5lciBvbmx5IHRha2VzIGluc3RhbmNlcyBvZiBGdW5jdGlvbicpO1xuICAgIH1cblxuICAgIHZhciBoYW5kbGVycyxsZWFmcz1bXTtcblxuICAgIGlmKHRoaXMud2lsZGNhcmQpIHtcbiAgICAgIHZhciBucyA9IHR5cGVvZiB0eXBlID09PSAnc3RyaW5nJyA/IHR5cGUuc3BsaXQodGhpcy5kZWxpbWl0ZXIpIDogdHlwZS5zbGljZSgpO1xuICAgICAgbGVhZnMgPSBzZWFyY2hMaXN0ZW5lclRyZWUuY2FsbCh0aGlzLCBudWxsLCBucywgdGhpcy5saXN0ZW5lclRyZWUsIDApO1xuICAgICAgaWYoIWxlYWZzKSByZXR1cm4gdGhpcztcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gZG9lcyBub3QgdXNlIGxpc3RlbmVycygpLCBzbyBubyBzaWRlIGVmZmVjdCBvZiBjcmVhdGluZyBfZXZlbnRzW3R5cGVdXG4gICAgICBpZiAoIXRoaXMuX2V2ZW50c1t0eXBlXSkgcmV0dXJuIHRoaXM7XG4gICAgICBoYW5kbGVycyA9IHRoaXMuX2V2ZW50c1t0eXBlXTtcbiAgICAgIGxlYWZzLnB1c2goe19saXN0ZW5lcnM6aGFuZGxlcnN9KTtcbiAgICB9XG5cbiAgICBmb3IgKHZhciBpTGVhZj0wOyBpTGVhZjxsZWFmcy5sZW5ndGg7IGlMZWFmKyspIHtcbiAgICAgIHZhciBsZWFmID0gbGVhZnNbaUxlYWZdO1xuICAgICAgaGFuZGxlcnMgPSBsZWFmLl9saXN0ZW5lcnM7XG4gICAgICBpZiAoaXNBcnJheShoYW5kbGVycykpIHtcblxuICAgICAgICB2YXIgcG9zaXRpb24gPSAtMTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gaGFuZGxlcnMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAoaGFuZGxlcnNbaV0gPT09IGxpc3RlbmVyIHx8XG4gICAgICAgICAgICAoaGFuZGxlcnNbaV0ubGlzdGVuZXIgJiYgaGFuZGxlcnNbaV0ubGlzdGVuZXIgPT09IGxpc3RlbmVyKSB8fFxuICAgICAgICAgICAgKGhhbmRsZXJzW2ldLl9vcmlnaW4gJiYgaGFuZGxlcnNbaV0uX29yaWdpbiA9PT0gbGlzdGVuZXIpKSB7XG4gICAgICAgICAgICBwb3NpdGlvbiA9IGk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocG9zaXRpb24gPCAwKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZih0aGlzLndpbGRjYXJkKSB7XG4gICAgICAgICAgbGVhZi5fbGlzdGVuZXJzLnNwbGljZShwb3NpdGlvbiwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdLnNwbGljZShwb3NpdGlvbiwgMSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaGFuZGxlcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgaWYodGhpcy53aWxkY2FyZCkge1xuICAgICAgICAgICAgZGVsZXRlIGxlYWYuX2xpc3RlbmVycztcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fcmVtb3ZlTGlzdGVuZXIpXG4gICAgICAgICAgdGhpcy5lbWl0KFwicmVtb3ZlTGlzdGVuZXJcIiwgdHlwZSwgbGlzdGVuZXIpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAoaGFuZGxlcnMgPT09IGxpc3RlbmVyIHx8XG4gICAgICAgIChoYW5kbGVycy5saXN0ZW5lciAmJiBoYW5kbGVycy5saXN0ZW5lciA9PT0gbGlzdGVuZXIpIHx8XG4gICAgICAgIChoYW5kbGVycy5fb3JpZ2luICYmIGhhbmRsZXJzLl9vcmlnaW4gPT09IGxpc3RlbmVyKSkge1xuICAgICAgICBpZih0aGlzLndpbGRjYXJkKSB7XG4gICAgICAgICAgZGVsZXRlIGxlYWYuX2xpc3RlbmVycztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9yZW1vdmVMaXN0ZW5lcilcbiAgICAgICAgICB0aGlzLmVtaXQoXCJyZW1vdmVMaXN0ZW5lclwiLCB0eXBlLCBsaXN0ZW5lcik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5saXN0ZW5lclRyZWUgJiYgcmVjdXJzaXZlbHlHYXJiYWdlQ29sbGVjdCh0aGlzLmxpc3RlbmVyVHJlZSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLm9mZkFueSA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgdmFyIGkgPSAwLCBsID0gMCwgZm5zO1xuICAgIGlmIChmbiAmJiB0aGlzLl9hbGwgJiYgdGhpcy5fYWxsLmxlbmd0aCA+IDApIHtcbiAgICAgIGZucyA9IHRoaXMuX2FsbDtcbiAgICAgIGZvcihpID0gMCwgbCA9IGZucy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYoZm4gPT09IGZuc1tpXSkge1xuICAgICAgICAgIGZucy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgaWYgKHRoaXMuX3JlbW92ZUxpc3RlbmVyKVxuICAgICAgICAgICAgdGhpcy5lbWl0KFwicmVtb3ZlTGlzdGVuZXJBbnlcIiwgZm4pO1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGZucyA9IHRoaXMuX2FsbDtcbiAgICAgIGlmICh0aGlzLl9yZW1vdmVMaXN0ZW5lcikge1xuICAgICAgICBmb3IoaSA9IDAsIGwgPSBmbnMubGVuZ3RoOyBpIDwgbDsgaSsrKVxuICAgICAgICAgIHRoaXMuZW1pdChcInJlbW92ZUxpc3RlbmVyQW55XCIsIGZuc1tpXSk7XG4gICAgICB9XG4gICAgICB0aGlzLl9hbGwgPSBbXTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lciA9IEV2ZW50RW1pdHRlci5wcm90b3R5cGUub2ZmO1xuXG4gIEV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzID0gZnVuY3Rpb24gKHR5cGUpIHtcbiAgICBpZiAodHlwZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAhdGhpcy5fZXZlbnRzIHx8IGluaXQuY2FsbCh0aGlzKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGlmICh0aGlzLndpbGRjYXJkKSB7XG4gICAgICB2YXIgbGVhZnMgPSBzZWFyY2hMaXN0ZW5lclRyZWUuY2FsbCh0aGlzLCBudWxsLCB0eXBlLCB0aGlzLmxpc3RlbmVyVHJlZSwgMCksIGxlYWYsIGk7XG4gICAgICBpZiAoIWxlYWZzKSByZXR1cm4gdGhpcztcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBsZWFmcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBsZWFmID0gbGVhZnNbaV07XG4gICAgICAgIGxlYWYuX2xpc3RlbmVycyA9IG51bGw7XG4gICAgICB9XG4gICAgICB0aGlzLmxpc3RlbmVyVHJlZSAmJiByZWN1cnNpdmVseUdhcmJhZ2VDb2xsZWN0KHRoaXMubGlzdGVuZXJUcmVlKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuX2V2ZW50cykge1xuICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdID0gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lcnMgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgIHZhciBfZXZlbnRzID0gdGhpcy5fZXZlbnRzO1xuICAgIHZhciBrZXlzLCBsaXN0ZW5lcnMsIGFsbExpc3RlbmVycztcbiAgICB2YXIgaTtcbiAgICB2YXIgbGlzdGVuZXJUcmVlO1xuXG4gICAgaWYgKHR5cGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgaWYgKHRoaXMud2lsZGNhcmQpIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoJ2V2ZW50IG5hbWUgcmVxdWlyZWQgZm9yIHdpbGRjYXJkIGVtaXR0ZXInKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFfZXZlbnRzKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cblxuICAgICAga2V5cyA9IG93bktleXMoX2V2ZW50cyk7XG4gICAgICBpID0ga2V5cy5sZW5ndGg7XG4gICAgICBhbGxMaXN0ZW5lcnMgPSBbXTtcbiAgICAgIHdoaWxlIChpLS0gPiAwKSB7XG4gICAgICAgIGxpc3RlbmVycyA9IF9ldmVudHNba2V5c1tpXV07XG4gICAgICAgIGlmICh0eXBlb2YgbGlzdGVuZXJzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgYWxsTGlzdGVuZXJzLnB1c2gobGlzdGVuZXJzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhbGxMaXN0ZW5lcnMucHVzaC5hcHBseShhbGxMaXN0ZW5lcnMsIGxpc3RlbmVycyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBhbGxMaXN0ZW5lcnM7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh0aGlzLndpbGRjYXJkKSB7XG4gICAgICAgIGxpc3RlbmVyVHJlZT0gdGhpcy5saXN0ZW5lclRyZWU7XG4gICAgICAgIGlmKCFsaXN0ZW5lclRyZWUpIHJldHVybiBbXTtcbiAgICAgICAgdmFyIGhhbmRsZXJzID0gW107XG4gICAgICAgIHZhciBucyA9IHR5cGVvZiB0eXBlID09PSAnc3RyaW5nJyA/IHR5cGUuc3BsaXQodGhpcy5kZWxpbWl0ZXIpIDogdHlwZS5zbGljZSgpO1xuICAgICAgICBzZWFyY2hMaXN0ZW5lclRyZWUuY2FsbCh0aGlzLCBoYW5kbGVycywgbnMsIGxpc3RlbmVyVHJlZSwgMCk7XG4gICAgICAgIHJldHVybiBoYW5kbGVycztcbiAgICAgIH1cblxuICAgICAgaWYgKCFfZXZlbnRzKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cblxuICAgICAgbGlzdGVuZXJzID0gX2V2ZW50c1t0eXBlXTtcblxuICAgICAgaWYgKCFsaXN0ZW5lcnMpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHR5cGVvZiBsaXN0ZW5lcnMgPT09ICdmdW5jdGlvbicgPyBbbGlzdGVuZXJzXSA6IGxpc3RlbmVycztcbiAgICB9XG4gIH07XG5cbiAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5ldmVudE5hbWVzID0gZnVuY3Rpb24obnNBc0FycmF5KXtcbiAgICB2YXIgX2V2ZW50cz0gdGhpcy5fZXZlbnRzO1xuICAgIHJldHVybiB0aGlzLndpbGRjYXJkPyBjb2xsZWN0VHJlZUV2ZW50cy5jYWxsKHRoaXMsIHRoaXMubGlzdGVuZXJUcmVlLCBbXSwgbnVsbCwgbnNBc0FycmF5KSA6IChfZXZlbnRzPyBvd25LZXlzKF9ldmVudHMpIDogW10pO1xuICB9O1xuXG4gIEV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJDb3VudCA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgICByZXR1cm4gdGhpcy5saXN0ZW5lcnModHlwZSkubGVuZ3RoO1xuICB9O1xuXG4gIEV2ZW50RW1pdHRlci5wcm90b3R5cGUuaGFzTGlzdGVuZXJzID0gZnVuY3Rpb24gKHR5cGUpIHtcbiAgICBpZiAodGhpcy53aWxkY2FyZCkge1xuICAgICAgdmFyIGhhbmRsZXJzID0gW107XG4gICAgICB2YXIgbnMgPSB0eXBlb2YgdHlwZSA9PT0gJ3N0cmluZycgPyB0eXBlLnNwbGl0KHRoaXMuZGVsaW1pdGVyKSA6IHR5cGUuc2xpY2UoKTtcbiAgICAgIHNlYXJjaExpc3RlbmVyVHJlZS5jYWxsKHRoaXMsIGhhbmRsZXJzLCBucywgdGhpcy5saXN0ZW5lclRyZWUsIDApO1xuICAgICAgcmV0dXJuIGhhbmRsZXJzLmxlbmd0aCA+IDA7XG4gICAgfVxuXG4gICAgdmFyIF9ldmVudHMgPSB0aGlzLl9ldmVudHM7XG4gICAgdmFyIF9hbGwgPSB0aGlzLl9hbGw7XG5cbiAgICByZXR1cm4gISEoX2FsbCAmJiBfYWxsLmxlbmd0aCB8fCBfZXZlbnRzICYmICh0eXBlID09PSB1bmRlZmluZWQgPyBvd25LZXlzKF9ldmVudHMpLmxlbmd0aCA6IF9ldmVudHNbdHlwZV0pKTtcbiAgfTtcblxuICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVyc0FueSA9IGZ1bmN0aW9uKCkge1xuXG4gICAgaWYodGhpcy5fYWxsKSB7XG4gICAgICByZXR1cm4gdGhpcy5fYWxsO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgfTtcblxuICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLndhaXRGb3IgPSBmdW5jdGlvbiAoZXZlbnQsIG9wdGlvbnMpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHR5cGUgPSB0eXBlb2Ygb3B0aW9ucztcbiAgICBpZiAodHlwZSA9PT0gJ251bWJlcicpIHtcbiAgICAgIG9wdGlvbnMgPSB7dGltZW91dDogb3B0aW9uc307XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBvcHRpb25zID0ge2ZpbHRlcjogb3B0aW9uc307XG4gICAgfVxuXG4gICAgb3B0aW9ucz0gcmVzb2x2ZU9wdGlvbnMob3B0aW9ucywge1xuICAgICAgdGltZW91dDogMCxcbiAgICAgIGZpbHRlcjogdW5kZWZpbmVkLFxuICAgICAgaGFuZGxlRXJyb3I6IGZhbHNlLFxuICAgICAgUHJvbWlzZTogUHJvbWlzZSxcbiAgICAgIG92ZXJsb2FkOiBmYWxzZVxuICAgIH0sIHtcbiAgICAgIGZpbHRlcjogZnVuY3Rpb25SZWR1Y2VyLFxuICAgICAgUHJvbWlzZTogY29uc3RydWN0b3JSZWR1Y2VyXG4gICAgfSk7XG5cbiAgICByZXR1cm4gbWFrZUNhbmNlbGFibGVQcm9taXNlKG9wdGlvbnMuUHJvbWlzZSwgZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCwgb25DYW5jZWwpIHtcbiAgICAgIGZ1bmN0aW9uIGxpc3RlbmVyKCkge1xuICAgICAgICB2YXIgZmlsdGVyPSBvcHRpb25zLmZpbHRlcjtcbiAgICAgICAgaWYgKGZpbHRlciAmJiAhZmlsdGVyLmFwcGx5KHNlbGYsIGFyZ3VtZW50cykpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5vZmYoZXZlbnQsIGxpc3RlbmVyKTtcbiAgICAgICAgaWYgKG9wdGlvbnMuaGFuZGxlRXJyb3IpIHtcbiAgICAgICAgICB2YXIgZXJyID0gYXJndW1lbnRzWzBdO1xuICAgICAgICAgIGVyciA/IHJlamVjdChlcnIpIDogcmVzb2x2ZSh0b0FycmF5LmFwcGx5KG51bGwsIGFyZ3VtZW50cykuc2xpY2UoMSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc29sdmUodG9BcnJheS5hcHBseShudWxsLCBhcmd1bWVudHMpKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBvbkNhbmNlbChmdW5jdGlvbigpe1xuICAgICAgICBzZWxmLm9mZihldmVudCwgbGlzdGVuZXIpO1xuICAgICAgfSk7XG5cbiAgICAgIHNlbGYuX29uKGV2ZW50LCBsaXN0ZW5lciwgZmFsc2UpO1xuICAgIH0sIHtcbiAgICAgIHRpbWVvdXQ6IG9wdGlvbnMudGltZW91dCxcbiAgICAgIG92ZXJsb2FkOiBvcHRpb25zLm92ZXJsb2FkXG4gICAgfSlcbiAgfTtcblxuICBmdW5jdGlvbiBvbmNlKGVtaXR0ZXIsIG5hbWUsIG9wdGlvbnMpIHtcbiAgICBvcHRpb25zPSByZXNvbHZlT3B0aW9ucyhvcHRpb25zLCB7XG4gICAgICBQcm9taXNlOiBQcm9taXNlLFxuICAgICAgdGltZW91dDogMCxcbiAgICAgIG92ZXJsb2FkOiBmYWxzZVxuICAgIH0sIHtcbiAgICAgIFByb21pc2U6IGNvbnN0cnVjdG9yUmVkdWNlclxuICAgIH0pO1xuXG4gICAgdmFyIF9Qcm9taXNlPSBvcHRpb25zLlByb21pc2U7XG5cbiAgICByZXR1cm4gbWFrZUNhbmNlbGFibGVQcm9taXNlKF9Qcm9taXNlLCBmdW5jdGlvbihyZXNvbHZlLCByZWplY3QsIG9uQ2FuY2VsKXtcbiAgICAgIHZhciBoYW5kbGVyO1xuICAgICAgaWYgKHR5cGVvZiBlbWl0dGVyLmFkZEV2ZW50TGlzdGVuZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgaGFuZGxlcj0gIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXNvbHZlKHRvQXJyYXkuYXBwbHkobnVsbCwgYXJndW1lbnRzKSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgb25DYW5jZWwoZnVuY3Rpb24oKXtcbiAgICAgICAgICBlbWl0dGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIobmFtZSwgaGFuZGxlcik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGVtaXR0ZXIuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICBoYW5kbGVyLFxuICAgICAgICAgICAge29uY2U6IHRydWV9XG4gICAgICAgICk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIGV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbigpe1xuICAgICAgICBlcnJvckxpc3RlbmVyICYmIGVtaXR0ZXIucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgZXJyb3JMaXN0ZW5lcik7XG4gICAgICAgIHJlc29sdmUodG9BcnJheS5hcHBseShudWxsLCBhcmd1bWVudHMpKTtcbiAgICAgIH07XG5cbiAgICAgIHZhciBlcnJvckxpc3RlbmVyO1xuXG4gICAgICBpZiAobmFtZSAhPT0gJ2Vycm9yJykge1xuICAgICAgICBlcnJvckxpc3RlbmVyID0gZnVuY3Rpb24gKGVycil7XG4gICAgICAgICAgZW1pdHRlci5yZW1vdmVMaXN0ZW5lcihuYW1lLCBldmVudExpc3RlbmVyKTtcbiAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfTtcblxuICAgICAgICBlbWl0dGVyLm9uY2UoJ2Vycm9yJywgZXJyb3JMaXN0ZW5lcik7XG4gICAgICB9XG5cbiAgICAgIG9uQ2FuY2VsKGZ1bmN0aW9uKCl7XG4gICAgICAgIGVycm9yTGlzdGVuZXIgJiYgZW1pdHRlci5yZW1vdmVMaXN0ZW5lcignZXJyb3InLCBlcnJvckxpc3RlbmVyKTtcbiAgICAgICAgZW1pdHRlci5yZW1vdmVMaXN0ZW5lcihuYW1lLCBldmVudExpc3RlbmVyKTtcbiAgICAgIH0pO1xuXG4gICAgICBlbWl0dGVyLm9uY2UobmFtZSwgZXZlbnRMaXN0ZW5lcik7XG4gICAgfSwge1xuICAgICAgdGltZW91dDogb3B0aW9ucy50aW1lb3V0LFxuICAgICAgb3ZlcmxvYWQ6IG9wdGlvbnMub3ZlcmxvYWRcbiAgICB9KTtcbiAgfVxuXG4gIHZhciBwcm90b3R5cGU9IEV2ZW50RW1pdHRlci5wcm90b3R5cGU7XG5cbiAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoRXZlbnRFbWl0dGVyLCB7XG4gICAgZGVmYXVsdE1heExpc3RlbmVyczoge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBwcm90b3R5cGUuX21heExpc3RlbmVycztcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uIChuKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbiAhPT0gJ251bWJlcicgfHwgbiA8IDAgfHwgTnVtYmVyLmlzTmFOKG4pKSB7XG4gICAgICAgICAgdGhyb3cgVHlwZUVycm9yKCduIG11c3QgYmUgYSBub24tbmVnYXRpdmUgbnVtYmVyJylcbiAgICAgICAgfVxuICAgICAgICBwcm90b3R5cGUuX21heExpc3RlbmVycyA9IG47XG4gICAgICB9LFxuICAgICAgZW51bWVyYWJsZTogdHJ1ZVxuICAgIH0sXG4gICAgb25jZToge1xuICAgICAgdmFsdWU6IG9uY2UsXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH1cbiAgfSk7XG5cbiAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMocHJvdG90eXBlLCB7XG4gICAgICBfbWF4TGlzdGVuZXJzOiB7XG4gICAgICAgICAgdmFsdWU6IGRlZmF1bHRNYXhMaXN0ZW5lcnMsXG4gICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9LFxuICAgICAgX29ic2VydmVyczoge3ZhbHVlOiBudWxsLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlfVxuICB9KTtcblxuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cbiAgICBkZWZpbmUoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gRXZlbnRFbWl0dGVyO1xuICAgIH0pO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuICAgIC8vIENvbW1vbkpTXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBFdmVudEVtaXR0ZXI7XG4gIH1cbiAgZWxzZSB7XG4gICAgLy8gZ2xvYmFsIGZvciBhbnkga2luZCBvZiBlbnZpcm9ubWVudC5cbiAgICB2YXIgX2dsb2JhbD0gbmV3IEZ1bmN0aW9uKCcnLCdyZXR1cm4gdGhpcycpKCk7XG4gICAgX2dsb2JhbC5FdmVudEVtaXR0ZXIyID0gRXZlbnRFbWl0dGVyO1xuICB9XG59KCk7XG4iLCIvLyBzcmMvaW5kZXgudHNcbmltcG9ydCB7IGRlZmF1bHQgYXMgZGVmYXVsdDIgfSBmcm9tIFwiQGdhcmZpc2gvY29yZVwiO1xuXG4vLyBzcmMvaW5zdGFuY2UudHNcbmltcG9ydCBHYXJmaXNoIGZyb20gXCJAZ2FyZmlzaC9jb3JlXCI7XG5pbXBvcnQgeyBHYXJmaXNoUm91dGVyIH0gZnJvbSBcIkBnYXJmaXNoL3JvdXRlclwiO1xuaW1wb3J0IHsgR2FyZmlzaEJyb3dzZXJWbSB9IGZyb20gXCJAZ2FyZmlzaC9icm93c2VyLXZtXCI7XG5pbXBvcnQgeyBHYXJmaXNoQnJvd3NlclNuYXBzaG90IH0gZnJvbSBcIkBnYXJmaXNoL2Jyb3dzZXItc25hcHNob3RcIjtcbmltcG9ydCB7IGRlZiwgd2FybiwgaGFzT3duLCBpbkJyb3dzZXIsIF9fR0FSRklTSF9GTEFHX18gfSBmcm9tIFwiQGdhcmZpc2gvdXRpbHNcIjtcbmZ1bmN0aW9uIGNyZWF0ZUNvbnRleHQoKSB7XG4gIGxldCBmcmVzaCA9IGZhbHNlO1xuICBpZiAoaW5Ccm93c2VyKCkgJiYgd2luZG93W1wiX19HQVJGSVNIX19cIl0gJiYgd2luZG93W1wiR2FyZmlzaFwiXSkge1xuICAgIHJldHVybiB3aW5kb3dbXCJHYXJmaXNoXCJdO1xuICB9XG4gIGNvbnN0IEdhcmZpc2hJbnN0YW5jZTIgPSBuZXcgR2FyZmlzaCh7XG4gICAgcGx1Z2luczogW0dhcmZpc2hSb3V0ZXIoKSwgR2FyZmlzaEJyb3dzZXJWbSgpLCBHYXJmaXNoQnJvd3NlclNuYXBzaG90KCldXG4gIH0pO1xuICBjb25zdCBzZXQgPSAobmFtZXNwYWNlLCB2YWwgPSBHYXJmaXNoSW5zdGFuY2UyKSA9PiB7XG4gICAgaWYgKGhhc093bih3aW5kb3csIG5hbWVzcGFjZSkpIHtcbiAgICAgIGlmICghKHdpbmRvd1tuYW1lc3BhY2VdICYmIHdpbmRvd1tuYW1lc3BhY2VdLmZsYWcgPT09IF9fR0FSRklTSF9GTEFHX18pKSB7XG4gICAgICAgIGNvbnN0IG5leHQgPSAoKSA9PiB7XG4gICAgICAgICAgZnJlc2ggPSB0cnVlO1xuICAgICAgICAgIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudiAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViA/IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA6IGZhbHNlKSB7XG4gICAgICAgICAgICB3YXJuKGBcIldpbmRvdy4ke25hbWVzcGFjZX1cIiB3aWxsIGJlIG92ZXJ3cml0dGVuIGJ5IFwiZ2FyZmlzaFwiLmApO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iod2luZG93LCBuYW1lc3BhY2UpO1xuICAgICAgICBpZiAoZGVzYykge1xuICAgICAgICAgIGlmIChkZXNjLmNvbmZpZ3VyYWJsZSkge1xuICAgICAgICAgICAgZGVmKHdpbmRvdywgbmFtZXNwYWNlLCB2YWwpO1xuICAgICAgICAgICAgbmV4dCgpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZGVzYy53cml0YWJsZSkge1xuICAgICAgICAgICAgd2luZG93W25hbWVzcGFjZV0gPSB2YWw7XG4gICAgICAgICAgICBuZXh0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGZyZXNoID0gdHJ1ZTtcbiAgICAgIGRlZih3aW5kb3csIG5hbWVzcGFjZSwgdmFsKTtcbiAgICB9XG4gIH07XG4gIGlmIChpbkJyb3dzZXIoKSkge1xuICAgIHNldChcIkdhcmZpc2hcIik7XG4gICAgZGVmKHdpbmRvdywgXCJfX0dBUkZJU0hfX1wiLCB0cnVlKTtcbiAgfVxuICBpZiAoZnJlc2gpIHtcbiAgICBpZiAodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPyBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgOiBmYWxzZSkge1xuICAgICAgaWYgKHdpbmRvd1tcIkdhcmZpc2hcIl0udmVyc2lvbiAhPT0gXCIxLjE2LjJcIikge1xuICAgICAgICB3YXJuKCdUaGUgXCJnYXJmaXNoIHZlcnNpb25cIiB1c2VkIGJ5IHRoZSBtYWluIGFuZCBzdWItYXBwbGljYXRpb25zIGlzIGluY29uc2lzdGVudC4nKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIEdhcmZpc2hJbnN0YW5jZTI7XG59XG52YXIgR2FyZmlzaEluc3RhbmNlID0gY3JlYXRlQ29udGV4dCgpO1xuXG4vLyBzcmMvY3VzdG9tRWxlbWVudC50c1xuZnVuY3Rpb24gZ2VuZXJhdGVDdXN0b21lckVsZW1lbnQoaHRtbFRhZywgb3B0aW9ucykge1xuICBjbGFzcyBNaWNyb0FwcCBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgIHN1cGVyKCk7XG4gICAgICB0aGlzLmFwcEluZm8gPSB7XG4gICAgICAgIG5hbWU6IFwiXCIsXG4gICAgICAgIGVudHJ5OiBcIlwiLFxuICAgICAgICBiYXNlbmFtZTogXCJcIlxuICAgICAgfTtcbiAgICAgIHRoaXMub3B0aW9ucyA9IHtcbiAgICAgICAgZGVsYXk6IDIwMFxuICAgICAgfTtcbiAgICAgIHRoaXMuc3RhdGUgPSB0aGlzLl9vYnNlcnZlckFwcFN0YXRlKHtcbiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgIHByb21pc2U6IG51bGwsXG4gICAgICAgIGxvYWRlZDogbnVsbCxcbiAgICAgICAgcGFzdERlbGF5OiBmYWxzZVxuICAgICAgfSk7XG4gICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgIH1cbiAgICBfb2JzZXJ2ZXJBcHBTdGF0ZShzdGF0ZSkge1xuICAgICAgcmV0dXJuIG5ldyBQcm94eShzdGF0ZSwge1xuICAgICAgICBzZXQ6ICh0YXJnZXQsIHAsIHZhbHVlLCByZWNlaXZlcikgPT4ge1xuICAgICAgICAgIGNvbnN0IGdldFBsYWNlSG9sZGVyQW5kQXBwZW5kID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMucGxhY2Vob2xkZXIgJiYgdGhpcy5jb250YWlucyh0aGlzLnBsYWNlaG9sZGVyKSkge1xuICAgICAgICAgICAgICB0aGlzLnJlbW92ZUNoaWxkKHRoaXMucGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcGxhY2Vob2xkZXIgPSB0aGlzLm9wdGlvbnMubG9hZGluZyAmJiB0aGlzLm9wdGlvbnMubG9hZGluZyh7XG4gICAgICAgICAgICAgIGlzTG9hZGluZzogdGhpcy5zdGF0ZS5pc0xvYWRpbmcsXG4gICAgICAgICAgICAgIGVycm9yOiB0aGlzLnN0YXRlLmVycm9yLFxuICAgICAgICAgICAgICBwYXN0RGVsYXk6IHRoaXMuc3RhdGUucGFzdERlbGF5XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyICYmIHRoaXMuYXBwZW5kQ2hpbGQocGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgcmV0dXJuIHBsYWNlaG9sZGVyO1xuICAgICAgICAgIH07XG4gICAgICAgICAgY29uc3QgcmVzID0gUmVmbGVjdC5zZXQodGFyZ2V0LCBwLCB2YWx1ZSwgcmVjZWl2ZXIpO1xuICAgICAgICAgIGlmIChwID09PSBcImVycm9yXCIgJiYgdmFsdWUpIHtcbiAgICAgICAgICAgIGNvbnN0IHBsYWNlaG9sZGVyID0gZ2V0UGxhY2VIb2xkZXJBbmRBcHBlbmQoKTtcbiAgICAgICAgICAgIGlmIChwbGFjZWhvbGRlcilcbiAgICAgICAgICAgICAgdGhpcy5wbGFjZWhvbGRlciA9IHBsYWNlaG9sZGVyO1xuICAgICAgICAgIH0gZWxzZSBpZiAocCA9PT0gXCJwYXN0RGVsYXlcIiAmJiB2YWx1ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgY29uc3QgcGxhY2Vob2xkZXIgPSBnZXRQbGFjZUhvbGRlckFuZEFwcGVuZCgpO1xuICAgICAgICAgICAgaWYgKHBsYWNlaG9sZGVyKVxuICAgICAgICAgICAgICB0aGlzLnBsYWNlaG9sZGVyID0gcGxhY2Vob2xkZXI7XG4gICAgICAgICAgfSBlbHNlIGlmIChwID09PSBcImlzTG9hZGluZ1wiICYmIHZhbHVlID09PSB0cnVlKSB7XG4gICAgICAgICAgICBjb25zdCBwbGFjZWhvbGRlciA9IGdldFBsYWNlSG9sZGVyQW5kQXBwZW5kKCk7XG4gICAgICAgICAgICBpZiAocGxhY2Vob2xkZXIpXG4gICAgICAgICAgICAgIHRoaXMucGxhY2Vob2xkZXIgPSBwbGFjZWhvbGRlcjtcbiAgICAgICAgICB9IGVsc2UgaWYgKHAgPT09IFwiaXNMb2FkaW5nXCIgJiYgdmFsdWUgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuc3RhdGUuZXJyb3IgJiYgdGhpcy5jb250YWlucyh0aGlzLnBsYWNlaG9sZGVyKSkge1xuICAgICAgICAgICAgICB0aGlzLnJlbW92ZUNoaWxkKHRoaXMucGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgX2xvYWRBcHAoKSB7XG4gICAgICBpZiAodGhpcy5zdGF0ZS5pc0xvYWRpbmcpXG4gICAgICAgIHJldHVybjtcbiAgICAgIHRoaXMuc3RhdGUuaXNMb2FkaW5nID0gdHJ1ZTtcbiAgICAgIGlmICh0eXBlb2YgdGhpcy5vcHRpb25zLmRlbGF5ID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZGVsYXkgPT09IDApIHtcbiAgICAgICAgICB0aGlzLnN0YXRlLnBhc3REZWxheSA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5fZGVsYXkgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUucGFzdERlbGF5ID0gdHJ1ZTtcbiAgICAgICAgICB9LCB0aGlzLm9wdGlvbnMuZGVsYXkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLnN0YXRlLnByb21pc2UgPSBHYXJmaXNoSW5zdGFuY2UubG9hZEFwcCh0aGlzLmFwcEluZm8ubmFtZSwge1xuICAgICAgICBlbnRyeTogdGhpcy5hcHBJbmZvLmVudHJ5LFxuICAgICAgICBkb21HZXR0ZXI6ICgpID0+IHRoaXMsXG4gICAgICAgIGJhc2VuYW1lOiB0aGlzLmFwcEluZm8uYmFzZW5hbWUsXG4gICAgICAgIHNhbmRib3g6IHtcbiAgICAgICAgICBzbmFwc2hvdDogZmFsc2UsXG4gICAgICAgICAgc3RyaWN0SXNvbGF0aW9uOiB0aGlzLmhhc0F0dHJpYnV0ZShcInNoYWRvd1wiKSB8fCBmYWxzZVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgX2NsZWFyVGltZW91dHMoKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5fZGVsYXkpO1xuICAgIH1cbiAgICBhc3luYyBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgIHRoaXMuYXBwSW5mbyA9IHtcbiAgICAgICAgbmFtZTogdGhpcy5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpIHx8IFwiXCIsXG4gICAgICAgIGVudHJ5OiB0aGlzLmdldEF0dHJpYnV0ZShcImVudHJ5XCIpIHx8IFwiXCIsXG4gICAgICAgIGJhc2VuYW1lOiB0aGlzLmdldEF0dHJpYnV0ZShcImJhc2VuYW1lXCIpIHx8IFwiL1wiXG4gICAgICB9O1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGhpcy5fbG9hZEFwcCgpO1xuICAgICAgICB0aGlzLnN0YXRlLmxvYWRlZCA9IGF3YWl0IHRoaXMuc3RhdGUucHJvbWlzZTtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUubG9hZGVkLm1vdW50ZWQpIHtcbiAgICAgICAgICB0aGlzLnN0YXRlLmxvYWRlZC5zaG93KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5zdGF0ZS5sb2FkZWQubW91bnQoKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5lcnJvciA9IGVycm9yO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgdGhpcy5zdGF0ZS5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgZGlzY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgICB0aGlzLl9jbGVhclRpbWVvdXRzKCk7XG4gICAgICBpZiAodGhpcy5zdGF0ZS5sb2FkZWQpIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5sb2FkZWQuaGlkZSgpO1xuICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBhZG9wdGVkQ2FsbGJhY2soKSB7XG4gICAgfVxuICAgIGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayhuYW1lLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiQ3VzdG9tIHNxdWFyZSBlbGVtZW50IGF0dHJpYnV0ZXMgY2hhbmdlZC5cIiwgbmFtZSwgb2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICB9XG4gIH1cbiAgaWYgKCFjdXN0b21FbGVtZW50cy5nZXQoaHRtbFRhZykpIHtcbiAgICBHYXJmaXNoSW5zdGFuY2UucnVuKG9wdGlvbnMuY29uZmlnIHx8IHt9KTtcbiAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUoaHRtbFRhZywgTWljcm9BcHApO1xuICB9XG59XG5mdW5jdGlvbiBjcmVhdGVMb2FkYWJsZVdlYkNvbXBvbmVudChodG1sVGFnLCBvcHRpb25zKSB7XG4gIGlmICh0eXBlb2YgaHRtbFRhZyAhPT0gXCJzdHJpbmdcIikge1xuICAgIHRocm93IG5ldyBFcnJvcihcImdhcmZpc2ggcmVxdWlyZXMgYSBgaHRtbFRhZ2AgbmFtZVwiKTtcbiAgfVxuICBpZiAoIW9wdGlvbnMubG9hZGluZykge1xuICAgIHRocm93IG5ldyBFcnJvcihcImdhcmZpc2ggcmVxdWlyZXMgYSBgbG9hZGluZ2AgY29tcG9uZW50XCIpO1xuICB9XG4gIGNvbnN0IG9wdHMgPSBPYmplY3QuYXNzaWduKHtcbiAgICBsb2FkaW5nOiBmYWxzZSxcbiAgICBkZWxheTogMjAwLFxuICAgIHRpbWVvdXQ6IG51bGxcbiAgfSwgb3B0aW9ucyk7XG4gIHJldHVybiBnZW5lcmF0ZUN1c3RvbWVyRWxlbWVudChodG1sVGFnLCBvcHRzKTtcbn1cbmZ1bmN0aW9uIGRlZmluZUN1c3RvbUVsZW1lbnRzKGh0bWxUYWcsIG9wdGlvbnMpIHtcbiAgcmV0dXJuIGNyZWF0ZUxvYWRhYmxlV2ViQ29tcG9uZW50KGh0bWxUYWcsIG9wdGlvbnMpO1xufVxuZXhwb3J0IHtcbiAgZGVmYXVsdDIgYXMgR2FyZmlzaCxcbiAgR2FyZmlzaEluc3RhbmNlIGFzIGRlZmF1bHQsXG4gIGRlZmluZUN1c3RvbUVsZW1lbnRzXG59O1xuIiwiLyoqXG4gKiBIZWxwZXJzLlxuICovXG5cbnZhciBzID0gMTAwMDtcbnZhciBtID0gcyAqIDYwO1xudmFyIGggPSBtICogNjA7XG52YXIgZCA9IGggKiAyNDtcbnZhciB3ID0gZCAqIDc7XG52YXIgeSA9IGQgKiAzNjUuMjU7XG5cbi8qKlxuICogUGFyc2Ugb3IgZm9ybWF0IHRoZSBnaXZlbiBgdmFsYC5cbiAqXG4gKiBPcHRpb25zOlxuICpcbiAqICAtIGBsb25nYCB2ZXJib3NlIGZvcm1hdHRpbmcgW2ZhbHNlXVxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfE51bWJlcn0gdmFsXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXG4gKiBAdGhyb3dzIHtFcnJvcn0gdGhyb3cgYW4gZXJyb3IgaWYgdmFsIGlzIG5vdCBhIG5vbi1lbXB0eSBzdHJpbmcgb3IgYSBudW1iZXJcbiAqIEByZXR1cm4ge1N0cmluZ3xOdW1iZXJ9XG4gKiBAYXBpIHB1YmxpY1xuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odmFsLCBvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICB2YXIgdHlwZSA9IHR5cGVvZiB2YWw7XG4gIGlmICh0eXBlID09PSAnc3RyaW5nJyAmJiB2YWwubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiBwYXJzZSh2YWwpO1xuICB9IGVsc2UgaWYgKHR5cGUgPT09ICdudW1iZXInICYmIGlzRmluaXRlKHZhbCkpIHtcbiAgICByZXR1cm4gb3B0aW9ucy5sb25nID8gZm10TG9uZyh2YWwpIDogZm10U2hvcnQodmFsKTtcbiAgfVxuICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgJ3ZhbCBpcyBub3QgYSBub24tZW1wdHkgc3RyaW5nIG9yIGEgdmFsaWQgbnVtYmVyLiB2YWw9JyArXG4gICAgICBKU09OLnN0cmluZ2lmeSh2YWwpXG4gICk7XG59O1xuXG4vKipcbiAqIFBhcnNlIHRoZSBnaXZlbiBgc3RyYCBhbmQgcmV0dXJuIG1pbGxpc2Vjb25kcy5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gc3RyXG4gKiBAcmV0dXJuIHtOdW1iZXJ9XG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5mdW5jdGlvbiBwYXJzZShzdHIpIHtcbiAgc3RyID0gU3RyaW5nKHN0cik7XG4gIGlmIChzdHIubGVuZ3RoID4gMTAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHZhciBtYXRjaCA9IC9eKC0/KD86XFxkKyk/XFwuP1xcZCspICoobWlsbGlzZWNvbmRzP3xtc2Vjcz98bXN8c2Vjb25kcz98c2Vjcz98c3xtaW51dGVzP3xtaW5zP3xtfGhvdXJzP3xocnM/fGh8ZGF5cz98ZHx3ZWVrcz98d3x5ZWFycz98eXJzP3x5KT8kL2kuZXhlYyhcbiAgICBzdHJcbiAgKTtcbiAgaWYgKCFtYXRjaCkge1xuICAgIHJldHVybjtcbiAgfVxuICB2YXIgbiA9IHBhcnNlRmxvYXQobWF0Y2hbMV0pO1xuICB2YXIgdHlwZSA9IChtYXRjaFsyXSB8fCAnbXMnKS50b0xvd2VyQ2FzZSgpO1xuICBzd2l0Y2ggKHR5cGUpIHtcbiAgICBjYXNlICd5ZWFycyc6XG4gICAgY2FzZSAneWVhcic6XG4gICAgY2FzZSAneXJzJzpcbiAgICBjYXNlICd5cic6XG4gICAgY2FzZSAneSc6XG4gICAgICByZXR1cm4gbiAqIHk7XG4gICAgY2FzZSAnd2Vla3MnOlxuICAgIGNhc2UgJ3dlZWsnOlxuICAgIGNhc2UgJ3cnOlxuICAgICAgcmV0dXJuIG4gKiB3O1xuICAgIGNhc2UgJ2RheXMnOlxuICAgIGNhc2UgJ2RheSc6XG4gICAgY2FzZSAnZCc6XG4gICAgICByZXR1cm4gbiAqIGQ7XG4gICAgY2FzZSAnaG91cnMnOlxuICAgIGNhc2UgJ2hvdXInOlxuICAgIGNhc2UgJ2hycyc6XG4gICAgY2FzZSAnaHInOlxuICAgIGNhc2UgJ2gnOlxuICAgICAgcmV0dXJuIG4gKiBoO1xuICAgIGNhc2UgJ21pbnV0ZXMnOlxuICAgIGNhc2UgJ21pbnV0ZSc6XG4gICAgY2FzZSAnbWlucyc6XG4gICAgY2FzZSAnbWluJzpcbiAgICBjYXNlICdtJzpcbiAgICAgIHJldHVybiBuICogbTtcbiAgICBjYXNlICdzZWNvbmRzJzpcbiAgICBjYXNlICdzZWNvbmQnOlxuICAgIGNhc2UgJ3NlY3MnOlxuICAgIGNhc2UgJ3NlYyc6XG4gICAgY2FzZSAncyc6XG4gICAgICByZXR1cm4gbiAqIHM7XG4gICAgY2FzZSAnbWlsbGlzZWNvbmRzJzpcbiAgICBjYXNlICdtaWxsaXNlY29uZCc6XG4gICAgY2FzZSAnbXNlY3MnOlxuICAgIGNhc2UgJ21zZWMnOlxuICAgIGNhc2UgJ21zJzpcbiAgICAgIHJldHVybiBuO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG59XG5cbi8qKlxuICogU2hvcnQgZm9ybWF0IGZvciBgbXNgLlxuICpcbiAqIEBwYXJhbSB7TnVtYmVyfSBtc1xuICogQHJldHVybiB7U3RyaW5nfVxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZnVuY3Rpb24gZm10U2hvcnQobXMpIHtcbiAgdmFyIG1zQWJzID0gTWF0aC5hYnMobXMpO1xuICBpZiAobXNBYnMgPj0gZCkge1xuICAgIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gZCkgKyAnZCc7XG4gIH1cbiAgaWYgKG1zQWJzID49IGgpIHtcbiAgICByZXR1cm4gTWF0aC5yb3VuZChtcyAvIGgpICsgJ2gnO1xuICB9XG4gIGlmIChtc0FicyA+PSBtKSB7XG4gICAgcmV0dXJuIE1hdGgucm91bmQobXMgLyBtKSArICdtJztcbiAgfVxuICBpZiAobXNBYnMgPj0gcykge1xuICAgIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gcykgKyAncyc7XG4gIH1cbiAgcmV0dXJuIG1zICsgJ21zJztcbn1cblxuLyoqXG4gKiBMb25nIGZvcm1hdCBmb3IgYG1zYC5cbiAqXG4gKiBAcGFyYW0ge051bWJlcn0gbXNcbiAqIEByZXR1cm4ge1N0cmluZ31cbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cbmZ1bmN0aW9uIGZtdExvbmcobXMpIHtcbiAgdmFyIG1zQWJzID0gTWF0aC5hYnMobXMpO1xuICBpZiAobXNBYnMgPj0gZCkge1xuICAgIHJldHVybiBwbHVyYWwobXMsIG1zQWJzLCBkLCAnZGF5Jyk7XG4gIH1cbiAgaWYgKG1zQWJzID49IGgpIHtcbiAgICByZXR1cm4gcGx1cmFsKG1zLCBtc0FicywgaCwgJ2hvdXInKTtcbiAgfVxuICBpZiAobXNBYnMgPj0gbSkge1xuICAgIHJldHVybiBwbHVyYWwobXMsIG1zQWJzLCBtLCAnbWludXRlJyk7XG4gIH1cbiAgaWYgKG1zQWJzID49IHMpIHtcbiAgICByZXR1cm4gcGx1cmFsKG1zLCBtc0FicywgcywgJ3NlY29uZCcpO1xuICB9XG4gIHJldHVybiBtcyArICcgbXMnO1xufVxuXG4vKipcbiAqIFBsdXJhbGl6YXRpb24gaGVscGVyLlxuICovXG5cbmZ1bmN0aW9uIHBsdXJhbChtcywgbXNBYnMsIG4sIG5hbWUpIHtcbiAgdmFyIGlzUGx1cmFsID0gbXNBYnMgPj0gbiAqIDEuNTtcbiAgcmV0dXJuIE1hdGgucm91bmQobXMgLyBuKSArICcgJyArIG5hbWUgKyAoaXNQbHVyYWwgPyAncycgOiAnJyk7XG59XG4iLCIvKiBlcy1tb2R1bGUtbGV4ZXIgMS4xLjAgKi9cbmNvbnN0IEE9MT09PW5ldyBVaW50OEFycmF5KG5ldyBVaW50MTZBcnJheShbMV0pLmJ1ZmZlcilbMF07ZXhwb3J0IGZ1bmN0aW9uIHBhcnNlKEUsZz1cIkBcIil7aWYoIUMpcmV0dXJuIGluaXQoKS50aGVuKCgoKT0+cGFyc2UoRSkpKTtjb25zdCBJPUUubGVuZ3RoKzEsSz0oQy5fX2hlYXBfYmFzZS52YWx1ZXx8Qy5fX2hlYXBfYmFzZSkrNCpJLUMubWVtb3J5LmJ1ZmZlci5ieXRlTGVuZ3RoO0s+MCYmQy5tZW1vcnkuZ3JvdyhNYXRoLmNlaWwoSy82NTUzNikpO2NvbnN0IGs9Qy5zYShJLTEpO2lmKChBP0I6USkoRSxuZXcgVWludDE2QXJyYXkoQy5tZW1vcnkuYnVmZmVyLGssSSkpLCFDLnBhcnNlKCkpdGhyb3cgT2JqZWN0LmFzc2lnbihuZXcgRXJyb3IoYFBhcnNlIGVycm9yICR7Z306JHtFLnNsaWNlKDAsQy5lKCkpLnNwbGl0KFwiXFxuXCIpLmxlbmd0aH06JHtDLmUoKS1FLmxhc3RJbmRleE9mKFwiXFxuXCIsQy5lKCktMSl9YCkse2lkeDpDLmUoKX0pO2NvbnN0IG89W10sRD1bXTtmb3IoO0MucmkoKTspe2NvbnN0IEE9Qy5pcygpLFE9Qy5pZSgpLEI9Qy5haSgpLGc9Qy5pZCgpLEk9Qy5zcygpLEs9Qy5zZSgpO2xldCBrO0MuaXAoKSYmKGs9dyhFLnNsaWNlKC0xPT09Zz9BLTE6QSwtMT09PWc/USsxOlEpKSksby5wdXNoKHtuOmssczpBLGU6USxzczpJLHNlOkssZDpnLGE6Qn0pfWZvcig7Qy5yZSgpOyl7Y29uc3QgQT1DLmVzKCksUT1DLmVlKCksQj1DLmVscygpLGc9Qy5lbGUoKSxJPUUuc2xpY2UoQSxRKSxLPUlbMF0saz1CPDA/dm9pZCAwOkUuc2xpY2UoQixnKSxvPWs/a1swXTpcIlwiO0QucHVzaCh7czpBLGU6USxsczpCLGxlOmcsbjonXCInPT09S3x8XCInXCI9PT1LP3coSSk6SSxsbjonXCInPT09b3x8XCInXCI9PT1vP3coayk6a30pfWZ1bmN0aW9uIHcoQSl7dHJ5e3JldHVybigwLGV2YWwpKEEpfWNhdGNoKEEpe319cmV0dXJuW28sRCwhIUMuZigpXX1mdW5jdGlvbiBRKEEsUSl7Y29uc3QgQj1BLmxlbmd0aDtsZXQgQz0wO2Zvcig7QzxCOyl7Y29uc3QgQj1BLmNoYXJDb2RlQXQoQyk7UVtDKytdPSgyNTUmQik8PDh8Qj4+Pjh9fWZ1bmN0aW9uIEIoQSxRKXtjb25zdCBCPUEubGVuZ3RoO2xldCBDPTA7Zm9yKDtDPEI7KVFbQ109QS5jaGFyQ29kZUF0KEMrKyl9bGV0IEMsRTtleHBvcnQgY29uc3QgaW5pdD0oKT0+e3ZhciBBO3JldHVybiBFfHwoRT1XZWJBc3NlbWJseS5jb21waWxlKChBPVwiQUdGemJRRUFBQUFCS2doZ0FYOEJmMkFFZjM5L2Z3QmdBQUYvWUFBQVlBRi9BR0FEZjM5L0FYOWdBbjkvQVg5Z0FuOS9BQU10TEFBQkFRSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQUF3TURCQVFBQUFBREFBQUFBQU1EQlFZQUFBY0FCZ0lGQkFVQmNBRUJBUVVEQVFBQkJnOENmd0ZCc1BJQUMzOEFRYkR5QUFzSGNCTUdiV1Z0YjNKNUFnQUNjMkVBQUFGbEFBTUNhWE1BQkFKcFpRQUZBbk56QUFZQ2MyVUFCd0poYVFBSUFtbGtBQWtDYVhBQUNnSmxjd0FMQW1WbEFBd0RaV3h6QUEwRFpXeGxBQTRDY21rQUR3SnlaUUFRQVdZQUVRVndZWEp6WlFBU0MxOWZhR1ZoY0Y5aVlYTmxBd0VLc2pzc2FBRUJmMEVBSUFBMkF2Z0pRUUFvQXRRSklnRWdBRUVCZEdvaUFFRUFPd0VBUVFBZ0FFRUNhaUlBTmdMOENVRUFJQUEyQW9BS1FRQkJBRFlDMkFsQkFFRUFOZ0xvQ1VFQVFRQTJBdUFKUVFCQkFEWUMzQWxCQUVFQU5nTHdDVUVBUVFBMkF1UUpJQUVMbndFQkEzOUJBQ2dDNkFraEJFRUFRUUFvQW9BS0lnVTJBdWdKUVFBZ0JEWUM3QWxCQUNBRlFTQnFOZ0tBQ2lBRVFSeHFRZGdKSUFRYklBVTJBZ0JCQUNnQ3pBa2hCRUVBS0FMSUNTRUdJQVVnQVRZQ0FDQUZJQUEyQWdnZ0JTQUNJQUpCQW1wQkFDQUdJQU5HR3lBRUlBTkdHellDRENBRklBTTJBaFFnQlVFQU5nSVFJQVVnQWpZQ0JDQUZRUUEyQWh3Z0JVRUFLQUxJQ1NBRFJqb0FHQXRXQVFGL1FRQW9BdkFKSWdSQkVHcEIzQWtnQkJ0QkFDZ0NnQW9pQkRZQ0FFRUFJQVEyQXZBSlFRQWdCRUVVYWpZQ2dBb2dCRUVBTmdJUUlBUWdBellDRENBRUlBSTJBZ2dnQkNBQk5nSUVJQVFnQURZQ0FBc0lBRUVBS0FLRUNnc1ZBRUVBS0FMZ0NTZ0NBRUVBS0FMVUNXdEJBWFVMSGdFQmYwRUFLQUxnQ1NnQ0JDSUFRUUFvQXRRSmEwRUJkVUYvSUFBYkN4VUFRUUFvQXVBSktBSUlRUUFvQXRRSmEwRUJkUXNlQVFGL1FRQW9BdUFKS0FJTUlnQkJBQ2dDMUFsclFRRjFRWDhnQUJzTEhnRUJmMEVBS0FMZ0NTZ0NFQ0lBUVFBb0F0UUphMEVCZFVGL0lBQWJDenNCQVg4Q1FFRUFLQUxnQ1NnQ0ZDSUFRUUFvQXNnSlJ3MEFRWDhQQ3dKQUlBQkJBQ2dDekFsSERRQkJmZzhMSUFCQkFDZ0MxQWxyUVFGMUN3c0FRUUFvQXVBSkxRQVlDeFVBUVFBb0F1UUpLQUlBUVFBb0F0UUphMEVCZFFzVkFFRUFLQUxrQ1NnQ0JFRUFLQUxVQ1d0QkFYVUxIZ0VCZjBFQUtBTGtDU2dDQ0NJQVFRQW9BdFFKYTBFQmRVRi9JQUFiQ3g0QkFYOUJBQ2dDNUFrb0Fnd2lBRUVBS0FMVUNXdEJBWFZCZnlBQUd3c2xBUUYvUVFCQkFDZ0M0QWtpQUVFY2FrSFlDU0FBR3lnQ0FDSUFOZ0xnQ1NBQVFRQkhDeVVCQVg5QkFFRUFLQUxrQ1NJQVFSQnFRZHdKSUFBYktBSUFJZ0EyQXVRSklBQkJBRWNMQ0FCQkFDMEFpQW9MNWd3QkJuOGpBRUdBMEFCcklnQWtBRUVBUVFFNkFJZ0tRUUJCQUNnQzBBazJBcEFLUVFCQkFDZ0MxQWxCZm1vaUFUWUNwQXBCQUNBQlFRQW9BdmdKUVFGMGFpSUNOZ0tvQ2tFQVFRQTdBWW9LUVFCQkFEc0JqQXBCQUVFQU9nQ1VDa0VBUVFBMkFvUUtRUUJCQURvQTlBbEJBQ0FBUVlBUWFqWUNtQXBCQUNBQU5nS2NDa0VBUVFBNkFLQUtBa0FDUUFKQUFrQURRRUVBSUFGQkFtb2lBellDcEFvZ0FTQUNUdzBCQWtBZ0F5OEJBQ0lDUVhkcVFRVkpEUUFDUUFKQUFrQUNRQUpBSUFKQm0zOXFEZ1VCQ0FnSUFnQUxJQUpCSUVZTkJDQUNRUzlHRFFNZ0FrRTdSZzBDREFjTFFRQXZBWXdLRFFFZ0F4QVRSUTBCSUFGQkJHcEJnZ2hCQ2hBckRRRVFGRUVBTFFDSUNnMEJRUUJCQUNnQ3BBb2lBVFlDa0FvTUJ3c2dBeEFUUlEwQUlBRkJCR3BCakFoQkNoQXJEUUFRRlF0QkFFRUFLQUtrQ2pZQ2tBb01BUXNDUUNBQkx3RUVJZ05CS2tZTkFDQURRUzlIRFFRUUZnd0JDMEVCRUJjTFFRQW9BcWdLSVFKQkFDZ0NwQW9oQVF3QUN3dEJBQ0VDSUFNaEFVRUFMUUQwQ1EwQ0RBRUxRUUFnQVRZQ3BBcEJBRUVBT2dDSUNnc0RRRUVBSUFGQkFtb2lBellDcEFvQ1FBSkFBa0FDUUFKQUFrQUNRQUpBQWtBZ0FVRUFLQUtvQ2s4TkFDQURMd0VBSWdKQmQycEJCVWtOQ0FKQUFrQUNRQUpBQWtBQ1FBSkFBa0FDUUFKQUlBSkJZR29PQ2hJUkJoRVJFUkVGQVFJQUN3SkFBa0FDUUFKQUlBSkJvSDlxRGdvTEZCUURGQUVVRkJRQ0FBc2dBa0dGZjJvT0F3VVRCZ2tMUVFBdkFZd0tEUklnQXhBVFJRMFNJQUZCQkdwQmdnaEJDaEFyRFJJUUZBd1NDeUFERUJORkRSRWdBVUVFYWtHTUNFRUtFQ3NORVJBVkRCRUxJQU1RRTBVTkVDQUJLUUFFUXV5QWhJT3dqc0E1VWcwUUlBRXZBUXdpQTBGM2FpSUJRUmRMRFE1QkFTQUJkRUdmZ0lBRWNVVU5EZ3dQQzBFQVFRQXZBWXdLSWdGQkFXbzdBWXdLUVFBb0FwZ0tJQUZCQTNScUlnRkJBVFlDQUNBQlFRQW9BcEFLTmdJRURBOExRUUF2QVl3S0lnSkZEUXRCQUNBQ1FYOXFJZ1E3QVl3S1FRQXZBWW9LSWdKRkRRNGdBa0VDZEVFQUtBS2NDbXBCZkdvb0FnQWlCU2dDRkVFQUtBS1lDaUFFUWYvL0EzRkJBM1JxS0FJRVJ3ME9Ba0FnQlNnQ0JBMEFJQVVnQXpZQ0JBdEJBQ0FDUVg5cU93R0tDaUFGSUFGQkJHbzJBZ3dNRGdzQ1FFRUFLQUtRQ2lJQkx3RUFRU2xIRFFCQkFDZ0M2QWtpQTBVTkFDQURLQUlFSUFGSERRQkJBRUVBS0FMc0NTSUROZ0xvQ1FKQUlBTkZEUUFnQTBFQU5nSWNEQUVMUVFCQkFEWUMyQWtMUVFCQkFDOEJqQW9pQTBFQmFqc0JqQXBCQUNnQ21Bb2dBMEVEZEdvaUEwRUdRUUpCQUMwQW9Bb2JOZ0lBSUFNZ0FUWUNCRUVBUVFBNkFLQUtEQTBMUVFBdkFZd0tJZ0ZGRFFsQkFDQUJRWDlxSWdFN0FZd0tRUUFvQXBnS0lBRkIvLzhEY1VFRGRHb29BZ0JCQkVZTkJBd01DMEVuRUJnTUN3dEJJaEFZREFvTElBSkJMMGNOQ1FKQUFrQWdBUzhCQkNJQlFTcEdEUUFnQVVFdlJ3MEJFQllNREF0QkFSQVhEQXNMQWtBQ1FFRUFLQUtRQ2lJQkx3RUFJZ01RR1VVTkFBSkFBa0FnQTBGVmFnNEVBQWdCQXdnTElBRkJmbW92QVFCQkswWU5CZ3dIQ3lBQlFYNXFMd0VBUVMxR0RRVU1CZ3NDUUNBRFFmMEFSZzBBSUFOQktVY05CVUVBS0FLWUNrRUFMd0dNQ2tFRGRHb29BZ1FRR2tVTkJRd0dDMEVBS0FLWUNrRUFMd0dNQ2tFRGRHb2lBaWdDQkJBYkRRVWdBaWdDQUVFR1JnMEZEQVFMSUFGQmZtb3ZBUUJCVUdwQi8vOERjVUVLU1EwRERBUUxRUUFvQXBnS1FRQXZBWXdLSWdGQkEzUWlBMnBCQUNnQ2tBbzJBZ1JCQUNBQlFRRnFPd0dNQ2tFQUtBS1lDaUFEYWtFRE5nSUFDeEFjREFjTFFRQXRBUFFKUVFBdkFZb0tRUUF2QVl3S2NuSkZJUUlNQ1FzZ0FSQWREUUFnQTBVTkFDQURRUzlHUVFBdEFKUUtRUUJIY1EwQUlBRkJmbW9oQVVFQUtBTFVDU0VDQWtBRFFDQUJRUUpxSWdRZ0FrME5BVUVBSUFFMkFwQUtJQUV2QVFBaEF5QUJRWDVxSWdRaEFTQURFQjVGRFFBTElBUkJBbW9oQkF0QkFTRUZJQU5CLy84RGNSQWZSUTBCSUFSQmZtb2hBUUpBQTBBZ0FVRUNhaUlESUFKTkRRRkJBQ0FCTmdLUUNpQUJMd0VBSVFNZ0FVRithaUlFSVFFZ0F4QWZEUUFMSUFSQkFtb2hBd3NnQXhBZ1JRMEJFQ0ZCQUVFQU9nQ1VDZ3dGQ3hBaFFRQWhCUXRCQUNBRk9nQ1VDZ3dEQ3hBaVFRQWhBZ3dGQ3lBRFFhQUJSdzBCQzBFQVFRRTZBS0FLQzBFQVFRQW9BcVFLTmdLUUNndEJBQ2dDcEFvaEFRd0FDd3NnQUVHQTBBQnFKQUFnQWdzZEFBSkFRUUFvQXRRSklBQkhEUUJCQVE4TElBQkJmbW92QVFBUUhndkZDZ0VIZjBFQVFRQW9BcVFLSWdCQkRHb2lBVFlDcEFwQkFDZ0M4QWtoQWtFQkVDWWhBd0pBQWtBQ1FBSkFBa0FDUUFKQVFRQW9BcVFLSWdRZ0FVY05BQ0FERUNWRkRRRUxBa0FDUUFKQUFrQWdBMEVxUmcwQUlBTkIrd0JIRFFGQkFDQUVRUUpxTmdLa0NrRUJFQ1loQkVFQUtBS2tDaUVCQTBBQ1FBSkFJQVJCLy84RGNTSURRU0pHRFFBZ0EwRW5SZzBBSUFNUUtCcEJBQ2dDcEFvaEF3d0JDeUFERUJoQkFFRUFLQUtrQ2tFQ2FpSUROZ0trQ2d0QkFSQW1HZ0pBSUFFZ0F4QXBJZ1JCTEVjTkFFRUFRUUFvQXFRS1FRSnFOZ0trQ2tFQkVDWWhCQXRCQUNnQ3BBb2hBeUFFUWYwQVJnMERJQU1nQVVZTkNpQURJUUVnQTBFQUtBS29DazBOQUF3S0N3dEJBQ0FFUVFKcU5nS2tDa0VCRUNZYVFRQW9BcVFLSWdNZ0F4QXBHZ3dDQzBFQVFRQTZBSWdLQWtBQ1FBSkFBa0FDUUFKQUlBTkJuMzlxRGd3Q0NBUUJDQU1JQ0FnSUNBVUFDeUFEUWZZQVJnMEVEQWNMUVFBZ0JFRU9haUlBTmdLa0NrSGhBQ0VEQWtCQkFSQW1JZ0pCNFFCSERRQkJBQ0VCUVFBb0FxUUtJZ0lRRTBVTkN5QUNLUUFDUXZPQTVJUGdqY0F4VWcwTElBSXZBUW9RSDBVTkMwRUFJQUpCQ21vMkFxUUtRUUFRSmlFQ0MwSG1BQ0VEUVFBaEFTQUNRZVlBUncwSlFRQWhBVUVBS0FLa0NpSUNFQk5GRFFvZ0FrRUNha0drQ0VFT0VDc05DaUFDTHdFUUlnVkJkMm9pQmtFWFN3MEhRUUVnQm5SQm40Q0FCSEZGRFFjTUNBdEJBQ0FFUVFwcU5nS2tDa0VCRUNZYVFRQW9BcVFLSVFRTFFRQWdCRUVRYWpZQ3BBb0NRRUVCRUNZaUJFRXFSdzBBUVFCQkFDZ0NwQXBCQW1vMkFxUUtRUUVRSmlFRUMwRUFLQUtrQ2lFRElBUVFLQm9nQTBFQUtBS2tDaUlFSUFNZ0JCQUNRUUJCQUNnQ3BBcEJmbW8yQXFRS0R3c0NRQ0FFS1FBQ1F1eUFoSU93anNBNVVnMEFJQVF2QVFvUUhrVU5BRUVBSUFSQkNtbzJBcVFLUVFFUUppRUVRUUFvQXFRS0lRTWdCQkFvR2lBRFFRQW9BcVFLSWdRZ0F5QUVFQUpCQUVFQUtBS2tDa0YrYWpZQ3BBb1BDMEVBSUFSQkJHb2lCRFlDcEFvTFFRQWdCRUVFYWlJRE5nS2tDa0VBUVFBNkFJZ0tBa0FEUUVFQUlBTkJBbW8yQXFRS1FRRVFKaUVFUVFBb0FxUUtJUU1nQkJBb1FTQnlRZnNBUmcwQlFRQW9BcVFLSWdRZ0EwWU5CQ0FESUFRZ0F5QUVFQUpCQVJBbVFTeEhEUUZCQUNnQ3BBb2hBd3dBQ3d0QkFFRUFLQUtrQ2tGK2FqWUNwQW9QQzBFQUlBTkJBbW8yQXFRS0MwRUJFQ1loQkVFQUtBS2tDaUVEQWtBZ0JFSG1BRWNOQUNBRFFRSnFRWjRJUVFZUUt3MEFRUUFnQTBFSWFqWUNwQW9nQUVFQkVDWVFKeUFDUVJCcVFkd0pJQUliSVFNRFFDQURLQUlBSWdORkRRSWdBMElBTndJSUlBTkJFR29oQXd3QUN3dEJBQ0FEUVg1cU5nS2tDZ3NQQ3dKQUlBVkJXR29PQXdFREFRQUxJQVZCb0FGSERRSUxRUUFnQWtFUWFqWUNwQXBCQVNFQkFrQkJBUkFtSWdKQktrY05BRUVBUVFBb0FxUUtRUUpxTmdLa0NrRUJFQ1loQWdzZ0FrRW9SdzBBSUFRZ0FFRUFRUUFRQWtFQUlBUkJER28yQXFRS0R3dEI0d0FoQXdKQUlBSkI0d0JHRFFBZ0FpRUREQUVMUVFBb0FxUUtJZ0lRRTBVTkFDQUNLUUFDUXV5QWhJT3dqc0E1VWcwQUFrQUNRQ0FDTHdFS0lnVkJkMm9pQmtFWFN3MEFRUUVnQm5SQm40Q0FCSEVOQVFzZ0JVR2dBVVlOQUNBRlFmc0FSdzBCQzBFQUlBSkJDbW8yQXFRS1FRRWhBVUVCRUNZaUEwSDdBRWNOQUNBRUlBQkJBRUVBRUFKQkFDQUVRUXhxTmdLa0NnOExRUUFvQXFRS0lRSWdBeEFvR2dKQUFrQWdBVVVOQUVFQUtBS2tDaUlESUFKTkRRQWdCQ0FBSUFJZ0F4QUNRUUFvQXFRS1FYNXFJUU1NQVFzZ0JDQUFRUUJCQUJBQ0lBUkJER29oQXd0QkFDQUROZ0trQ2c4TEVDSUx2Z1lCQkg5QkFFRUFLQUtrQ2lJQVFReHFJZ0UyQXFRS0FrQUNRQUpBQWtBQ1FBSkFBa0FDUUFKQUFrQkJBUkFtSWdKQldXb09DQVFDQVFRQkFRRURBQXNnQWtFaVJnMERJQUpCK3dCR0RRUUxRUUFvQXFRS0lBRkhEUUpCQUNBQVFRcHFOZ0trQ2c4TFFRQW9BcGdLUVFBdkFZd0tJZ0pCQTNScUlnRkJBQ2dDcEFvMkFnUkJBQ0FDUVFGcU93R01DaUFCUVFVMkFnQkJBQ2dDa0FvdkFRQkJMa1lOQTBFQVFRQW9BcVFLSWdGQkFtbzJBcVFLUVFFUUppRUNJQUJCQUNnQ3BBcEJBQ0FCRUFGQkFFRUFMd0dLQ2lJQlFRRnFPd0dLQ2tFQUtBS2NDaUFCUVFKMGFrRUFLQUxvQ1RZQ0FBSkFJQUpCSWtZTkFDQUNRU2RHRFFCQkFFRUFLQUtrQ2tGK2FqWUNwQW9QQ3lBQ0VCaEJBRUVBS0FLa0NrRUNhaUlDTmdLa0NnSkFBa0FDUUVFQkVDWkJWMm9PQkFFQ0FnQUNDMEVBUVFBb0FxUUtRUUpxTmdLa0NrRUJFQ1lhUVFBb0F1Z0pJZ0VnQWpZQ0JDQUJRUUU2QUJnZ0FVRUFLQUtrQ2lJQ05nSVFRUUFnQWtGK2FqWUNwQW9QQzBFQUtBTG9DU0lCSUFJMkFnUWdBVUVCT2dBWVFRQkJBQzhCakFwQmYybzdBWXdLSUFGQkFDZ0NwQXBCQW1vMkFneEJBRUVBTHdHS0NrRi9hanNCaWdvUEMwRUFRUUFvQXFRS1FYNXFOZ0trQ2c4TFFRQkJBQ2dDcEFwQkFtbzJBcVFLUVFFUUprSHRBRWNOQWtFQUtBS2tDaUlDUVFKcVFaWUlRUVlRS3cwQ1FRQW9BcEFLTHdFQVFTNUdEUUlnQUNBQUlBSkJDR3BCQUNnQ3pBa1FBUThMUVFBdkFZd0tEUUpCQUNnQ3BBb2hBa0VBS0FLb0NpRURBMEFnQWlBRFR3MEZBa0FDUUNBQ0x3RUFJZ0ZCSjBZTkFDQUJRU0pIRFFFTElBQWdBUkFuRHd0QkFDQUNRUUpxSWdJMkFxUUtEQUFMQzBFQUtBS2tDaUVDUVFBdkFZd0tEUUlDUUFOQUFrQUNRQUpBSUFKQkFDZ0NxQXBQRFFCQkFSQW1JZ0pCSWtZTkFTQUNRU2RHRFFFZ0FrSDlBRWNOQWtFQVFRQW9BcVFLUVFKcU5nS2tDZ3RCQVJBbUdrRUFLQUtrQ2lJQ0tRQUFRdWFBeUlQd2pjQTJVZzBIUVFBZ0FrRUlhallDcEFwQkFSQW1JZ0pCSWtZTkF5QUNRU2RHRFFNTUJ3c2dBaEFZQzBFQVFRQW9BcVFLUVFKcUlnSTJBcVFLREFBTEN5QUFJQUlRSndzUEMwRUFRUUFvQXFRS1FYNXFOZ0trQ2c4TFFRQWdBa0YrYWpZQ3BBb1BDeEFpQzBjQkEzOUJBQ2dDcEFwQkFtb2hBRUVBS0FLb0NpRUJBa0FEUUNBQUlnSkJmbW9nQVU4TkFTQUNRUUpxSVFBZ0FpOEJBRUYyYWc0RUFRQUFBUUFMQzBFQUlBSTJBcVFLQzVnQkFRTi9RUUJCQUNnQ3BBb2lBVUVDYWpZQ3BBb2dBVUVHYWlFQlFRQW9BcWdLSVFJRFFBSkFBa0FDUUNBQlFYeHFJQUpQRFFBZ0FVRithaThCQUNFREFrQUNRQ0FBRFFBZ0EwRXFSZzBCSUFOQmRtb09CQUlFQkFJRUN5QURRU3BIRFFNTElBRXZBUUJCTDBjTkFrRUFJQUZCZm1vMkFxUUtEQUVMSUFGQmZtb2hBUXRCQUNBQk5nS2tDZzhMSUFGQkFtb2hBUXdBQ3d1SUFRRUVmMEVBS0FLa0NpRUJRUUFvQXFnS0lRSUNRQUpBQTBBZ0FTSURRUUpxSVFFZ0F5QUNUdzBCSUFFdkFRQWlCQ0FBUmcwQ0FrQWdCRUhjQUVZTkFDQUVRWFpxRGdRQ0FRRUNBUXNnQTBFRWFpRUJJQU12QVFSQkRVY05BQ0FEUVFacUlBRWdBeThCQmtFS1Joc2hBUXdBQ3d0QkFDQUJOZ0trQ2hBaUR3dEJBQ0FCTmdLa0NndHNBUUYvQWtBQ1FDQUFRVjlxSWdGQkJVc05BRUVCSUFGMFFURnhEUUVMSUFCQlJtcEIvLzhEY1VFR1NRMEFJQUJCS1VjZ0FFRllha0gvL3dOeFFRZEpjUTBBQWtBZ0FFR2xmMm9PQkFFQUFBRUFDeUFBUWYwQVJ5QUFRWVYvYWtILy93TnhRUVJKY1E4TFFRRUxMZ0VCZjBFQklRRUNRQ0FBUVpnSlFRVVFJdzBBSUFCQm9nbEJBeEFqRFFBZ0FFR29DVUVDRUNNaEFRc2dBUXVEQVFFQ2YwRUJJUUVDUUFKQUFrQUNRQUpBQWtBZ0FDOEJBQ0lDUVVWcURnUUZCQVFCQUFzQ1FDQUNRWnQvYWc0RUF3UUVBZ0FMSUFKQktVWU5CQ0FDUWZrQVJ3MERJQUJCZm1wQnRBbEJCaEFqRHdzZ0FFRithaThCQUVFOVJnOExJQUJCZm1wQnJBbEJCQkFqRHdzZ0FFRitha0hBQ1VFREVDTVBDMEVBSVFFTElBRUwzZ0VCQkg5QkFDZ0NwQW9oQUVFQUtBS29DaUVCQWtBQ1FBSkFBMEFnQUNJQ1FRSnFJUUFnQWlBQlR3MEJBa0FDUUFKQUlBQXZBUUFpQTBHa2Yyb09CUUlEQXdNQkFBc2dBMEVrUncwQ0lBSXZBUVJCK3dCSERRSkJBQ0FDUVFScUlnQTJBcVFLUVFCQkFDOEJqQW9pQWtFQmFqc0JqQXBCQUNnQ21Bb2dBa0VEZEdvaUFrRUVOZ0lBSUFJZ0FEWUNCQThMUVFBZ0FEWUNwQXBCQUVFQUx3R01Da0YvYWlJQU93R01Da0VBS0FLWUNpQUFRZi8vQTNGQkEzUnFLQUlBUVFOSERRTU1CQXNnQWtFRWFpRUFEQUFMQzBFQUlBQTJBcVFLQ3hBaUN3dTBBd0VDZjBFQUlRRUNRQUpBQWtBQ1FBSkFBa0FDUUFKQUFrQUNRQ0FBTHdFQVFaeC9hZzRVQUFFQ0NRa0pDUU1KQ1FRRkNRa0dDUWNKQ1FnSkN3SkFBa0FnQUVGK2FpOEJBRUdYZjJvT0JBQUtDZ0VLQ3lBQVFYeHFRYndJUVFJUUl3OExJQUJCZkdwQndBaEJBeEFqRHdzQ1FBSkFBa0FnQUVGK2FpOEJBRUdOZjJvT0F3QUJBZ29MQWtBZ0FFRjhhaThCQUNJQ1FlRUFSZzBBSUFKQjdBQkhEUW9nQUVGNmFrSGxBQkFrRHdzZ0FFRjZha0hqQUJBa0R3c2dBRUY4YWtIR0NFRUVFQ01QQ3lBQVFYeHFRYzRJUVFZUUl3OExJQUJCZm1vdkFRQkI3d0JIRFFZZ0FFRjhhaThCQUVIbEFFY05CZ0pBSUFCQmVtb3ZBUUFpQWtId0FFWU5BQ0FDUWVNQVJ3MEhJQUJCZUdwQjJnaEJCaEFqRHdzZ0FFRjRha0htQ0VFQ0VDTVBDeUFBUVg1cVFlb0lRUVFRSXc4TFFRRWhBU0FBUVg1cUlnQkI2UUFRSkEwRUlBQkI4Z2hCQlJBakR3c2dBRUYrYWtIa0FCQWtEd3NnQUVGK2FrSDhDRUVIRUNNUEN5QUFRWDVxUVlvSlFRUVFJdzhMQWtBZ0FFRithaThCQUNJQ1FlOEFSZzBBSUFKQjVRQkhEUUVnQUVGOGFrSHVBQkFrRHdzZ0FFRjhha0dTQ1VFREVDTWhBUXNnQVFzMEFRRi9RUUVoQVFKQUlBQkJkMnBCLy84RGNVRUZTUTBBSUFCQmdBRnlRYUFCUmcwQUlBQkJMa2NnQUJBbGNTRUJDeUFCQ3pBQkFYOENRQUpBSUFCQmQyb2lBVUVYU3cwQVFRRWdBWFJCallDQUJIRU5BUXNnQUVHZ0FVWU5BRUVBRHd0QkFRdE9BUUovUVFBaEFRSkFBa0FnQUM4QkFDSUNRZVVBUmcwQUlBSkI2d0JIRFFFZ0FFRitha0hxQ0VFRUVDTVBDeUFBUVg1cUx3RUFRZlVBUncwQUlBQkJmR3BCemdoQkJoQWpJUUVMSUFFTGNBRUNmd0pBQWtBRFFFRUFRUUFvQXFRS0lnQkJBbW9pQVRZQ3BBb2dBRUVBS0FLb0NrOE5BUUpBQWtBQ1FDQUJMd0VBSWdGQnBYOXFEZ0lCQWdBTEFrQWdBVUYyYWc0RUJBTURCQUFMSUFGQkwwY05BZ3dFQ3hBcUdnd0JDMEVBSUFCQkJHbzJBcVFLREFBTEN4QWlDd3MxQVFGL1FRQkJBVG9BOUFsQkFDZ0NwQW9oQUVFQVFRQW9BcWdLUVFKcU5nS2tDa0VBSUFCQkFDZ0MxQWxyUVFGMU5nS0VDZ3RKQVFOL1FRQWhBd0pBSUFBZ0FrRUJkQ0lDYXlJRVFRSnFJZ0JCQUNnQzFBa2lCVWtOQUNBQUlBRWdBaEFyRFFBQ1FDQUFJQVZIRFFCQkFROExJQVF2QVFBUUhpRURDeUFEQ3owQkFuOUJBQ0VDQWtCQkFDZ0MxQWtpQXlBQVN3MEFJQUF2QVFBZ0FVY05BQUpBSUFNZ0FFY05BRUVCRHdzZ0FFRithaThCQUJBZUlRSUxJQUlMYUFFQ2YwRUJJUUVDUUFKQUlBQkJYMm9pQWtFRlN3MEFRUUVnQW5SQk1YRU5BUXNnQUVINC93TnhRU2hHRFFBZ0FFRkdha0gvL3dOeFFRWkpEUUFDUUNBQVFhVi9haUlDUVFOTERRQWdBa0VCUncwQkN5QUFRWVYvYWtILy93TnhRUVJKSVFFTElBRUxuQUVCQTM5QkFDZ0NwQW9oQVFKQUEwQUNRQUpBSUFFdkFRQWlBa0V2UncwQUFrQWdBUzhCQWlJQlFTcEdEUUFnQVVFdlJ3MEVFQllNQWdzZ0FCQVhEQUVMQWtBQ1FDQUFSUTBBSUFKQmQyb2lBVUVYU3cwQlFRRWdBWFJCbjRDQUJIRkZEUUVNQWdzZ0FoQWZSUTBEREFFTElBSkJvQUZIRFFJTFFRQkJBQ2dDcEFvaUEwRUNhaUlCTmdLa0NpQURRUUFvQXFnS1NRMEFDd3NnQWd2Q0F3RUJmd0pBSUFGQklrWU5BQ0FCUVNkR0RRQVFJZzhMUVFBb0FxUUtJUUlnQVJBWUlBQWdBa0VDYWtFQUtBS2tDa0VBS0FMSUNSQUJRUUJCQUNnQ3BBcEJBbW8yQXFRS1FRQVFKaUVBUVFBb0FxUUtJUUVDUUFKQUlBQkI0UUJIRFFBZ0FVRUNha0d5Q0VFS0VDdEZEUUVMUVFBZ0FVRithallDcEFvUEMwRUFJQUZCREdvMkFxUUtBa0JCQVJBbVFmc0FSZzBBUVFBZ0FUWUNwQW9QQzBFQUtBS2tDaUlDSVFBRFFFRUFJQUJCQW1vMkFxUUtBa0FDUUFKQVFRRVFKaUlBUVNKR0RRQWdBRUVuUncwQlFTY1FHRUVBUVFBb0FxUUtRUUpxTmdLa0NrRUJFQ1loQUF3Q0MwRWlFQmhCQUVFQUtBS2tDa0VDYWpZQ3BBcEJBUkFtSVFBTUFRc2dBQkFvSVFBTEFrQWdBRUU2UmcwQVFRQWdBVFlDcEFvUEMwRUFRUUFvQXFRS1FRSnFOZ0trQ2dKQVFRRVFKaUlBUVNKR0RRQWdBRUVuUmcwQVFRQWdBVFlDcEFvUEN5QUFFQmhCQUVFQUtBS2tDa0VDYWpZQ3BBb0NRQUpBUVFFUUppSUFRU3hHRFFBZ0FFSDlBRVlOQVVFQUlBRTJBcVFLRHd0QkFFRUFLQUtrQ2tFQ2FqWUNwQXBCQVJBbVFmMEFSZzBBUVFBb0FxUUtJUUFNQVFzTFFRQW9BdWdKSWdFZ0FqWUNFQ0FCUVFBb0FxUUtRUUpxTmdJTUMyMEJBbjhDUUFKQUEwQUNRQ0FBUWYvL0EzRWlBVUYzYWlJQ1FSZExEUUJCQVNBQ2RFR2ZnSUFFY1EwQ0N5QUJRYUFCUmcwQklBQWhBaUFCRUNVTkFrRUFJUUpCQUVFQUtBS2tDaUlBUVFKcU5nS2tDaUFBTHdFQ0lnQU5BQXdDQ3dzZ0FDRUNDeUFDUWYvL0EzRUxxd0VCQkg4Q1FBSkFRUUFvQXFRS0lnSXZBUUFpQTBIaEFFWU5BQ0FCSVFRZ0FDRUZEQUVMUVFBZ0FrRUVhallDcEFwQkFSQW1JUUpCQUNnQ3BBb2hCUUpBQWtBZ0FrRWlSZzBBSUFKQkowWU5BQ0FDRUNnYVFRQW9BcVFLSVFRTUFRc2dBaEFZUVFCQkFDZ0NwQXBCQW1vaUJEWUNwQW9MUVFFUUppRURRUUFvQXFRS0lRSUxBa0FnQWlBRlJnMEFJQVVnQkVFQUlBQWdBQ0FCUmlJQ0cwRUFJQUVnQWhzUUFnc2dBd3R5QVFSL1FRQW9BcVFLSVFCQkFDZ0NxQW9oQVFKQUFrQURRQ0FBUVFKcUlRSWdBQ0FCVHcwQkFrQUNRQ0FDTHdFQUlnTkJwSDlxRGdJQkJBQUxJQUloQUNBRFFYWnFEZ1FDQVFFQ0FRc2dBRUVFYWlFQURBQUxDMEVBSUFJMkFxUUtFQ0pCQUE4TFFRQWdBallDcEFwQjNRQUxTUUVEZjBFQUlRTUNRQ0FDUlEwQUFrQURRQ0FBTFFBQUlnUWdBUzBBQUNJRlJ3MEJJQUZCQVdvaEFTQUFRUUZxSVFBZ0FrRi9haUlDRFFBTUFnc0xJQVFnQldzaEF3c2dBd3NMNUFFQ0FFR0FDQXZHQVFBQWVBQndBRzhBY2dCMEFHMEFjQUJ2QUhJQWRBQmxBSFFBWVFCbUFISUFid0J0QUhVQWJnQmpBSFFBYVFCdkFHNEFjd0J6QUdVQWNnQjBBSFlBYndCNUFHa0FaUUJrQUdVQWJBQmxBR01BYndCdUFIUUFhUUJ1QUdrQWJnQnpBSFFBWVFCdUFIUUFlUUJpQUhJQVpRQmhBSElBWlFCMEFIVUFjZ0JrQUdVQVlnQjFBR2NBWndCbEFHRUFkd0JoQUdrQWRBQm9BSElBZHdCb0FHa0FiQUJsQUdZQWJ3QnlBR2tBWmdCakFHRUFkQUJqQUdZQWFRQnVBR0VBYkFCc0FHVUFiQUJ6QUFCQnlBa0xFQUVBQUFBQ0FBQUFBQVFBQURBNUFBQT1cIixcInVuZGVmaW5lZFwiIT10eXBlb2YgQnVmZmVyP0J1ZmZlci5mcm9tKEEsXCJiYXNlNjRcIik6VWludDhBcnJheS5mcm9tKGF0b2IoQSksKEE9PkEuY2hhckNvZGVBdCgwKSkpKSkudGhlbihXZWJBc3NlbWJseS5pbnN0YW50aWF0ZSkudGhlbigoKHtleHBvcnRzOkF9KT0+e0M9QX0pKSksRX07Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9